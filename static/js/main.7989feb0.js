/*! For license information please see main.7989feb0.js.LICENSE.txt */
(()=>{var e={188:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>C});var r=n(9379),a=n(5043),i=n(5352),o=n(5016),s=n(6471),l=n(2054),c=n(4596),u=n(5469),d=n(2626),h=n(8646),f=n(247),p=n(5088),m=n(2313),g=n(8006),v=n(1360),y=n(2681),b=n(9855),x=n(7118),w=n(614),N=n(1994),S=n(1565),E=n(579);const C=()=>{var e,t;const{classroomId:n}=(0,i.g)(),C=(0,i.Zp)(),{userData:k}=(0,o.A)(),{showSuccess:A,showError:_,confirmDelete:j,showLoading:I,hideLoading:T}=(0,s.E$)(),[O,P]=(0,a.useState)(null),[D,R]=(0,a.useState)(!0),[M,F]=(0,a.useState)(""),[L,B]=(0,a.useState)("overview"),[U,z]=(0,a.useState)(!1),[V,W]=(0,a.useState)(null),[q,H]=(0,a.useState)(!1),[G,K]=(0,a.useState)(!1),[X,Y]=(0,a.useState)(null),[Q,$]=(0,a.useState)(!1),[J,Z]=(0,a.useState)({name:"",code:"",credits:"",description:""});(0,a.useEffect)(()=>{ee()},[n]);const ee=async()=>{try{R(!0),console.log("Loading classroom details for ID:",n);const e=await(0,N.Qs)(n);console.log("Classroom details result:",e),e.success?P(e.classroom):F(e.error||"Failed to load classroom details")}catch(M){console.error("Error loading classroom:",M),F("Failed to load classroom details")}finally{R(!1)}};return D?(0,E.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,E.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading classroom details..."})]})}):M?(0,E.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("p",{className:"text-red-600 mb-4",children:M}),(0,E.jsx)("button",{onClick:()=>C("/teacher-dashboard"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to Dashboard"})]})}):O?(0,E.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 safe-area-top safe-area-bottom",children:[(0,E.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-6 sm:py-8",children:[(0,E.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 mb-6 sm:mb-8",children:[(0,E.jsxs)("button",{onClick:()=>C("/teacher-dashboard"),className:"flex items-center gap-2 px-4 py-2 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow text-sm sm:text-base min-h-10 touch-manipulation",children:[(0,E.jsx)(u.A,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Back to Dashboard"})]}),(0,E.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,E.jsx)("h1",{className:"text-xl sm:text-3xl font-bold text-gray-800 truncate",children:O.name}),(0,E.jsx)("p",{className:"text-sm sm:text-base text-gray-600",children:O.description||"No description available"})]})]}),(0,E.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 sm:gap-8",children:[(0,E.jsxs)("div",{className:"lg:col-span-1 space-y-4 sm:space-y-6",children:[(0,E.jsxs)("div",{className:"bg-white rounded-xl sm:rounded-2xl p-4 sm:p-6 shadow-sm",children:[(0,E.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-800 mb-4",children:"Classroom Code"}),(0,E.jsxs)("div",{className:"flex items-center gap-3",children:[(0,E.jsx)("div",{className:"flex-1 bg-gray-50 rounded-lg p-3 font-mono text-base sm:text-lg font-bold text-center min-h-12",children:O.code||"N/A"}),(0,E.jsx)("button",{onClick:()=>{null!==O&&void 0!==O&&O.code&&(navigator.clipboard.writeText(O.code),H(!0),setTimeout(()=>H(!1),2e3))},className:"p-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors min-h-12 min-w-12 flex items-center justify-center touch-manipulation",disabled:!O.code,children:q?(0,E.jsx)(l.A,{className:"w-4 h-4"}):(0,E.jsx)(m.A,{className:"w-4 h-4"})})]}),(0,E.jsx)("p",{className:"text-xs sm:text-sm text-gray-500 mt-2",children:"Share this code with students to join"})]}),(0,E.jsxs)("div",{className:"bg-white rounded-xl sm:rounded-2xl p-4 sm:p-6 shadow-sm",children:[(0,E.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-800 mb-4",children:"Information"}),(0,E.jsxs)("div",{className:"space-y-4",children:[(0,E.jsxs)("div",{className:"flex items-center gap-3 cursor-pointer hover:bg-blue-50 p-3 rounded-lg transition-colors touch-manipulation",onClick:()=>$(!0),children:[(0,E.jsx)(x.A,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),(0,E.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,E.jsx)("p",{className:"font-medium text-sm sm:text-base",children:"Students"}),(0,E.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600",children:[O.studentCount||0," enrolled"]})]})]}),(0,E.jsxs)("div",{className:"flex items-center gap-3",children:[(0,E.jsx)(h.A,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),(0,E.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,E.jsx)("p",{className:"font-medium",children:"Academic Year"}),(0,E.jsx)("p",{className:"text-sm text-gray-600",children:O.academicYear||"N/A"})]})]}),O.location&&(0,E.jsxs)("div",{className:"flex items-center gap-3",children:[(0,E.jsx)(g.A,{className:"w-5 h-5 text-red-600"}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"font-medium",children:"Location"}),(0,E.jsx)("p",{className:"text-sm text-gray-600",children:O.location.name||"N/A"}),O.location.address&&(0,E.jsx)("p",{className:"text-xs text-gray-500",children:O.location.address})]})]}),(0,E.jsxs)("div",{className:"flex items-center gap-3",children:[(0,E.jsx)(d.A,{className:"w-5 h-5 text-purple-600"}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"font-medium",children:"Subjects"}),(0,E.jsxs)("p",{className:"text-sm text-gray-600",children:[(null===(e=O.subjects)||void 0===e?void 0:e.length)||0," subjects"]})]})]})]})]}),(0,E.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,E.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Quick Actions"}),(0,E.jsxs)("div",{className:"space-y-3",children:[(0,E.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors",children:[(0,E.jsx)(y.A,{className:"w-5 h-5"}),"Generate QR Code"]}),(0,E.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors",children:[(0,E.jsx)(f.A,{className:"w-5 h-5"}),"Face Recognition"]}),(0,E.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 bg-purple-50 text-purple-700 rounded-lg hover:bg-purple-100 transition-colors",children:[(0,E.jsx)(p.A,{className:"w-5 h-5"}),"Take Attendance"]})]})]})]}),(0,E.jsx)("div",{className:"lg:col-span-2",children:(0,E.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,E.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Subjects"}),(0,E.jsxs)("button",{onClick:()=>z(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,E.jsx)(v.A,{className:"w-4 h-4"}),"Add Subject"]})]}),(0,E.jsx)("div",{className:"space-y-4",children:O.subjects&&O.subjects.length>0?O.subjects.map(e=>(0,E.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,E.jsxs)("div",{className:"flex items-start justify-between",children:[(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsx)("h4",{className:"font-semibold text-gray-800",children:e.name}),(0,E.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Code: ",e.code]}),e.credits&&(0,E.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Credits: ",e.credits]}),e.description&&(0,E.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:e.description}),(0,E.jsxs)("button",{onClick:()=>{Y(e),K(!0)},className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors",children:[(0,E.jsx)(y.A,{className:"w-4 h-4"}),"Generate QR Code"]})]}),(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)("button",{onClick:()=>W(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:(0,E.jsx)(c.A,{className:"w-4 h-4"})}),(0,E.jsx)("button",{onClick:()=>(async e=>{await j(e.name,async()=>{try{I("Deleting subject...");const t=await(0,N.gg)(n,e.id);t.success?(await ee(),T(),A('Subject "'.concat(e.name,'" deleted successfully!'))):(T(),_("Failed to delete subject: "+t.error))}catch(M){console.error("Error deleting subject:",M),T(),_("Error deleting subject. Please try again.")}})})(e),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:(0,E.jsx)(b.A,{className:"w-4 h-4"})})]})]})},e.id)):(0,E.jsxs)("div",{className:"text-center py-12",children:[(0,E.jsx)(d.A,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,E.jsx)("p",{className:"text-gray-500 text-lg mb-2",children:"No subjects added yet"}),(0,E.jsx)("p",{className:"text-gray-400",children:"Add subjects to organize your classroom content"})]})})]})})]})]}),U&&(0,E.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,E.jsxs)("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md mx-4",children:[(0,E.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Add New Subject"}),(0,E.jsxs)("div",{className:"space-y-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),(0,E.jsx)("input",{type:"text",value:J.name,onChange:e=>Z((0,r.A)((0,r.A)({},J),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Computer Science"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Code"}),(0,E.jsx)("input",{type:"text",value:J.code,onChange:e=>Z((0,r.A)((0,r.A)({},J),{},{code:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., CS101"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credits"}),(0,E.jsx)("input",{type:"number",value:J.credits,onChange:e=>Z((0,r.A)((0,r.A)({},J),{},{credits:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 3"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,E.jsx)("textarea",{value:J.description,onChange:e=>Z((0,r.A)((0,r.A)({},J),{},{description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Brief description of the subject",rows:"3"})]})]}),(0,E.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,E.jsx)("button",{onClick:()=>{z(!1),Z({name:"",code:"",credits:"",description:""})},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,E.jsx)("button",{onClick:async()=>{try{I("Adding subject...");const e=await(0,N.uo)(n,J);e.success?(await ee(),Z({name:"",code:"",credits:"",description:""}),z(!1),T(),A('Subject "'.concat(J.name,'" added successfully!'))):(T(),_("Failed to add subject: "+e.error))}catch(M){console.error("Error adding subject:",M),T(),_("Error adding subject. Please try again.")}},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add Subject"})]})]})}),Q&&(0,E.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,E.jsxs)("div",{className:"bg-white rounded-2xl p-6 w-full max-w-2xl mx-4 max-h-[80vh] overflow-y-auto",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,E.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Enrolled Students"}),(0,E.jsx)("button",{onClick:()=>$(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:(0,E.jsx)(w.A,{className:"w-5 h-5"})})]}),(0,E.jsx)("div",{className:"space-y-4",children:O.students&&O.students.length>0?O.students.map((e,t)=>(0,E.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:(0,E.jsx)(x.A,{className:"w-5 h-5 text-blue-600"})}),(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsx)("h4",{className:"font-semibold text-gray-800",children:e.name}),(0,E.jsx)("p",{className:"text-sm text-gray-600",children:e.email}),(0,E.jsxs)("p",{className:"text-xs text-gray-500",children:["Student ID: ",e.id]}),e.joinedAt&&(0,E.jsxs)("p",{className:"text-xs text-gray-500",children:["Joined: ",e.joinedAt.toDate?e.joinedAt.toDate().toLocaleDateString():new Date(e.joinedAt).toLocaleDateString()]})]})]},e.id||t)):(0,E.jsxs)("div",{className:"text-center py-12",children:[(0,E.jsx)(x.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,E.jsx)("h4",{className:"text-lg font-semibold text-gray-600 mb-2",children:"No Students Enrolled"}),(0,E.jsx)("p",{className:"text-gray-500",children:"Students will appear here once they join the classroom"})]})}),(0,E.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:(0,E.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[(0,E.jsxs)("span",{children:["Total Students: ",(null===(t=O.students)||void 0===t?void 0:t.length)||0]}),(0,E.jsxs)("span",{children:["Classroom Code: ",O.code]})]})})]})}),G&&(0,E.jsx)(S.default,{classroomId:n,subjectData:X,onClose:()=>{K(!1),Y(null)}})]}):(0,E.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("p",{className:"text-gray-600 mb-4",children:"Classroom not found"}),(0,E.jsx)("button",{onClick:()=>C("/teacher-dashboard"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to Dashboard"})]})})}},247:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},253:(e,t,n)=>{"use strict";n.d(t,{Dl:()=>p,OR:()=>f,Q8:()=>u,U6:()=>o,ih:()=>m,lz:()=>c,mt:()=>s,rq:()=>l});var r=n(9379),a=n(6667),i=n(1121);const o=async(e,t)=>{try{if(!e)throw new Error("Teacher ID is required but was undefined or null");const n=Date.now().toString(36)+Math.random().toString(36).substr(2),r={latitude:parseFloat(t.latitude),longitude:parseFloat(t.longitude),address:t.address||"Manual Location"},o={sessionId:n,location:r,subject:t.subject,teacherId:e,timestamp:Date.now()},s={sessionId:n,teacherId:e,subject:t.subject,location:r,qrData:JSON.stringify(o),createdAt:(0,a.O5)(),isActive:!0,expiresAt:new Date(Date.now()+108e5),attendeeCount:0,attendees:[]};return{success:!0,sessionId:n,docId:(await(0,a.gS)((0,a.rJ)(i.db,"attendanceSessions"),s)).id,qrData:JSON.stringify(o)}}catch(n){return console.error("Error creating attendance session:",n),{success:!1,error:n.message}}},s=async e=>{try{const t=(0,a.P)((0,a.rJ)(i.db,"attendanceSessions"),(0,a._M)("teacherId","==",e)),n=await(0,a.GG)(t),o=[];return n.forEach(e=>{const t=e.data();!0===t.isActive&&o.push((0,r.A)({id:e.id},t))}),o.sort((e,t)=>{var n,r,a,i;const o=(null===(n=e.createdAt)||void 0===n||null===(r=n.toDate)||void 0===r?void 0:r.call(n))||new Date(e.createdAt)||new Date(0);return((null===(a=t.createdAt)||void 0===a||null===(i=a.toDate)||void 0===i?void 0:i.call(a))||new Date(t.createdAt)||new Date(0))-o}),{success:!0,sessions:o}}catch(t){return console.error("Error getting teacher sessions:",t),{success:!1,error:t.message}}},l=async(e,t,n)=>{try{var r;const o=(0,a.P)((0,a.rJ)(i.db,"attendanceSessions"),(0,a._M)("sessionId","==",e)),s=await(0,a.GG)(o);if(s.empty)return{success:!1,error:"Session not found"};const l=s.docs[0],c=l.data();if(null===(r=c.attendees)||void 0===r?void 0:r.find(e=>e.studentId===t.studentId))return{success:!1,error:"Attendance already marked for this session"};const u={sessionId:e,studentId:t.studentId,studentName:t.name,studentEmail:t.email,markedAt:(0,a.O5)(),location:n.location,locationVerified:n.locationVerified,qrVerified:n.qrVerified,faceVerified:n.faceVerified,status:"present"};console.log("\ud83d\udcbe Creating attendance record:",u);const d=await(0,a.gS)((0,a.rJ)(i.db,"attendanceRecords"),u);return console.log("\u2705 Attendance record saved with ID:",d.id),await(0,a.mZ)((0,a.doc)(i.db,"attendanceSessions",l.id),{attendees:(0,a.hq)({studentId:t.studentId,studentName:t.name,markedAt:new Date,location:n.location}),attendeeCount:(c.attendeeCount||0)+1}),console.log("\u2705 Session updated with new attendee"),{success:!0,message:"Attendance marked successfully!",recordId:d.id}}catch(o){return console.error("Error marking attendance:",o),{success:!1,error:o.message}}},c=async e=>{try{const t=(0,a.P)((0,a.rJ)(i.db,"attendanceSessions"),(0,a._M)("sessionId","==",e)),n=await(0,a.GG)(t);if(!n.empty){const e=n.docs[0];await(0,a.mZ)((0,a.doc)(i.db,"attendanceSessions",e.id),{isActive:!1,endedAt:(0,a.O5)()})}return{success:!0,message:"Session ended successfully"}}catch(t){return console.error("Error ending session:",t),{success:!1,error:t.message}}},u=async e=>{try{console.log("\ud83d\udd0d Getting attendance for sessionId:",e);const t=(0,a.P)((0,a.rJ)(i.db,"attendanceRecords"),(0,a._M)("sessionId","==",e)),n=await(0,a.GG)(t),o=[];return console.log("\ud83d\udcca Found",n.size,"attendance records"),n.forEach(e=>{const t=e.data();console.log("\ud83d\udcdd Attendance record:",t),o.push((0,r.A)({id:e.id},t))}),o.sort((e,t)=>{var n,r,a,i;const o=(null===(n=e.markedAt)||void 0===n||null===(r=n.toDate)||void 0===r?void 0:r.call(n))||new Date(e.markedAt);return((null===(a=t.markedAt)||void 0===a||null===(i=a.toDate)||void 0===i?void 0:i.call(a))||new Date(t.markedAt))-o}),console.log("\u2705 Returning",o.length,"sorted attendance records"),{success:!0,records:o}}catch(t){return console.error("\u274c Error getting session attendance:",t),{success:!1,error:t.message,records:[]}}},d=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;try{const n=(0,a.P)((0,a.rJ)(i.db,"attendanceRecords"),(0,a._M)("studentId","==",e),(0,a.My)("markedAt","desc")),r=await(0,a.GG)(n),o=[];return r.forEach(e=>{var t,n,r,a,i;const s=e.data();o.push({id:e.id,subject:s.subject||"Unknown Subject",date:(null===(t=s.markedAt)||void 0===t||null===(n=t.toDate)||void 0===n?void 0:n.call(t))||new Date(s.markedAt),time:(null===(r=s.markedAt)||void 0===r||null===(a=r.toDate)||void 0===a||null===(i=a.call(r))||void 0===i?void 0:i.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}))||new Date(s.markedAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),status:s.status||"Present",sessionData:s.sessionData})}),{success:!0,records:o.slice(0,t)}}catch(n){return console.error("Error getting student recent attendance:",n),{success:!1,error:n.message,records:[]}}},h=async e=>{try{const t=(0,a.P)((0,a.rJ)(i.db,"attendanceRecords"),(0,a._M)("studentId","==",e)),n=await(0,a.GG)(t),r={};n.forEach(e=>{const t=e.data(),n=t.subject||"Unknown Subject";r[n]||(r[n]={total:0,present:0,absent:0,late:0}),r[n].total++,"Present"===t.status?r[n].present++:"Absent"===t.status?r[n].absent++:"Late"===t.status&&r[n].late++});const o=(0,a.P)((0,a.rJ)(i.db,"studentGrades"),(0,a._M)("studentId","==",e)),s=await(0,a.GG)(o),l={};s.forEach(e=>{const t=e.data();l[t.subject]={grade:t.grade,percentage:t.percentage,lastUpdated:t.lastUpdated}});const c=[];return Object.keys(r).forEach(e=>{const t=r[e],n=Math.round(t.present/t.total*100),a=l[e];let i="B",o=n;a?(i=a.grade,o=a.percentage):i=n>=90?"A+":n>=85?"A":n>=80?"B+":n>=75?"B":n>=70?"C":"D",c.push({subject:e,attendancePercentage:n,performancePercentage:o,grade:i,totalClasses:t.total,attendedClasses:t.present,absentClasses:t.absent,lateClasses:t.late})}),{success:!0,performance:c}}catch(t){return console.error("Error getting student subject performance:",t),{success:!1,error:t.message,performance:[]}}},f=async e=>{try{const[t,n]=await Promise.all([d(e,5),h(e)]);return{success:!0,recentAttendance:t.records||[],subjectPerformance:n.performance||[],error:null}}catch(t){return console.error("Error getting student dashboard data:",t),{success:!1,recentAttendance:[],subjectPerformance:[],error:t.message}}},p=async e=>{try{const t=[{studentId:e,subject:"Data Structures",status:"Present",markedAt:new Date("2024-09-12T09:15:00"),sessionData:{subject:"Data Structures",location:"Room 101"}},{studentId:e,subject:"Web Development",status:"Present",markedAt:new Date("2024-09-11T10:30:00"),sessionData:{subject:"Web Development",location:"Lab 201"}},{studentId:e,subject:"Database Systems",status:"Late",markedAt:new Date("2024-09-10T09:45:00"),sessionData:{subject:"Database Systems",location:"Room 301"}},{studentId:e,subject:"Software Engineering",status:"Present",markedAt:new Date("2024-09-09T11:15:00"),sessionData:{subject:"Software Engineering",location:"Room 102"}},{studentId:e,subject:"Machine Learning",status:"Absent",markedAt:new Date("2024-09-08T10:00:00"),sessionData:{subject:"Machine Learning",location:"Lab 301"}}];for(const e of t)await(0,a.gS)((0,a.rJ)(i.db,"attendanceRecords"),e);return{success:!0,message:"Sample data added successfully"}}catch(t){return console.error("Error adding sample data:",t),{success:!1,error:t.message}}},m=async e=>{try{const t=[{studentId:e,subject:"Data Structures",grade:"A",percentage:85,lastUpdated:new Date},{studentId:e,subject:"Web Development",grade:"A+",percentage:92,lastUpdated:new Date},{studentId:e,subject:"Database Systems",grade:"B+",percentage:78,lastUpdated:new Date},{studentId:e,subject:"Software Engineering",grade:"A",percentage:88,lastUpdated:new Date},{studentId:e,subject:"Machine Learning",grade:"B",percentage:75,lastUpdated:new Date}];for(const e of t)await(0,a.gS)((0,a.rJ)(i.db,"studentGrades"),e);return{success:!0,message:"Sample grades added successfully"}}catch(t){return console.error("Error adding sample grades:",t),{success:!1,error:t.message}}}},254:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},350:(e,t,n)=>{const r=n(7969),a=r.getBCHDigit(1335);t.getEncodedBits=function(e,t){const n=e.bit<<3|t;let i=n<<10;for(;r.getBCHDigit(i)-a>=0;)i^=1335<<r.getBCHDigit(i)-a;return 21522^(n<<10|i)}},356:(e,t,n)=>{e.exports=n(9645).last},516:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},579:(e,t,n)=>{"use strict";e.exports=n(5180)},614:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},745:()=>{},797:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},817:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]])},823:(e,t,n)=>{"use strict";n.d(t,{eJ:()=>ht,xI:()=>Bn,hg:()=>mt,signInWithEmailAndPassword:()=>ft,CI:()=>gt,r7:()=>pt});var r=n(3986),a=n(9379),i=n(1150),o=n(1776),s=n(2965),l=n(9606);const c=["providerId"],u=["uid","auth","stsTokenManager"],d=["providerId","signInMethod"];function h(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const f=h,p=new o.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),m=new s.Vy("@firebase/auth");function g(e){if(m.logLevel<=s.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];m.error("Auth (".concat(i.MF,"): ").concat(e),...n)}}function v(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw w(e,...n)}function y(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return w(e,...n)}function b(e,t,n){const r=(0,a.A)((0,a.A)({},f()),{},{[t]:n});return new o.FA("auth","Firebase",r).create(t,{appName:e.name})}function x(e){return b(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function w(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return p.create(e,...n)}function N(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];throw w(t,...r)}}function S(e){const t="INTERNAL ASSERTION FAILED: "+e;throw g(t),new Error(t)}function E(e,t){e||S(t)}function C(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function k(){return"http:"===A()||"https:"===A()}function A(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class _{constructor(e,t){this.shortDelay=e,this.longDelay=t,E(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,o.jZ)()||(0,o.lV)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(k()||(0,o.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function j(e,t){E(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class I{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void S("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void S("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void S("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const T={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},O=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],P=new _(3e4,6e4);function D(e,t){return e.tenantId&&!t.tenantId?(0,a.A)((0,a.A)({},t),{},{tenantId:e.tenantId}):t}async function R(e,t,n,r){return M(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const l=(0,o.Am)((0,a.A)({key:e.config.apiKey},s)).slice(1),c=await e._getAdditionalHeaders();c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode);const u=(0,a.A)({method:t,headers:c},i);return(0,o.c1)()||(u.referrerPolicy="no-referrer"),e.emulatorConfig&&(0,o.zJ)(e.emulatorConfig.host)&&(u.credentials="include"),I.fetch()(await L(e,e.config.apiHost,n,l),u)})}async function M(e,t,n){e._canInitEmulator=!1;const r=(0,a.A)((0,a.A)({},T),t);try{const t=new U(e),a=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw z(e,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const t=a.ok?i.errorMessage:i.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw z(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw z(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw z(e,"user-disabled",i);const s=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw b(e,s,o);v(e,s)}}catch(i){if(i instanceof o.g)throw i;v(e,"network-request-failed",{message:String(i)})}}async function F(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=await R(e,t,n,r,a);return"mfaPendingCredential"in i&&v(e,"multi-factor-auth-required",{_serverResponse:i}),i}async function L(e,t,n,r){const a="".concat(t).concat(n,"?").concat(r),i=e,o=i.config.emulator?j(e.config,a):"".concat(e.config.apiScheme,"://").concat(a);if(O.includes(n)&&(await i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())){return i._getPersistence()._getFinalTarget(o).toString()}return o}function B(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class U{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(y(this.auth,"network-request-failed")),P.get())})}}function z(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const a=y(e,t,r);return a.customData._tokenResponse=n,a}function V(e){return void 0!==e&&void 0!==e.enterprise}class W{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return B(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function q(e,t){return R(e,"GET","/v2/recaptchaConfig",D(e,t))}async function H(e,t){return R(e,"POST","/v1/accounts:lookup",t)}function G(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function K(e){return 1e3*Number(e)}function X(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return g("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,o.u)(n);return e?JSON.parse(e):(g("Failed to decode base64 JWT payload"),null)}catch(a){return g("Caught error parsing JWT payload as JSON",null===a||void 0===a?void 0:a.toString()),null}}function Y(e){const t=X(e);return N(t,"internal-error"),N("undefined"!==typeof t.exp,"internal-error"),N("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Q(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof o.g&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class ${constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{var t;this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class J{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=G(this.lastLoginAt),this.creationTime=G(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Z(e){var t;const n=e.auth,r=await e.getIdToken(),a=await Q(e,H(n,{idToken:r}));N(null===a||void 0===a?void 0:a.users.length,n,"internal-error");const i=a.users[0];e._notifyReloadListener(i);const o=null!==(t=i.providerUserInfo)&&void 0!==t&&t.length?ee(i.providerUserInfo):[],s=(l=e.providerData,c=o,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&i.passwordHash)&&!(null!==s&&void 0!==s&&s.length),h=!!u&&d,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new J(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function ee(e){return e.map(e=>{let{providerId:t}=e,n=(0,r.A)(e,c);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class te{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){N(e.idToken,"internal-error"),N("undefined"!==typeof e.idToken,"internal-error"),N("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Y(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){N(0!==e.length,"internal-error");const t=Y(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(N(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:a}=await async function(e,t){const n=await M(e,{},async()=>{const n=(0,o.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:a}=e.config,i=await L(e,r,"/v1/token","key=".concat(a)),s=await e._getAdditionalHeaders();s["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:s,body:n};return e.emulatorConfig&&(0,o.zJ)(e.emulatorConfig.host)&&(l.credentials="include"),I.fetch()(i,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(a))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:a}=t,i=new te;return n&&(N("string"===typeof n,"internal-error",{appName:e}),i.refreshToken=n),r&&(N("string"===typeof r,"internal-error",{appName:e}),i.accessToken=r),a&&(N("number"===typeof a,"internal-error",{appName:e}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new te,this.toJSON())}_performRefresh(){return S("not implemented")}}function ne(e,t){N("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class re{constructor(e){let{uid:t,auth:n,stsTokenManager:a}=e,i=(0,r.A)(e,u);this.providerId="firebase",this.proactiveRefresh=new $(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new J(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Q(this,this.stsTokenManager.getToken(this.auth,e));return N(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(0,o.Ku)(e),r=await n.getIdToken(t),a=X(r);N(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const i="object"===typeof a.firebase?a.firebase:void 0,s=null===i||void 0===i?void 0:i.sign_in_provider;return{claims:a,token:r,authTime:G(K(a.auth_time)),issuedAtTime:G(K(a.iat)),expirationTime:G(K(a.exp)),signInProvider:s||null,signInSecondFactor:(null===i||void 0===i?void 0:i.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=(0,o.Ku)(e);await Z(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(N(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>(0,a.A)({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new re((0,a.A)((0,a.A)({},this),{},{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){N(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Z(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,i.xZ)(this.auth.app))return Promise.reject(x(this.auth));const e=await this.getIdToken();return await Q(this,async function(e,t){return R(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return(0,a.A)((0,a.A)({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>(0,a.A)({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{},{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,o,s,l,c,u;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,f=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,p=null!==(o=t.photoURL)&&void 0!==o?o:void 0,m=null!==(s=t.tenantId)&&void 0!==s?s:void 0,g=null!==(l=t._redirectEventId)&&void 0!==l?l:void 0,v=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:b,emailVerified:x,isAnonymous:w,providerData:S,stsTokenManager:E}=t;N(b&&E,e,"internal-error");const C=te.fromJSON(this.name,E);N("string"===typeof b,e,"internal-error"),ne(d,e.name),ne(h,e.name),N("boolean"===typeof x,e,"internal-error"),N("boolean"===typeof w,e,"internal-error"),ne(f,e.name),ne(p,e.name),ne(m,e.name),ne(g,e.name),ne(v,e.name),ne(y,e.name);const k=new re({uid:b,auth:e,email:h,emailVerified:x,displayName:d,isAnonymous:w,photoURL:p,phoneNumber:f,tenantId:m,stsTokenManager:C,createdAt:v,lastLoginAt:y});return S&&Array.isArray(S)&&(k.providerData=S.map(e=>(0,a.A)({},e))),g&&(k._redirectEventId=g),k}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new te;r.updateFromServerResponse(t);const a=new re({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Z(a),a}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];N(void 0!==r.localId,"internal-error");const a=void 0!==r.providerUserInfo?ee(r.providerUserInfo):[],i=!(r.email&&r.passwordHash)&&!(null!==a&&void 0!==a&&a.length),o=new te;o.updateFromIdToken(n);const s=new re({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:i}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new J(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null!==a&&void 0!==a&&a.length)};return Object.assign(s,l),s}}const ae=new Map;function ie(e){E(e instanceof Function,"Expected a class definition");let t=ae.get(e);return t?(E(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ae.set(e,t),t)}class oe{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}oe.type="NONE";const se=oe;function le(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class ce{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:a}=this.auth;this.fullUserKey=le(this.userKey,r.apiKey,a),this.fullPersistenceKey=le("persistence",r.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await H(this.auth,{idToken:e}).catch(()=>{});return t?re._fromGetAccountInfoResponse(this.auth,t,e):null}return re._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new ce(ie(se),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let a=r[0]||ie(se);const i=le(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(i);if(t){let n;if("string"===typeof t){const r=await H(e,{idToken:t}).catch(()=>{});if(!r)break;n=await re._fromGetAccountInfoResponse(e,r,t)}else n=re._fromJSON(e,t);c!==a&&(o=n),a=c;break}}catch(l){}const s=r.filter(e=>e._shouldAllowMigration);return a._shouldAllowMigration&&s.length?(a=s[0],o&&await a._set(i,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==a)try{await e._remove(i)}catch(t){}})),new ce(a,e,n)):new ce(a,e,n)}}function ue(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(pe(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(de(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ge(t))return"Blackberry";if(ve(t))return"Webos";if(he(t))return"Safari";if((t.includes("chrome/")||fe(t))&&!t.includes("edge/"))return"Chrome";if(me(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function de(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.ZQ)();return/firefox\//i.test(e)}function he(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.ZQ)()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function fe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.ZQ)();return/crios\//i.test(e)}function pe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.ZQ)();return/iemobile/i.test(e)}function me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.ZQ)();return/android/i.test(e)}function ge(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.ZQ)();return/blackberry/i.test(e)}function ve(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.ZQ)();return/webos/i.test(e)}function ye(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.ZQ)();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function be(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.ZQ)();return ye(e)||me(e)||ve(e)||ge(e)||/windows phone/i.test(e)||pe(e)}function xe(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=ue((0,o.ZQ)());break;case"Worker":t="".concat(ue((0,o.ZQ)()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(i.MF,"/").concat(r)}class we{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(a){r(a)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class Ne{constructor(e){var t,n,r,a;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=i.minPasswordLength)&&void 0!==t?t:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(n=null===(r=e.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==n?n:"",this.forceUpgradeOnSignin=null!==(a=e.forceUpgradeOnSignin)&&void 0!==a&&a,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,a,i,o;const s={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,s),this.validatePasswordCharacterOptions(e,s),s.isValid&&(s.isValid=null===(t=s.meetsMinPasswordLength)||void 0===t||t),s.isValid&&(s.isValid=null===(n=s.meetsMaxPasswordLength)||void 0===n||n),s.isValid&&(s.isValid=null===(r=s.containsLowercaseLetter)||void 0===r||r),s.isValid&&(s.isValid=null===(a=s.containsUppercaseLetter)||void 0===a||a),s.isValid&&(s.isValid=null===(i=s.containsNumericCharacter)||void 0===i||i),s.isValid&&(s.isValid=null===(o=s.containsNonAlphanumericCharacter)||void 0===o||o),s}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class Se{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ce(this),this.idTokenSubscription=new Ce(this),this.beforeStateQueue=new we(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=p,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ie(t)),this._initializationPromise=this.queue(async()=>{var n,r,a;if(!this._deleted&&(this.persistenceManager=await ce.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null!==(r=this._popupRedirectResolver)&&void 0!==r&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(a=this.currentUser)||void 0===a?void 0:a.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await H(this,{idToken:e}),n=await re._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if((0,i.xZ)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){var a,o;await this.getOrInitRedirectPersistenceManager();const t=null===(a=this.redirectUser)||void 0===a?void 0:a._redirectEventId,i=null===(o=n)||void 0===o?void 0:o._redirectEventId,s=await this.tryRedirectSignIn(e);t&&t!==i||null===s||void 0===s||!s.user||(n=s.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(s){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return N(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Z(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,i.xZ)(this.app))return Promise.reject(x(this));const t=e?(0,o.Ku)(e):null;return t&&N(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&N(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(0,i.xZ)(this.app)?Promise.reject(x(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,i.xZ)(this.app)?Promise.reject(x(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ie(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return R(e,"GET","/v2/passwordPolicy",D(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Ne(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new o.FA("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return R(e,"POST","/v2/accounts:revokeToken",D(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ie(e)||this._popupRedirectResolver;N(t,this,"argument-error"),this.redirectPersistenceManager=await ce.create(this,[ie(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const a="function"===typeof t?t:t.next.bind(t);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(N(o,this,"internal-error"),o.then(()=>{i||a(this.currentUser)}),"function"===typeof t){const a=e.addObserver(t,n,r);return()=>{i=!0,a()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return N(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xe(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if((0,i.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return null!==t&&void 0!==t&&t.error&&function(e){if(m.logLevel<=s.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];m.warn("Auth (".concat(i.MF,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function Ee(e){return(0,o.Ku)(e)}class Ce{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,o.tD)(e=>this.observer=e)}get next(){return N(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ke={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ae(e){return ke.loadJS(e)}function _e(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class je{constructor(){this.enterprise=new Ie}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Ie{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Te="NO_RECAPTCHA";class Oe{constructor(e){this.type="recaptcha-enterprise",this.auth=Ee(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const a=window.grecaptcha;V(a)?a.enterprise.ready(()=>{a.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Te)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new je).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{q(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new W(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(a=>{if(!t&&V(window.grecaptcha))n(a,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=ke.recaptchaEnterpriseScript;0!==t.length&&(t+=a),Ae(t).then(()=>{n(a,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function Pe(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o=new Oe(e);let s;if(i)s=Te;else try{s=await o.verify(n)}catch(c){s=await o.verify(n,!0)}const l=(0,a.A)({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in l){const e=l.phoneEnrollmentInfo.phoneNumber,t=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const e=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:s}):Object.assign(l,{captchaResponse:s}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function De(e,t,n,r,a){if("EMAIL_PASSWORD_PROVIDER"===a){var i;if(null!==(i=e._getRecaptchaConfig())&&void 0!==i&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Pe(e,t,n,"getOobCode"===n);return r(e,a)}return r(e,t).catch(async a=>{if(a.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const a=await Pe(e,t,n,"getOobCode"===n);return r(e,a)}return Promise.reject(a)})}if("PHONE_PROVIDER"===a){var o;if(null!==(o=e._getRecaptchaConfig())&&void 0!==o&&o.isProviderEnabled("PHONE_PROVIDER")){const a=await Pe(e,t,n);return r(e,a).catch(async a=>{var i;if("AUDIT"===(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.getProviderEnforcementState("PHONE_PROVIDER"))&&(a.code==="auth/".concat("missing-recaptcha-token")||a.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(n," flow."));const a=await Pe(e,t,n,!1,!0);return r(e,a)}return Promise.reject(a)})}{const a=await Pe(e,t,n,!1,!0);return r(e,a)}}return Promise.reject(a+" provider is not supported.")}async function Re(e){const t=Ee(e),n=await q(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new W(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Oe(t).verify()}}function Me(e,t,n){const r=Ee(e);N(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const a=!(null===n||void 0===n||!n.disableWarnings),i=Fe(t),{host:s,port:l}=function(e){const t=Fe(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const e=a[1];return{host:e,port:Le(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Le(t)}}}(t),c=null===l?"":":".concat(l),u={url:"".concat(i,"//").concat(s).concat(c,"/")},d=Object.freeze({host:s,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator)return N(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void N((0,o.bD)(u,r.config.emulator)&&(0,o.bD)(d,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,(0,o.zJ)(s)?((0,o.gE)("".concat(i,"//").concat(s).concat(c)),(0,o.P1)("Auth",!0)):a||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Fe(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Le(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Be{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return S("not implemented")}_getIdTokenResponse(e){return S("not implemented")}_linkToIdToken(e,t){return S("not implemented")}_getReauthenticationResolver(e){return S("not implemented")}}async function Ue(e,t){return R(e,"POST","/v1/accounts:signUp",t)}async function ze(e,t){return F(e,"POST","/v1/accounts:signInWithPassword",D(e,t))}class Ve extends Be{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Ve(e,t,"password")}static _fromEmailAndCode(e,t){return new Ve(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if(null!==t&&void 0!==t&&t.email&&null!==t&&void 0!==t&&t.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return De(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",ze,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return F(e,"POST","/v1/accounts:signInWithEmailLink",D(e,t))}(e,{email:this._email,oobCode:this._password});default:v(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return De(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ue,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return F(e,"POST","/v1/accounts:signInWithEmailLink",D(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:v(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function We(e,t){return F(e,"POST","/v1/accounts:signInWithIdp",D(e,t))}class qe extends Be{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new qe(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):v("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:a}=t,i=(0,r.A)(t,d);if(!n||!a)return null;const o=new qe(n,a);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){return We(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,We(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,We(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,o.Am)(t)}return e}}async function He(e,t){return R(e,"POST","/v1/accounts:sendVerificationCode",D(e,t))}const Ge={USER_NOT_FOUND:"user-not-found"};class Ke extends Be{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ke({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ke({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return F(e,"POST","/v1/accounts:signInWithPhoneNumber",D(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await F(e,"POST","/v1/accounts:signInWithPhoneNumber",D(e,t));if(n.temporaryProof)throw z(e,"account-exists-with-different-credential",n);return n}(e,(0,a.A)({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return F(e,"POST","/v1/accounts:signInWithPhoneNumber",D(e,(0,a.A)((0,a.A)({},t),{},{operation:"REAUTH"})),Ge)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}=e;return n||t||r||a?new Ke({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}):null}}class Xe{constructor(e){var t,n,r,a,i,s;const l=(0,o.I9)((0,o.hp)(e)),c=null!==(t=l.apiKey)&&void 0!==t?t:null,u=null!==(n=l.oobCode)&&void 0!==n?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=l.mode)&&void 0!==r?r:null);N(c&&u&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=u,this.continueUrl=null!==(a=l.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(i=l.lang)&&void 0!==i?i:null,this.tenantId=null!==(s=l.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=(0,o.I9)((0,o.hp)(e)).link,n=t?(0,o.I9)((0,o.hp)(t)).deep_link_id:null,r=(0,o.I9)((0,o.hp)(e)).deep_link_id;return(r?(0,o.I9)((0,o.hp)(r)).link:null)||r||n||t||e}(e);try{return new Xe(t)}catch(n){return null}}}class Ye{constructor(){this.providerId=Ye.PROVIDER_ID}static credential(e,t){return Ve._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Xe.parseLink(t);return N(n,"argument-error"),Ve._fromEmailAndCode(e,n.code,n.tenantId)}}Ye.PROVIDER_ID="password",Ye.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ye.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Qe{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class $e extends Qe{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Je extends $e{constructor(){super("facebook.com")}static credential(e){return qe._fromParams({providerId:Je.PROVIDER_ID,signInMethod:Je.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Je.credentialFromTaggedObject(e)}static credentialFromError(e){return Je.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Je.credential(t.oauthAccessToken)}catch(n){return null}}}Je.FACEBOOK_SIGN_IN_METHOD="facebook.com",Je.PROVIDER_ID="facebook.com";class Ze extends $e{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return qe._fromParams({providerId:Ze.PROVIDER_ID,signInMethod:Ze.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ze.credentialFromTaggedObject(e)}static credentialFromError(e){return Ze.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Ze.credential(n,r)}catch(a){return null}}}Ze.GOOGLE_SIGN_IN_METHOD="google.com",Ze.PROVIDER_ID="google.com";class et extends $e{constructor(){super("github.com")}static credential(e){return qe._fromParams({providerId:et.PROVIDER_ID,signInMethod:et.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return et.credentialFromTaggedObject(e)}static credentialFromError(e){return et.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return et.credential(t.oauthAccessToken)}catch(n){return null}}}et.GITHUB_SIGN_IN_METHOD="github.com",et.PROVIDER_ID="github.com";class tt extends $e{constructor(){super("twitter.com")}static credential(e,t){return qe._fromParams({providerId:tt.PROVIDER_ID,signInMethod:tt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return tt.credentialFromTaggedObject(e)}static credentialFromError(e){return tt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return tt.credential(n,r)}catch(a){return null}}}async function nt(e,t){return F(e,"POST","/v1/accounts:signUp",D(e,t))}tt.TWITTER_SIGN_IN_METHOD="twitter.com",tt.PROVIDER_ID="twitter.com";class rt{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=await re._fromIdTokenResponse(e,n,r),i=at(n);return new rt({user:a,providerId:i,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=at(n);return new rt({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function at(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class it extends o.g{constructor(e,t,n,r){var a;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,it.prototype),this.customData={appName:e.name,tenantId:null!==(a=e.tenantId)&&void 0!==a?a:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new it(e,t,n,r)}}function ot(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw it._fromErrorAndOperation(e,n,t,r);throw n})}async function st(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Q(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return rt._forOperation(e,"link",r)}async function lt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if((0,i.xZ)(r.app))return Promise.reject(x(r));const a="reauthenticate";try{const i=await Q(e,ot(r,a,t,e),n);N(i.idToken,r,"internal-error");const o=X(i.idToken);N(o,r,"internal-error");const{sub:s}=o;return N(e.uid===s,r,"user-mismatch"),rt._forOperation(e,a,i)}catch(o){throw(null===o||void 0===o?void 0:o.code)==="auth/".concat("user-not-found")&&v(r,"user-mismatch"),o}}async function ct(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,i.xZ)(e.app))return Promise.reject(x(e));const r="signIn",a=await ot(e,r,t),o=await rt._fromIdTokenResponse(e,r,a);return n||await e._updateCurrentUser(o.user),o}async function ut(e,t){return ct(Ee(e),t)}async function dt(e){const t=Ee(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function ht(e,t,n){if((0,i.xZ)(e.app))return Promise.reject(x(e));const r=Ee(e),a=De(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",nt,"EMAIL_PASSWORD_PROVIDER"),o=await a.catch(t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&dt(e),t}),s=await rt._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(s.user),s}function ft(e,t,n){return(0,i.xZ)(e.app)?Promise.reject(x(e)):ut((0,o.Ku)(e),Ye.credential(t,n)).catch(async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&dt(e),t})}async function pt(e,t){let{displayName:n,photoURL:r}=t;if(void 0===n&&void 0===r)return;const a=(0,o.Ku)(e),i={idToken:await a.getIdToken(),displayName:n,photoUrl:r,returnSecureToken:!0},s=await Q(a,async function(e,t){return R(e,"POST","/v1/accounts:update",t)}(a.auth,i));a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null;const l=a.providerData.find(e=>{let{providerId:t}=e;return"password"===t});l&&(l.displayName=a.displayName,l.photoURL=a.photoURL),await a._updateTokensIfNecessary(s)}function mt(e,t,n,r){return(0,o.Ku)(e).onAuthStateChanged(t,n,r)}function gt(e){return(0,o.Ku)(e).signOut()}function vt(e,t){return R(e,"POST","/v2/accounts/mfaEnrollment:start",D(e,t))}new WeakMap;const yt="__sak";class bt{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(yt,"1"),this.storage.removeItem(yt),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class xt extends bt{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=be(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},a=this.storage.getItem(n);(0,o.lT)()&&10===document.documentMode&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}xt.type="LOCAL";const wt=xt;function Nt(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),a=RegExp("".concat(r,"=([^;]+)"));return null!==(t=null===(n=document.cookie.match(a))||void 0===n?void 0:n[1])&&void 0!==t?t:null}function St(e){const t="http:"===window.location.protocol;return"".concat(t?"__dev_":"__HOST-","FIREBASE_").concat(e.split(":")[3])}class Et{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL("".concat(window.location.origin,"/__cookies__"));return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=St(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return Nt(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=St(e);document.cookie="".concat(t,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=St(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=Nt(n);const a=setInterval(()=>{const e=Nt(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(a))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}Et.type="COOKIE";class Ct extends bt{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Ct.type="SESSION";const kt=Ct;class At{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new At(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:a}=t.data,i=this.handlersMap[r];if(null===i||void 0===i||!i.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(i).map(async e=>e(t.origin,a)),s=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:s})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function _t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}At.receivers=[];class jt{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let a,i;return new Promise((o,s)=>{const l=_t("",20);r.port1.start();const c=setTimeout(()=>{s(new Error("unsupported_event"))},n);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),a=setTimeout(()=>{s(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(t.data.response);break;default:clearTimeout(c),clearTimeout(a),s(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}function It(){return window}function Tt(){return"undefined"!==typeof It().WorkerGlobalScope&&"function"===typeof It().importScripts}const Ot="firebaseLocalStorageDb",Pt="firebaseLocalStorage",Dt="fbase_key";class Rt{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Mt(e,t){return e.transaction([Pt],t?"readwrite":"readonly").objectStore(Pt)}function Ft(){const e=indexedDB.open(Ot,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Pt,{keyPath:Dt})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Pt)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ot);return new Rt(e).toPromise()}(),t(await Ft()))})})}async function Lt(e,t,n){const r=Mt(e,!0).put({[Dt]:t,value:n});return new Rt(r).toPromise()}function Bt(e,t){const n=Mt(e,!0).delete(t);return new Rt(n).toPromise()}class Ut{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Ft()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Tt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=At._getInstance(Tt()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){var e;if(null===(e=navigator)||void 0===e||!e.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new jt(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&null!==(e=n[0])&&void 0!==e&&e.fulfilled&&null!==(t=n[0])&&void 0!==t&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=navigator)||void 0===e||null===(e=e.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ft();return await Lt(e,yt,"1"),await Bt(e,yt),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Lt(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Mt(e,!1).get(t),r=await new Rt(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Bt(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Mt(e,!1).getAll();return new Rt(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:a}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(a)&&(this.notifyListeners(r,a),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Ut.type="LOCAL";const zt=Ut;function Vt(e,t){return R(e,"POST","/v2/accounts/mfaSignIn:start",D(e,t))}_e("rcb"),new _(3e4,6e4);const Wt="recaptcha";async function qt(e,t,n){if(!e._getRecaptchaConfig())try{await Re(e)}catch(a){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let a;if(a="string"===typeof t?{phoneNumber:t}:t,"session"in a){const t=a.session;if("phoneNumber"in a){N("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},i=De(e,r,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Te){N((null===n||void 0===n?void 0:n.type)===Wt,e,"argument-error");return vt(e,await Ht(e,t,n))}return vt(e,t)},"PHONE_PROVIDER");return(await i.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{var r;N("signin"===t.type,e,"internal-error");const i=(null===(r=a.multiFactorHint)||void 0===r?void 0:r.uid)||a.multiFactorUid;N(i,e,"missing-multi-factor-info");const o={mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},s=De(e,o,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Te){N((null===n||void 0===n?void 0:n.type)===Wt,e,"argument-error");return Vt(e,await Ht(e,t,n))}return Vt(e,t)},"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=De(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===Te){N((null===n||void 0===n?void 0:n.type)===Wt,e,"argument-error");return He(e,await Ht(e,t,n))}return He(e,t)},"PHONE_PROVIDER");return(await r.catch(e=>Promise.reject(e))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function Ht(e,t,n){N(n.type===Wt,e,"argument-error");const r=await n.verify();N("string"===typeof r,e,"argument-error");const i=(0,a.A)({},t);if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,a=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:a}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class Gt{constructor(e){this.providerId=Gt.PROVIDER_ID,this.auth=Ee(e)}verifyPhoneNumber(e,t){return qt(this.auth,e,(0,o.Ku)(t))}static credential(e,t){return Ke._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Gt.credentialFromTaggedObject(t)}static credentialFromError(e){return Gt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Ke._fromTokenResponse(n,r):null}}function Kt(e,t){return t?ie(t):(N(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Gt.PROVIDER_ID="phone",Gt.PHONE_SIGN_IN_METHOD="phone";class Xt extends Be{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return We(e,this._buildIdpRequest())}_linkToIdToken(e,t){return We(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return We(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Yt(e){return ct(e.auth,new Xt(e),e.bypassAuthState)}function Qt(e){const{auth:t,user:n}=e;return N(n,t,"internal-error"),lt(n,new Xt(e),e.bypassAuthState)}async function $t(e){const{auth:t,user:n}=e;return N(n,t,"internal-error"),st(n,new Xt(e),e.bypassAuthState)}class Jt{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:a,error:i,type:o}=e;if(i)return void this.reject(i);const s={auth:this.auth,requestUri:t,sessionId:n,tenantId:a||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(s))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Yt;case"linkViaPopup":case"linkViaRedirect":return $t;case"reauthViaPopup":case"reauthViaRedirect":return Qt;default:v(this.auth,"internal-error")}}resolve(e){E(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){E(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Zt=new _(2e3,1e4);class en extends Jt{constructor(e,t,n,r,a){super(e,t,r,a),this.provider=n,this.authWindow=null,this.pollId=null,en.currentPopupAction&&en.currentPopupAction.cancel(),en.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return N(e,this.auth,"internal-error"),e}async onExecution(){E(1===this.filter.length,"Popup operations only handle one event");const e=_t();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(y(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(y(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,en.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t;null!==(t=this.authWindow)&&void 0!==t&&null!==(t=t.window)&&void 0!==t&&t.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(y(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Zt.get())};e()}}en.currentPopupAction=null;const tn=new Map;class nn extends Jt{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=tn.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=on(t),r=an(e);if(!await r._isAvailable())return!1;const a="true"===await r._get(n);return await r._remove(n),a}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}tn.set(this.auth._key(),e)}return this.bypassAuthState||tn.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function rn(e,t){tn.set(e._key(),t)}function an(e){return ie(e._redirectPersistence)}function on(e){return le("pendingRedirect",e.config.apiKey,e.name)}async function sn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,i.xZ)(e.app))return Promise.reject(x(e));const r=Ee(e),a=Kt(r,t),o=new nn(r,a,n),s=await o.execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,t)),s}class ln{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return un(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!un(e)){var n;const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(y(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(cn(e))}saveEventToCache(e){this.cachedEventUids.add(cn(e)),this.lastProcessedEventTime=Date.now()}}function cn(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function un(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const dn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hn=/^https?/;async function fn(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return R(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(pn(r))return}catch(n){}v(e,"unauthorized-domain")}function pn(e){const t=C(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return""===a.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&a.hostname===r}if(!hn.test(n))return!1;if(dn.test(e))return r===e;const a=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const mn=new _(3e4,6e4);function gn(){const e=It().___jsl;if(null!==e&&void 0!==e&&e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function vn(e){return new Promise((t,n)=>{var r,a;function i(){gn(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{gn(),n(y(e,"network-request-failed"))},timeout:mn.get()})}if(null!==(r=It().gapi)&&void 0!==r&&null!==(r=r.iframes)&&void 0!==r&&r.Iframe)t(gapi.iframes.getContext());else{if(null===(a=It().gapi)||void 0===a||!a.load){const t=_e("iframefcb");return It()[t]=()=>{gapi.load?i():n(y(e,"network-request-failed"))},Ae("".concat(ke.gapiScript,"?onload=").concat(t)).catch(e=>n(e))}i()}}).catch(e=>{throw yn=null,e})}let yn=null;const bn=new _(5e3,15e3),xn={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},wn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Nn(e){const t=e.config;N(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?j(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:i.MF},a=wn.get(e.config.apiHost);a&&(r.eid=a);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),"".concat(n,"?").concat((0,o.Am)(r).slice(1))}async function Sn(e){const t=await function(e){return yn=yn||vn(e),yn}(e),n=It().gapi;return N(n,e,"internal-error"),t.open({where:document.body,url:Nn(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xn,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const a=y(e,"network-request-failed"),i=It().setTimeout(()=>{r(a)},bn.get());function o(){It().clearTimeout(i),n(t)}t.ping(o).then(o,()=>{r(a)})}))}const En={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Cn{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function kn(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=(0,a.A)((0,a.A)({},En),{},{width:r.toString(),height:i.toString(),top:s,left:l}),d=(0,o.ZQ)().toLowerCase();n&&(c=fe(d)?"_blank":n),de(d)&&(t=t||"http://localhost",u.scrollbars="yes");const h=Object.entries(u).reduce((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")},"");if(function(){var e;return ye(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.ZQ)())&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(d)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new Cn(null);const f=window.open(t||"",c,h);N(f,e,"popup-blocked");try{f.focus()}catch(p){}return new Cn(f)}const An="__/auth/handler",_n="emulator/auth/handler",jn=encodeURIComponent("fac");async function In(e,t,n,r,a,s){N(e.config.authDomain,e,"auth-domain-config-required"),N(e.config.apiKey,e,"invalid-api-key");const l={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:i.MF,eventId:a};if(t instanceof Qe){t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",(0,o.Im)(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))l[e]=t}if(t instanceof $e){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(l.scopes=e.join(","))}e.tenantId&&(l.tid=e.tenantId);const c=l;for(const i of Object.keys(c))void 0===c[i]&&delete c[i];const u=await e._getAppCheckToken(),d=u?"#".concat(jn,"=").concat(encodeURIComponent(u)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(An);return j(t,_n)}(e),"?").concat((0,o.Am)(c).slice(1)).concat(d)}const Tn="webStorageSupport";const On=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=kt,this._completeRedirectFn=sn,this._overrideRedirectResult=rn}async _openPopup(e,t,n,r){var a;E(null===(a=this.eventManagers[e._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()");return kn(e,await In(e,t,n,C(),r),_t())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){It().location.href=e}(await In(e,t,n,C(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(E(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await Sn(e),n=new ln(e);return t.register("authEvent",t=>{N(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Tn,{type:Tn},n=>{var r;const a=null===n||void 0===n||null===(r=n[0])||void 0===r?void 0:r[Tn];void 0!==a&&t(!!a),v(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=fn(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return be()||he()||ye()}};var Pn="@firebase/auth",Dn="1.11.0";class Rn{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){N(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Mn=(0,o.XA)("authIdTokenMaxAge")||300;let Fn=null;const Ln=e=>async t=>{const n=t&&await t.getIdTokenResult(),r=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Mn)return;const a=null===n||void 0===n?void 0:n.token;Fn!==a&&(Fn=a,await fetch(e,{method:a?"POST":"DELETE",headers:a?{Authorization:"Bearer ".concat(a)}:{}}))};function Bn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.Sx)();const t=(0,i.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=(0,i.j6)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),r=n.getOptions();if((0,o.bD)(r,null!==t&&void 0!==t?t:{}))return e;v(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:On,persistence:[zt,wt,kt]}),r=(0,o.XA)("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=Ln(e.toString());!function(e,t,n){(0,o.Ku)(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){(0,o.Ku)(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}const a=(0,o.Tj)("auth");return a&&Me(n,"http://".concat(a)),n}var Un;ke={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=y("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Un="Browser",(0,i.om)(new l.uA("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:s}=r.options;N(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:s,clientPlatform:Un,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xe(Un)},c=new Se(r,a,i,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ie);null!==t&&void 0!==t&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),(0,i.om)(new l.uA("auth-internal",e=>(e=>new Rn(e))(Ee(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,i.KO)(Pn,Dn,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Un)),(0,i.KO)(Pn,Dn,"esm2020")},870:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isObject=function(e){return null!==e&&("object"===typeof e||"function"===typeof e)}},900:(e,t,n)=>{const r=n(7421);function a(e){this.mode=r.NUMERIC,this.data=e.toString()}a.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){let t,n,r;for(t=0;t+3<=this.data.length;t+=3)n=this.data.substr(t,3),r=parseInt(n,10),e.put(r,10);const a=this.data.length-t;a>0&&(n=this.data.substr(t),r=parseInt(n,10),e.put(r,3*a+1))},e.exports=a},1121:(e,t,n)=>{"use strict";n.d(t,{auth:()=>Fe,db:()=>Me});var r=n(1150);(0,r.KO)("firebase","12.2.1","app");var a=n(6667),i=n(823),o=n(9379),s=n(2965),l=n(1776),c=n(9606),u=n(2799);const d="@firebase/installations",h="0.6.19",f=1e4,p="w:".concat(h),m="FIS_v2",g=36e5,v={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},y=new l.FA("installations","Installations",v);function b(e){return e instanceof l.g&&e.code.includes("request-failed")}function x(e){let{projectId:t}=e;return"".concat("https://firebaseinstallations.googleapis.com/v1","/projects/").concat(t,"/installations")}function w(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function N(e,t){const n=(await t.json()).error;return y.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function S(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function E(e,t){let{refreshToken:n}=t;const r=S(e);return r.append("Authorization",function(e){return"".concat(m," ").concat(e)}(n)),r}async function C(e){const t=await e();return t.status>=500&&t.status<600?e():t}function k(e){return new Promise(t=>{setTimeout(t,e)})}const A=/^[cdef][\w-]{21}$/;function _(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return A.test(t)?t:""}catch(e){return""}}function j(e){return"".concat(e.appName,"!").concat(e.appId)}const I=new Map;function T(e,t){const n=j(e);O(n,t),function(e,t){const n=D();n&&n.postMessage({key:e,fid:t});R()}(n,t)}function O(e,t){const n=I.get(e);if(n)for(const r of n)r(t)}let P=null;function D(){return!P&&"BroadcastChannel"in self&&(P=new BroadcastChannel("[Firebase] FID Change"),P.onmessage=e=>{O(e.data.key,e.data.fid)}),P}function R(){0===I.size&&P&&(P.close(),P=null)}const M="firebase-installations-store";let F=null;function L(){return F||(F=(0,u.P2)("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(M)}})),F}async function B(e,t){const n=j(e),r=(await L()).transaction(M,"readwrite"),a=r.objectStore(M),i=await a.get(n);return await a.put(t,n),await r.done,i&&i.fid===t.fid||T(e,t.fid),t}async function U(e){const t=j(e),n=(await L()).transaction(M,"readwrite");await n.objectStore(M).delete(t),await n.done}async function z(e,t){const n=j(e),r=(await L()).transaction(M,"readwrite"),a=r.objectStore(M),i=await a.get(n),o=t(i);return void 0===o?await a.delete(n):await a.put(o,n),await r.done,!o||i&&i.fid===o.fid||T(e,o.fid),o}async function V(e){let t;const n=await z(e.appConfig,n=>{const r=function(e){const t=e||{fid:_(),registrationStatus:0};return H(t)}(n),a=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(y.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:a}=t;const i=x(n),o=S(n),s=r.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&o.append("x-firebase-client",e)}const l={fid:a,authVersion:m,appId:n.appId,sdkVersion:p},c={method:"POST",headers:o,body:JSON.stringify(l)},u=await C(()=>fetch(i,c));if(u.ok){const e=await u.json();return{fid:e.fid||a,registrationStatus:2,refreshToken:e.refreshToken,authToken:w(e.authToken)}}throw await N("Create Installation",u)}(e,t);return B(e.appConfig,n)}catch(n){throw b(n)&&409===n.customData.serverCode?await U(e.appConfig):await B(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:W(e)}:{installationEntry:t}}(e,r);return t=a.registrationPromise,a.installationEntry});return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function W(e){let t=await q(e.appConfig);for(;1===t.registrationStatus;)await k(100),t=await q(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await V(e);return n||t}return t}function q(e){return z(e,e=>{if(!e)throw y.create("installation-not-found");return H(e)})}function H(e){return 1===(t=e).registrationStatus&&t.registrationTime+f<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function G(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const a=function(e,t){let{fid:n}=t;return"".concat(x(e),"/").concat(n,"/authTokens:generate")}(n,t),i=E(n,t),o=r.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const s={installation:{sdkVersion:p,appId:n.appId}},l={method:"POST",headers:i,body:JSON.stringify(s)},c=await C(()=>fetch(a,l));if(c.ok){return w(await c.json())}throw await N("Generate Auth Token",c)}async function K(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await z(e.appConfig,r=>{if(!Y(r))throw y.create("not-registered");const a=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+g}(e)}(a))return r;if(1===a.requestStatus)return t=async function(e,t){let n=await X(e.appConfig);for(;1===n.authToken.requestStatus;)await k(100),n=await X(e.appConfig);const r=n.authToken;return 0===r.requestStatus?K(e,t):r}(e,n),r;{if(!navigator.onLine)throw y.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return(0,o.A)((0,o.A)({},e),{},{authToken:t})}(r);return t=async function(e,t){try{const n=await G(e,t),r=(0,o.A)((0,o.A)({},t),{},{authToken:n});return await B(e.appConfig,r),n}catch(n){if(!b(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=(0,o.A)((0,o.A)({},t),{},{authToken:{requestStatus:0}});await B(e.appConfig,n)}else await U(e.appConfig);throw n}}(e,n),n}});return t?await t:r.authToken}function X(e){return z(e,e=>{if(!Y(e))throw y.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+f<Date.now()?(0,o.A)((0,o.A)({},e),{},{authToken:{requestStatus:0}}):e;var n})}function Y(e){return void 0!==e&&2===e.registrationStatus}async function Q(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await V(e);t&&await t}(n);return(await K(n,t)).token}function $(e){return y.create("missing-app-config-values",{valueName:e})}const J="installations",Z=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw $("App Configuration");if(!e.name)throw $("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw $(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:(0,r.j6)(t,"heartbeat"),_delete:()=>Promise.resolve()}},ee=e=>{const t=e.getProvider("app").getImmediate(),n=(0,r.j6)(t,J).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await V(t);return r?r.catch(console.error):K(t).catch(console.error),n.fid}(n),getToken:e=>Q(n,e)}};(0,r.om)(new c.uA(J,Z,"PUBLIC")),(0,r.om)(new c.uA("installations-internal",ee,"PRIVATE")),(0,r.KO)(d,h),(0,r.KO)(d,h,"esm2020");const te="analytics",ne="https://www.googletagmanager.com/gtag/js",re=new s.Vy("@firebase/analytics"),ae={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ie=new l.FA("analytics","Analytics",ae);function oe(e){if(!e.startsWith(ne)){const t=ie.create("invalid-gtag-resource",{gtagURL:e});return re.warn(t.message),""}return e}function se(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function le(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:oe}),r=document.createElement("script"),a="".concat(ne,"?l=").concat(e,"&id=").concat(t);r.src=n?null===n||void 0===n?void 0:n.createScriptURL(a):a,r.async=!0,document.head.appendChild(r)}function ce(e,t,n,r){return async function(a){try{for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];if("event"===a){const[r,a]=o;await async function(e,t,n,r,a){try{let i=[];if(a&&a.send_to){let e=a.send_to;Array.isArray(e)||(e=[e]);const r=await se(n);for(const n of e){const e=r.find(e=>e.measurementId===n),a=e&&t[e.appId];if(!a){i=[];break}i.push(a)}}0===i.length&&(i=Object.values(t)),await Promise.all(i),e("event",r,a||{})}catch(i){re.error(i)}}(e,t,n,r,a)}else if("config"===a){const[a,i]=o;await async function(e,t,n,r,a,i){const o=r[a];try{if(o)await t[o];else{const e=(await se(n)).find(e=>e.measurementId===a);e&&await t[e.appId]}}catch(s){re.error(s)}e("config",a,i)}(e,t,n,r,a,i)}else if("consent"===a){const[t,n]=o;e("consent",t,n)}else if("get"===a){const[t,n,r]=o;e("get",t,n,r)}else if("set"===a){const[t]=o;e("set",t)}else e(a,...o)}catch(l){re.error(l)}}}const ue=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function de(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function he(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ue,n=arguments.length>2?arguments[2]:void 0;const{appId:r,apiKey:a,measurementId:i}=e.options;if(!r)throw ie.create("no-app-id");if(!a){if(i)return{measurementId:i,appId:r};throw ie.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},s=new pe;return setTimeout(async()=>{s.abort()},void 0!==n?n:6e4),fe({appId:r,apiKey:a,measurementId:i},o,s,t)}async function fe(e,t,n){let{throttleEndTimeMillis:r,backoffCount:a}=t,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ue;const{appId:o,measurementId:s}=e;try{await function(e,t){return new Promise((n,r)=>{const a=Math.max(t-Date.now(),0),i=setTimeout(n,a);e.addEventListener(()=>{clearTimeout(i),r(ie.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(n,r)}catch(u){if(s)return re.warn("Timed out fetching this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(s)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===u||void 0===u?void 0:u.message,"]")),{appId:o,measurementId:s};throw u}try{const t=await async function(e){const{appId:t,apiKey:n}=e,r={method:"GET",headers:de(n)},a="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",t),i=await fetch(a,r);if(200!==i.status&&304!==i.status){let e="";try{var o;const t=await i.json();null!==(o=t.error)&&void 0!==o&&o.message&&(e=t.error.message)}catch(s){}throw ie.create("config-fetch-failed",{httpStatus:i.status,responseMessage:e})}return i.json()}(e);return i.deleteThrottleMetadata(o),t}catch(u){var c;const t=u;if(!function(e){if(!(e instanceof l.g)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(i.deleteThrottleMetadata(o),s)return re.warn("Failed to fetch this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(s)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===t||void 0===t?void 0:t.message,"]")),{appId:o,measurementId:s};throw u}const r=503===Number(null===t||void 0===t||null===(c=t.customData)||void 0===c?void 0:c.httpStatus)?(0,l.p9)(a,i.intervalMillis,30):(0,l.p9)(a,i.intervalMillis),d={throttleEndTimeMillis:Date.now()+r,backoffCount:a+1};return i.setThrottleMetadata(o,d),re.debug("Calling attemptFetch again in ".concat(r," millis")),fe(e,d,n,i)}}class pe{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let me,ge;function ve(e){ge=e}function ye(e){me=e}async function be(e,t,n,r,a,i,o){var s;const c=he(e);c.then(t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&re.warn("The measurement ID in the local Firebase config (".concat(e.options.measurementId,")")+" does not match the measurement ID fetched from the server (".concat(t.measurementId,").")+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(e=>re.error(e)),t.push(c);const u=async function(){if(!(0,l.zW)())return re.warn(ie.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,l.eX)()}catch(e){return re.warn(ie.create("indexeddb-unavailable",{errorInfo:null===e||void 0===e?void 0:e.toString()}).message),!1}return!0}().then(e=>e?r.getId():void 0),[d,h]=await Promise.all([c,u]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(ne)&&n.src.includes(e))return n;return null})(i)||le(i,d.measurementId),ge&&(a("consent","default",ge),ve(void 0)),a("js",new Date);const f=null!==(s=null===o||void 0===o?void 0:o.config)&&void 0!==s?s:{};return f.origin="firebase",f.update=!0,null!=h&&(f.firebase_id=h),a("config",d.measurementId,f),me&&(a("set",me),ye(void 0)),d.measurementId}class xe{constructor(e){this.app=e}_delete(){return delete we[this.app.options.appId],Promise.resolve()}}let we={},Ne=[];const Se={};let Ee,Ce,ke="dataLayer",Ae="gtag",_e=!1;function je(e,t,n){!function(){const e=[];if((0,l.sr)()&&e.push("This is a browser extension environment."),(0,l.dM)()||e.push("Cookies are not available."),e.length>0){const t=e.map((e,t)=>"(".concat(t+1,") ").concat(e)).join(" "),n=ie.create("invalid-analytics-context",{errorInfo:t});re.warn(n.message)}}();const r=e.options.appId;if(!r)throw ie.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw ie.create("no-api-key");re.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+" measurement ID for this Firebase app. Falling back to the measurement ID ".concat(e.options.measurementId)+' provided in the "measurementId" field in the local Firebase config.')}if(null!=we[r])throw ie.create("already-exists",{id:r});if(!_e){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(ke);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,a){let i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[a]&&"function"===typeof window[a]&&(i=window[a]),window[a]=ce(i,e,t,n),{gtagCore:i,wrappedGtag:window[a]}}(we,Ne,Se,ke,Ae);Ce=e,Ee=t,_e=!0}we[r]=be(e,Ne,Se,t,Ee,ke,n);return new xe(e)}function Ie(e,t,n,r){e=(0,l.Ku)(e),async function(e,t,n,r,a){if(a&&a.global)e("event",n,r);else{const a=await t;e("event",n,(0,o.A)((0,o.A)({},r),{},{send_to:a}))}}(Ce,we[e.app.options.appId],t,n,r).catch(e=>re.error(e))}const Te="@firebase/analytics",Oe="0.10.18";var Pe;(0,r.om)(new c.uA(te,(e,t)=>{let{options:n}=t;return je(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),(0,r.om)(new c.uA("analytics-internal",function(e){try{const t=e.getProvider(te).getImmediate();return{logEvent:(e,n,r)=>Ie(t,e,n,r)}}catch(t){throw ie.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),(0,r.KO)(Te,Oe),(0,r.KO)(Te,Oe,"esm2020");const De={apiKey:"AIzaSyCoAWynuJ4pNRM3lQ4c45FqXLn5sGcK2VM",authDomain:"attendance-d7971.firebaseapp.com",projectId:"attendance-d7971",storageBucket:"attendance-d7971.firebasestorage.app",messagingSenderId:"623306028217",appId:"1:623306028217:web:bf43b45af2955d503e9768",measurementId:"G-QFFFG9GYH6"};console.log("\ud83d\udd25 Firebase Config Status:"),console.log("\ud83d\udd25 Using API Key:",(null===(Pe=De.apiKey)||void 0===Pe?void 0:Pe.substring(0,10))+"..."),console.log("\ud83d\udd25 Project ID:",De.projectId),console.log("\ud83d\udd25 Auth Domain:",De.authDomain);const Re=(0,r.Wp)(De),Me=(0,a.aU)(Re),Fe=(0,i.xI)(Re);"undefined"!==typeof window&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.Sx)();e=(0,l.Ku)(e);const t=(0,r.j6)(e,te);t.isInitialized()?t.getImmediate():function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,r.j6)(e,te);if(n.isInitialized()){const e=n.getImmediate();if((0,l.bD)(t,n.getOptions()))return e;throw ie.create("already-initialized")}const a=n.initialize({options:t})}(e)}(Re)},1150:(e,t,n)=>{"use strict";n.d(t,{KO:()=>Z,MF:()=>Q,Sx:()=>J,Wp:()=>$,j6:()=>H,om:()=>q,xZ:()=>G});var r=n(9379),a=n(9606),i=n(2965),o=n(1776),s=n(2799);class l{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const c="@firebase/app",u="0.14.2",d=new i.Vy("@firebase/app"),h="@firebase/app-compat",f="@firebase/analytics-compat",p="@firebase/analytics",m="@firebase/app-check-compat",g="@firebase/app-check",v="@firebase/auth",y="@firebase/auth-compat",b="@firebase/database",x="@firebase/data-connect",w="@firebase/database-compat",N="@firebase/functions",S="@firebase/functions-compat",E="@firebase/installations",C="@firebase/installations-compat",k="@firebase/messaging",A="@firebase/messaging-compat",_="@firebase/performance",j="@firebase/performance-compat",I="@firebase/remote-config",T="@firebase/remote-config-compat",O="@firebase/storage",P="@firebase/storage-compat",D="@firebase/firestore",R="@firebase/ai",M="@firebase/firestore-compat",F="firebase",L="[DEFAULT]",B={[c]:"fire-core",[h]:"fire-core-compat",[p]:"fire-analytics",[f]:"fire-analytics-compat",[g]:"fire-app-check",[m]:"fire-app-check-compat",[v]:"fire-auth",[y]:"fire-auth-compat",[b]:"fire-rtdb",[x]:"fire-data-connect",[w]:"fire-rtdb-compat",[N]:"fire-fn",[S]:"fire-fn-compat",[E]:"fire-iid",[C]:"fire-iid-compat",[k]:"fire-fcm",[A]:"fire-fcm-compat",[_]:"fire-perf",[j]:"fire-perf-compat",[I]:"fire-rc",[T]:"fire-rc-compat",[O]:"fire-gcs",[P]:"fire-gcs-compat",[D]:"fire-fst",[M]:"fire-fst-compat",[R]:"fire-vertex","fire-js":"fire-js",[F]:"fire-js-all"},U=new Map,z=new Map,V=new Map;function W(e,t){try{e.container.addComponent(t)}catch(n){d.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function q(e){const t=e.name;if(V.has(t))return d.debug("There were multiple attempts to register component ".concat(t,".")),!1;V.set(t,e);for(const n of U.values())W(n,e);for(const n of z.values())W(n,e);return!0}function H(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function G(e){return null!==e&&void 0!==e&&void 0!==e.settings}const K={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},X=new o.FA("app","Firebase",K);class Y{constructor(e,t,n){this._isDeleted=!1,this._options=(0,r.A)({},e),this._config=(0,r.A)({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new a.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw X.create("app-deleted",{appName:this._name})}}const Q="12.2.0";function $(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const i=(0,r.A)({name:L,automaticDataCollectionEnabled:!0},t),s=i.name;if("string"!==typeof s||!s)throw X.create("bad-app-name",{appName:String(s)});if(n||(n=(0,o.T9)()),!n)throw X.create("no-options");const l=U.get(s);if(l){if((0,o.bD)(n,l.options)&&(0,o.bD)(i,l.config))return l;throw X.create("duplicate-app",{appName:s})}const c=new a.h1(s);for(const r of V.values())c.addComponent(r);const u=new Y(n,i,c);return U.set(s,u),u}function J(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L;const t=U.get(e);if(!t&&e===L&&(0,o.T9)())return $();if(!t)throw X.create("no-app",{appName:e});return t}function Z(e,t,n){var r;let i=null!==(r=B[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const o=i.match(/\s|\//),s=t.match(/\s|\//);if(o||s){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return o&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),o&&s&&e.push("and"),s&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void d.warn(e.join(" "))}q(new a.uA("".concat(i,"-version"),()=>({library:i,version:t}),"VERSION"))}const ee="firebase-heartbeat-store";let te=null;function ne(){return te||(te=(0,s.P2)("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(ee)}catch(n){console.warn(n)}}}).catch(e=>{throw X.create("idb-open",{originalErrorMessage:e.message})})),te}async function re(e,t){try{const n=(await ne()).transaction(ee,"readwrite"),r=n.objectStore(ee);await r.put(t,ae(e)),await n.done}catch(n){if(n instanceof o.g)d.warn(n.message);else{const e=X.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});d.warn(e.message)}}}function ae(e){return"".concat(e.name,"!").concat(e.options.appId)}class ie{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new se(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=oe();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){d.warn(n)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=oe(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const a of e){const e=n.find(e=>e.agent===a.agent);if(e){if(e.dates.push(a.date),le(n)>t){e.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),le(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),a=(0,o.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return d.warn(t),""}}}function oe(){return(new Date).toISOString().substring(0,10)}class se{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,o.zW)()&&(0,o.eX)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await ne()).transaction(ee),n=await t.objectStore(ee).get(ae(e));return await t.done,n}catch(t){if(t instanceof o.g)d.warn(t.message);else{const e=X.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});d.warn(e.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return re(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return re(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function le(e){return(0,o.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var ce;ce="",q(new a.uA("platform-logger",e=>new l(e),"PRIVATE")),q(new a.uA("heartbeat",e=>new ie(e),"PRIVATE")),Z(c,u,ce),Z(c,u,"esm2020"),Z("fire-js","")},1166:(e,t)=>{const n=new Uint8Array(512),r=new Uint8Array(256);!function(){let e=1;for(let t=0;t<255;t++)n[t]=e,r[e]=t,e<<=1,256&e&&(e^=285);for(let t=255;t<512;t++)n[t]=n[t-255]}(),t.log=function(e){if(e<1)throw new Error("log("+e+")");return r[e]},t.exp=function(e){return n[e]},t.mul=function(e,t){return 0===e||0===t?0:n[r[e]+r[t]]}},1203:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8420);t.isArrayLike=function(e){return null!=e&&"function"!==typeof e&&r.isLength(e.length)}},1286:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},1293:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(4830);t.debounce=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"object"!==typeof n&&(n={});const{leading:a=!1,trailing:i=!0,maxWait:o}=n,s=Array(2);let l;a&&(s[0]="leading"),i&&(s[1]="trailing");let c=null;const u=r.debounce(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];l=e.apply(this,n),c=null},t,{edges:s}),d=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return null!=o&&(null===c&&(c=Date.now()),Date.now()-c>=o)?(l=e.apply(this,n),c=Date.now(),u.cancel(),u.schedule(),l):(u.apply(this,n),l)};return d.cancel=u.cancel,d.flush=()=>(u.flush(),l),d}},1312:(e,t,n)=>{const r=n(1166);t.mul=function(e,t){const n=new Uint8Array(e.length+t.length-1);for(let a=0;a<e.length;a++)for(let i=0;i<t.length;i++)n[a+i]^=r.mul(e[a],t[i]);return n},t.mod=function(e,t){let n=new Uint8Array(e);for(;n.length-t.length>=0;){const e=n[0];for(let i=0;i<t.length;i++)n[i]^=r.mul(t[i],e);let a=0;for(;a<n.length&&0===n[a];)a++;n=n.slice(a)}return n},t.generateECPolynomial=function(e){let n=new Uint8Array([1]);for(let a=0;a<e;a++)n=t.mul(n,new Uint8Array([1,r.exp(a)]));return n}},1360:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1444:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toPath=function(e){const t=[],n=e.length;if(0===n)return t;let r=0,a="",i="",o=!1;for(46===e.charCodeAt(0)&&(t.push(""),r++);r<n;){const s=e[r];i?"\\"===s&&r+1<n?(r++,a+=e[r]):s===i?i="":a+=s:o?'"'===s||"'"===s?i=s:"]"===s?(o=!1,t.push(a),a=""):a+=s:"["===s?(o=!0,a&&(t.push(a),a="")):"."===s?a&&(t.push(a),a=""):a+=s,r++}return a&&t.push(a),t}},1565:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>v});var r=n(9379),a=n(5043),i=n(8970),o=n(2626),s=n(6210),l=n(5088),c=n(2313),u=n(7104),d=n(8006),h=n(2681),f=n(614),p=n(253),m=n(5016),g=n(579);const v=e=>{let{onClose:t,classroomId:n=null,subjectData:v=null}=e;const{userData:y}=(0,m.A)(),[b,x]=(0,a.useState)("form"),[w,N]=(0,a.useState)(!1),[S,E]=(0,a.useState)(""),[C,k]=(0,a.useState)(""),[A,_]=(0,a.useState)(""),[j,I]=(0,a.useState)(null),[T,O]=(0,a.useState)(!1),[P,D]=((0,a.useRef)(null),(0,a.useState)({subject:(null===v||void 0===v?void 0:v.name)||"",subjectCode:(null===v||void 0===v?void 0:v.code)||"",classroomId:n||"",latitude:"",longitude:"",address:"",duration:"180"})),R=e=>{const{name:t,value:n}=e.target;D(e=>(0,r.A)((0,r.A)({},e),{},{[t]:n}))};return(0,g.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 safe-area-top safe-area-bottom",children:(0,g.jsxs)("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[95vh] sm:max-h-[90vh] overflow-hidden animate-slide-up",children:[(0,g.jsx)("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,g.jsx)("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0",children:(0,g.jsx)(h.A,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600"})}),(0,g.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,g.jsx)("h2",{className:"text-lg sm:text-xl font-bold text-gray-800 truncate",children:v?"Generate QR - ".concat(v.name):"Generate Attendance QR"}),(0,g.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:v?"Create QR code for ".concat(v.code," attendance"):"Create QR code for class attendance"})]})]}),(0,g.jsx)("button",{onClick:t,className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200 transition-colors flex-shrink-0",children:(0,g.jsx)(f.A,{className:"w-4 h-4"})})]})}),(0,g.jsxs)("div",{className:"p-4 sm:p-6 overflow-y-auto max-h-[calc(95vh-120px)] sm:max-h-[calc(90vh-120px)]",children:["form"===b&&(0,g.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,g.jsxs)("div",{children:[(0,g.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[(0,g.jsx)(o.A,{className:"w-4 h-4"}),"Subject *"]}),(0,g.jsxs)("select",{name:"subject",value:P.subject,onChange:R,className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base",children:[(0,g.jsx)("option",{value:"",children:"Select a subject"}),["Mathematics","Physics","Chemistry","Biology","Computer Science","English","History","Geography","Economics","Psychology"].map(e=>(0,g.jsx)("option",{value:e,children:e},e))]})]}),(0,g.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,g.jsxs)("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[(0,g.jsx)(d.A,{className:"w-4 h-4"}),"Location *"]}),(0,g.jsx)("button",{onClick:()=>{if(N(!0),E(""),!navigator.geolocation)return E("Geolocation is not supported by this browser"),void N(!1);navigator.geolocation.getCurrentPosition(e=>{D(t=>(0,r.A)((0,r.A)({},t),{},{latitude:e.coords.latitude.toFixed(6),longitude:e.coords.longitude.toFixed(6)})),N(!1),k("Location obtained successfully!"),setTimeout(()=>k(""),3e3)},e=>{E("Unable to get location: "+e.message),N(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},disabled:w,className:"px-3 py-1 bg-blue-500 text-white text-sm rounded-lg hover:bg-blue-600 disabled:opacity-50 transition-colors",children:w?"Getting...":"Get Current"})]}),(0,g.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Latitude"}),(0,g.jsx)("input",{type:"number",name:"latitude",value:P.latitude,onChange:R,step:"0.000001",placeholder:"e.g., 40.712776",className:"w-full p-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Longitude"}),(0,g.jsx)("input",{type:"number",name:"longitude",value:P.longitude,onChange:R,step:"0.000001",placeholder:"e.g., -74.005974",className:"w-full p-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]})]}),(0,g.jsxs)("div",{className:"mt-3",children:[(0,g.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Address (Optional)"}),(0,g.jsx)("input",{type:"text",name:"address",value:P.address,onChange:R,placeholder:"e.g., Main Building, Room 101",className:"w-full p-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]})]}),(0,g.jsxs)("div",{children:[(0,g.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[(0,g.jsx)(l.A,{className:"w-4 h-4"}),"Session Duration"]}),(0,g.jsxs)("select",{name:"duration",value:P.duration,onChange:R,className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,g.jsx)("option",{value:"60",children:"1 Hour"}),(0,g.jsx)("option",{value:"90",children:"1.5 Hours"}),(0,g.jsx)("option",{value:"120",children:"2 Hours"}),(0,g.jsx)("option",{value:"180",children:"3 Hours"}),(0,g.jsx)("option",{value:"240",children:"4 Hours"})]})]}),S&&(0,g.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:S}),C&&(0,g.jsx)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg text-green-700 text-sm",children:C}),(0,g.jsx)("button",{onClick:async()=>{if(P.subject&&P.latitude&&P.longitude)if(y)if(y.uid){N(!0),E(""),x("generating");try{const e=await(0,p.U6)(y.uid,{subject:P.subject,latitude:P.latitude,longitude:P.longitude,address:P.address});if(e.success){const t={width:300,margin:2,color:{dark:"#000000",light:"#ffffff"}},n=await i.toDataURL(e.qrData,t);_(n),I((0,r.A)((0,r.A)({},e),{},{subject:P.subject,location:{latitude:P.latitude,longitude:P.longitude,address:P.address}})),x("generated")}else E(e.error||"Failed to create attendance session"),x("form")}catch(S){console.error("Error generating QR code:",S),E("Failed to generate QR code"),x("form")}N(!1)}else E("User ID not available. Please log in again.");else E("User data not available. Please log in again.");else E("Please fill in all required fields")},disabled:w||!P.subject||!P.latitude||!P.longitude,className:"w-full py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:w?"Generating QR Code...":"Generate QR Code"})]}),"generating"===b&&(0,g.jsxs)("div",{className:"text-center py-12",children:[(0,g.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4",children:(0,g.jsx)(h.A,{className:"w-8 h-8 text-blue-600 animate-pulse"})}),(0,g.jsx)("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Generating QR Code"}),(0,g.jsx)("p",{className:"text-gray-600",children:"Creating attendance session..."})]}),"generated"===b&&j&&(0,g.jsxs)("div",{className:"space-y-6",children:[(0,g.jsx)("div",{className:"text-center",children:(0,g.jsx)("div",{className:"inline-block p-4 bg-white border-2 border-gray-200 rounded-2xl",children:(0,g.jsx)("img",{src:A,alt:"Attendance QR Code",className:"w-64 h-64 mx-auto"})})}),(0,g.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,g.jsx)("h3",{className:"font-medium text-gray-800 mb-3",children:"Session Information"}),(0,g.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,g.jsxs)("div",{className:"flex justify-between",children:[(0,g.jsx)("span",{className:"text-gray-600",children:"Subject:"}),(0,g.jsx)("span",{className:"font-medium",children:j.subject})]}),(0,g.jsxs)("div",{className:"flex justify-between",children:[(0,g.jsx)("span",{className:"text-gray-600",children:"Session ID:"}),(0,g.jsx)("span",{className:"font-mono text-xs",children:j.sessionId})]}),(0,g.jsxs)("div",{className:"flex justify-between",children:[(0,g.jsx)("span",{className:"text-gray-600",children:"Location:"}),(0,g.jsxs)("span",{className:"text-xs",children:[j.location.latitude,", ",j.location.longitude]})]}),j.location.address&&(0,g.jsxs)("div",{className:"flex justify-between",children:[(0,g.jsx)("span",{className:"text-gray-600",children:"Address:"}),(0,g.jsx)("span",{className:"text-xs",children:j.location.address})]})]})]}),(0,g.jsxs)("div",{className:"flex gap-3",children:[(0,g.jsxs)("button",{onClick:()=>{const e=document.createElement("a");e.download="attendance-qr-".concat(P.subject,"-").concat((new Date).toISOString().split("T")[0],".png"),e.href=A,e.click()},className:"flex-1 flex items-center justify-center gap-2 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors",children:[(0,g.jsx)(u.A,{className:"w-4 h-4"}),"Download QR"]}),(0,g.jsxs)("button",{onClick:()=>{j&&(navigator.clipboard.writeText(j.qrData),O(!0),setTimeout(()=>O(!1),2e3))},className:"flex-1 flex items-center justify-center gap-2 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:[T?(0,g.jsx)(s.A,{className:"w-4 h-4"}):(0,g.jsx)(c.A,{className:"w-4 h-4"}),T?"Copied!":"Copy Code"]})]}),(0,g.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[(0,g.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"Instructions for Students:"}),(0,g.jsxs)("ol",{className:"text-sm text-blue-700 space-y-1 list-decimal list-inside",children:[(0,g.jsx)("li",{children:"Allow location access when prompted"}),(0,g.jsx)("li",{children:"Be within 50 meters of the class location"}),(0,g.jsx)("li",{children:"Scan this QR code using the app"}),(0,g.jsx)("li",{children:"Complete facial recognition verification"})]})]})]})]})]})})}},1776:(e,t,n)=>{"use strict";n.d(t,{cY:()=>m,FA:()=>R,g:()=>D,dM:()=>P,u:()=>l,Uj:()=>s,p9:()=>Q,Fy:()=>y,tD:()=>W,bD:()=>L,hp:()=>V,T9:()=>f,Tj:()=>d,yU:()=>h,XA:()=>p,mS:()=>c,Ku:()=>$,ZQ:()=>N,sr:()=>k,zJ:()=>g,c1:()=>C,Im:()=>F,lT:()=>_,zW:()=>T,jZ:()=>S,lV:()=>A,nr:()=>j,Ov:()=>I,gE:()=>v,Am:()=>U,I9:()=>z,P1:()=>w,eX:()=>O});var r=n(9379);const a=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296===(64512&a)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<e.length;a+=3){const t=e[a],i=a+1<e.length,o=i?e[a+1]:0,s=a+2<e.length,l=s?e[a+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let d=(15&o)<<2|l>>6,h=63&l;s||(h=64,i||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(a(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){const i=e[n++];t[r++]=String.fromCharCode((31&a)<<6|63&i)}else if(a>239&&a<365){const i=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&a)<<12|(63&i)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<e.length;){const t=n[e.charAt(a++)],i=a<e.length?n[e.charAt(a)]:0;++a;const s=a<e.length?n[e.charAt(a)]:64;++a;const l=a<e.length?n[e.charAt(a)]:64;if(++a,null==t||null==i||null==s||null==l)throw new o;const c=t<<2|i>>4;if(r.push(c),64!==s){const e=i<<4&240|s>>2;if(r.push(e),64!==l){const e=s<<6&192|l;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class o extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const s=function(e){return function(e){const t=a(e);return i.encodeByteArray(t,!0)}(e).replace(/\./g,"")},l=function(e){try{return i.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function c(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const u=()=>{try{return c().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/Smart-Attendance",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyCoAWynuJ4pNRM3lQ4c45FqXLn5sGcK2VM",REACT_APP_FIREBASE_APP_ID:"1:623306028217:web:bf43b45af2955d503e9768",REACT_APP_FIREBASE_AUTH_DOMAIN:"attendance-d7971.firebaseapp.com",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-QFFFG9GYH6",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"623306028217",REACT_APP_FIREBASE_PROJECT_ID:"attendance-d7971",REACT_APP_FIREBASE_STORAGE_BUCKET:"attendance-d7971.firebasestorage.app"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&l(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},d=e=>{var t;return null===(t=u())||void 0===t||null===(t=t.emulatorHosts)||void 0===t?void 0:t[e]},h=e=>{const t=d(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},f=()=>{var e;return null===(e=u())||void 0===e?void 0:e.config},p=e=>{var t;return null===(t=u())||void 0===t?void 0:t["_".concat(e)]};class m{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function g(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function v(e){return(await fetch(e,{credentials:"include"})).ok}function y(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",a=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=(0,r.A)({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:a,exp:a+3600,auth_time:a,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[s(JSON.stringify({alg:"none",type:"JWT"})),s(JSON.stringify(o)),""].join(".")}const b={};let x=!1;function w(e,t){if("undefined"===typeof window||"undefined"===typeof document||!g(window.location.host)||b[e]===t||b[e]||x)return;function n(e){return"__firebase__banner__".concat(e)}b[e]=t;const r="__firebase__banner",a=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(b))b[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function i(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{x=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function o(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),o=document.getElementById(t)||document.createElement("span"),s=n("learnmore"),l=document.getElementById(s)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,s);const n=i();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,o,l,n),document.body.appendChild(t)}a?(o.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',o.innerText="Preview backend running in this workspace."),o.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",o):o()}function N(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function S(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(N())}function E(){var e;const t=null===(e=u())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function C(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function k(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function A(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function _(){const e=N();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function j(){return!E()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function I(){return!E()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function T(){try{return"object"===typeof indexedDB}catch(e){return!1}}function O(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function P(){return!("undefined"===typeof navigator||!navigator.cookieEnabled)}class D extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,D.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,R.prototype.create)}}class R{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],a=r?function(e,t){return e.replace(M,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",i="".concat(this.serviceName,": ").concat(a," (").concat(n,").");return new D(n,i,t)}}const M=/\{\$([^}]+)}/g;function F(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function L(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const a of n){if(!r.includes(a))return!1;const n=e[a],i=t[a];if(B(n)&&B(i)){if(!L(n,i))return!1}else if(n!==i)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function B(e){return null!==e&&"object"===typeof e}function U(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function z(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function V(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function W(e,t){const n=new q(e,t);return n.subscribe.bind(n)}class q{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=H),void 0===r.error&&(r.error=H),void 0===r.complete&&(r.complete=H);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),a}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function H(){}const G=1e3,K=2,X=144e5,Y=.5;function Q(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:K;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:G)*Math.pow(t,e),r=Math.round(Y*n*(Math.random()-.5)*2);return Math.min(X,n+r)}function $(e){return e&&e._delegate?e._delegate:e}},1805:(e,t,n)=>{const r=n(6272),a=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],i=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];t.getBlocksCount=function(e,t){switch(t){case r.L:return a[4*(e-1)+0];case r.M:return a[4*(e-1)+1];case r.Q:return a[4*(e-1)+2];case r.H:return a[4*(e-1)+3];default:return}},t.getTotalCodewordsCount=function(e,t){switch(t){case r.L:return i[4*(e-1)+0];case r.M:return i[4*(e-1)+1];case r.Q:return i[4*(e-1)+2];case r.H:return i[4*(e-1)+3];default:return}}},1884:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},1994:(e,t,n)=>{"use strict";n.d(t,{B5:()=>d,E1:()=>c,JN:()=>h,Qs:()=>l,fA:()=>s,gg:()=>m,iQ:()=>p,if:()=>g,ot:()=>o,uC:()=>u,uo:()=>f});var r=n(9379),a=n(6667),i=n(1121);const o=async e=>{try{const t=(()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let t="";for(let n=0;n<6;n++)t+=e.charAt(Math.floor(36*Math.random()));return t})(),n=(0,r.A)((0,r.A)({},e),{},{code:t,students:[],subjects:[],studentCount:0,createdAt:(0,a.O5)(),isActive:!0});console.log("Creating classroom with data:",n);const o=await(0,a.gS)((0,a.rJ)(i.db,"classrooms"),n);return console.log("Classroom created with ID:",o.id),{success:!0,classroomId:o.id,code:t,message:"Classroom created successfully with code: ".concat(t)}}catch(t){return console.error("Error creating classroom:",t),{success:!1,error:t.message}}},s=async e=>{try{console.log("Getting classrooms for teacherId:",e);const t=(0,a.P)((0,a.rJ)(i.db,"classrooms"),(0,a._M)("teacherId","==",e),(0,a._M)("isActive","==",!0)),n=await(0,a.GG)(t),o=[];return console.log("Query snapshot size:",n.size),n.forEach(e=>{const t=e.data();console.log("Classroom document:",e.id,t),o.push((0,r.A)({id:e.id},t))}),o.sort((e,t)=>{var n,r,a,i;const o=(null===(n=e.createdAt)||void 0===n||null===(r=n.toDate)||void 0===r?void 0:r.call(n))||new Date(e.createdAt||0);return((null===(a=t.createdAt)||void 0===a||null===(i=a.toDate)||void 0===i?void 0:i.call(a))||new Date(t.createdAt||0))-o}),console.log("Final classrooms array:",o),{success:!0,classrooms:o}}catch(t){return console.error("Error getting teacher classrooms:",t),{success:!1,error:t.message,classrooms:[]}}},l=async e=>{try{console.log("Getting classroom by ID:",e);const t=(0,a.doc)(i.db,"classrooms",e),n=await(0,a.getDoc)(t);if(!n.exists())return console.error("Classroom not found:",e),{success:!1,error:"Classroom not found"};const o=(0,r.A)({id:n.id},n.data());return console.log("Classroom found:",o),{success:!0,classroom:o}}catch(t){return console.error("Error getting classroom by ID:",t),{success:!1,error:t.message}}},c=async(e,t,n)=>{try{var r;console.log("Student attempting to join classroom with code:",n),console.log("Student data:",t);const o=(0,a.P)((0,a.rJ)(i.db,"classrooms"),(0,a._M)("code","==",n),(0,a._M)("isActive","==",!0)),s=await(0,a.GG)(o);if(console.log("Classroom search result:",s.size,"classrooms found"),s.empty)return{success:!1,error:"Invalid classroom code"};const l=s.docs[0],c=l.data();if(console.log("Found classroom:",l.id,c),null!==(r=c.students)&&void 0!==r&&r.some(t=>t.id===e))return{success:!1,error:"You are already in this classroom"};const u={studentId:e,studentName:t.name,studentEmail:t.email,classroomId:l.id,classroomName:c.name,teacherId:c.teacherId,status:"pending",requestedAt:(0,a.O5)()};console.log("Creating join request:",u);const d=await(0,a.gS)((0,a.rJ)(i.db,"joinRequests"),u);return console.log("Join request created with ID:",d.id),{success:!0,message:"Join request sent successfully"}}catch(o){return console.error("Error joining classroom:",o),{success:!1,error:o.message}}},u=async e=>{try{console.log("Getting join requests for teacher:",e);const t=(0,a.P)((0,a.rJ)(i.db,"joinRequests"),(0,a._M)("teacherId","==",e),(0,a._M)("status","==","pending")),n=await(0,a.GG)(t),o=[];return console.log("Join requests query result:",n.size,"requests found"),n.forEach(e=>{const t=e.data();console.log("Join request:",e.id,t),o.push((0,r.A)({id:e.id},t))}),o.sort((e,t)=>{var n,r,a,i;const o=(null===(n=e.requestedAt)||void 0===n||null===(r=n.toDate)||void 0===r?void 0:r.call(n))||new Date(e.requestedAt||0);return((null===(a=t.requestedAt)||void 0===a||null===(i=a.toDate)||void 0===i?void 0:i.call(a))||new Date(t.requestedAt||0))-o}),console.log("Final join requests:",o),{success:!0,requests:o}}catch(t){return console.error("Error getting join requests:",t),{success:!1,error:t.message,requests:[]}}},d=async(e,t)=>{try{console.log("Approving join request:",e,"for classroom:",t);const n=(0,a.doc)(i.db,"joinRequests",e),r=await(0,a.getDoc)(n);if(!r.exists())return console.error("Join request not found:",e),{success:!1,error:"Join request not found"};const o=r.data();console.log("Join request data:",o);const s=(0,a.doc)(i.db,"classrooms",t),l=await(0,a.getDoc)(s);if(!l.exists())return console.error("Classroom not found:",t),{success:!1,error:"Classroom not found"};const c=l.data();console.log("Current classroom data:",c);const u={id:o.studentId,name:o.studentName,email:o.studentEmail,joinedAt:new Date};console.log("Adding student to classroom:",u);c.students;const d=c.studentCount||0;return await(0,a.mZ)(s,{students:(0,a.hq)(u),studentCount:d+1,lastUpdated:(0,a.O5)()}),console.log("Student added to classroom successfully"),await(0,a.mZ)(n,{status:"approved",approvedAt:(0,a.O5)()}),console.log("Join request status updated to approved"),{success:!0}}catch(n){return console.error("Error approving join request:",n),{success:!1,error:n.message}}},h=async e=>{try{const t=(0,a.doc)(i.db,"joinRequests",e);return await(0,a.mZ)(t,{status:"rejected",rejectedAt:(0,a.O5)()}),{success:!0}}catch(t){return console.error("Error rejecting join request:",t),{success:!1,error:t.message}}},f=async(e,t)=>{try{const n=Date.now().toString(),o=(0,r.A)((0,r.A)({id:n},t),{},{createdAt:(new Date).toISOString()}),s=(0,a.doc)(i.db,"classrooms",e);return await(0,a.mZ)(s,{subjects:(0,a.hq)(o)}),{success:!0,subjectId:n}}catch(n){return console.error("Error adding subject:",n),{success:!1,error:n.message}}},p=async(e,t,n)=>{try{const o=(0,a.doc)(i.db,"classrooms",e),s=await(0,a.getDoc)(o);if(!s.exists())return{success:!1,error:"Classroom not found"};const l=s.data(),c=(l.subjects||[]).map(e=>e.id===t?(0,r.A)((0,r.A)((0,r.A)({},e),n),{},{updatedAt:new Date}):e);return await(0,a.mZ)(o,{subjects:c}),{success:!0}}catch(o){return console.error("Error updating subject:",o),{success:!1,error:o.message}}},m=async(e,t)=>{try{const n=(0,a.doc)(i.db,"classrooms",e),r=await(0,a.getDoc)(n);if(!r.exists())return{success:!1,error:"Classroom not found"};const o=r.data(),s=(o.subjects||[]).filter(e=>e.id!==t);return await(0,a.mZ)(n,{subjects:s}),{success:!0}}catch(n){return console.error("Error deleting subject:",n),{success:!1,error:n.message}}},g=async e=>{try{const t=(0,a.P)((0,a.rJ)(i.db,"classrooms"),(0,a._M)("isActive","==",!0)),n=await(0,a.GG)(t),o=[];return n.forEach(t=>{var n;const a=t.data();(null===(n=a.students)||void 0===n?void 0:n.some(t=>t.id===e))&&o.push((0,r.A)({id:t.id},a))}),{success:!0,classrooms:o}}catch(t){return console.error("Error getting student classrooms:",t),{success:!1,error:t.message,classrooms:[]}}}},2054:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2086:(e,t,n)=>{"use strict";e.exports=n(5082)},2104:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(1203),a=n(9921);t.isArrayLikeObject=function(e){return a.isObjectLike(e)&&r.isArrayLike(e)}},2132:(e,t,n)=>{"use strict";var r=n(2897).default;Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const a=n(8268),i=n(870),o=n(4803),s=n(9972);function l(e,t,n,a){if(t===e)return!0;switch(typeof t){case"object":return function(e,t,n,r){if(null==t)return!0;if(Array.isArray(t))return c(e,t,n,r);if(t instanceof Map)return function(e,t,n,r){if(0===t.size)return!0;if(!(e instanceof Map))return!1;for(const[a,i]of t.entries()){if(!1===n(e.get(a),i,a,e,t,r))return!1}return!0}(e,t,n,r);if(t instanceof Set)return u(e,t,n,r);const a=Object.keys(t);if(null==e)return 0===a.length;if(0===a.length)return!0;if(r&&r.has(t))return r.get(t)===e;r&&r.set(t,e);try{for(let i=0;i<a.length;i++){const s=a[i];if(!o.isPrimitive(e)&&!(s in e))return!1;if(void 0===t[s]&&void 0!==e[s])return!1;if(null===t[s]&&null!==e[s])return!1;if(!n(e[s],t[s],s,e,t,r))return!1}return!0}finally{r&&r.delete(t)}}(e,t,n,a);case"function":return Object.keys(t).length>0?l(e,r({},t),n,a):s.eq(e,t);default:return i.isObject(e)?"string"!==typeof t||""===t:s.eq(e,t)}}function c(e,t,n,r){if(0===t.length)return!0;if(!Array.isArray(e))return!1;const a=new Set;for(let i=0;i<t.length;i++){const o=t[i];let s=!1;for(let l=0;l<e.length;l++){if(a.has(l))continue;let c=!1;if(n(e[l],o,i,e,t,r)&&(c=!0),c){a.add(l),s=!0;break}}if(!s)return!1}return!0}function u(e,t,n,r){return 0===t.size||e instanceof Set&&c([...e],[...t],n,r)}t.isMatchWith=function(e,t,n){return"function"!==typeof n?a.isMatch(e,t):l(e,t,function e(t,r,a,i,o,s){const c=n(t,r,a,i,o,s);return void 0!==c?Boolean(c):l(t,r,e,s)},new Map)},t.isSetMatch=u},2182:(e,t,n)=>{const r=n(8293);t.render=function(e,t,n){let a=n,i=t;"undefined"!==typeof a||t&&t.getContext||(a=t,t=void 0),t||(i=function(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}()),a=r.getOptions(a);const o=r.getImageWidth(e.modules.size,a),s=i.getContext("2d"),l=s.createImageData(o,o);return r.qrToImageData(l.data,e,a),function(e,t,n){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=n,t.width=n,t.style.height=n+"px",t.style.width=n+"px"}(s,i,o),s.putImageData(l,0,0),i},t.renderToDataURL=function(e,n,r){let a=r;"undefined"!==typeof a||n&&n.getContext||(a=n,n=void 0),a||(a={});const i=t.render(e,n,a),o=a.type||"image/png",s=a.rendererOpts||{};return i.toDataURL(o,s.quality)}},2204:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(5316),a=n(7312),i=n(3799);t.sortBy=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];const s=n.length;return s>1&&i.isIterateeCall(e,n[0],n[1])?n=[]:s>2&&i.isIterateeCall(n[0],n[1],n[2])&&(n=[n[0]]),r.orderBy(e,a.flatten(n),["asc"])}},2313:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},2330:(e,t,n)=>{"use strict";var r=n(5043);var a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=r.useState,o=r.useEffect,s=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!a(e,n)}catch(r){return!0}}var u="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=i({inst:{value:n,getSnapshot:t}}),a=r[0].inst,u=r[1];return s(function(){a.value=n,a.getSnapshot=t,c(a)&&u({inst:a})},[e,n,t]),o(function(){return c(a)&&u({inst:a}),e(function(){c(a)&&u({inst:a})})},[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},2489:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isDeepKey=function(e){switch(typeof e){case"number":case"symbol":return!1;case"string":return e.includes(".")||e.includes("[")||e.includes("]")}}},2626:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},2681:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("qr-code",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]])},2682:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isPlainObject=function(e){if("object"!==typeof e)return!1;if(null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){var t;const n=e[Symbol.toStringTag];if(null==n)return!1;return!!(null!==(t=Object.getOwnPropertyDescriptor(e,Symbol.toStringTag))&&void 0!==t&&t.writable)&&e.toString()==="[object ".concat(n,"]")}let n=e;for(;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}},2715:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9599),a=n(7330),i=n(3808),o=n(8845);t.iteratee=function(e){if(null==e)return r.identity;switch(typeof e){case"function":return e;case"object":return Array.isArray(e)&&2===e.length?o.matchesProperty(e[0],e[1]):i.matches(e);case"string":case"symbol":case"number":return a.property(e)}}},2777:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isSymbol=function(e){return"symbol"===typeof e||e instanceof Symbol}},2799:(e,t,n)=>{"use strict";n.d(t,{P2:()=>v});var r=n(9379);const a=(e,t)=>t.some(t=>e instanceof t);let i,o;const s=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap;let h={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return l.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return m(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function f(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(g(this),n),m(s.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return m(e.apply(g(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];const i=e.call(g(this),t,...r);return c.set(i,t.sort?t.sort():[t]),m(i)}}function p(e){return"function"===typeof e?f(e):(e instanceof IDBTransaction&&function(e){if(l.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});l.set(e,t)}(e),a(e,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,h):e)}function m(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{t(m(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",i)});return t.then(t=>{t instanceof IDBCursor&&s.set(t,e)}).catch(()=>{}),d.set(t,e),t}(e);if(u.has(e))return u.get(e);const t=p(e);return t!==e&&(u.set(e,t),d.set(t,e)),t}const g=e=>d.get(e);function v(e,t){let{blocked:n,upgrade:r,blocking:a,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),s=m(o);return r&&o.addEventListener("upgradeneeded",e=>{r(m(o.result),e.oldVersion,e.newVersion,m(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{i&&e.addEventListener("close",()=>i()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}const y=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],x=new Map;function w(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(x.get(t))return x.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=b.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!y.includes(n))return;const i=async function(e){const t=this.transaction(e,a?"readwrite":"readonly");let i=t.store;for(var o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];return r&&(i=i.index(s.shift())),(await Promise.all([i[n](...s),a&&t.done]))[0]};return x.set(t,i),i}h=(e=>(0,r.A)((0,r.A)({},e),{},{get:(t,n,r)=>w(t,n)||e.get(t,n,r),has:(t,n)=>!!w(t,n)||e.has(t,n)}))(h)},2897:(e,t,n)=>{var r=n(3693);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports},2963:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>YC});var r={};n.r(r),n.d(r,{scaleBand:()=>ci,scaleDiverging:()=>au,scaleDivergingLog:()=>iu,scaleDivergingPow:()=>su,scaleDivergingSqrt:()=>lu,scaleDivergingSymlog:()=>ou,scaleIdentity:()=>Jo,scaleImplicit:()=>si,scaleLinear:()=>$o,scaleLog:()=>ss,scaleOrdinal:()=>li,scalePoint:()=>di,scalePow:()=>gs,scaleQuantile:()=>_s,scaleQuantize:()=>js,scaleRadial:()=>bs,scaleSequential:()=>$c,scaleSequentialLog:()=>Jc,scaleSequentialPow:()=>eu,scaleSequentialQuantile:()=>nu,scaleSequentialSqrt:()=>tu,scaleSequentialSymlog:()=>Zc,scaleSqrt:()=>vs,scaleSymlog:()=>ds,scaleThreshold:()=>Is,scaleTime:()=>Kc,scaleUtc:()=>Xc,tickFormat:()=>Yo});var a=n(5043),i=n.t(a,2),o=n(7784);const s=(0,o.A)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var l=n(9797),c=n(7118),u=n(2626);const d=(0,o.A)("chart-no-axes-column",[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]]),h=(0,o.A)("clipboard-check",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);var f=n(614),p=n(9493);const m=(0,o.A)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);var g=n(9233),v=n(7365),y=n(9308),b=n(5016),x=n(6471),w=n(579);var N=n(9379),S=n(4919),E=n(4537),C=n(254),k=n(8646),A=n(516);function _(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=_(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function j(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=_(e))&&(r&&(r+=" "),r+=t);return r}var I=n(7820),T=n.n(I),O=n(7770),P=n.n(O),D=e=>0===e?0:e>0?1:-1,R=e=>"number"==typeof e&&e!=+e,M=e=>"string"===typeof e&&e.indexOf("%")===e.length-1,F=e=>("number"===typeof e||e instanceof Number)&&!R(e),L=e=>F(e)||"string"===typeof e,B=0,U=e=>{var t=++B;return"".concat(e||"").concat(t)},z=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!F(e)&&"string"!==typeof e)return r;if(M(e)){if(null==t)return r;var i=e.indexOf("%");n=t*parseFloat(e.slice(0,i))/100}else n=+e;return R(n)&&(n=r),a&&null!=t&&n>t&&(n=t),n},V=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++){if(n[e[r]])return!0;n[e[r]]=!0}return!1};function W(e,t,n){return F(e)&&F(t)?e+n*(t-e):t}var q=e=>null===e||"undefined"===typeof e,H=e=>q(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),G=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a]};function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach(function(t){Y(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Y(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Q=(0,a.forwardRef)((e,t)=>{var{aspect:n,initialDimension:r={width:-1,height:-1},width:i="100%",height:o="100%",minWidth:s=0,minHeight:l,maxHeight:c,children:u,debounce:d=0,id:h,className:f,onResize:p,style:m={}}=e,g=(0,a.useRef)(null),v=(0,a.useRef)();v.current=p,(0,a.useImperativeHandle)(t,()=>g.current);var[y,b]=(0,a.useState)({containerWidth:r.width,containerHeight:r.height}),x=(0,a.useCallback)((e,t)=>{b(n=>{var r=Math.round(e),a=Math.round(t);return n.containerWidth===r&&n.containerHeight===a?n:{containerWidth:r,containerHeight:a}})},[]);(0,a.useEffect)(()=>{var e=e=>{var t,{width:n,height:r}=e[0].contentRect;x(n,r),null===(t=v.current)||void 0===t||t.call(v,n,r)};d>0&&(e=T()(e,d,{trailing:!0,leading:!1}));var t=new ResizeObserver(e),{width:n,height:r}=g.current.getBoundingClientRect();return x(n,r),t.observe(g.current),()=>{t.disconnect()}},[x,d]);var w=(0,a.useMemo)(()=>{var{containerWidth:e,containerHeight:t}=y;if(e<0||t<0)return null;G(M(i)||M(o),"The width(%s) and height(%s) are both fixed numbers,\n       maybe you don't need to use a ResponsiveContainer.",i,o),G(!n||n>0,"The aspect(%s) must be greater than zero.",n);var r=M(i)?e:i,d=M(o)?t:o;return n&&n>0&&(r?d=r/n:d&&(r=d*n),c&&d>c&&(d=c)),G(r>0||d>0,"The width(%s) and height(%s) of chart should be greater than 0,\n       please check the style of container, or the props width(%s) and height(%s),\n       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the\n       height and width.",r,d,i,o,s,l,n),a.Children.map(u,e=>(0,a.cloneElement)(e,{width:r,height:d,style:X({width:r,height:d},e.props.style)}))},[n,u,o,c,l,s,y,i]);return a.createElement("div",{id:h?"".concat(h):void 0,className:j("recharts-responsive-container",f),style:X(X({},m),{},{width:i,height:o,minWidth:s,minHeight:l,maxHeight:c}),ref:g},a.createElement("div",{style:{width:0,height:0,overflow:"visible"}},w))}),$=n(3986),J=n(4705);function Z(e){return"Minified Redux error #".concat(e,"; visit https://redux.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}var ee=(()=>"function"===typeof Symbol&&Symbol.observable||"@@observable")(),te=()=>Math.random().toString(36).substring(7).split("").join("."),ne={INIT:"@@redux/INIT".concat(te()),REPLACE:"@@redux/REPLACE".concat(te()),PROBE_UNKNOWN_ACTION:()=>"@@redux/PROBE_UNKNOWN_ACTION".concat(te())};function re(e){if("object"!==typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function ae(e,t,n){if("function"!==typeof e)throw new Error(Z(2));if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(Z(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(Z(1));return n(ae)(e,t)}let r=e,a=t,i=new Map,o=i,s=0,l=!1;function c(){o===i&&(o=new Map,i.forEach((e,t)=>{o.set(t,e)}))}function u(){if(l)throw new Error(Z(3));return a}function d(e){if("function"!==typeof e)throw new Error(Z(4));if(l)throw new Error(Z(5));let t=!0;c();const n=s++;return o.set(n,e),function(){if(t){if(l)throw new Error(Z(6));t=!1,c(),o.delete(n),i=null}}}function h(e){if(!re(e))throw new Error(Z(7));if("undefined"===typeof e.type)throw new Error(Z(8));if("string"!==typeof e.type)throw new Error(Z(17));if(l)throw new Error(Z(9));try{l=!0,a=r(a,e)}finally{l=!1}return(i=o).forEach(e=>{e()}),e}h({type:ne.INIT});return{dispatch:h,subscribe:d,getState:u,replaceReducer:function(e){if("function"!==typeof e)throw new Error(Z(10));r=e,h({type:ne.REPLACE})},[ee]:function(){const e=d;return{subscribe(t){if("object"!==typeof t||null===t)throw new Error(Z(11));function n(){const e=t;e.next&&e.next(u())}n();return{unsubscribe:e(n)}},[ee](){return this}}}}}function ie(e){const t=Object.keys(e),n={};for(let o=0;o<t.length;o++){const r=t[o];0,"function"===typeof e[r]&&(n[r]=e[r])}const r=Object.keys(n);let a;try{!function(e){Object.keys(e).forEach(t=>{const n=e[t];if("undefined"===typeof n(void 0,{type:ne.INIT}))throw new Error(Z(12));if("undefined"===typeof n(void 0,{type:ne.PROBE_UNKNOWN_ACTION()}))throw new Error(Z(13))})}(n)}catch(i){a=i}return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(a)throw a;let i=!1;const o={};for(let a=0;a<r.length;a++){const s=r[a],l=n[s],c=e[s],u=l(c,t);if("undefined"===typeof u){t&&t.type;throw new Error(Z(14))}o[s]=u,i=i||u!==c}return i=i||r.length!==Object.keys(e).length,i?o:e}}function oe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?e=>e:1===t.length?t[0]:t.reduce((e,t)=>function(){return e(t(...arguments))})}function se(e){return re(e)&&"type"in e&&"string"===typeof e.type}function le(e){return t=>{let{dispatch:n,getState:r}=t;return t=>a=>"function"===typeof a?a(n,r,e):t(a)}}var ce=le(),ue=le,de=Symbol.for("immer-nothing"),he=Symbol.for("immer-draftable"),fe=Symbol.for("immer-state");function pe(e){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var me=Object.getPrototypeOf;function ge(e){return!!e&&!!e[fe]}function ve(e){var t;return!!e&&(be(e)||Array.isArray(e)||!!e[he]||!(null===(t=e.constructor)||void 0===t||!t[he])||Ee(e)||Ce(e))}var ye=Object.prototype.constructor.toString();function be(e){if(!e||"object"!==typeof e)return!1;const t=me(e);if(null===t)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===ye}function xe(e,t){0===we(e)?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function we(e){const t=e[fe];return t?t.type_:Array.isArray(e)?1:Ee(e)?2:Ce(e)?3:0}function Ne(e,t){return 2===we(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Se(e,t,n){const r=we(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function Ee(e){return e instanceof Map}function Ce(e){return e instanceof Set}function ke(e){return e.copy_||e.base_}function Ae(e,t){if(Ee(e))return new Map(e);if(Ce(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=be(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[fe];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const a=n[r],i=t[a];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[a]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[a]})}return Object.create(me(e),t)}{const t=me(e);if(null!==t&&n)return(0,N.A)({},e);const r=Object.create(t);return Object.assign(r,e)}}function _e(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Ie(e)||ge(e)||!ve(e)||(we(e)>1&&Object.defineProperties(e,{set:{value:je},add:{value:je},clear:{value:je},delete:{value:je}}),Object.freeze(e),t&&Object.values(e).forEach(e=>_e(e,!0))),e}function je(){pe(2)}function Ie(e){return Object.isFrozen(e)}var Te,Oe={};function Pe(e){const t=Oe[e];return t||pe(0),t}function De(){return Te}function Re(e,t){t&&(Pe("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Me(e){Fe(e),e.drafts_.forEach(Be),e.drafts_=null}function Fe(e){e===Te&&(Te=e.parent_)}function Le(e){return Te={drafts_:[],parent_:Te,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Be(e){const t=e[fe];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function Ue(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[fe].modified_&&(Me(t),pe(4)),ve(e)&&(e=ze(t,e),t.parent_||We(t,e)),t.patches_&&Pe("Patches").generateReplacementPatches_(n[fe].base_,e,t.patches_,t.inversePatches_)):e=ze(t,n,[]),Me(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==de?e:void 0}function ze(e,t,n){if(Ie(t))return t;const r=t[fe];if(!r)return xe(t,(a,i)=>Ve(e,r,t,a,i,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return We(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const t=r.copy_;let a=t,i=!1;3===r.type_&&(a=new Set(t),t.clear(),i=!0),xe(a,(a,o)=>Ve(e,r,t,a,o,n,i)),We(e,t,!1),n&&e.patches_&&Pe("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function Ve(e,t,n,r,a,i,o){if(ge(a)){const o=ze(e,a,i&&t&&3!==t.type_&&!Ne(t.assigned_,r)?i.concat(r):void 0);if(Se(n,r,o),!ge(o))return;e.canAutoFreeze_=!1}else o&&n.add(a);if(ve(a)&&!Ie(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;ze(e,a),t&&t.scope_.parent_||"symbol"===typeof r||!(Ee(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))||We(e,a)}}function We(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&_e(t,n)}var qe={get(e,t){if(t===fe)return e;const n=ke(e);if(!Ne(n,t))return function(e,t,n){var r;const a=Ke(t,n);return a?"value"in a?a.value:null===(r=a.get)||void 0===r?void 0:r.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!ve(r)?r:r===Ge(e.base_,t)?(Ye(e),e.copy_[t]=Qe(r,e)):r},has:(e,t)=>t in ke(e),ownKeys:e=>Reflect.ownKeys(ke(e)),set(e,t,n){const r=Ke(ke(e),t);if(null!==r&&void 0!==r&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=Ge(ke(e),t),a=null===r||void 0===r?void 0:r[fe];if(a&&a.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}(n,r)&&(void 0!==n||Ne(e.base_,t)))return!0;Ye(e),Xe(e)}return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==Ge(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,Ye(e),Xe(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=ke(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){pe(11)},getPrototypeOf:e=>me(e.base_),setPrototypeOf(){pe(12)}},He={};function Ge(e,t){const n=e[fe];return(n?ke(n):e)[t]}function Ke(e,t){if(!(t in e))return;let n=me(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=me(n)}}function Xe(e){e.modified_||(e.modified_=!0,e.parent_&&Xe(e.parent_))}function Ye(e){e.copy_||(e.copy_=Ae(e.base_,e.scope_.immer_.useStrictShallowCopy_))}xe(qe,(e,t)=>{He[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),He.deleteProperty=function(e,t){return He.set.call(this,e,t,void 0)},He.set=function(e,t,n){return qe.set.call(this,e[0],t,n,e[0])};function Qe(e,t){const n=Ee(e)?Pe("MapSet").proxyMap_(e,t):Ce(e)?Pe("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:De(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=r,i=qe;n&&(a=[r],i=He);const{revoke:o,proxy:s}=Proxy.revocable(a,i);return r.draft_=s,r.revoke_=o,s}(e,t);return(t?t.scope_:De()).drafts_.push(n),n}function $e(e){return ge(e)||pe(10),Je(e)}function Je(e){if(!ve(e)||Ie(e))return e;const t=e[fe];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Ae(e,t.scope_.immer_.useStrictShallowCopy_)}else n=Ae(e,!0);return xe(n,(e,t)=>{Se(n,e,Je(t))}),t&&(t.finalized_=!1),n}var Ze=new class{constructor(e){var t=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if("function"===typeof e&&"function"!==typeof t){const n=t;t=e;const r=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return r.produce(e,e=>t.call(this,e,...i))}}let r;if("function"!==typeof t&&pe(6),void 0!==n&&"function"!==typeof n&&pe(7),ve(e)){const a=Le(this),i=Qe(e,void 0);let o=!0;try{r=t(i),o=!1}finally{o?Me(a):Fe(a)}return Re(a,n),Ue(r,a)}if(!e||"object"!==typeof e){if(r=t(e),void 0===r&&(r=e),r===de&&(r=void 0),this.autoFreeze_&&_e(r,!0),n){const t=[],a=[];Pe("Patches").generateReplacementPatches_(e,r,t,a),n(t,a)}return r}pe(1)},this.produceWithPatches=(e,n)=>{if("function"===typeof e)return function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return t.produceWithPatches(n,t=>e(t,...a))};let r,a;return[this.produce(e,n,(e,t)=>{r=e,a=t}),r,a]},"boolean"===typeof(null===e||void 0===e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){ve(e)||pe(8),ge(e)&&(e=$e(e));const t=Le(this),n=Qe(e,void 0);return n[fe].isManual_=!0,Fe(t),n}finishDraft(e,t){const n=e&&e[fe];n&&n.isManual_||pe(9);const{scope_:r}=n;return Re(r,t),Ue(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=Pe("Patches").applyPatches_;return ge(e)?r(e,t):this.produce(e,e=>r(e,t))}},et=Ze.produce;const tt=["reducerPath"];var nt="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?oe:oe.apply(null,arguments)};"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;function rt(e,t){function n(){if(t){let n=t(...arguments);if(!n)throw new Error($t(0));return(0,N.A)((0,N.A)({type:e,payload:n.payload},"meta"in n&&{meta:n.meta}),"error"in n&&{error:n.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return n.toString=()=>"".concat(e),n.type=e,n.match=t=>se(t)&&t.type===e,n}var at=class e extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return super.concat.apply(this,t)}prepend(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return 1===n.length&&Array.isArray(n[0])?new e(...n[0].concat(this)):new e(...n.concat(this))}};function it(e){return ve(e)?et(e,()=>{}):e}function ot(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}var st="RTK_autoBatch",lt=e=>t=>{setTimeout(t,e)},ct=e=>function(t){const{autoBatch:n=!0}=null!==t&&void 0!==t?t:{};let r=new at(e);return n&&r.push(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"raf"};return t=>function(){const n=t(...arguments);let r=!0,a=!1,i=!1;const o=new Set,s="tick"===e.type?queueMicrotask:"raf"===e.type?"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:lt(10):"callback"===e.type?e.queueNotification:lt(e.timeout),l=()=>{i=!1,a&&(a=!1,o.forEach(e=>e()))};return Object.assign({},n,{subscribe(e){const t=n.subscribe(()=>r&&e());return o.add(e),()=>{t(),o.delete(e)}},dispatch(e){try{var t;return r=!(null!==e&&void 0!==e&&null!==(t=e.meta)&&void 0!==t&&t[st]),a=!r,a&&(i||(i=!0,s(l))),n.dispatch(e)}finally{r=!0}}})}}("object"===typeof n?n:void 0)),r};function ut(e){const t=function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:a=!0}=null!==e&&void 0!==e?e:{};let i=new at;return t&&(function(e){return"boolean"===typeof e}(t)?i.push(ce):i.push(ue(t.extraArgument))),i},{reducer:n,middleware:r,devTools:a=!0,duplicateMiddlewareCheck:i=!0,preloadedState:o,enhancers:s}=e||{};let l,c;if("function"===typeof n)l=n;else{if(!re(n))throw new Error($t(1));l=ie(n)}c="function"===typeof r?r(t):t();let u=oe;a&&(u=nt((0,N.A)({trace:!1},"object"===typeof a&&a)));const d=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>(n,r)=>{const a=e(n,r);let i=()=>{throw new Error(Z(15))};const o={getState:a.getState,dispatch:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return i(e,...n)}},s=t.map(e=>e(o));return i=oe(...s)(a.dispatch),(0,N.A)((0,N.A)({},a),{},{dispatch:i})}}(...c),h=ct(d);return ae(l,o,u(..."function"===typeof s?s(h):h()))}function dt(e){const t={},n=[];let r;const a={addCase(e,n){const r="string"===typeof e?e:e.type;if(!r)throw new Error($t(28));if(r in t)throw new Error($t(29));return t[r]=n,a},addAsyncThunk:(e,r)=>(r.pending&&(t[e.pending.type]=r.pending),r.rejected&&(t[e.rejected.type]=r.rejected),r.fulfilled&&(t[e.fulfilled.type]=r.fulfilled),r.settled&&n.push({matcher:e.settled,reducer:r.settled}),a),addMatcher:(e,t)=>(n.push({matcher:e,reducer:t}),a),addDefaultCase:e=>(r=e,a)};return e(a),[t,n,r]}var ht=function(){let e="",t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;for(;t--;)e+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return e};var ft=Symbol.for("rtk-slice-createasyncthunk");function pt(e,t){return"".concat(e,"/").concat(t)}function mt(){var e;let{creators:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=null===t||void 0===t||null===(e=t.asyncThunk)||void 0===e?void 0:e[ft];return function(e){const{name:t,reducerPath:r=t}=e;if(!t)throw new Error($t(11));const a=("function"===typeof e.reducers?e.reducers(function(){function e(e,t){return(0,N.A)({_reducerDefinitionType:"asyncThunk",payloadCreator:e},t)}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name](){return e(...arguments)}}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},i=Object.keys(a),o={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},s={addCase(e,t){const n="string"===typeof e?e:e.type;if(!n)throw new Error($t(12));if(n in o.sliceCaseReducersByType)throw new Error($t(13));return o.sliceCaseReducersByType[n]=t,s},addMatcher:(e,t)=>(o.sliceMatchers.push({matcher:e,reducer:t}),s),exposeAction:(e,t)=>(o.actionCreators[e]=t,s),exposeCaseReducer:(e,t)=>(o.sliceCaseReducersByName[e]=t,s)};function l(){const[t={},n=[],r]="function"===typeof e.extraReducers?dt(e.extraReducers):[e.extraReducers],a=(0,N.A)((0,N.A)({},t),o.sliceCaseReducersByType);return function(e,t){let n,[r,a,i]=dt(t);if(function(e){return"function"===typeof e}(e))n=()=>it(e());else{const t=it(e);n=()=>t}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n(),t=arguments.length>1?arguments[1]:void 0,o=[r[t.type],...a.filter(e=>{let{matcher:n}=e;return n(t)}).map(e=>{let{reducer:t}=e;return t})];return 0===o.filter(e=>!!e).length&&(o=[i]),o.reduce((e,n)=>{if(n){if(ge(e)){const r=n(e,t);return void 0===r?e:r}if(ve(e))return et(e,e=>n(e,t));{const r=n(e,t);if(void 0===r){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}}return e},e)}return o.getInitialState=n,o}(e.initialState,e=>{for(let t in a)e.addCase(t,a[t]);for(let t of o.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);r&&e.addDefaultCase(r)})}i.forEach(r=>{const i=a[r],o={reducerName:r,type:pt(t,r),createNotation:"function"===typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(i)?function(e,t,n){let r,a,{type:i,reducerName:o,createNotation:s}=e;if("reducer"in t){if(s&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(t))throw new Error($t(17));r=t.reducer,a=t.prepare}else r=t;n.addCase(i,r).exposeCaseReducer(o,r).exposeAction(o,a?rt(i,a):rt(i))}(o,i,s):function(e,t,n,r){let{type:a,reducerName:i}=e;if(!r)throw new Error($t(18));const{payloadCreator:o,fulfilled:s,pending:l,rejected:c,settled:u,options:d}=t,h=r(a,o,d);n.exposeAction(i,h),s&&n.addCase(h.fulfilled,s);l&&n.addCase(h.pending,l);c&&n.addCase(h.rejected,c);u&&n.addMatcher(h.settled,u);n.exposeCaseReducer(i,{fulfilled:s||yt,pending:l||yt,rejected:c||yt,settled:u||yt})}(o,i,s,n)});const c=e=>e,u=new Map,d=new WeakMap;let h;function f(e,t){return h||(h=l()),h(e,t)}function p(){return h||(h=l()),h.getInitialState()}function m(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function r(e){let a=e[t];return"undefined"===typeof a&&n&&(a=ot(d,r,p)),a}function a(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c;const r=ot(u,n,()=>new WeakMap);return ot(r,t,()=>{const r={};for(const[i,o]of Object.entries(null!==(a=e.selectors)&&void 0!==a?a:{})){var a;r[i]=gt(o,t,()=>ot(d,t,p),n)}return r})}return{reducerPath:t,getSelectors:a,get selectors(){return a(r)},selectSlice:r}}const g=(0,N.A)((0,N.A)({name:t,reducer:f,actions:o.actionCreators,caseReducers:o.sliceCaseReducersByName,getInitialState:p},m(r)),{},{injectInto(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{reducerPath:n}=t,a=(0,$.A)(t,tt);const i=null!==n&&void 0!==n?n:r;return e.inject({reducerPath:i,reducer:f},a),(0,N.A)((0,N.A)({},g),m(i,!0))}});return g}}function gt(e,t,n,r){function a(a){let i=t(a);"undefined"===typeof i&&r&&(i=n());for(var o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];return e(i,...s)}return a.unwrapped=e,a}var vt=mt();function yt(){}var bt="listener",xt="completed",wt="cancelled",Nt="task-".concat(wt),St="task-".concat(xt),Et="".concat(bt,"-").concat(wt),Ct="".concat(bt,"-").concat(xt),kt=class{constructor(e){(0,J.A)(this,"name","TaskAbortError"),(0,J.A)(this,"message",void 0),this.code=e,this.message="".concat("task"," ").concat(wt," (reason: ").concat(e,")")}},At=(e,t)=>{if("function"!==typeof e)throw new TypeError($t(32))},_t=()=>{},jt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_t;return e.catch(t),e},It=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Tt=(e,t)=>{const n=e.signal;n.aborted||("reason"in n||Object.defineProperty(n,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Ot=e=>{if(e.aborted){const{reason:t}=e;throw new kt(t)}};function Pt(e,t){let n=_t;return new Promise((r,a)=>{const i=()=>a(new kt(e.reason));e.aborted?i():(n=It(e,i),t.finally(()=>n()).then(r,a))}).finally(()=>{n=_t})}var Dt=e=>t=>jt(Pt(e,t).then(t=>(Ot(e),t))),Rt=e=>{const t=Dt(e);return e=>t(new Promise(t=>setTimeout(t,e)))},{assign:Mt}=Object,Ft={},Lt="listenerMiddleware",Bt=(e,t)=>(n,r)=>{At(n);const a=new AbortController;var i;i=a,It(e,()=>Tt(i,e.reason));const o=(async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof kt?"cancelled":"rejected",error:n}}finally{null===t||void 0===t||t()}})(async()=>{Ot(e),Ot(a.signal);const t=await n({pause:Dt(a.signal),delay:Rt(a.signal),signal:a.signal});return Ot(a.signal),t},()=>Tt(a,St));return null!==r&&void 0!==r&&r.autoJoin&&t.push(o.catch(_t)),{result:Dt(e)(o),cancel(){Tt(a,Nt)}}},Ut=(e,t)=>(n,r)=>jt((async(n,r)=>{Ot(t);let a=()=>{};const i=[new Promise((t,r)=>{let i=e({predicate:n,effect:(e,n)=>{n.unsubscribe(),t([e,n.getState(),n.getOriginalState()])}});a=()=>{i(),r()}})];null!=r&&i.push(new Promise(e=>setTimeout(e,r,null)));try{const e=await Pt(t,Promise.race(i));return Ot(t),e}finally{a()}})(n,r)),zt=e=>{let{type:t,actionCreator:n,matcher:r,predicate:a,effect:i}=e;if(t)a=rt(t).match;else if(n)t=n.type,a=n.match;else if(r)a=r;else if(!a)throw new Error($t(21));return At(i),{predicate:a,type:t,effect:i}},Vt=Mt(e=>{const{type:t,predicate:n,effect:r}=zt(e);return{id:ht(),effect:r,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error($t(22))}}},{withTypes:()=>Vt}),Wt=(e,t)=>{const{type:n,effect:r,predicate:a}=zt(t);return Array.from(e.values()).find(e=>("string"===typeof n?e.type===n:e.predicate===a)&&e.effect===r)},qt=e=>{e.pending.forEach(e=>{Tt(e,Et)})},Ht=(e,t,n)=>{try{e(t,n)}catch(r){setTimeout(()=>{throw r},0)}},Gt=Mt(rt("".concat(Lt,"/add")),{withTypes:()=>Gt}),Kt=rt("".concat(Lt,"/removeAll")),Xt=Mt(rt("".concat(Lt,"/remove")),{withTypes:()=>Xt}),Yt=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.error("".concat(Lt,"/error"),...t)},Qt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map,{extra:n,onError:r=Yt}=e;At(r);const a=e=>{var n;return(e=>(e.unsubscribe=()=>t.delete(e.id),t.set(e.id,e),t=>{e.unsubscribe(),null!==t&&void 0!==t&&t.cancelActive&&qt(e)}))(null!==(n=Wt(t,e))&&void 0!==n?n:Vt(e))};Mt(a,{withTypes:()=>a});const i=e=>{const n=Wt(t,e);return n&&(n.unsubscribe(),e.cancelActive&&qt(n)),!!n};Mt(i,{withTypes:()=>i});const o=async(e,i,o,s)=>{const l=new AbortController,c=Ut(a,l.signal),u=[];try{e.pending.add(l),await Promise.resolve(e.effect(i,Mt({},o,{getOriginalState:s,condition:(e,t)=>c(e,t).then(Boolean),take:c,delay:Rt(l.signal),pause:Dt(l.signal),extra:n,signal:l.signal,fork:Bt(l.signal,u),unsubscribe:e.unsubscribe,subscribe:()=>{t.set(e.id,e)},cancelActiveListeners:()=>{e.pending.forEach((e,t,n)=>{e!==l&&(Tt(e,Et),n.delete(e))})},cancel:()=>{Tt(l,Et),e.pending.delete(l)},throwIfCancelled:()=>{Ot(l.signal)}})))}catch(d){d instanceof kt||Ht(r,d,{raisedBy:"effect"})}finally{await Promise.all(u),Tt(l,Ct),e.pending.delete(l)}},s=(e=>()=>{e.forEach(qt),e.clear()})(t);return{middleware:e=>n=>l=>{if(!se(l))return n(l);if(Gt.match(l))return a(l.payload);if(Kt.match(l))return void s();if(Xt.match(l))return i(l.payload);let c=e.getState();const u=()=>{if(c===Ft)throw new Error($t(23));return c};let d;try{if(d=n(l),t.size>0){const n=e.getState(),a=Array.from(t.values());for(const t of a){let a=!1;try{a=t.predicate(l,n,c)}catch(h){a=!1,Ht(r,h,{raisedBy:"predicate"})}a&&o(t,l,e,u)}}}finally{c=Ft}return d},startListening:a,stopListening:i,clearListeners:s}};Symbol.for("rtk-state-proxy-original");function $t(e){return"Minified Redux Toolkit error #".concat(e,"; visit https://redux-toolkit.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}function Jt(e,t){if(t){var n=Number.parseInt(t,10);if(!R(n))return null===e||void 0===e?void 0:e[n]}}var Zt=vt({name:"options",initialState:{chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},reducers:{createEventEmitter:e=>{null==e.eventEmitter&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),en=Zt.reducer,{createEventEmitter:tn}=Zt.actions;n(7237);function nn(e){e()}var rn={notify(){},get:()=>[]};function an(e,t){let n,r=rn,a=0,i=!1;function o(){c.onStateChange&&c.onStateChange()}function s(){a++,n||(n=t?t.addNestedSub(o):e.subscribe(o),r=function(){let e=null,t=null;return{clear(){e=null,t=null},notify(){nn(()=>{let t=e;for(;t;)t.callback(),t=t.next})},get(){const t=[];let n=e;for(;n;)t.push(n),n=n.next;return t},subscribe(n){let r=!0;const a=t={callback:n,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){r&&null!==e&&(r=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}())}function l(){a--,n&&0===a&&(n(),n=void 0,r.clear(),r=rn)}const c={addNestedSub:function(e){s();const t=r.subscribe(e);let n=!1;return()=>{n||(n=!0,t(),l())}},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:o,isSubscribed:function(){return i},trySubscribe:function(){i||(i=!0,s())},tryUnsubscribe:function(){i&&(i=!1,l())},getListeners:()=>r};return c}var on=(()=>!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement))(),sn=(()=>"undefined"!==typeof navigator&&"ReactNative"===navigator.product)(),ln=(()=>on||sn?a.useLayoutEffect:a.useEffect)();Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;var cn=Symbol.for("react-redux-context"),un="undefined"!==typeof globalThis?globalThis:{};function dn(){var e;if(!a.createContext)return{};const t=null!==(e=un[cn])&&void 0!==e?e:un[cn]=new Map;let n=t.get(a.createContext);return n||(n=a.createContext(null),t.set(a.createContext,n)),n}var hn=dn();var fn=function(e){const{children:t,context:n,serverState:r,store:i}=e,o=a.useMemo(()=>{const e=an(i);return{store:i,subscription:e,getServerState:r?()=>r:void 0}},[i,r]),s=a.useMemo(()=>i.getState(),[i]);ln(()=>{const{subscription:e}=o;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),s!==i.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}},[o,s]);const l=n||hn;return a.createElement(l.Provider,{value:o},t)};var pn=Symbol.for("immer-nothing"),mn=Symbol.for("immer-draftable"),gn=Symbol.for("immer-state");function vn(e){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var yn=Object.getPrototypeOf;function bn(e){return!!e&&!!e[gn]}function xn(e){var t;return!!e&&(Nn(e)||Array.isArray(e)||!!e[mn]||!(null===(t=e.constructor)||void 0===t||!t[mn])||An(e)||_n(e))}var wn=Object.prototype.constructor.toString();function Nn(e){if(!e||"object"!==typeof e)return!1;const t=yn(e);if(null===t)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===wn}function Sn(e,t){0===En(e)?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function En(e){const t=e[gn];return t?t.type_:Array.isArray(e)?1:An(e)?2:_n(e)?3:0}function Cn(e,t){return 2===En(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function kn(e,t,n){const r=En(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function An(e){return e instanceof Map}function _n(e){return e instanceof Set}function jn(e){return e.copy_||e.base_}function In(e,t){if(An(e))return new Map(e);if(_n(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=Nn(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[gn];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const a=n[r],i=t[a];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[a]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[a]})}return Object.create(yn(e),t)}{const t=yn(e);if(null!==t&&n)return(0,N.A)({},e);const r=Object.create(t);return Object.assign(r,e)}}function Tn(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Pn(e)||bn(e)||!xn(e)||(En(e)>1&&Object.defineProperties(e,{set:{value:On},add:{value:On},clear:{value:On},delete:{value:On}}),Object.freeze(e),t&&Object.values(e).forEach(e=>Tn(e,!0))),e}function On(){vn(2)}function Pn(e){return Object.isFrozen(e)}var Dn,Rn={};function Mn(e){const t=Rn[e];return t||vn(0),t}function Fn(){return Dn}function Ln(e,t){t&&(Mn("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Bn(e){Un(e),e.drafts_.forEach(Vn),e.drafts_=null}function Un(e){e===Dn&&(Dn=e.parent_)}function zn(e){return Dn={drafts_:[],parent_:Dn,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Vn(e){const t=e[gn];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function Wn(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[gn].modified_&&(Bn(t),vn(4)),xn(e)&&(e=qn(t,e),t.parent_||Gn(t,e)),t.patches_&&Mn("Patches").generateReplacementPatches_(n[gn].base_,e,t.patches_,t.inversePatches_)):e=qn(t,n,[]),Bn(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==pn?e:void 0}function qn(e,t,n){if(Pn(t))return t;const r=t[gn];if(!r)return Sn(t,(a,i)=>Hn(e,r,t,a,i,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return Gn(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const t=r.copy_;let a=t,i=!1;3===r.type_&&(a=new Set(t),t.clear(),i=!0),Sn(a,(a,o)=>Hn(e,r,t,a,o,n,i)),Gn(e,t,!1),n&&e.patches_&&Mn("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function Hn(e,t,n,r,a,i,o){if(bn(a)){const o=qn(e,a,i&&t&&3!==t.type_&&!Cn(t.assigned_,r)?i.concat(r):void 0);if(kn(n,r,o),!bn(o))return;e.canAutoFreeze_=!1}else o&&n.add(a);if(xn(a)&&!Pn(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;qn(e,a),t&&t.scope_.parent_||"symbol"===typeof r||!(An(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))||Gn(e,a)}}function Gn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Tn(t,n)}var Kn={get(e,t){if(t===gn)return e;const n=jn(e);if(!Cn(n,t))return function(e,t,n){var r;const a=Qn(t,n);return a?"value"in a?a.value:null===(r=a.get)||void 0===r?void 0:r.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!xn(r)?r:r===Yn(e.base_,t)?(Jn(e),e.copy_[t]=Zn(r,e)):r},has:(e,t)=>t in jn(e),ownKeys:e=>Reflect.ownKeys(jn(e)),set(e,t,n){const r=Qn(jn(e),t);if(null!==r&&void 0!==r&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=Yn(jn(e),t),a=null===r||void 0===r?void 0:r[gn];if(a&&a.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}(n,r)&&(void 0!==n||Cn(e.base_,t)))return!0;Jn(e),$n(e)}return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==Yn(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,Jn(e),$n(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=jn(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){vn(11)},getPrototypeOf:e=>yn(e.base_),setPrototypeOf(){vn(12)}},Xn={};function Yn(e,t){const n=e[gn];return(n?jn(n):e)[t]}function Qn(e,t){if(!(t in e))return;let n=yn(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=yn(n)}}function $n(e){e.modified_||(e.modified_=!0,e.parent_&&$n(e.parent_))}function Jn(e){e.copy_||(e.copy_=In(e.base_,e.scope_.immer_.useStrictShallowCopy_))}Sn(Kn,(e,t)=>{Xn[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Xn.deleteProperty=function(e,t){return Xn.set.call(this,e,t,void 0)},Xn.set=function(e,t,n){return Kn.set.call(this,e[0],t,n,e[0])};function Zn(e,t){const n=An(e)?Mn("MapSet").proxyMap_(e,t):_n(e)?Mn("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:Fn(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=r,i=Kn;n&&(a=[r],i=Xn);const{revoke:o,proxy:s}=Proxy.revocable(a,i);return r.draft_=s,r.revoke_=o,s}(e,t);return(t?t.scope_:Fn()).drafts_.push(n),n}function er(e){if(!xn(e)||Pn(e))return e;const t=e[gn];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=In(e,t.scope_.immer_.useStrictShallowCopy_)}else n=In(e,!0);return Sn(n,(e,t)=>{kn(n,e,er(t))}),t&&(t.finalized_=!1),n}var tr=new class{constructor(e){var t=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if("function"===typeof e&&"function"!==typeof t){const n=t;t=e;const r=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return r.produce(e,e=>t.call(this,e,...i))}}let r;if("function"!==typeof t&&vn(6),void 0!==n&&"function"!==typeof n&&vn(7),xn(e)){const a=zn(this),i=Zn(e,void 0);let o=!0;try{r=t(i),o=!1}finally{o?Bn(a):Un(a)}return Ln(a,n),Wn(r,a)}if(!e||"object"!==typeof e){if(r=t(e),void 0===r&&(r=e),r===pn&&(r=void 0),this.autoFreeze_&&Tn(r,!0),n){const t=[],a=[];Mn("Patches").generateReplacementPatches_(e,r,t,a),n(t,a)}return r}vn(1)},this.produceWithPatches=(e,n)=>{if("function"===typeof e)return function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return t.produceWithPatches(n,t=>e(t,...a))};let r,a;return[this.produce(e,n,(e,t)=>{r=e,a=t}),r,a]},"boolean"===typeof(null===e||void 0===e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){xn(e)||vn(8),bn(e)&&(e=function(e){bn(e)||vn(10);return er(e)}(e));const t=zn(this),n=Zn(e,void 0);return n[gn].isManual_=!0,Un(t),n}finishDraft(e,t){const n=e&&e[gn];n&&n.isManual_||vn(9);const{scope_:r}=n;return Ln(r,t),Wn(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=Mn("Patches").applyPatches_;return bn(e)?r(e,t):this.produce(e,e=>r(e,t))}};tr.produce;var nr={active:!1,index:null,dataKey:void 0,coordinate:void 0},rr=vt({name:"tooltip",initialState:{itemInteraction:{click:nr,hover:nr},axisInteraction:{click:nr,hover:nr},keyboardInteraction:nr,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var n=$e(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:ar,removeTooltipEntrySettings:ir,setTooltipSettingsState:or,setActiveMouseOverItemIndex:sr,mouseLeaveItem:lr,mouseLeaveChart:cr,setActiveClickItemIndex:ur,setMouseOverAxisIndex:dr,setMouseClickAxisIndex:hr,setSyncInteraction:fr,setKeyboardInteraction:pr}=rr.actions,mr=rr.reducer,gr=vt({name:"chartData",initialState:{chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},reducers:{setChartData(e,t){if(e.chartData=t.payload,null==t.payload)return e.dataStartIndex=0,void(e.dataEndIndex=0);t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:r}=t.payload;null!=n&&(e.dataStartIndex=n),null!=r&&(e.dataEndIndex=r)}}}),{setChartData:vr,setDataStartEndIndexes:yr,setComputedData:br}=gr.actions,xr=gr.reducer,wr=vt({name:"chartLayout",initialState:{layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var n,r,a,i;e.margin.top=null!==(n=t.payload.top)&&void 0!==n?n:0,e.margin.right=null!==(r=t.payload.right)&&void 0!==r?r:0,e.margin.bottom=null!==(a=t.payload.bottom)&&void 0!==a?a:0,e.margin.left=null!==(i=t.payload.left)&&void 0!==i?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:Nr,setLayout:Sr,setChartSize:Er,setScale:Cr}=wr.actions,kr=wr.reducer;function Ar(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected a function, instead received ".concat(typeof e);if("function"!==typeof e)throw new TypeError(t)}var _r=e=>Array.isArray(e)?e:[e];function jr(e){const t=Array.isArray(e[0])?e[0]:e;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected all items to be functions, instead received the following types: ";if(!e.every(e=>"function"===typeof e)){const n=e.map(e=>"function"===typeof e?"function ".concat(e.name||"unnamed","()"):typeof e).join(", ");throw new TypeError("".concat(t,"[").concat(n,"]"))}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}Symbol(),Object.getPrototypeOf({});var Ir="undefined"!==typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function Tr(){return{s:0,v:void 0,o:null,p:null}}function Or(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:r}=t;let a,i=0;function o(){let t=n;const{length:o}=arguments;for(let e=0,n=o;e<n;e++){const n=arguments[e];if("function"===typeof n||"object"===typeof n&&null!==n){let e=t.o;null===e&&(t.o=e=new WeakMap);const r=e.get(n);void 0===r?(t=Tr(),e.set(n,t)):t=r}else{let e=t.p;null===e&&(t.p=e=new Map);const r=e.get(n);void 0===r?(t=Tr(),e.set(n,t)):t=r}}const s=t;let l;if(1===t.s)l=t.v;else if(l=e.apply(null,arguments),i++,r){var c,u,d;const e=null!==(c=null===(u=a)||void 0===u||null===(d=u.deref)||void 0===d?void 0:d.call(u))&&void 0!==c?c:a;null!=e&&r(e,l)&&(l=e,0!==i&&i--);a="object"===typeof l&&null!==l||"function"===typeof l?new Ir(l):l}return s.s=1,s.v=l,l}return o.clearCache=()=>{n={s:0,v:void 0,o:null,p:null},o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function Pr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a="function"===typeof e?{memoize:e,memoizeOptions:n}:e,i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let r,i=0,o=0,s={},l=t.pop();"object"===typeof l&&(s=l,l=t.pop()),Ar(l,"createSelector expects an output function after the inputs, but received: [".concat(typeof l,"]"));const c=(0,N.A)((0,N.A)({},a),s),{memoize:u,memoizeOptions:d=[],argsMemoize:h=Or,argsMemoizeOptions:f=[],devModeChecks:p={}}=c,m=_r(d),g=_r(f),v=jr(t),y=u(function(){return i++,l.apply(null,arguments)},...m);const b=h(function(){o++;const e=function(e,t){const n=[],{length:r}=e;for(let a=0;a<r;a++)n.push(e[a].apply(null,t));return n}(v,arguments);return r=y.apply(null,e),r},...g);return Object.assign(b,{resultFunc:l,memoizedResultFunc:y,dependencies:v,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>r,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:u,argsMemoize:h})};return Object.assign(i,{withTypes:()=>i}),i}var Dr=Pr(Or),Rr=Object.assign(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dr;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected an object, instead received ".concat(typeof e);if("object"!==typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ".concat(typeof e));const n=Object.keys(e),r=t(n.map(t=>e[t]),function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((e,t,r)=>(e[n[r]]=t,e),{})});return r},{withTypes:()=>Rr}),Mr=n(8443),Fr=(0,a.createContext)(null),Lr=e=>e,Br=()=>{var e=(0,a.useContext)(Fr);return e?e.store.dispatch:Lr},Ur=()=>{},zr=()=>Ur,Vr=(e,t)=>e===t;function Wr(e){var t=(0,a.useContext)(Fr);return(0,Mr.useSyncExternalStoreWithSelector)(t?t.subscription.addNestedSub:zr,t?t.store.getState:Ur,t?t.store.getState:Ur,t?e:Ur,Vr)}var qr=n(3821),Hr=n.n(qr),Gr=e=>e.legend.settings;Dr([e=>e.legend.payload,Gr],(e,t)=>{var{itemSorter:n}=t,r=e.flat(1);return n?Hr()(r,n):r});function Kr(e,t){if((a=e.length)>1)for(var n,r,a,i=1,o=e[t[0]],s=o.length;i<a;++i)for(r=o,o=e[t[i]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}Array.prototype.slice;function Xr(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function Yr(e){return function(){return e}}function Qr(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function $r(e,t){return e[t]}function Jr(e){const t=[];return t.key=e,t}function Zr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ea(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zr(Object(n),!0).forEach(function(t){ta(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ta(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var na=Math.PI/180,ra=e=>180*e/Math.PI,aa=(e,t,n,r)=>({x:e+Math.cos(-na*r)*n,y:t+Math.sin(-na*r)*n}),ia=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(t-(n.top||0)-(n.bottom||0)))/2},oa=(e,t)=>{var{x:n,y:r}=e,{cx:a,cy:i}=t,o=((e,t)=>{var{x:n,y:r}=e,{x:a,y:i}=t;return Math.sqrt((n-a)**2+(r-i)**2)})({x:n,y:r},{x:a,y:i});if(o<=0)return{radius:o,angle:0};var s=(n-a)/o,l=Math.acos(s);return r>i&&(l=2*Math.PI-l),{radius:o,angle:ra(l),angleInRadian:l}},sa=(e,t)=>{var{startAngle:n,endAngle:r}=t,a=Math.floor(n/360),i=Math.floor(r/360);return e+360*Math.min(a,i)},la=(e,t)=>{var{x:n,y:r}=e,{radius:a,angle:i}=oa({x:n,y:r},t),{innerRadius:o,outerRadius:s}=t;if(a<o||a>s)return null;if(0===a)return null;var l,{startAngle:c,endAngle:u}=(e=>{var{startAngle:t,endAngle:n}=e,r=Math.floor(t/360),a=Math.floor(n/360),i=Math.min(r,a);return{startAngle:t-360*i,endAngle:n-360*i}})(t),d=i;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;l=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;l=d>=u&&d<=c}return l?ea(ea({},t),{},{radius:a,angle:sa(d,t)}):null};function ca(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function ua(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function da(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ua(Object(n),!0).forEach(function(t){ha(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ua(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ha(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fa(e,t,n){return q(e)||q(t)?n:L(t)?P()(e,t,n):"function"===typeof t?t(e):n}var pa=(e,t)=>"horizontal"===e&&"xAxis"===t||"vertical"===e&&"yAxis"===t||"centric"===e&&"angleAxis"===t||"radial"===e&&"radiusAxis"===t,ma=(e,t,n,r)=>{if(r)return e.map(e=>e.coordinate);var a,i,o=e.map(e=>(e.coordinate===t&&(a=!0),e.coordinate===n&&(i=!0),e.coordinate));return a||o.push(t),i||o.push(n),o},ga=(e,t,n)=>{if(!e)return null;var{duplicateDomain:r,type:a,range:i,scale:o,realScaleType:s,isCategorical:l,categoricalDomain:c,tickCount:u,ticks:d,niceTicks:h,axisType:f}=e;if(!o)return null;var p="scaleBand"===s&&o.bandwidth?o.bandwidth()/2:2,m=(t||n)&&"category"===a&&o.bandwidth?o.bandwidth()/p:0;return m="angleAxis"===f&&i&&i.length>=2?2*D(i[0]-i[1])*m:m,t&&(d||h)?(d||h||[]).map((e,t)=>{var n=r?r.indexOf(e):e;return{coordinate:o(n)+m,value:e,offset:m,index:t}}).filter(e=>!R(e.coordinate)):l&&c?c.map((e,t)=>({coordinate:o(e)+m,value:e,index:t,offset:m})):o.ticks&&!n&&null!=u?o.ticks(u).map((e,t)=>({coordinate:o(e)+m,value:e,offset:m,index:t})):o.domain().map((e,t)=>({coordinate:o(e)+m,value:r?r[e]:e,index:t,offset:m}))},va=1e-4,ya={sign:e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,i=0,o=0;o<t;++o){var s=R(e[o][n][1])?e[o][n][0]:e[o][n][1];s>=0?(e[o][n][0]=a,e[o][n][1]=a+s,a=e[o][n][1]):(e[o][n][0]=i,e[o][n][1]=i+s,i=e[o][n][1])}},expand:function(e,t){if((r=e.length)>0){for(var n,r,a,i=0,o=e[0].length;i<o;++i){for(a=n=0;n<r;++n)a+=e[n][i][1]||0;if(a)for(n=0;n<r;++n)e[n][i][1]/=a}Kr(e,t)}},none:Kr,silhouette:function(e,t){if((n=e.length)>0){for(var n,r=0,a=e[t[0]],i=a.length;r<i;++r){for(var o=0,s=0;o<n;++o)s+=e[o][r][1]||0;a[r][1]+=a[r][0]=-s/2}Kr(e,t)}},wiggle:function(e,t){if((a=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,a,i=0,o=1;o<r;++o){for(var s=0,l=0,c=0;s<a;++s){for(var u=e[t[s]],d=u[o][1]||0,h=(d-(u[o-1][1]||0))/2,f=0;f<s;++f){var p=e[t[f]];h+=(p[o][1]||0)-(p[o-1][1]||0)}l+=d,c+=h*d}n[o-1][1]+=n[o-1][0]=i,l&&(i-=c/l)}n[o-1][1]+=n[o-1][0]=i,Kr(e,t)}},positive:e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,i=0;i<t;++i){var o=R(e[i][n][1])?e[i][n][0]:e[i][n][1];o>=0?(e[i][n][0]=a,e[i][n][1]=a+o,a=e[i][n][1]):(e[i][n][0]=0,e[i][n][1]=0)}}},ba=(e,t,n)=>{var r=ya[n],a=function(){var e=Yr([]),t=Qr,n=Kr,r=$r;function a(a){var i,o,s=Array.from(e.apply(this,arguments),Jr),l=s.length,c=-1;for(const e of a)for(i=0,++c;i<l;++i)(s[i][c]=[0,+r(e,s[i].key,c,a)]).data=e;for(i=0,o=Xr(t(s));i<l;++i)s[o[i]].index=i;return n(s,o),s}return a.keys=function(t){return arguments.length?(e="function"===typeof t?t:Yr(Array.from(t)),a):e},a.value=function(e){return arguments.length?(r="function"===typeof e?e:Yr(+e),a):r},a.order=function(e){return arguments.length?(t=null==e?Qr:"function"===typeof e?e:Yr(Array.from(e)),a):t},a.offset=function(e){return arguments.length?(n=null==e?Kr:e,a):n},a}().keys(t).value((e,t)=>+fa(e,t,0)).order(Qr).offset(r);return a(e)};var xa=e=>{var{axis:t,ticks:n,offset:r,bandSize:a,entry:i,index:o}=e;if("category"===t.type)return n[o]?n[o].coordinate+r:null;var s=fa(i,t.dataKey,t.scale.domain()[o]);return q(s)?null:t.scale(s)-a/2+r},wa=(e,t,n)=>{var r;if(null!=e)return r=Object.keys(e).reduce((r,a)=>{var i=e[a],{stackedData:o}=i,s=o.reduce((e,r)=>{var a=(e=>{var t=e.flat(2).filter(F);return[Math.min(...t),Math.max(...t)]})(ca(r,t,n));return[Math.min(e[0],a[0]),Math.max(e[1],a[1])]},[1/0,-1/0]);return[Math.min(s[0],r[0]),Math.max(s[1],r[1])]},[1/0,-1/0]),[r[0]===1/0?0:r[0],r[1]===-1/0?0:r[1]]},Na=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Sa=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ea=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=Hr()(t,e=>e.coordinate),i=1/0,o=1,s=a.length;o<s;o++){var l=a[o],c=a[o-1];i=Math.min((l.coordinate||0)-(c.coordinate||0),i)}return i===1/0?0:i}return n?void 0:0};function Ca(e){var{tooltipEntrySettings:t,dataKey:n,payload:r,value:a,name:i}=e;return da(da({},t),{},{dataKey:n,payload:r,value:a,name:i})}function ka(e,t){return e?String(e):"string"===typeof t?t:void 0}var Aa=e=>e.layout.width,_a=e=>e.layout.height,ja=e=>e.layout.scale,Ia=e=>e.layout.margin,Ta=Dr(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Oa=Dr(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),Pa="data-recharts-item-index",Da="data-recharts-item-data-key";function Ra(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ma(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ra(Object(n),!0).forEach(function(t){Fa(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ra(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Fa(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var La=Dr([Aa,_a,Ia,e=>e.brush.height,function(e){return Oa(e).reduce((e,t)=>"left"!==t.orientation||t.mirror||t.hide?e:e+("number"===typeof t.width?t.width:60),0)},function(e){return Oa(e).reduce((e,t)=>"right"!==t.orientation||t.mirror||t.hide?e:e+("number"===typeof t.width?t.width:60),0)},function(e){return Ta(e).reduce((e,t)=>"top"!==t.orientation||t.mirror||t.hide?e:e+t.height,0)},function(e){return Ta(e).reduce((e,t)=>"bottom"!==t.orientation||t.mirror||t.hide?e:e+t.height,0)},Gr,e=>e.legend.size],(e,t,n,r,a,i,o,s,l,c)=>{var u={left:(n.left||0)+a,right:(n.right||0)+i},d=Ma(Ma({},{top:(n.top||0)+o,bottom:(n.bottom||0)+s}),u),h=d.bottom;d.bottom+=r,d=((e,t,n)=>{if(t&&n){var{width:r,height:a}=n,{align:i,verticalAlign:o,layout:s}=t;if(("vertical"===s||"horizontal"===s&&"middle"===o)&&"center"!==i&&F(e[i]))return da(da({},e),{},{[i]:e[i]+(r||0)});if(("horizontal"===s||"vertical"===s&&"center"===i)&&"middle"!==o&&F(e[o]))return da(da({},e),{},{[o]:e[o]+(a||0)})}return e})(d,l,c);var f=e-d.left-d.right,p=t-d.top-d.bottom;return Ma(Ma({brushBottom:h},d),{},{width:Math.max(f,0),height:Math.max(p,0)})}),Ba=Dr(La,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Ua=Dr(Aa,_a,(e,t)=>({x:0,y:0,width:e,height:t})),za=(0,a.createContext)(null),Va=()=>null!=(0,a.useContext)(za),Wa=e=>e.brush,qa=Dr([Wa,La,Ia],(e,t,n)=>({height:e.height,x:F(e.x)?e.x:t.left,y:F(e.y)?e.y:t.top+t.height+t.brushBottom-((null===n||void 0===n?void 0:n.bottom)||0),width:F(e.width)?e.width:t.width})),Ha=()=>{var e,t=Va(),n=Wr(Ba),r=Wr(qa),a=null===(e=Wr(Wa))||void 0===e?void 0:e.padding;return t&&r&&a?{width:r.width-a.left-a.right,height:r.height-a.top-a.bottom,x:a.left,y:a.top}:n},Ga={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Ka=()=>{var e;return null!==(e=Wr(La))&&void 0!==e?e:Ga},Xa=()=>Wr(Aa),Ya=()=>Wr(_a),Qa=e=>e.layout.layoutType,$a=()=>Wr(Qa),Ja=n(9859),Za=n.n(Ja);function ei(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function ti(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}class ni extends Map{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oi;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(ri(this,e))}has(e){return super.has(ri(this,e))}set(e,t){return super.set(ai(this,e),t)}delete(e){return super.delete(ii(this,e))}}Set;function ri(e,t){let{_intern:n,_key:r}=e;const a=r(t);return n.has(a)?n.get(a):t}function ai(e,t){let{_intern:n,_key:r}=e;const a=r(t);return n.has(a)?n.get(a):(n.set(a,t),t)}function ii(e,t){let{_intern:n,_key:r}=e;const a=r(t);return n.has(a)&&(t=n.get(a),n.delete(a)),t}function oi(e){return null!==e&&"object"===typeof e?e.valueOf():e}const si=Symbol("implicit");function li(){var e=new ni,t=[],n=[],r=si;function a(a){let i=e.get(a);if(void 0===i){if(r!==si)return r;e.set(a,i=t.push(a)-1)}return n[i%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new ni;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return li(t,n).unknown(r)},ei.apply(a,arguments),a}function ci(){var e,t,n=li().unknown(void 0),r=n.domain,a=n.range,i=0,o=1,s=!1,l=0,c=0,u=.5;function d(){var n=r().length,d=o<i,h=d?o:i,f=d?i:o;e=(f-h)/Math.max(1,n-l+2*c),s&&(e=Math.floor(e)),h+=(f-h-e*(n-l))*u,t=e*(1-l),s&&(h=Math.round(h),t=Math.round(t));var p=function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i}(n).map(function(t){return h+e*t});return a(d?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),d()):r()},n.range=function(e){return arguments.length?([i,o]=e,i=+i,o=+o,d()):[i,o]},n.rangeRound=function(e){return[i,o]=e,i=+i,o=+o,s=!0,d()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(s=!!e,d()):s},n.padding=function(e){return arguments.length?(l=Math.min(1,c=+e),d()):l},n.paddingInner=function(e){return arguments.length?(l=Math.min(1,e),d()):l},n.paddingOuter=function(e){return arguments.length?(c=+e,d()):c},n.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),d()):u},n.copy=function(){return ci(r(),[i,o]).round(s).paddingInner(l).paddingOuter(c).align(u)},ei.apply(d(),arguments)}function ui(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return ui(t())},e}function di(){return ui(ci.apply(null,arguments).paddingInner(1))}const hi=Math.sqrt(50),fi=Math.sqrt(10),pi=Math.sqrt(2);function mi(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),i=r/Math.pow(10,a),o=i>=hi?10:i>=fi?5:i>=pi?2:1;let s,l,c;return a<0?(c=Math.pow(10,-a)/o,s=Math.round(e*c),l=Math.round(t*c),s/c<e&&++s,l/c>t&&--l,c=-c):(c=Math.pow(10,a)*o,s=Math.round(e/c),l=Math.round(t/c),s*c<e&&++s,l*c>t&&--l),l<s&&.5<=n&&n<2?mi(e,t,2*n):[s,l,c]}function gi(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[a,i,o]=r?mi(t,e,n):mi(e,t,n);if(!(i>=a))return[];const s=i-a+1,l=new Array(s);if(r)if(o<0)for(let c=0;c<s;++c)l[c]=(i-c)/-o;else for(let c=0;c<s;++c)l[c]=(i-c)*o;else if(o<0)for(let c=0;c<s;++c)l[c]=(a+c)/-o;else for(let c=0;c<s;++c)l[c]=(a+c)*o;return l}function vi(e,t,n){return mi(e=+e,t=+t,n=+n)[2]}function yi(e,t,n){n=+n;const r=(t=+t)<(e=+e),a=r?vi(t,e,n):vi(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function bi(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function xi(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function wi(e){let t,n,r;function a(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{const t=a+i>>>1;n(e[t],r)<0?a=t+1:i=t}while(a<i)}return a}return 2!==e.length?(t=bi,n=(t,n)=>bi(e(t),n),r=(t,n)=>e(t)-n):(t=e===bi||e===xi?e:Ni,n=e,r=e),{left:a,center:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=a(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return i>n&&r(e[i-1],t)>-r(e[i],t)?i-1:i},right:function(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{const t=a+i>>>1;n(e[t],r)<=0?a=t+1:i=t}while(a<i)}return a}}}function Ni(){return 0}function Si(e){return null===e?NaN:+e}const Ei=wi(bi),Ci=Ei.right,ki=(Ei.left,wi(Si).center,Ci);function Ai(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function _i(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ji(){}var Ii=.7,Ti=1/Ii,Oi="\\s*([+-]?\\d+)\\s*",Pi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Di="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ri=/^#([0-9a-f]{3,8})$/,Mi=new RegExp("^rgb\\(".concat(Oi,",").concat(Oi,",").concat(Oi,"\\)$")),Fi=new RegExp("^rgb\\(".concat(Di,",").concat(Di,",").concat(Di,"\\)$")),Li=new RegExp("^rgba\\(".concat(Oi,",").concat(Oi,",").concat(Oi,",").concat(Pi,"\\)$")),Bi=new RegExp("^rgba\\(".concat(Di,",").concat(Di,",").concat(Di,",").concat(Pi,"\\)$")),Ui=new RegExp("^hsl\\(".concat(Pi,",").concat(Di,",").concat(Di,"\\)$")),zi=new RegExp("^hsla\\(".concat(Pi,",").concat(Di,",").concat(Di,",").concat(Pi,"\\)$")),Vi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Wi(){return this.rgb().formatHex()}function qi(){return this.rgb().formatRgb()}function Hi(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Ri.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Gi(t):3===n?new Yi(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Ki(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Ki(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Mi.exec(e))?new Yi(t[1],t[2],t[3],1):(t=Fi.exec(e))?new Yi(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Li.exec(e))?Ki(t[1],t[2],t[3],t[4]):(t=Bi.exec(e))?Ki(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Ui.exec(e))?to(t[1],t[2]/100,t[3]/100,1):(t=zi.exec(e))?to(t[1],t[2]/100,t[3]/100,t[4]):Vi.hasOwnProperty(e)?Gi(Vi[e]):"transparent"===e?new Yi(NaN,NaN,NaN,0):null}function Gi(e){return new Yi(e>>16&255,e>>8&255,255&e,1)}function Ki(e,t,n,r){return r<=0&&(e=t=n=NaN),new Yi(e,t,n,r)}function Xi(e,t,n,r){return 1===arguments.length?((a=e)instanceof ji||(a=Hi(a)),a?new Yi((a=a.rgb()).r,a.g,a.b,a.opacity):new Yi):new Yi(e,t,n,null==r?1:r);var a}function Yi(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Qi(){return"#".concat(eo(this.r)).concat(eo(this.g)).concat(eo(this.b))}function $i(){const e=Ji(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(Zi(this.r),", ").concat(Zi(this.g),", ").concat(Zi(this.b)).concat(1===e?")":", ".concat(e,")"))}function Ji(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Zi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function eo(e){return((e=Zi(e))<16?"0":"")+e.toString(16)}function to(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ro(e,t,n,r)}function no(e){if(e instanceof ro)return new ro(e.h,e.s,e.l,e.opacity);if(e instanceof ji||(e=Hi(e)),!e)return new ro;if(e instanceof ro)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,s=i-a,l=(i+a)/2;return s?(o=t===i?(n-r)/s+6*(n<r):n===i?(r-t)/s+2:(t-n)/s+4,s/=l<.5?i+a:2-i-a,o*=60):s=l>0&&l<1?0:o,new ro(o,s,l,e.opacity)}function ro(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function ao(e){return(e=(e||0)%360)<0?e+360:e}function io(e){return Math.max(0,Math.min(1,e||0))}function oo(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function so(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}Ai(ji,Hi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Wi,formatHex:Wi,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return no(this).formatHsl()},formatRgb:qi,toString:qi}),Ai(Yi,Xi,_i(ji,{brighter(e){return e=null==e?Ti:Math.pow(Ti,e),new Yi(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Ii:Math.pow(Ii,e),new Yi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Yi(Zi(this.r),Zi(this.g),Zi(this.b),Ji(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qi,formatHex:Qi,formatHex8:function(){return"#".concat(eo(this.r)).concat(eo(this.g)).concat(eo(this.b)).concat(eo(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:$i,toString:$i})),Ai(ro,function(e,t,n,r){return 1===arguments.length?no(e):new ro(e,t,n,null==r?1:r)},_i(ji,{brighter(e){return e=null==e?Ti:Math.pow(Ti,e),new ro(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Ii:Math.pow(Ii,e),new ro(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new Yi(oo(e>=240?e-240:e+120,a,r),oo(e,a,r),oo(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new ro(ao(this.h),io(this.s),io(this.l),Ji(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ji(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(ao(this.h),", ").concat(100*io(this.s),"%, ").concat(100*io(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const lo=e=>()=>e;function co(e,t){return function(n){return e+n*t}}function uo(e){return 1===(e=+e)?ho:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):lo(isNaN(t)?n:t)}}function ho(e,t){var n=t-e;return n?co(e,n):lo(isNaN(e)?t:e)}const fo=function e(t){var n=uo(t);function r(e,t){var r=n((e=Xi(e)).r,(t=Xi(t)).r),a=n(e.g,t.g),i=n(e.b,t.b),o=ho(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=i(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function po(e){return function(t){var n,r,a=t.length,i=new Array(a),o=new Array(a),s=new Array(a);for(n=0;n<a;++n)r=Xi(t[n]),i[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return i=e(i),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=i(e),r.g=o(e),r.b=s(e),r+""}}}po(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],i=e[r+1],o=r>0?e[r-1]:2*a-i,s=r<t-1?e[r+2]:2*i-a;return so((n-r/t)*t,o,a,i,s)}}),po(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],i=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return so((n-r/t)*t,a,i,o,s)}});function mo(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=So(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=i[n](e);return o}}function go(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function vo(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function yo(e,t){var n,r={},a={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=So(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}var bo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xo=new RegExp(bo.source,"g");function wo(e,t){var n,r,a,i=bo.lastIndex=xo.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(n=bo.exec(e))&&(r=xo.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,l.push({i:o,x:vo(n,r)})),i=xo.lastIndex;return i<t.length&&(a=t.slice(i),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function No(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function So(e,t){var n,r=typeof t;return null==t||"boolean"===r?lo(t):("number"===r?vo:"string"===r?(n=Hi(t))?(t=n,fo):wo:t instanceof Hi?fo:t instanceof Date?go:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?No:Array.isArray(t)?mo:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?yo:vo)(e,t)}function Eo(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Co(e){return+e}var ko=[0,1];function Ao(e){return e}function _o(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function jo(e,t,n){var r=e[0],a=e[1],i=t[0],o=t[1];return a<r?(r=_o(a,r),i=n(o,i)):(r=_o(r,a),i=n(i,o)),function(e){return i(r(e))}}function Io(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),i=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)a[o]=_o(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(t){var n=ki(e,t,1,r)-1;return i[n](a[n](t))}}function To(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Oo(){var e,t,n,r,a,i,o=ko,s=ko,l=So,c=Ao;function u(){var e=Math.min(o.length,s.length);return c!==Ao&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?Io:jo,a=i=null,d}function d(t){return null==t||isNaN(t=+t)?n:(a||(a=r(o.map(e),s,l)))(e(c(t)))}return d.invert=function(n){return c(t((i||(i=r(s,o.map(e),vo)))(n)))},d.domain=function(e){return arguments.length?(o=Array.from(e,Co),u()):o.slice()},d.range=function(e){return arguments.length?(s=Array.from(e),u()):s.slice()},d.rangeRound=function(e){return s=Array.from(e),l=Eo,u()},d.clamp=function(e){return arguments.length?(c=!!e||Ao,u()):c!==Ao},d.interpolate=function(e){return arguments.length?(l=e,u()):l},d.unknown=function(e){return arguments.length?(n=e,d):n},function(n,r){return e=n,t=r,u()}}function Po(){return Oo()(Ao,Ao)}var Do,Ro=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Mo(e){if(!(t=Ro.exec(e)))throw new Error("invalid format: "+e);var t;return new Fo({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Fo(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Lo(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Bo(e){return(e=Lo(Math.abs(e)))?e[1]:NaN}function Uo(e,t){var n=Lo(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}Mo.prototype=Fo.prototype,Fo.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const zo={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Uo(100*e,t),r:Uo,s:function(e,t){var n=Lo(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(Do=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+Lo(e,Math.max(0,t+i-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Vo(e){return e}var Wo,qo,Ho,Go=Array.prototype.map,Ko=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Xo(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Vo:(t=Go.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,i=[],o=0,s=t[0],l=0;a>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),i.push(e.substring(a-=s,a+s)),!((l+=s+1)>r));)s=t[o=(o+1)%t.length];return i.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?Vo:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(Go.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function d(e){var t=(e=Mo(e)).fill,n=e.align,d=e.sign,h=e.symbol,f=e.zero,p=e.width,m=e.comma,g=e.precision,v=e.trim,y=e.type;"n"===y?(m=!0,y="g"):zo[y]||(void 0===g&&(g=12),v=!0,y="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var b="$"===h?a:"#"===h&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===h?i:/[%p]/.test(y)?l:"",w=zo[y],N=/[defgprs%]/.test(y);function S(e){var a,i,l,h=b,S=x;if("c"===y)S=w(e)+S,e="";else{var E=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:w(Math.abs(e),g),v&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),E&&0===+e&&"+"!==d&&(E=!1),h=(E?"("===d?d:c:"-"===d||"("===d?"":d)+h,S=("s"===y?Ko[8+Do/3]:"")+S+(E&&"("===d?")":""),N)for(a=-1,i=e.length;++a<i;)if(48>(l=e.charCodeAt(a))||l>57){S=(46===l?o+e.slice(a+1):e.slice(a))+S,e=e.slice(0,a);break}}m&&!f&&(e=r(e,1/0));var C=h.length+e.length+S.length,k=C<p?new Array(p-C+1).join(t):"";switch(m&&f&&(e=r(k+e,k.length?p-S.length:1/0),k=""),n){case"<":e=h+e+S+k;break;case"=":e=h+k+e+S;break;case"^":e=k.slice(0,C=k.length>>1)+h+e+S+k.slice(C);break;default:e=k+h+e+S}return s(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return e+""},S}return{format:d,formatPrefix:function(e,t){var n=d(((e=Mo(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Bo(t)/3))),a=Math.pow(10,-r),i=Ko[8+r/3];return function(e){return n(a*e)+i}}}}function Yo(e,t,n,r){var a,i=yi(e,t,n);switch((r=Mo(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Bo(t)/3)))-Bo(Math.abs(e)))}(i,o))||(r.precision=a),Ho(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Bo(t)-Bo(e))+1}(i,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=function(e){return Math.max(0,-Bo(Math.abs(e)))}(i))||(r.precision=a-2*("%"===r.type))}return qo(r)}function Qo(e){var t=e.domain;return e.ticks=function(e){var n=t();return gi(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Yo(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,i=t(),o=0,s=i.length-1,l=i[o],c=i[s],u=10;for(c<l&&(a=l,l=c,c=a,a=o,o=s,s=a);u-- >0;){if((a=vi(l,c,n))===r)return i[o]=l,i[s]=c,t(i);if(a>0)l=Math.floor(l/a)*a,c=Math.ceil(c/a)*a;else{if(!(a<0))break;l=Math.ceil(l*a)/a,c=Math.floor(c*a)/a}r=a}return e},e}function $o(){var e=Po();return e.copy=function(){return To(e,$o())},ei.apply(e,arguments),Qo(e)}function Jo(e){var t;function n(e){return null==e||isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,Co),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return Jo(e).unknown(t)},e=arguments.length?Array.from(e,Co):[0,1],Qo(n)}function Zo(e,t){var n,r=0,a=(e=e.slice()).length-1,i=e[r],o=e[a];return o<i&&(n=r,r=a,a=n,n=i,i=o,o=n),e[r]=t.floor(i),e[a]=t.ceil(o),e}function es(e){return Math.log(e)}function ts(e){return Math.exp(e)}function ns(e){return-Math.log(-e)}function rs(e){return-Math.exp(-e)}function as(e){return isFinite(e)?+("1e"+e):e<0?0:e}function is(e){return(t,n)=>-e(-t,n)}function os(e){const t=e(es,ts),n=t.domain;let r,a,i=10;function o(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(i),a=function(e){return 10===e?as:e===Math.E?Math.exp:t=>Math.pow(e,t)}(i),n()[0]<0?(r=is(r),a=is(a),e(ns,rs)):e(es,ts),t}return t.base=function(e){return arguments.length?(i=+e,o()):i},t.domain=function(e){return arguments.length?(n(e),o()):n()},t.ticks=e=>{const t=n();let o=t[0],s=t[t.length-1];const l=s<o;l&&([o,s]=[s,o]);let c,u,d=r(o),h=r(s);const f=null==e?10:+e;let p=[];if(!(i%1)&&h-d<f){if(d=Math.floor(d),h=Math.ceil(h),o>0){for(;d<=h;++d)for(c=1;c<i;++c)if(u=d<0?c/a(-d):c*a(d),!(u<o)){if(u>s)break;p.push(u)}}else for(;d<=h;++d)for(c=i-1;c>=1;--c)if(u=d>0?c/a(-d):c*a(d),!(u<o)){if(u>s)break;p.push(u)}2*p.length<f&&(p=gi(o,s,f))}else p=gi(d,h,Math.min(h-d,f)).map(a);return l?p.reverse():p},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===i?"s":","),"function"!==typeof n&&(i%1||null!=(n=Mo(n)).precision||(n.trim=!0),n=qo(n)),e===1/0)return n;const o=Math.max(1,i*e/t.ticks().length);return e=>{let t=e/a(Math.round(r(e)));return t*i<i-.5&&(t*=i),t<=o?n(e):""}},t.nice=()=>n(Zo(n(),{floor:e=>a(Math.floor(r(e))),ceil:e=>a(Math.ceil(r(e)))})),t}function ss(){const e=os(Oo()).domain([1,10]);return e.copy=()=>To(e,ss()).base(e.base()),ei.apply(e,arguments),e}function ls(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function cs(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function us(e){var t=1,n=e(ls(t),cs(t));return n.constant=function(n){return arguments.length?e(ls(t=+n),cs(t)):t},Qo(n)}function ds(){var e=us(Oo());return e.copy=function(){return To(e,ds()).constant(e.constant())},ei.apply(e,arguments)}function hs(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function fs(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ps(e){return e<0?-e*e:e*e}function ms(e){var t=e(Ao,Ao),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(Ao,Ao):.5===n?e(fs,ps):e(hs(n),hs(1/n)):n},Qo(t)}function gs(){var e=ms(Oo());return e.copy=function(){return To(e,gs()).exponent(e.exponent())},ei.apply(e,arguments),e}function vs(){return gs.apply(null,arguments).exponent(.5)}function ys(e){return Math.sign(e)*e*e}function bs(){var e,t=Po(),n=[0,1],r=!1;function a(n){var a=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(t(n));return isNaN(a)?e:r?Math.round(a):a}return a.invert=function(e){return t.invert(ys(e))},a.domain=function(e){return arguments.length?(t.domain(e),a):t.domain()},a.range=function(e){return arguments.length?(t.range((n=Array.from(e,Co)).map(ys)),a):n.slice()},a.rangeRound=function(e){return a.range(e).round(!0)},a.round=function(e){return arguments.length?(r=!!e,a):r},a.clamp=function(e){return arguments.length?(t.clamp(e),a):t.clamp()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return bs(t.domain(),n).round(r).clamp(t.clamp()).unknown(e)},ei.apply(a,arguments),Qo(a)}function xs(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n<a||void 0===n&&a>=a)&&(n=a)}return n}function ws(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n>a||void 0===n&&a>=a)&&(n=a)}return n}function Ns(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bi;if(e===bi)return Ss;if("function"!==typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}function Ss(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function Es(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,a=arguments.length>4?arguments[4]:void 0;if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=void 0===a?Ss:Ns(a);r>n;){if(r-n>600){const i=r-n+1,o=t-n+1,s=Math.log(i),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(i-l)/i)*(o-i/2<0?-1:1);Es(e,t,Math.max(n,Math.floor(t-o*l/i+c)),Math.min(r,Math.floor(t+(i-o)*l/i+c)),a)}const i=e[t];let o=n,s=r;for(Cs(e,n,t),a(e[r],i)>0&&Cs(e,n,r);o<s;){for(Cs(e,o,s),++o,--s;a(e[o],i)<0;)++o;for(;a(e[s],i)>0;)--s}0===a(e[n],i)?Cs(e,n,s):(++s,Cs(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function Cs(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function ks(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n)),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return ws(e);if(t>=1)return xs(e);var r,a=(r-1)*t,i=Math.floor(a),o=xs(Es(e,i).subarray(0,i+1));return o+(ws(e.subarray(i+1))-o)*(a-i)}}function As(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Si;if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,i=Math.floor(a),o=+n(e[i],i,e);return o+(+n(e[i+1],i+1,e)-o)*(a-i)}}function _s(){var e,t=[],n=[],r=[];function a(){var e=0,a=Math.max(1,n.length);for(r=new Array(a-1);++e<a;)r[e-1]=As(t,e/a);return i}function i(t){return null==t||isNaN(t=+t)?e:n[ki(r,t)]}return i.invertExtent=function(e){var a=n.indexOf(e);return a<0?[NaN,NaN]:[a>0?r[a-1]:t[0],a<r.length?r[a]:t[t.length-1]]},i.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)null==n||isNaN(n=+n)||t.push(n);return t.sort(bi),a()},i.range=function(e){return arguments.length?(n=Array.from(e),a()):n.slice()},i.unknown=function(t){return arguments.length?(e=t,i):e},i.quantiles=function(){return r.slice()},i.copy=function(){return _s().domain(t).range(n).unknown(e)},ei.apply(i,arguments)}function js(){var e,t=0,n=1,r=1,a=[.5],i=[0,1];function o(t){return null!=t&&t<=t?i[ki(a,t,0,r)]:e}function s(){var e=-1;for(a=new Array(r);++e<r;)a[e]=((e+1)*n-(e-r)*t)/(r+1);return o}return o.domain=function(e){return arguments.length?([t,n]=e,t=+t,n=+n,s()):[t,n]},o.range=function(e){return arguments.length?(r=(i=Array.from(e)).length-1,s()):i.slice()},o.invertExtent=function(e){var o=i.indexOf(e);return o<0?[NaN,NaN]:o<1?[t,a[0]]:o>=r?[a[r-1],n]:[a[o-1],a[o]]},o.unknown=function(t){return arguments.length?(e=t,o):o},o.thresholds=function(){return a.slice()},o.copy=function(){return js().domain([t,n]).range(i).unknown(e)},ei.apply(Qo(o),arguments)}function Is(){var e,t=[.5],n=[0,1],r=1;function a(a){return null!=a&&a<=a?n[ki(t,a,0,r)]:e}return a.domain=function(e){return arguments.length?(t=Array.from(e),r=Math.min(t.length,n.length-1),a):t.slice()},a.range=function(e){return arguments.length?(n=Array.from(e),r=Math.min(t.length,n.length-1),a):n.slice()},a.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return Is().domain(t).range(n).unknown(e)},ei.apply(a,arguments)}Wo=Xo({thousands:",",grouping:[3],currency:["$",""]}),qo=Wo.format,Ho=Wo.formatPrefix;const Ts=1e3,Os=6e4,Ps=36e5,Ds=864e5,Rs=6048e5,Ms=2592e6,Fs=31536e6,Ls=new Date,Bs=new Date;function Us(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=t=>(e(t=new Date(+t)),t),a.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),a.round=e=>{const t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),a.range=(n,r,i)=>{const o=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return o;let s;do{o.push(s=new Date(+n)),t(n,i),e(n)}while(s<n&&n<r);return o},a.filter=n=>Us(t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},(e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}),n&&(a.count=(t,r)=>(Ls.setTime(+t),Bs.setTime(+r),e(Ls),e(Bs),Math.floor(n(Ls,Bs))),a.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?t=>r(t)%e===0:t=>a.count(0,t)%e===0):a:null)),a}const zs=Us(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);zs.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?Us(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):zs:null);zs.range;const Vs=Us(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ts)},(e,t)=>(t-e)/Ts,e=>e.getUTCSeconds()),Ws=(Vs.range,Us(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ts)},(e,t)=>{e.setTime(+e+t*Os)},(e,t)=>(t-e)/Os,e=>e.getMinutes())),qs=(Ws.range,Us(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Os)},(e,t)=>(t-e)/Os,e=>e.getUTCMinutes())),Hs=(qs.range,Us(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ts-e.getMinutes()*Os)},(e,t)=>{e.setTime(+e+t*Ps)},(e,t)=>(t-e)/Ps,e=>e.getHours())),Gs=(Hs.range,Us(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Ps)},(e,t)=>(t-e)/Ps,e=>e.getUTCHours())),Ks=(Gs.range,Us(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Os)/Ds,e=>e.getDate()-1)),Xs=(Ks.range,Us(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ds,e=>e.getUTCDate()-1)),Ys=(Xs.range,Us(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ds,e=>Math.floor(e/Ds)));Ys.range;function Qs(e){return Us(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Os)/Rs)}const $s=Qs(0),Js=Qs(1),Zs=Qs(2),el=Qs(3),tl=Qs(4),nl=Qs(5),rl=Qs(6);$s.range,Js.range,Zs.range,el.range,tl.range,nl.range,rl.range;function al(e){return Us(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/Rs)}const il=al(0),ol=al(1),sl=al(2),ll=al(3),cl=al(4),ul=al(5),dl=al(6),hl=(il.range,ol.range,sl.range,ll.range,cl.range,ul.range,dl.range,Us(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth())),fl=(hl.range,Us(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth())),pl=(fl.range,Us(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear()));pl.every=e=>isFinite(e=Math.floor(e))&&e>0?Us(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}):null;pl.range;const ml=Us(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ml.every=e=>isFinite(e=Math.floor(e))&&e>0?Us(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null;ml.range;function gl(e,t,n,r,a,i){const o=[[Vs,1,Ts],[Vs,5,5e3],[Vs,15,15e3],[Vs,30,3e4],[i,1,Os],[i,5,3e5],[i,15,9e5],[i,30,18e5],[a,1,Ps],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,Ds],[r,2,1728e5],[n,1,Rs],[t,1,Ms],[t,3,7776e6],[e,1,Fs]];function s(t,n,r){const a=Math.abs(n-t)/r,i=wi(e=>{let[,,t]=e;return t}).right(o,a);if(i===o.length)return e.every(yi(t/Fs,n/Fs,r));if(0===i)return zs.every(Math.max(yi(t,n,r),1));const[s,l]=o[a/o[i-1][2]<o[i][2]/a?i-1:i];return s.every(l)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const a=n&&"function"===typeof n.range?n:s(e,t,n),i=a?a.range(e,+t+1):[];return r?i.reverse():i},s]}const[vl,yl]=gl(ml,fl,il,Ys,Gs,qs),[bl,xl]=gl(pl,hl,$s,Ks,Hs,Ws);function wl(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Nl(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Sl(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var El,Cl,kl,Al={"-":"",_:" ",0:"0"},_l=/^\s*\d+/,jl=/^%/,Il=/[\\^$*+?|[\]().{}]/g;function Tl(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function Ol(e){return e.replace(Il,"\\$&")}function Pl(e){return new RegExp("^(?:"+e.map(Ol).join("|")+")","i")}function Dl(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function Rl(e,t,n){var r=_l.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Ml(e,t,n){var r=_l.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Fl(e,t,n){var r=_l.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Ll(e,t,n){var r=_l.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Bl(e,t,n){var r=_l.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Ul(e,t,n){var r=_l.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function zl(e,t,n){var r=_l.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Vl(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Wl(e,t,n){var r=_l.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function ql(e,t,n){var r=_l.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Hl(e,t,n){var r=_l.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Gl(e,t,n){var r=_l.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Kl(e,t,n){var r=_l.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Xl(e,t,n){var r=_l.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Yl(e,t,n){var r=_l.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Ql(e,t,n){var r=_l.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function $l(e,t,n){var r=_l.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Jl(e,t,n){var r=jl.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Zl(e,t,n){var r=_l.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function ec(e,t,n){var r=_l.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function tc(e,t){return Tl(e.getDate(),t,2)}function nc(e,t){return Tl(e.getHours(),t,2)}function rc(e,t){return Tl(e.getHours()%12||12,t,2)}function ac(e,t){return Tl(1+Ks.count(pl(e),e),t,3)}function ic(e,t){return Tl(e.getMilliseconds(),t,3)}function oc(e,t){return ic(e,t)+"000"}function sc(e,t){return Tl(e.getMonth()+1,t,2)}function lc(e,t){return Tl(e.getMinutes(),t,2)}function cc(e,t){return Tl(e.getSeconds(),t,2)}function uc(e){var t=e.getDay();return 0===t?7:t}function dc(e,t){return Tl($s.count(pl(e)-1,e),t,2)}function hc(e){var t=e.getDay();return t>=4||0===t?tl(e):tl.ceil(e)}function fc(e,t){return e=hc(e),Tl(tl.count(pl(e),e)+(4===pl(e).getDay()),t,2)}function pc(e){return e.getDay()}function mc(e,t){return Tl(Js.count(pl(e)-1,e),t,2)}function gc(e,t){return Tl(e.getFullYear()%100,t,2)}function vc(e,t){return Tl((e=hc(e)).getFullYear()%100,t,2)}function yc(e,t){return Tl(e.getFullYear()%1e4,t,4)}function bc(e,t){var n=e.getDay();return Tl((e=n>=4||0===n?tl(e):tl.ceil(e)).getFullYear()%1e4,t,4)}function xc(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Tl(t/60|0,"0",2)+Tl(t%60,"0",2)}function wc(e,t){return Tl(e.getUTCDate(),t,2)}function Nc(e,t){return Tl(e.getUTCHours(),t,2)}function Sc(e,t){return Tl(e.getUTCHours()%12||12,t,2)}function Ec(e,t){return Tl(1+Xs.count(ml(e),e),t,3)}function Cc(e,t){return Tl(e.getUTCMilliseconds(),t,3)}function kc(e,t){return Cc(e,t)+"000"}function Ac(e,t){return Tl(e.getUTCMonth()+1,t,2)}function _c(e,t){return Tl(e.getUTCMinutes(),t,2)}function jc(e,t){return Tl(e.getUTCSeconds(),t,2)}function Ic(e){var t=e.getUTCDay();return 0===t?7:t}function Tc(e,t){return Tl(il.count(ml(e)-1,e),t,2)}function Oc(e){var t=e.getUTCDay();return t>=4||0===t?cl(e):cl.ceil(e)}function Pc(e,t){return e=Oc(e),Tl(cl.count(ml(e),e)+(4===ml(e).getUTCDay()),t,2)}function Dc(e){return e.getUTCDay()}function Rc(e,t){return Tl(ol.count(ml(e)-1,e),t,2)}function Mc(e,t){return Tl(e.getUTCFullYear()%100,t,2)}function Fc(e,t){return Tl((e=Oc(e)).getUTCFullYear()%100,t,2)}function Lc(e,t){return Tl(e.getUTCFullYear()%1e4,t,4)}function Bc(e,t){var n=e.getUTCDay();return Tl((e=n>=4||0===n?cl(e):cl.ceil(e)).getUTCFullYear()%1e4,t,4)}function Uc(){return"+0000"}function zc(){return"%"}function Vc(e){return+e}function Wc(e){return Math.floor(+e/1e3)}function qc(e){return new Date(e)}function Hc(e){return e instanceof Date?+e:+new Date(+e)}function Gc(e,t,n,r,a,i,o,s,l,c){var u=Po(),d=u.invert,h=u.domain,f=c(".%L"),p=c(":%S"),m=c("%I:%M"),g=c("%I %p"),v=c("%a %d"),y=c("%b %d"),b=c("%B"),x=c("%Y");function w(e){return(l(e)<e?f:s(e)<e?p:o(e)<e?m:i(e)<e?g:r(e)<e?a(e)<e?v:y:n(e)<e?b:x)(e)}return u.invert=function(e){return new Date(d(e))},u.domain=function(e){return arguments.length?h(Array.from(e,Hc)):h().map(qc)},u.ticks=function(t){var n=h();return e(n[0],n[n.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?w:c(t)},u.nice=function(e){var n=h();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?h(Zo(n,e)):u},u.copy=function(){return To(u,Gc(e,t,n,r,a,i,o,s,l,c))},u}function Kc(){return ei.apply(Gc(bl,xl,pl,hl,$s,Ks,Hs,Ws,Vs,Cl).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Xc(){return ei.apply(Gc(vl,yl,ml,fl,il,Xs,Gs,qs,Vs,kl).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Yc(){var e,t,n,r,a,i=0,o=1,s=Ao,l=!1;function c(t){return null==t||isNaN(t=+t)?a:s(0===n?.5:(t=(r(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}function u(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),c):[s(0),s(1)]}}return c.domain=function(a){return arguments.length?([i,o]=a,e=r(i=+i),t=r(o=+o),n=e===t?0:1/(t-e),c):[i,o]},c.clamp=function(e){return arguments.length?(l=!!e,c):l},c.interpolator=function(e){return arguments.length?(s=e,c):s},c.range=u(So),c.rangeRound=u(Eo),c.unknown=function(e){return arguments.length?(a=e,c):a},function(a){return r=a,e=a(i),t=a(o),n=e===t?0:1/(t-e),c}}function Qc(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function $c(){var e=Qo(Yc()(Ao));return e.copy=function(){return Qc(e,$c())},ti.apply(e,arguments)}function Jc(){var e=os(Yc()).domain([1,10]);return e.copy=function(){return Qc(e,Jc()).base(e.base())},ti.apply(e,arguments)}function Zc(){var e=us(Yc());return e.copy=function(){return Qc(e,Zc()).constant(e.constant())},ti.apply(e,arguments)}function eu(){var e=ms(Yc());return e.copy=function(){return Qc(e,eu()).exponent(e.exponent())},ti.apply(e,arguments)}function tu(){return eu.apply(null,arguments).exponent(.5)}function nu(){var e=[],t=Ao;function n(n){if(null!=n&&!isNaN(n=+n))return t((ki(e,n,1)-1)/(e.length-1))}return n.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(bi),n},n.interpolator=function(e){return arguments.length?(t=e,n):t},n.range=function(){return e.map((n,r)=>t(r/(e.length-1)))},n.quantiles=function(t){return Array.from({length:t+1},(n,r)=>ks(e,r/t))},n.copy=function(){return nu(t).domain(e)},ti.apply(n,arguments)}function ru(){var e,t,n,r,a,i,o,s=0,l=.5,c=1,u=1,d=Ao,h=!1;function f(e){return isNaN(e=+e)?o:(e=.5+((e=+i(e))-t)*(u*e<u*t?r:a),d(h?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,a;return arguments.length?([n,r,a]=t,d=function(e,t){void 0===t&&(t=e,e=So);for(var n=0,r=t.length-1,a=t[0],i=new Array(r<0?0:r);n<r;)i[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return i[t](e-t)}}(e,[n,r,a]),f):[d(0),d(.5),d(1)]}}return f.domain=function(o){return arguments.length?([s,l,c]=o,e=i(s=+s),t=i(l=+l),n=i(c=+c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),u=t<e?-1:1,f):[s,l,c]},f.clamp=function(e){return arguments.length?(h=!!e,f):h},f.interpolator=function(e){return arguments.length?(d=e,f):d},f.range=p(So),f.rangeRound=p(Eo),f.unknown=function(e){return arguments.length?(o=e,f):o},function(o){return i=o,e=o(s),t=o(l),n=o(c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),u=t<e?-1:1,f}}function au(){var e=Qo(ru()(Ao));return e.copy=function(){return Qc(e,au())},ti.apply(e,arguments)}function iu(){var e=os(ru()).domain([.1,1,10]);return e.copy=function(){return Qc(e,iu()).base(e.base())},ti.apply(e,arguments)}function ou(){var e=us(ru());return e.copy=function(){return Qc(e,ou()).constant(e.constant())},ti.apply(e,arguments)}function su(){var e=ms(ru());return e.copy=function(){return Qc(e,su()).exponent(e.exponent())},ti.apply(e,arguments)}function lu(){return su.apply(null,arguments).exponent(.5)}!function(e){El=function(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,i=e.days,o=e.shortDays,s=e.months,l=e.shortMonths,c=Pl(a),u=Dl(a),d=Pl(i),h=Dl(i),f=Pl(o),p=Dl(o),m=Pl(s),g=Dl(s),v=Pl(l),y=Dl(l),b={a:function(e){return o[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:tc,e:tc,f:oc,g:vc,G:bc,H:nc,I:rc,j:ac,L:ic,m:sc,M:lc,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Vc,s:Wc,S:cc,u:uc,U:dc,V:fc,w:pc,W:mc,x:null,X:null,y:gc,Y:yc,Z:xc,"%":zc},x={a:function(e){return o[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:wc,e:wc,f:kc,g:Fc,G:Bc,H:Nc,I:Sc,j:Ec,L:Cc,m:Ac,M:_c,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Vc,s:Wc,S:jc,u:Ic,U:Tc,V:Pc,w:Dc,W:Rc,x:null,X:null,y:Mc,Y:Lc,Z:Uc,"%":zc},w={a:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=h.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return E(e,t,n,r)},d:Hl,e:Hl,f:$l,g:zl,G:Ul,H:Kl,I:Kl,j:Gl,L:Ql,m:ql,M:Xl,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=u.get(r[0].toLowerCase()),n+r[0].length):-1},q:Wl,Q:Zl,s:ec,S:Yl,u:Ml,U:Fl,V:Ll,w:Rl,W:Bl,x:function(e,t,r){return E(e,n,t,r)},X:function(e,t,n){return E(e,r,t,n)},y:zl,Y:Ul,Z:Vl,"%":Jl};function N(e,t){return function(n){var r,a,i,o=[],s=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===e.charCodeAt(s)&&(o.push(e.slice(l,s)),null!=(a=Al[r=e.charAt(++s)])?r=e.charAt(++s):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),l=s+1);return o.push(e.slice(l,s)),o.join("")}}function S(e,t){return function(n){var r,a,i=Sl(1900,void 0,1);if(E(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(t&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=Nl(Sl(i.y,0,1))).getUTCDay(),r=a>4||0===a?ol.ceil(r):ol(r),r=Xs.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(a=(r=wl(Sl(i.y,0,1))).getDay(),r=a>4||0===a?Js.ceil(r):Js(r),r=Ks.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?Nl(Sl(i.y,0,1)).getUTCDay():wl(Sl(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,Nl(i)):wl(i)}}function E(e,t,n,r){for(var a,i,o=0,s=t.length,l=n.length;o<s;){if(r>=l)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=w[a in Al?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return b.x=N(n,b),b.X=N(r,b),b.c=N(t,b),x.x=N(n,x),x.X=N(r,x),x.c=N(t,x),{format:function(e){var t=N(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=S(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=N(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=S(e+="",!0);return t.toString=function(){return e},t}}}(e),Cl=El.format,El.parse,kl=El.utcFormat,El.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var cu=e=>e.chartData,uu=Dr([cu],e=>{var t=null!=e.chartData?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),du=(e,t,n,r)=>r?uu(e):cu(e);function hu(e){return Number.isFinite(e)}function fu(e){return"number"===typeof e&&e>0&&Number.isFinite(e)}function pu(e){if(Array.isArray(e)&&2===e.length){var[t,n]=e;if(hu(t)&&hu(n))return!0}return!1}function mu(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}var gu=n(8210),vu=n.n(gu),yu=e=>e,bu={"@@functional/placeholder":!0},xu=e=>e===bu,wu=e=>function t(){return 0===arguments.length||1===arguments.length&&xu(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},Nu=(e,t)=>1===e?t:wu(function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=r.filter(e=>e!==bu).length;return i>=e?t(...r):Nu(e-i,wu(function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var i=r.map(e=>xu(e)?n.shift():e);return t(...i,...n)}))}),Su=e=>Nu(e.length,e),Eu=(e,t)=>{for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},Cu=Su((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(e=>t[e]).map(e)),ku=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),Au=e=>{var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t&&a.every((e,n)=>{var r;return e===(null===(r=t)||void 0===r?void 0:r[n])})?n:(t=a,n=e(...a))}};function _u(e){return 0===e?1:Math.floor(new(vu())(e).abs().log(10).toNumber())+1}function ju(e,t,n){for(var r=new(vu())(e),a=0,i=[];r.lt(t)&&a<1e5;)i.push(r.toNumber()),r=r.add(n),a++;return i}Su((e,t,n)=>{var r=+e;return r+n*(+t-r)}),Su((e,t,n)=>{var r=t-+e;return(n-e)/(r=r||1/0)}),Su((e,t,n)=>{var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});var Iu=e=>{var[t,n]=e,[r,a]=[t,n];return t>n&&([r,a]=[n,t]),[r,a]},Tu=(e,t,n)=>{if(e.lte(0))return new(vu())(0);var r=_u(e.toNumber()),a=new(vu())(10).pow(r),i=e.div(a),o=1!==r?.05:.1,s=new(vu())(Math.ceil(i.div(o).toNumber())).add(n).mul(o).mul(a);return t?new(vu())(s.toNumber()):new(vu())(Math.ceil(s.toNumber()))},Ou=(e,t,n)=>{var r=new(vu())(1),a=new(vu())(e);if(!a.isint()&&n){var i=Math.abs(e);i<1?(r=new(vu())(10).pow(_u(e)-1),a=new(vu())(Math.floor(a.div(r).toNumber())).mul(r)):i>1&&(a=new(vu())(Math.floor(e)))}else 0===e?a=new(vu())(Math.floor((t-1)/2)):n||(a=new(vu())(Math.floor(e)));var o=Math.floor((t-1)/2);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return yu;var r=t.reverse(),a=r[0],i=r.slice(1);return function(){return i.reduce((e,t)=>t(e),a(...arguments))}}(Cu(e=>a.add(new(vu())(e-o).mul(r)).toNumber()),Eu)(0,t)},Pu=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new(vu())(0),tickMin:new(vu())(0),tickMax:new(vu())(0)};var i,o=Tu(new(vu())(t).sub(e).div(n-1),r,a);i=e<=0&&t>=0?new(vu())(0):(i=new(vu())(e).add(t).div(2)).sub(new(vu())(i).mod(o));var s=Math.ceil(i.sub(e).div(o).toNumber()),l=Math.ceil(new(vu())(t).sub(i).div(o).toNumber()),c=s+l+1;return c>n?Pu(e,t,n,r,a+1):(c<n&&(l=t>0?l+(n-c):l,s=t>0?s:s+(n-c)),{step:o,tickMin:i.sub(new(vu())(s).mul(o)),tickMax:i.add(new(vu())(l).mul(o))})};var Du=Au(function(e){var[t,n]=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=Math.max(r,2),[o,s]=Iu([t,n]);if(o===-1/0||s===1/0){var l=s===1/0?[o,...Eu(0,r-1).map(()=>1/0)]:[...Eu(0,r-1).map(()=>-1/0),s];return t>n?ku(l):l}if(o===s)return Ou(o,r,a);var{step:c,tickMin:u,tickMax:d}=Pu(o,s,i,a,0),h=ju(u,d.add(new(vu())(.1).mul(c)),c);return t>n?ku(h):h}),Ru=Au(function(e,t){var[n,r]=e,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],[i,o]=Iu([n,r]);if(i===-1/0||o===1/0)return[n,r];if(i===o)return[i];var s=Math.max(t,2),l=Tu(new(vu())(o).sub(i).div(s-1),a,0),c=[...ju(new(vu())(i),new(vu())(o),l),o];return!1===a&&(c=c.map(e=>Math.round(e))),n>r?ku(c):c}),Mu=e=>e.rootProps.maxBarSize,Fu=e=>e.rootProps.barCategoryGap,Lu=e=>e.rootProps.stackOffset,Bu=e=>e.options.chartName,Uu=e=>e.rootProps.syncId,zu=e=>e.rootProps.syncMethod,Vu=e=>e.options.eventEmitter,Wu=0,qu="auto",Hu=!0,Gu=!1,Ku=!0,Xu=0,Yu="auto",Qu=!0,$u=5,Ju=(e,t)=>{if(e&&t)return null!==e&&void 0!==e&&e.reversed?[t[1],t[0]]:t},Zu={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Wu,includeHidden:!1,name:void 0,reversed:!1,scale:qu,tick:Hu,tickCount:void 0,ticks:void 0,type:"category",unit:void 0},ed={allowDataOverflow:Gu,allowDecimals:!1,allowDuplicatedCategory:Ku,dataKey:void 0,domain:void 0,id:Xu,includeHidden:!1,name:void 0,reversed:!1,scale:Yu,tick:Qu,tickCount:$u,ticks:void 0,type:"number",unit:void 0},td={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,dataKey:void 0,domain:void 0,id:Wu,includeHidden:!1,name:void 0,reversed:!1,scale:qu,tick:Hu,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},nd={allowDataOverflow:Gu,allowDecimals:!1,allowDuplicatedCategory:Ku,dataKey:void 0,domain:void 0,id:Xu,includeHidden:!1,name:void 0,reversed:!1,scale:Yu,tick:Qu,tickCount:$u,ticks:void 0,type:"category",unit:void 0},rd=(e,t)=>null!=e.polarAxis.angleAxis[t]?e.polarAxis.angleAxis[t]:"radial"===e.layout.layoutType?td:Zu,ad=(e,t)=>null!=e.polarAxis.radiusAxis[t]?e.polarAxis.radiusAxis[t]:"radial"===e.layout.layoutType?nd:ed,id=e=>e.polarOptions,od=Dr([Aa,_a,La],ia),sd=Dr([id,od],(e,t)=>{if(null!=e)return z(e.innerRadius,t,0)}),ld=Dr([id,od],(e,t)=>{if(null!=e)return z(e.outerRadius,t,.8*t)}),cd=Dr([id],e=>{if(null==e)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]}),ud=(Dr([rd,cd],Ju),Dr([od,sd,ld],(e,t,n)=>{if(null!=e&&null!=t&&null!=n)return[t,n]})),dd=(Dr([ad,ud],Ju),Dr([Qa,id,sd,ld,Aa,_a],(e,t,n,r,a,i)=>{if(("centric"===e||"radial"===e)&&null!=t&&null!=n&&null!=r){var{cx:o,cy:s,startAngle:l,endAngle:c}=t;return{cx:z(o,a,a/2),cy:z(s,i,i/2),innerRadius:n,outerRadius:r,startAngle:l,endAngle:c,clockWise:!1}}})),hd=(e,t)=>t,fd=(e,t,n)=>n;function pd(e){return null===e||void 0===e?void 0:e.id}var md=e=>{var t=Qa(e);return"horizontal"===t?"xAxis":"vertical"===t?"yAxis":"centric"===t?"angleAxis":"radiusAxis"},gd=e=>e.tooltip.settings.axisId,vd=e=>{var t=md(e),n=gd(e);return Dd(e,t,n)},yd=Dr([vd],e=>null===e||void 0===e?void 0:e.dataKey);function bd(e,t,n){var{chartData:r=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=n,o=new Map;return e.forEach(e=>{var t,n=null!==(t=e.data)&&void 0!==t?t:r;if(null!=n&&0!==n.length){var s=pd(e);n.forEach((t,n)=>{var r,l=null==i||a?n:String(fa(t,i,null)),c=fa(t,e.dataKey,0);r=o.has(l)?o.get(l):{},Object.assign(r,{[s]:c}),o.set(l,r)})}}),Array.from(o.values())}function xd(e){return null!=e.stackId&&null!=e.dataKey}function wd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Nd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wd(Object(n),!0).forEach(function(t){Sd(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wd(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Sd(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ed=[0,"auto"],Cd={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},kd=(e,t)=>e.cartesianAxis.xAxis[t],Ad=(e,t)=>{var n=kd(e,t);return null==n?Cd:n},_d={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Ed,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:60},jd=(e,t)=>e.cartesianAxis.yAxis[t],Id=(e,t)=>{var n=jd(e,t);return null==n?_d:n},Td={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Od=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return null==n?Td:n},Pd=(e,t,n)=>{switch(t){case"xAxis":return Ad(e,n);case"yAxis":return Id(e,n);case"zAxis":return Od(e,n);case"angleAxis":return rd(e,n);case"radiusAxis":return ad(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},Dd=(e,t,n)=>{switch(t){case"xAxis":return Ad(e,n);case"yAxis":return Id(e,n);case"angleAxis":return rd(e,n);case"radiusAxis":return ad(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},Rd=e=>e.graphicalItems.cartesianItems.some(e=>"bar"===e.type)||e.graphicalItems.polarItems.some(e=>"radialBar"===e.type);function Md(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var Fd=e=>e.graphicalItems.cartesianItems,Ld=Dr([hd,fd],Md),Bd=(e,t,n)=>e.filter(n).filter(e=>!0===(null===t||void 0===t?void 0:t.includeHidden)||!e.hide),Ud=Dr([Fd,Pd,Ld],Bd),zd=Dr([Ud],e=>e.filter(e=>"area"===e.type||"bar"===e.type).filter(xd)),Vd=e=>e.filter(e=>!("stackId"in e)||void 0===e.stackId),Wd=Dr([Ud],Vd),qd=e=>e.map(e=>e.data).filter(Boolean).flat(1),Hd=Dr([Ud],qd),Gd=(e,t)=>{var{chartData:n=[],dataStartIndex:r,dataEndIndex:a}=t;return e.length>0?e:n.slice(r,a+1)},Kd=Dr([Hd,du],Gd),Xd=(e,t,n)=>null!=(null===t||void 0===t?void 0:t.dataKey)?e.map(e=>({value:fa(e,t.dataKey)})):n.length>0?n.map(e=>e.dataKey).flatMap(t=>e.map(e=>({value:fa(e,t)}))):e.map(e=>({value:e})),Yd=Dr([Kd,Pd,Ud],Xd);function Qd(e,t){switch(e){case"xAxis":return"x"===t.direction;case"yAxis":return"y"===t.direction;default:return!1}}function $d(e){return e.filter(e=>L(e)||e instanceof Date).map(Number).filter(e=>!1===R(e))}function Jd(e,t,n){return!n||"number"!==typeof t||R(t)?[]:n.length?$d(n.flatMap(n=>{var r,a,i=fa(e,n.dataKey);if(Array.isArray(i)?[r,a]=i:r=a=i,hu(r)&&hu(a))return[t-r,t+a]})):[]}var Zd=Dr([zd,du,vd],bd),eh=(e,t,n)=>{var r=t.reduce((e,t)=>(null==t.stackId||(null==e[t.stackId]&&(e[t.stackId]=[]),e[t.stackId].push(t)),e),{});return Object.fromEntries(Object.entries(r).map(t=>{var[r,a]=t,i=a.map(pd);return[r,{stackedData:ba(e,i,n),graphicalItems:a}]}))},th=Dr([Zd,zd,Lu],eh),nh=(e,t,n)=>{var{dataStartIndex:r,dataEndIndex:a}=t;if("zAxis"!==n){var i=wa(e,r,a);if(null==i||0!==i[0]||0!==i[1])return i}},rh=Dr([th,cu,hd],nh),ah=(e,t,n,r,a)=>n.length>0?e.flatMap(e=>n.flatMap(n=>{var i,o,s=null===(i=r[n.id])||void 0===i?void 0:i.filter(e=>Qd(a,e)),l=fa(e,null!==(o=t.dataKey)&&void 0!==o?o:n.dataKey);return{value:l,errorDomain:Jd(e,l,s)}})).filter(Boolean):null!=(null===t||void 0===t?void 0:t.dataKey)?e.map(e=>({value:fa(e,t.dataKey),errorDomain:[]})):e.map(e=>({value:e,errorDomain:[]})),ih=e=>e.errorBars,oh=(e,t,n)=>e.flatMap(e=>t[e.id]).filter(Boolean).filter(e=>Qd(n,e)),sh=(Dr([Wd,ih,hd],oh),Dr([Kd,Pd,Wd,ih,hd],ah));function lh(e){var{value:t}=e;if(L(t)||t instanceof Date)return t}var ch=e=>{var t=$d(e.flatMap(e=>[e.value,e.errorDomain]).flat(1));if(0!==t.length)return[Math.min(...t),Math.max(...t)]},uh=e=>{var t;if(null==e||!("domain"in e))return Ed;if(null!=e.domain)return e.domain;if(null!=e.ticks){if("number"===e.type){var n=$d(e.ticks);return[Math.min(...n),Math.max(...n)]}if("category"===e.type)return e.ticks.map(String)}return null!==(t=null===e||void 0===e?void 0:e.domain)&&void 0!==t?t:Ed},dh=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.filter(Boolean);if(0!==r.length){var a=r.flat();return[Math.min(...a),Math.max(...a)]}},hh=e=>e.referenceElements.dots,fh=(e,t,n)=>e.filter(e=>"extendDomain"===e.ifOverflow).filter(e=>"xAxis"===t?e.xAxisId===n:e.yAxisId===n),ph=Dr([hh,hd,fd],fh),mh=e=>e.referenceElements.areas,gh=Dr([mh,hd,fd],fh),vh=e=>e.referenceElements.lines,yh=Dr([vh,hd,fd],fh),bh=(e,t)=>{var n=$d(e.map(e=>"xAxis"===t?e.x:e.y));if(0!==n.length)return[Math.min(...n),Math.max(...n)]},xh=Dr(ph,hd,bh),wh=(e,t)=>{var n=$d(e.flatMap(e=>["xAxis"===t?e.x1:e.y1,"xAxis"===t?e.x2:e.y2]));if(0!==n.length)return[Math.min(...n),Math.max(...n)]},Nh=Dr([gh,hd],wh),Sh=(e,t)=>{var n=$d(e.map(e=>"xAxis"===t?e.x:e.y));if(0!==n.length)return[Math.min(...n),Math.max(...n)]},Eh=Dr(yh,hd,Sh),Ch=Dr(xh,Eh,Nh,(e,t,n)=>dh(e,n,t)),kh=Dr([Pd],uh),Ah=(e,t,n,r,a,i,o)=>{var s=function(e,t){if(t&&"function"!==typeof e&&Array.isArray(e)&&2===e.length){var n,r,[a,i]=e;if(hu(a))n=a;else if("function"===typeof a)return;if(hu(i))r=i;else if("function"===typeof i)return;var o=[n,r];if(pu(o))return o}}(t,e.allowDataOverflow);return null!=s?s:function(e,t,n){if(n||null!=t){if("function"===typeof e&&null!=t)try{var r=e(t,n);if(pu(r))return mu(r,t,n)}catch(f){}if(Array.isArray(e)&&2===e.length){var a,i,[o,s]=e;if("auto"===o)null!=t&&(a=Math.min(...t));else if(F(o))a=o;else if("function"===typeof o)try{null!=t&&(a=o(null===t||void 0===t?void 0:t[0]))}catch(p){}else if("string"===typeof o&&Na.test(o)){var l=Na.exec(o);if(null==l||null==t)a=void 0;else{var c=+l[1];a=t[0]-c}}else a=null===t||void 0===t?void 0:t[0];if("auto"===s)null!=t&&(i=Math.max(...t));else if(F(s))i=s;else if("function"===typeof s)try{null!=t&&(i=s(null===t||void 0===t?void 0:t[1]))}catch(m){}else if("string"===typeof s&&Sa.test(s)){var u=Sa.exec(s);if(null==u||null==t)i=void 0;else{var d=+u[1];i=t[1]+d}}else i=null===t||void 0===t?void 0:t[1];var h=[a,i];if(pu(h))return null==t?h:mu(h,t,n)}}}(t,"vertical"===i&&"xAxis"===o||"horizontal"===i&&"yAxis"===o?dh(n,a,ch(r)):dh(a,ch(r)),e.allowDataOverflow)},_h=Dr([Pd,kh,rh,sh,Ch,Qa,hd],Ah),jh=[0,1],Ih=(e,t,n,r,a,i,o)=>{if(null!=e&&null!=n&&0!==n.length||void 0!==o){var{dataKey:s,type:l}=e,c=pa(t,i);return c&&null==s?Za()(0,n.length):"category"===l?((e,t,n)=>{var r=e.map(lh).filter(e=>null!=e);return n&&(null==t.dataKey||t.allowDuplicatedCategory&&V(r))?Za()(0,e.length):t.allowDuplicatedCategory?r:Array.from(new Set(r))})(r,e,c):"expand"===a?jh:o}},Th=Dr([Pd,Qa,Kd,Yd,Lu,hd,_h],Ih),Oh=(e,t,n,a,i)=>{if(null!=e){var{scale:o,type:s}=e;if("auto"===o)return"radial"===t&&"radiusAxis"===i?"band":"radial"===t&&"angleAxis"===i?"linear":"category"===s&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!n)?"point":"category"===s?"band":"linear";if("string"===typeof o){var l="scale".concat(H(o));return l in r?l:"point"}}},Ph=Dr([Pd,Qa,Rd,Bu,hd],Oh);function Dh(e,t,n,a){if(null!=n&&null!=a){if("function"===typeof e.scale)return e.scale.copy().domain(n).range(a);var i=function(e){if(null!=e){if(e in r)return r[e]();var t="scale".concat(H(e));return t in r?r[t]():void 0}}(t);if(null!=i){var o=i.domain(n).range(a);return(e=>{var t=e.domain();if(t&&!(t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-va,i=Math.max(r[0],r[1])+va,o=e(t[0]),s=e(t[n-1]);(o<a||o>i||s<a||s>i)&&e.domain([t[0],t[n-1]])}})(o),o}}}var Rh=(e,t,n)=>{var r=uh(t);if("auto"===n||"linear"===n)return null!=t&&t.tickCount&&Array.isArray(r)&&("auto"===r[0]||"auto"===r[1])&&pu(e)?Du(e,t.tickCount,t.allowDecimals):null!=t&&t.tickCount&&"number"===t.type&&pu(e)?Ru(e,t.tickCount,t.allowDecimals):void 0},Mh=Dr([Th,Dd,Ph],Rh),Fh=(e,t,n,r)=>{if("angleAxis"!==r&&"number"===(null===e||void 0===e?void 0:e.type)&&pu(t)&&Array.isArray(n)&&n.length>0){var a=t[0],i=n[0],o=t[1],s=n[n.length-1];return[Math.min(a,i),Math.max(o,s)]}return t},Lh=Dr([Pd,Th,Mh,hd],Fh),Bh=Dr(Yd,Pd,(e,t)=>{if(t&&"number"===t.type){var n=1/0,r=Array.from($d(e.map(e=>e.value))).sort((e,t)=>e-t);if(r.length<2)return 1/0;var a=r[r.length-1]-r[0];if(0===a)return 1/0;for(var i=0;i<r.length-1;i++){var o=r[i+1]-r[i];n=Math.min(n,o)}return n/a}}),Uh=Dr(Bh,Qa,Fu,La,(e,t,n,r)=>r,(e,t,n,r,a)=>{if(!hu(e))return 0;var i="vertical"===t?r.height:r.width;if("gap"===a)return e*i/2;if("no-gap"===a){var o=z(n,e*i),s=e*i/2;return s-o-(s-o)/i*o}return 0}),zh=Dr(Ad,(e,t)=>{var n=Ad(e,t);return null==n||"string"!==typeof n.padding?0:Uh(e,"xAxis",t,n.padding)},(e,t)=>{var n,r;if(null==e)return{left:0,right:0};var{padding:a}=e;return"string"===typeof a?{left:t,right:t}:{left:(null!==(n=a.left)&&void 0!==n?n:0)+t,right:(null!==(r=a.right)&&void 0!==r?r:0)+t}}),Vh=Dr(Id,(e,t)=>{var n=Id(e,t);return null==n||"string"!==typeof n.padding?0:Uh(e,"yAxis",t,n.padding)},(e,t)=>{var n,r;if(null==e)return{top:0,bottom:0};var{padding:a}=e;return"string"===typeof a?{top:t,bottom:t}:{top:(null!==(n=a.top)&&void 0!==n?n:0)+t,bottom:(null!==(r=a.bottom)&&void 0!==r?r:0)+t}}),Wh=Dr([La,zh,qa,Wa,(e,t,n)=>n],(e,t,n,r,a)=>{var{padding:i}=r;return a?[i.left,n.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),qh=Dr([La,Qa,Vh,qa,Wa,(e,t,n)=>n],(e,t,n,r,a,i)=>{var{padding:o}=a;return i?[r.height-o.bottom,o.top]:"horizontal"===t?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),Hh=(e,t,n,r)=>{var a;switch(t){case"xAxis":return Wh(e,n,r);case"yAxis":return qh(e,n,r);case"zAxis":return null===(a=Od(e,n))||void 0===a?void 0:a.range;case"angleAxis":return cd(e);case"radiusAxis":return ud(e,n);default:return}},Gh=Dr([Pd,Hh],Ju),Kh=Dr([Pd,Ph,Lh,Gh],Dh);Dr([Ud,ih,hd],oh);function Xh(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Yh=(e,t)=>t,Qh=(e,t,n)=>n,$h=Dr(Ta,Yh,Qh,(e,t,n)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===n).sort(Xh)),Jh=Dr(Oa,Yh,Qh,(e,t,n)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===n).sort(Xh)),Zh=(e,t)=>({width:e.width,height:t.height}),ef=Dr(La,Ad,Zh),tf=Dr(_a,La,$h,Yh,Qh,(e,t,n,r,a)=>{var i,o={};return n.forEach(n=>{var s=Zh(t,n);null==i&&(i=((e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}})(t,r,e));var l="top"===r&&!a||"bottom"===r&&a;o[n.id]=i-Number(l)*s.height,i+=(l?-1:1)*s.height}),o}),nf=Dr(Aa,La,Jh,Yh,Qh,(e,t,n,r,a)=>{var i,o={};return n.forEach(n=>{var s=((e,t)=>({width:"number"===typeof t.width?t.width:60,height:e.height}))(t,n);null==i&&(i=((e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}})(t,r,e));var l="left"===r&&!a||"right"===r&&a;o[n.id]=i-Number(l)*s.width,i+=(l?-1:1)*s.width}),o}),rf=Dr(La,Id,(e,t)=>({width:"number"===typeof t.width?t.width:60,height:e.height})),af=(e,t,n)=>{switch(t){case"xAxis":return ef(e,n).width;case"yAxis":return rf(e,n).height;default:return}},of=(e,t,n,r)=>{if(null!=n){var{allowDuplicatedCategory:a,type:i,dataKey:o}=n,s=pa(e,r),l=t.map(e=>e.value);return o&&s&&"category"===i&&a&&V(l)?l:void 0}},sf=Dr([Qa,Yd,Pd,hd],of),lf=(e,t,n,r)=>{if(null!=n&&null!=n.dataKey){var{type:a,scale:i}=n;return!pa(e,r)||"number"!==a&&"auto"===i?void 0:t.map(e=>e.value)}},cf=Dr([Qa,Yd,Dd,hd],lf),uf=Dr([Qa,(e,t,n)=>{switch(t){case"xAxis":return Ad(e,n);case"yAxis":return Id(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},Ph,Kh,sf,cf,Hh,Mh,hd],(e,t,n,r,a,i,o,s,l)=>{if(null==t)return null;var c=pa(e,l);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:l,categoricalDomain:i,duplicateDomain:a,isCategorical:c,niceTicks:s,range:o,realScaleType:n,scale:r}}),df=Dr([Qa,Dd,Ph,Kh,Mh,Hh,sf,cf,hd],(e,t,n,r,a,i,o,s,l)=>{if(null!=t&&null!=r){var c=pa(e,l),{type:u,ticks:d,tickCount:h}=t,f="scaleBand"===n&&"function"===typeof r.bandwidth?r.bandwidth()/2:2,p="category"===u&&r.bandwidth?r.bandwidth()/f:0;p="angleAxis"===l&&null!=i&&i.length>=2?2*D(i[0]-i[1])*p:p;var m=d||a;return m?m.map((e,t)=>{var n=o?o.indexOf(e):e;return{index:t,coordinate:r(n)+p,value:e,offset:p}}).filter(e=>!R(e.coordinate)):c&&s?s.map((e,t)=>({coordinate:r(e)+p,value:e,index:t,offset:p})):r.ticks?r.ticks(h).map(e=>({coordinate:r(e)+p,value:e,offset:p})):r.domain().map((e,t)=>({coordinate:r(e)+p,value:o?o[e]:e,index:t,offset:p}))}}),hf=Dr([Qa,Dd,Kh,Hh,sf,cf,hd],(e,t,n,r,a,i,o)=>{if(null!=t&&null!=n&&null!=r&&r[0]!==r[1]){var s=pa(e,o),{tickCount:l}=t,c=0;return c="angleAxis"===o&&(null===r||void 0===r?void 0:r.length)>=2?2*D(r[0]-r[1])*c:c,s&&i?i.map((e,t)=>({coordinate:n(e)+c,value:e,index:t,offset:c})):n.ticks?n.ticks(l).map(e=>({coordinate:n(e)+c,value:e,offset:c})):n.domain().map((e,t)=>({coordinate:n(e)+c,value:a?a[e]:e,index:t,offset:c}))}}),ff=Dr(Pd,Kh,(e,t)=>{if(null!=e&&null!=t)return Nd(Nd({},e),{},{scale:t})}),pf=Dr([Pd,Ph,Th,Gh],Dh),mf=(Dr((e,t,n)=>Od(e,n),pf,(e,t)=>{if(null!=e&&null!=t)return Nd(Nd({},e),{},{scale:t})}),Dr([Qa,Ta,Oa],(e,t,n)=>{switch(e){case"horizontal":return t.some(e=>e.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(e=>e.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}})),gf=e=>e.options.defaultTooltipEventType,vf=e=>e.options.validateTooltipEventTypes;function yf(e,t,n){if(null==e)return t;var r=e?"axis":"item";return null==n?t:n.includes(r)?r:t}function bf(e,t){return yf(t,gf(e),vf(e))}var xf=(e,t)=>{var n,r=Number(t);if(!R(r)&&null!=t)return r>=0?null===e||void 0===e||null===(n=e[r])||void 0===n?void 0:n.value:void 0};function wf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Nf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wf(Object(n),!0).forEach(function(t){Sf(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wf(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Sf(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ef=(e,t,n,r)=>{if(null==t)return nr;var a=function(e,t,n){return"axis"===t?"click"===n?e.axisInteraction.click:e.axisInteraction.hover:"click"===n?e.itemInteraction.click:e.itemInteraction.hover}(e,t,n);if(null==a)return nr;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&null!=e.syncInteraction.index)return e.syncInteraction;var i=!0===e.settings.active;if(null!=a.index){if(i)return Nf(Nf({},a),{},{active:!0})}else if(null!=r)return{active:!0,coordinate:void 0,dataKey:void 0,index:r};return Nf(Nf({},nr),{},{coordinate:a.coordinate})},Cf=(e,t)=>{var n=null===e||void 0===e?void 0:e.index;if(null==n)return null;var r=Number(n);if(!hu(r))return n;var a=1/0;return t.length>0&&(a=t.length-1),String(Math.max(0,Math.min(r,a)))},kf=(e,t,n,r,a,i,o,s)=>{if(null!=i&&null!=s){var l=o[0],c=null==l?void 0:s(l.positions,i);if(null!=c)return c;var u=null===a||void 0===a?void 0:a[Number(i)];if(u)return"horizontal"===n?{x:u.coordinate,y:(r.top+t)/2}:{x:(r.left+e)/2,y:u.coordinate}}},Af=(e,t,n,r)=>{return"axis"===t?e.tooltipItemPayloads:0===e.tooltipItemPayloads.length?[]:null==(a="hover"===n?e.itemInteraction.hover.dataKey:e.itemInteraction.click.dataKey)&&null!=r?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(e=>{var t;return(null===(t=e.settings)||void 0===t?void 0:t.dataKey)===a});var a},_f=e=>e.options.tooltipPayloadSearcher,jf=e=>e.tooltip;function If(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Tf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?If(Object(n),!0).forEach(function(t){Of(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):If(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Of(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pf=(e,t,n,r,a,i,o)=>{if(null!=t&&null!=i){var{chartData:s,computedData:l,dataStartIndex:c,dataEndIndex:u}=n;return e.reduce((e,n)=>{var d,h,f,{dataDefinedOnItem:p,settings:m}=n,g=function(e,t){return null!=e?e:t}(p,s),v=Array.isArray(g)?ca(g,c,u):g,y=null!==(d=null===m||void 0===m?void 0:m.dataKey)&&void 0!==d?d:r,b=null===m||void 0===m?void 0:m.nameKey;(h=r&&Array.isArray(v)&&!Array.isArray(v[0])&&"axis"===o?function(e,t,n){if(e&&e.length)return e.find(e=>e&&("function"===typeof t?t(e):P()(e,t))===n)}(v,r,a):i(v,t,l,b),Array.isArray(h))?h.forEach(t=>{var n=Tf(Tf({},m),{},{name:t.name,unit:t.unit,color:void 0,fill:void 0});e.push(Ca({tooltipEntrySettings:n,dataKey:t.dataKey,payload:t.payload,value:fa(t.payload,t.dataKey),name:t.name}))}):e.push(Ca({tooltipEntrySettings:m,dataKey:y,payload:h,value:fa(h,y),name:null!==(f=fa(h,b))&&void 0!==f?f:null===m||void 0===m?void 0:m.name}));return e},[])}},Df=Dr([vd,Qa,Rd,Bu,md],Oh),Rf=Dr([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),Mf=Dr([md,gd],Md),Ff=Dr([Rf,vd,Mf],Bd),Lf=Dr([Ff],e=>e.filter(xd)),Bf=Dr([Ff],qd),Uf=Dr([Bf,cu],Gd),zf=Dr([Lf,cu,vd],bd),Vf=Dr([Uf,vd,Ff],Xd),Wf=Dr([vd],uh),qf=Dr([Ff],e=>e.filter(xd)),Hf=Dr([zf,qf,Lu],eh),Gf=Dr([Hf,cu,md],nh),Kf=Dr([Ff],Vd),Xf=Dr([Uf,vd,Kf,ih,md],ah),Yf=Dr([hh,md,gd],fh),Qf=Dr([Yf,md],bh),$f=Dr([mh,md,gd],fh),Jf=Dr([$f,md],wh),Zf=Dr([vh,md,gd],fh),ep=Dr([Zf,md],Sh),tp=Dr([Qf,ep,Jf],dh),np=Dr([vd,Wf,Gf,Xf,tp,Qa,md],Ah),rp=Dr([vd,Qa,Uf,Vf,Lu,md,np],Ih),ap=Dr([rp,vd,Df],Rh),ip=Dr([vd,rp,ap,md],Fh),op=e=>{var t=md(e),n=gd(e);return Hh(e,t,n,!1)},sp=Dr([vd,op],Ju),lp=Dr([vd,Df,ip,sp],Dh),cp=Dr([Qa,Vf,vd,md],of),up=Dr([Qa,Vf,vd,md],lf),dp=Dr([Qa,vd,Df,lp,op,cp,up,md],(e,t,n,r,a,i,o,s)=>{if(t){var{type:l}=t,c=pa(e,s);if(r){var u="scaleBand"===n&&r.bandwidth?r.bandwidth()/2:2,d="category"===l&&r.bandwidth?r.bandwidth()/u:0;return d="angleAxis"===s&&null!=a&&(null===a||void 0===a?void 0:a.length)>=2?2*D(a[0]-a[1])*d:d,c&&o?o.map((e,t)=>({coordinate:r(e)+d,value:e,index:t,offset:d})):r.domain().map((e,t)=>({coordinate:r(e)+d,value:i?i[e]:e,index:t,offset:d}))}}}),hp=Dr([gf,vf,e=>e.tooltip.settings],(e,t,n)=>yf(n.shared,e,t)),fp=e=>e.tooltip.settings.trigger,pp=e=>e.tooltip.settings.defaultIndex,mp=Dr([jf,hp,fp,pp],Ef),gp=Dr([mp,Uf],Cf),vp=Dr([dp,gp],xf),yp=Dr([mp],e=>{if(e)return e.dataKey}),bp=Dr([jf,hp,fp,pp],Af),xp=Dr([Aa,_a,Qa,La,dp,pp,bp,_f],kf),wp=Dr([mp,xp],(e,t)=>null!==e&&void 0!==e&&e.coordinate?e.coordinate:t),Np=Dr([mp],e=>e.active),Sp=Dr([bp,gp,cu,yd,vp,_f,hp],Pf),Ep=(Dr([Sp],e=>{if(null!=e){var t=e.map(e=>e.payload).filter(e=>null!=e);return Array.from(new Set(t))}}),(e,t)=>t),Cp=(e,t,n)=>n,kp=(e,t,n,r)=>r,Ap=Dr(dp,e=>Hr()(e,e=>e.coordinate)),_p=Dr([jf,Ep,Cp,kp],Ef),jp=Dr([_p,Uf],Cf),Ip=Dr([jf,Ep,Cp,kp],Af),Tp=Dr([Aa,_a,Qa,La,dp,kp,Ip,_f],kf),Op=Dr([_p,Tp],(e,t)=>{var n;return null!==(n=e.coordinate)&&void 0!==n?n:t}),Pp=Dr(dp,jp,xf),Dp=Dr([Ip,jp,cu,yd,Pp,_f,Ep],Pf),Rp=Dr([_p],e=>({isActive:e.active,activeIndex:e.index})),Mp=Dr([(e,t)=>t,Qa,dd,md,sp,dp,Ap,La],(e,t,n,r,a,i,o,s)=>{if(e&&t&&r&&a&&i){var l=function(e,t,n,r,a){return"horizontal"===n||"vertical"===n?e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height?{x:e,y:t}:null:r?la({x:e,y:t},r):null}(e.chartX,e.chartY,t,n,s);if(l){var c=((e,t)=>"horizontal"===t?e.x:"vertical"===t?e.y:"centric"===t?e.angle:e.radius)(l,t),u=((e,t,n,r,a)=>{var i,o=-1,s=null!==(i=null===t||void 0===t?void 0:t.length)&&void 0!==i?i:0;if(s<=1||null==e)return 0;if("angleAxis"===r&&null!=a&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<s;l++){var c=l>0?n[l-1].coordinate:n[s-1].coordinate,u=n[l].coordinate,d=l>=s-1?n[0].coordinate:n[l+1].coordinate,h=void 0;if(D(u-c)!==D(d-u)){var f=[];if(D(d-u)===D(a[1]-a[0])){h=d;var p=u+a[1]-a[0];f[0]=Math.min(p,(p+c)/2),f[1]=Math.max(p,(p+c)/2)}else{h=c;var m=d+a[1]-a[0];f[0]=Math.min(u,(m+u)/2),f[1]=Math.max(u,(m+u)/2)}var g=[Math.min(u,(h+u)/2),Math.max(u,(h+u)/2)];if(e>g[0]&&e<=g[1]||e>=f[0]&&e<=f[1]){({index:o}=n[l]);break}}else{var v=Math.min(c,d),y=Math.max(c,d);if(e>(v+u)/2&&e<=(y+u)/2){({index:o}=n[l]);break}}}else if(t)for(var b=0;b<s;b++)if(0===b&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b>0&&b<s-1&&e>(t[b].coordinate+t[b-1].coordinate)/2&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b===s-1&&e>(t[b].coordinate+t[b-1].coordinate)/2){({index:o}=t[b]);break}return o})(c,o,i,r,a),d=((e,t,n,r)=>{var a=t.find(e=>e&&e.index===n);if(a){if("horizontal"===e)return{x:a.coordinate,y:r.y};if("vertical"===e)return{x:r.x,y:a.coordinate};if("centric"===e){var i=a.coordinate,{radius:o}=r;return da(da(da({},r),aa(r.cx,r.cy,o,i)),{},{angle:i,radius:o})}var s=a.coordinate,{angle:l}=r;return da(da(da({},r),aa(r.cx,r.cy,s,l)),{},{angle:l,radius:s})}return{x:0,y:0}})(t,i,u,l);return{activeIndex:String(u),activeCoordinate:d}}}}),Fp=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,r=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/r)}},Lp=rt("mouseClick"),Bp=Qt();Bp.startListening({actionCreator:Lp,effect:(e,t)=>{var n=e.payload,r=Mp(t.getState(),Fp(n));null!=(null===r||void 0===r?void 0:r.activeIndex)&&t.dispatch(hr({activeIndex:r.activeIndex,activeDataKey:void 0,activeCoordinate:r.activeCoordinate}))}});var Up=rt("mouseMove"),zp=Qt();function Vp(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}function Wp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function qp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wp(Object(n),!0).forEach(function(t){Hp(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wp(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Hp(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}zp.startListening({actionCreator:Up,effect:(e,t)=>{var n=e.payload,r=t.getState(),a=bf(r,r.tooltip.settings.shared),i=Mp(r,Fp(n));"axis"===a&&(null!=(null===i||void 0===i?void 0:i.activeIndex)?t.dispatch(dr({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(cr()))}});var Gp=vt({name:"cartesianAxis",initialState:{xAxis:{},yAxis:{},zAxis:{}},reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:n,width:r}=t.payload;e.yAxis[n]&&(e.yAxis[n]=qp(qp({},e.yAxis[n]),{},{width:r}))}}}),{addXAxis:Kp,removeXAxis:Xp,addYAxis:Yp,removeYAxis:Qp,addZAxis:$p,removeZAxis:Jp,updateYAxisWidth:Zp}=Gp.actions,em=Gp.reducer,tm=vt({name:"graphicalItems",initialState:{cartesianItems:[],polarItems:[]},reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:n,next:r}=t.payload,a=$e(e).cartesianItems.indexOf(n);a>-1&&(e.cartesianItems[a]=r)},removeCartesianGraphicalItem(e,t){var n=$e(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var n=$e(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)}}}),{addCartesianGraphicalItem:nm,replaceCartesianGraphicalItem:rm,removeCartesianGraphicalItem:am,addPolarGraphicalItem:im,removePolarGraphicalItem:om}=tm.actions,sm=tm.reducer,lm=vt({name:"referenceElements",initialState:{dots:[],areas:[],lines:[]},reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=$e(e).dots.findIndex(e=>e===t.payload);-1!==n&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=$e(e).areas.findIndex(e=>e===t.payload);-1!==n&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=$e(e).lines.findIndex(e=>e===t.payload);-1!==n&&e.lines.splice(n,1)}}}),{addDot:cm,removeDot:um,addArea:dm,removeArea:hm,addLine:fm,removeLine:pm}=lm.actions,mm=lm.reducer,gm={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},vm=vt({name:"brush",initialState:gm,reducers:{setBrushSettings:(e,t)=>null==t.payload?gm:t.payload}}),{setBrushSettings:ym}=vm.actions,bm=vm.reducer,xm=vt({name:"legend",initialState:{settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var n=$e(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)}}}),{setLegendSize:wm,setLegendSettings:Nm,addLegendPayload:Sm,removeLegendPayload:Em}=xm.actions,Cm=xm.reducer,km={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},Am=vt({name:"rootProps",initialState:km,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=null!==(n=t.payload.barGap)&&void 0!==n?n:km.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),_m=Am.reducer,{updateOptions:jm}=Am.actions,Im=vt({name:"polarAxis",initialState:{radiusAxis:{},angleAxis:{}},reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Tm,removeRadiusAxis:Om,addAngleAxis:Pm,removeAngleAxis:Dm}=Im.actions,Rm=Im.reducer,Mm=vt({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:Fm}=Mm.actions,Lm=Mm.reducer,Bm=rt("keyDown"),Um=rt("focus"),zm=Qt();zm.startListening({actionCreator:Bm,effect:(e,t)=>{var n=t.getState();if(!1!==n.rootProps.accessibilityLayer){var{keyboardInteraction:r}=n.tooltip,a=e.payload;if("ArrowRight"===a||"ArrowLeft"===a||"Enter"===a){var i=Number(Cf(r,Uf(n))),o=dp(n);if("Enter"!==a){var s=i+("ArrowRight"===a?1:-1)*("left-to-right"===mf(n)?1:-1);if(!(null==o||s>=o.length||s<0)){var l=Tp(n,"axis","hover",String(s));t.dispatch(pr({active:!0,activeIndex:s.toString(),activeDataKey:void 0,activeCoordinate:l}))}}else{var c=Tp(n,"axis","hover",String(r.index));t.dispatch(pr({active:!r.active,activeIndex:r.index,activeDataKey:r.dataKey,activeCoordinate:c}))}}}}}),zm.startListening({actionCreator:Um,effect:(e,t)=>{var n=t.getState();if(!1!==n.rootProps.accessibilityLayer){var{keyboardInteraction:r}=n.tooltip;if(!r.active&&null==r.index){var a=Tp(n,"axis","hover",String("0"));t.dispatch(pr({activeDataKey:void 0,active:!0,activeIndex:"0",activeCoordinate:a}))}}}});var Vm=rt("externalEvent"),Wm=Qt();Wm.startListening({actionCreator:Vm,effect:(e,t)=>{if(null!=e.payload.handler){var n=t.getState(),r={activeCoordinate:wp(n),activeDataKey:yp(n),activeIndex:gp(n),activeLabel:vp(n),activeTooltipIndex:gp(n),isTooltipActive:Np(n)};e.payload.handler(r,e.payload.reactEvent)}}});var qm=Dr([jf],e=>e.tooltipItemPayloads),Hm=Dr([qm,_f,(e,t,n)=>t,(e,t,n)=>n],(e,t,n,r)=>{var a=e.find(e=>e.settings.dataKey===r);if(null!=a){var{positions:i}=a;if(null!=i)return t(i,n)}}),Gm=rt("touchMove"),Km=Qt();Km.startListening({actionCreator:Gm,effect:(e,t)=>{var n=e.payload,r=t.getState(),a=bf(r,r.tooltip.settings.shared);if("axis"===a){var i=Mp(r,Fp({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));null!=(null===i||void 0===i?void 0:i.activeIndex)&&t.dispatch(dr({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if("item"===a){var o,s=n.touches[0],l=document.elementFromPoint(s.clientX,s.clientY);if(!l||!l.getAttribute)return;var c=l.getAttribute(Pa),u=null!==(o=l.getAttribute(Da))&&void 0!==o?o:void 0,d=Hm(t.getState(),c,u);t.dispatch(sr({activeDataKey:u,activeIndex:c,activeCoordinate:d}))}}});var Xm=vt({name:"errorBars",initialState:{},reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]||(e[n]=[]),e[n].push(r)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:r,next:a}=t.payload;e[n]&&(e[n]=e[n].map(e=>e.dataKey===r.dataKey&&e.direction===r.direction?a:e))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]&&(e[n]=e[n].filter(e=>e.dataKey!==r.dataKey||e.direction!==r.direction))}}}),{addErrorBar:Ym,replaceErrorBar:Qm,removeErrorBar:$m}=Xm.actions,Jm=ie({brush:bm,cartesianAxis:em,chartData:xr,errorBars:Xm.reducer,graphicalItems:sm,layout:kr,legend:Cm,options:en,polarAxis:Rm,polarOptions:Lm,referenceElements:mm,rootProps:_m,tooltip:mr});function Zm(e){var{preloadedState:t,children:n,reduxStoreName:r}=e,i=Va(),o=(0,a.useRef)(null);if(i)return n;null==o.current&&(o.current=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Chart";return ut({reducer:Jm,preloadedState:e,middleware:e=>e({serializableCheck:!1}).concat([Bp.middleware,zp.middleware,zm.middleware,Wm.middleware,Km.middleware]),devTools:!!window.RECHARTS_DEV_TOOLS_ENABLED&&{serialize:{replacer:Vp},name:"recharts-".concat(t)}})}(t,r));var s=Fr;return a.createElement(fn,{context:s,store:o.current},n)}var eg=e=>{var{chartData:t}=e,n=Br(),r=Va();return(0,a.useEffect)(()=>r?()=>{}:(n(vr(t)),()=>{n(vr(void 0))}),[t,n,r]),null};function tg(e){var{layout:t,width:n,height:r,margin:i}=e,o=Br(),s=Va();return(0,a.useEffect)(()=>{s||(o(Sr(t)),o(Er({width:n,height:r})),o(Nr(i)))},[o,s,t,n,r,i]),null}function ng(e){var t=Br();return(0,a.useEffect)(()=>{t(jm(e))},[t,e]),null}var rg=()=>Wr(e=>e.rootProps.accessibilityLayer),ag=n(2086),ig=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function og(e){return"string"===typeof e&&ig.includes(e)}var sg=["points","pathLength"],lg={svg:["viewBox","children"],polygon:sg,polyline:sg},cg=(e,t,n)=>{if(null===e||"object"!==typeof e&&"function"!==typeof e)return null;var r=null;return Object.keys(e).forEach(a=>{var i=e[a];og(a)&&"function"===typeof i&&(r||(r={}),r[a]=((e,t,n)=>r=>(e(t,n,r),null))(i,t,n))}),r},ug=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function dg(e){return"string"===typeof e&&ug.includes(e)}function hg(e){var t=Object.entries(e).filter(e=>{var[t]=e;return dg(t)});return Object.fromEntries(t)}var fg=e=>"string"===typeof e?e:e?e.displayName||e.name||"Component":"",pg=null,mg=null,gg=e=>{if(e===pg&&Array.isArray(mg))return mg;var t=[];return a.Children.forEach(e,e=>{q(e)||((0,ag.isFragment)(e)?t=t.concat(gg(e.props.children)):t.push(e))}),mg=t,pg=e,t};function vg(e,t){var n=[],r=[];return r=Array.isArray(t)?t.map(e=>fg(e)):[fg(t)],gg(e).forEach(e=>{var t=P()(e,"type.displayName")||P()(e,"type.name");-1!==r.indexOf(t)&&n.push(e)}),n}var yg=(e,t,n)=>{if(!e||"function"===typeof e||"boolean"===typeof e)return null;var r=e;if((0,a.isValidElement)(e)&&(r=e.props),"object"!==typeof r&&"function"!==typeof r)return null;var i={};return Object.keys(r).forEach(e=>{var a;((e,t,n,r)=>{var a;if("symbol"===typeof t||"number"===typeof t)return!0;var i=null!==(a=r&&(null===lg||void 0===lg?void 0:lg[r]))&&void 0!==a?a:[],o=t.startsWith("data-"),s="function"!==typeof e&&(Boolean(r)&&i.includes(t)||dg(t)),l=Boolean(n)&&og(t);return o||s||l})(null===(a=r)||void 0===a?void 0:a[e],e,t,n)&&(i[e]=r[e])}),i},bg=["children","width","height","viewBox","className","style","title","desc"];function xg(){return xg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xg.apply(null,arguments)}var wg=(0,a.forwardRef)((e,t)=>{var{children:n,width:r,height:i,viewBox:o,className:s,style:l,title:c,desc:u}=e,d=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,bg),h=o||{width:r,height:i,x:0,y:0},f=j("recharts-surface",s);return a.createElement("svg",xg({},yg(d,!0,"svg"),{className:f,width:r,height:i,style:l,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:t}),a.createElement("title",null,c),a.createElement("desc",null,u),n)}),Ng=["children"];function Sg(){return Sg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Sg.apply(null,arguments)}var Eg={width:"100%",height:"100%"},Cg=(0,a.forwardRef)((e,t)=>{var n=Xa(),r=Ya(),i=rg();if(!fu(n)||!fu(r))return null;var o,s,{children:l,otherAttributes:c,title:u,desc:d}=e;return o="number"===typeof c.tabIndex?c.tabIndex:i?0:void 0,s="string"===typeof c.role?c.role:i?"application":void 0,a.createElement(wg,Sg({},c,{title:u,desc:d,role:s,tabIndex:o,width:n,height:r,style:Eg,ref:t}),l)}),kg=e=>{var{children:t}=e,n=Wr(qa);if(!n)return null;var{width:r,height:i,y:o,x:s}=n;return a.createElement(wg,{width:r,height:i,x:s,y:o},t)},Ag=(0,a.forwardRef)((e,t)=>{var{children:n}=e,r=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Ng);return Va()?a.createElement(kg,null,n):a.createElement(Cg,Sg({ref:t},r),n)});var _g=new(n(8499)),jg="recharts.syncEvent.tooltip",Ig="recharts.syncEvent.brush";function Tg(e){return e.tooltip.syncInteraction}var Og=["x","y"];function Pg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Dg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pg(Object(n),!0).forEach(function(t){Rg(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Rg(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mg=()=>{};function Fg(){var e=Wr(Uu),t=Wr(Vu),n=Br(),r=Wr(zu),i=Wr(dp),o=$a(),s=Ha(),l=Wr(e=>e.rootProps.className);(0,a.useEffect)(()=>{if(null==e)return Mg;var a=(a,l,c)=>{var u;if(t!==c&&e===a)if("index"!==r){if(null!=i){var d;if("function"===typeof r){var h={activeTooltipIndex:null==l.payload.index?void 0:Number(l.payload.index),isTooltipActive:l.payload.active,activeIndex:null==l.payload.index?void 0:Number(l.payload.index),activeLabel:l.payload.label,activeDataKey:l.payload.dataKey,activeCoordinate:l.payload.coordinate},f=r(i,h);d=i[f]}else"value"===r&&(d=i.find(e=>String(e.value)===l.payload.label));var{coordinate:p}=l.payload;if(null!=d&&!1!==l.payload.active&&null!=p&&null!=s){var{x:m,y:g}=p,v=Math.min(m,s.x+s.width),y=Math.min(g,s.y+s.height),b={x:"horizontal"===o?d.coordinate:v,y:"horizontal"===o?y:d.coordinate},x=fr({active:l.payload.active,coordinate:b,dataKey:l.payload.dataKey,index:String(d.index),label:l.payload.label});n(x)}else n(fr({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}))}}else if(s&&null!==l&&void 0!==l&&null!==(u=l.payload)&&void 0!==u&&u.coordinate){var w=l.payload.coordinate,{x:N,y:S}=w,E=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(w,Og),C=Dg(Dg(Dg({},E),"number"===typeof N&&{x:Math.max(s.x,Math.min(N,s.x+s.width))}),"number"===typeof S&&{y:Math.max(s.y,Math.min(S,s.y+s.height))}),k=Dg(Dg({},l),{},{payload:Dg(Dg({},l.payload),{},{coordinate:C})});n(k)}else n(l)};return _g.on(jg,a),()=>{_g.off(jg,a)}},[l,n,t,e,r,i,o,s])}function Lg(){var e=Br();(0,a.useEffect)(()=>{e(tn())},[e]),Fg(),function(){var e=Wr(Uu),t=Wr(Vu),n=Br();(0,a.useEffect)(()=>{if(null==e)return Mg;var r=(r,a,i)=>{t!==i&&e===r&&n(yr(a))};return _g.on(Ig,r),()=>{_g.off(Ig,r)}},[n,t,e])}()}function Bg(e,t,n,r,i,o){var s=Wr(n=>((e,t,n)=>{if(null!=t){var r=jf(e);return"axis"===t?"hover"===n?r.axisInteraction.hover.dataKey:r.axisInteraction.click.dataKey:"hover"===n?r.itemInteraction.hover.dataKey:r.itemInteraction.click.dataKey}})(n,e,t)),l=Wr(Vu),c=Wr(Uu),u=Wr(zu),d=Wr(Tg),h=null===d||void 0===d?void 0:d.active;(0,a.useEffect)(()=>{if(!h&&null!=c&&null!=l){var e=fr({active:o,coordinate:n,dataKey:s,index:i,label:"number"===typeof r?String(r):r});_g.emit(jg,c,e,l)}},[h,n,s,i,r,l,c,u,o])}var Ug=(0,a.createContext)(null),zg=(0,a.createContext)(null);function Vg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Wg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vg(Object(n),!0).forEach(function(t){qg(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function qg(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Hg=(0,a.forwardRef)((e,t)=>{var{children:n,className:r,height:i,onClick:o,onContextMenu:s,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:h,onMouseUp:f,onTouchEnd:p,onTouchMove:m,onTouchStart:g,style:v,width:y}=e,b=Br(),[x,w]=(0,a.useState)(null),[N,S]=(0,a.useState)(null);Lg();var E=function(){var e=Br(),[t,n]=(0,a.useState)(null),r=Wr(ja);return(0,a.useEffect)(()=>{if(null!=t){var n=t.getBoundingClientRect().width/t.offsetWidth;hu(n)&&n!==r&&e(Cr(n))}},[t,e,r]),n}(),C=(0,a.useCallback)(e=>{E(e),"function"===typeof t&&t(e),w(e),S(e)},[E,t,w,S]),k=(0,a.useCallback)(e=>{b(Lp(e)),b(Vm({handler:o,reactEvent:e}))},[b,o]),A=(0,a.useCallback)(e=>{b(Up(e)),b(Vm({handler:u,reactEvent:e}))},[b,u]),_=(0,a.useCallback)(e=>{b(cr()),b(Vm({handler:d,reactEvent:e}))},[b,d]),I=(0,a.useCallback)(e=>{b(Up(e)),b(Vm({handler:h,reactEvent:e}))},[b,h]),T=(0,a.useCallback)(()=>{b(Um())},[b]),O=(0,a.useCallback)(e=>{b(Bm(e.key))},[b]),P=(0,a.useCallback)(e=>{b(Vm({handler:s,reactEvent:e}))},[b,s]),D=(0,a.useCallback)(e=>{b(Vm({handler:l,reactEvent:e}))},[b,l]),R=(0,a.useCallback)(e=>{b(Vm({handler:c,reactEvent:e}))},[b,c]),M=(0,a.useCallback)(e=>{b(Vm({handler:f,reactEvent:e}))},[b,f]),F=(0,a.useCallback)(e=>{b(Vm({handler:g,reactEvent:e}))},[b,g]),L=(0,a.useCallback)(e=>{b(Gm(e)),b(Vm({handler:m,reactEvent:e}))},[b,m]),B=(0,a.useCallback)(e=>{b(Vm({handler:p,reactEvent:e}))},[b,p]);return a.createElement(Ug.Provider,{value:x},a.createElement(zg.Provider,{value:N},a.createElement("div",{className:j("recharts-wrapper",r),style:Wg({position:"relative",cursor:"default",width:y,height:i},v),onClick:k,onContextMenu:P,onDoubleClick:D,onFocus:T,onKeyDown:O,onMouseDown:R,onMouseEnter:A,onMouseLeave:_,onMouseMove:I,onMouseUp:M,onTouchEnd:B,onTouchMove:L,onTouchStart:F,ref:C},n)))}),Gg=Dr([La],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),Kg=Dr([Gg,Aa,_a],(e,t,n)=>{if(e&&null!=t&&null!=n)return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),Xg=()=>Wr(Kg),Yg=(0,a.createContext)(void 0),Qg=e=>{var{children:t}=e,[n]=(0,a.useState)("".concat(U("recharts"),"-clip")),r=Xg();if(null==r)return null;var{x:i,y:o,width:s,height:l}=r;return a.createElement(Yg.Provider,{value:n},a.createElement("defs",null,a.createElement("clipPath",{id:n},a.createElement("rect",{x:i,y:o,height:l,width:s}))),t)},$g=["children","className","width","height","style","compact","title","desc"];var Jg=(0,a.forwardRef)((e,t)=>{var{children:n,className:r,width:i,height:o,style:s,compact:l,title:c,desc:u}=e,d=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,$g),h=hg(d);return l?a.createElement(Ag,{otherAttributes:h,title:c,desc:u},n):a.createElement(Hg,{className:r,style:s,width:i,height:o,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},a.createElement(Ag,{otherAttributes:h,title:c,desc:u,ref:t},a.createElement(Qg,null,n)))});function Zg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ev(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tv(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zg(Object(n),!0).forEach(function(t){ev(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e),r=t;return Object.keys(t).reduce((e,t)=>(void 0===e[t]&&void 0!==r[t]&&(e[t]=r[t]),e),n)}var nv=["width","height"];function rv(){return rv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rv.apply(null,arguments)}var av={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},iv=(0,a.forwardRef)(function(e,t){var n,r=tv(e.categoricalChartProps,av),{width:i,height:o}=r,s=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(r,nv);if(!fu(i)||!fu(o))return null;var{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,categoricalChartProps:h}=e,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return a.createElement(Zm,{preloadedState:{options:f},reduxStoreName:null!==(n=h.id)&&void 0!==n?n:l},a.createElement(eg,{chartData:h.data}),a.createElement(tg,{width:i,height:o,layout:r.layout,margin:r.margin}),a.createElement(ng,{accessibilityLayer:r.accessibilityLayer,barCategoryGap:r.barCategoryGap,maxBarSize:r.maxBarSize,stackOffset:r.stackOffset,barGap:r.barGap,barSize:r.barSize,syncId:r.syncId,syncMethod:r.syncMethod,className:r.className}),a.createElement(Jg,rv({},s,{width:i,height:o,ref:t})))}),ov=["axis","item"],sv=(0,a.forwardRef)((e,t)=>a.createElement(iv,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:ov,tooltipPayloadSearcher:Jt,categoricalChartProps:e,ref:t})),lv=!("undefined"!==typeof window&&window.document&&Boolean(window.document.createElement)&&window.setTimeout);function cv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function dv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uv(Object(n),!0).forEach(function(t){hv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function hv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fv=dv({},{cacheSize:2e3,enableCache:!0}),pv=new class{constructor(e){cv(this,"cache",new Map),this.maxSize=e}get(e){var t=this.cache.get(e);return void 0!==t&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}clear(){this.cache.clear()}size(){return this.cache.size}}(fv.cacheSize),mv={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},gv="recharts_measurement_span";var vv=(e,t)=>{try{var n=document.getElementById(gv);n||((n=document.createElement("span")).setAttribute("id",gv),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,mv,t),n.textContent="".concat(e);var r=n.getBoundingClientRect();return{width:r.width,height:r.height}}catch(a){return{width:0,height:0}}},yv=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e||null===e||lv)return{width:0,height:0};if(!fv.enableCache)return vv(e,t);var n=function(e,t){var n=t.fontSize||"",r=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",o=t.letterSpacing||"",s=t.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(r,"|").concat(a,"|").concat(i,"|").concat(o,"|").concat(s)}(e,t),r=pv.get(n);if(r)return r;var a=vv(e,t);return pv.set(n,a),a};function bv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class xv{static create(e){return new xv(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:t,position:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0!==e){if(n)switch(n){case"start":default:return this.scale(e);case"middle":var r=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+r;case"end":var a=this.bandwidth?this.bandwidth():0;return this.scale(e)+a}if(t){var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+i}return this.scale(e)}}isInRange(e){var t=this.range(),n=t[0],r=t[t.length-1];return n<=r?e>=n&&e<=r:e>=r&&e<=n}}bv(xv,"EPS",1e-4);function wv(e,t,n){if(t<1)return[];if(1===t&&void 0===n)return e;for(var r=[],a=0;a<e.length;a+=t){if(void 0!==n&&!0!==n(e[a]))return;r.push(e[a])}return r}function Nv(e,t,n){return function(e){var{width:t,height:n}=e,r=function(e){return(e%180+180)%180}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),a=r*Math.PI/180,i=Math.atan(n/t),o=a>i&&a<Math.PI-i?n/Math.sin(a):t/Math.cos(a);return Math.abs(o)}({width:e.width+t.width,height:e.height+t.height},n)}function Sv(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var i=n();return e*(t-e*i/2-r)>=0&&e*(t+e*i/2-a)<=0}function Ev(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Cv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ev(Object(n),!0).forEach(function(t){kv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ev(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function kv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Av(e,t,n){var r,{tick:a,ticks:i,viewBox:o,minTickGap:s,orientation:l,interval:c,tickFormatter:u,unit:d,angle:h}=e;if(!i||!i.length||!a)return[];if(F(c)||lv)return null!==(r=function(e,t){return wv(e,t+1)}(i,F(c)?c:0))&&void 0!==r?r:[];var f=[],p="top"===l||"bottom"===l?"width":"height",m=d&&"width"===p?yv(d,{fontSize:t,letterSpacing:n}):{width:0,height:0},g=(e,r)=>{var a="function"===typeof u?u(e.value,r):e.value;return"width"===p?Nv(yv(a,{fontSize:t,letterSpacing:n}),m,h):yv(a,{fontSize:t,letterSpacing:n})[p]},v=i.length>=2?D(i[1].coordinate-i[0].coordinate):1,y=function(e,t,n){var r="width"===n,{x:a,y:i,width:o,height:s}=e;return 1===t?{start:r?a:i,end:r?a+o:i+s}:{start:r?a+o:i+s,end:r?a:i}}(o,v,p);return"equidistantPreserveStart"===c?function(e,t,n,r,a){for(var i,o=(r||[]).slice(),{start:s,end:l}=t,c=0,u=1,d=s,h=function(){var t=null===r||void 0===r?void 0:r[c];if(void 0===t)return{v:wv(r,u)};var i,o=c,h=()=>(void 0===i&&(i=n(t,o)),i),f=t.coordinate,p=0===c||Sv(e,f,h,d,l);p||(c=0,d=s,u+=1),p&&(d=f+e*(h()/2+a),c+=u)};u<=o.length;)if(i=h())return i.v;return[]}(v,y,g,i,s):(f="preserveStart"===c||"preserveStartEnd"===c?function(e,t,n,r,a,i){var o=(r||[]).slice(),s=o.length,{start:l,end:c}=t;if(i){var u=r[s-1],d=n(u,s-1),h=e*(u.coordinate+e*d/2-c);o[s-1]=u=Cv(Cv({},u),{},{tickCoord:h>0?u.coordinate-h*e:u.coordinate}),Sv(e,u.tickCoord,()=>d,l,c)&&(c=u.tickCoord-e*(d/2+a),o[s-1]=Cv(Cv({},u),{},{isShow:!0}))}for(var f=i?s-1:s,p=function(t){var r,i=o[t],s=()=>(void 0===r&&(r=n(i,t)),r);if(0===t){var u=e*(i.coordinate-e*s()/2-l);o[t]=i=Cv(Cv({},i),{},{tickCoord:u<0?i.coordinate-u*e:i.coordinate})}else o[t]=i=Cv(Cv({},i),{},{tickCoord:i.coordinate});Sv(e,i.tickCoord,s,l,c)&&(l=i.tickCoord+e*(s()/2+a),o[t]=Cv(Cv({},i),{},{isShow:!0}))},m=0;m<f;m++)p(m);return o}(v,y,g,i,s,"preserveStartEnd"===c):function(e,t,n,r,a){for(var i=(r||[]).slice(),o=i.length,{start:s}=t,{end:l}=t,c=function(t){var r,c=i[t],u=()=>(void 0===r&&(r=n(c,t)),r);if(t===o-1){var d=e*(c.coordinate+e*u()/2-l);i[t]=c=Cv(Cv({},c),{},{tickCoord:d>0?c.coordinate-d*e:c.coordinate})}else i[t]=c=Cv(Cv({},c),{},{tickCoord:c.coordinate});Sv(e,c.tickCoord,u,s,l)&&(l=c.tickCoord-e*(u()/2+a),i[t]=Cv(Cv({},c),{},{isShow:!0}))},u=o-1;u>=0;u--)c(u);return i}(v,y,g,i,s),f.filter(e=>e.isShow))}function _v(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}var jv=["children","className"];function Iv(){return Iv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Iv.apply(null,arguments)}var Tv=a.forwardRef((e,t)=>{var{children:n,className:r}=e,i=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,jv),o=j("recharts-layer",r);return a.createElement("g",Iv({className:o},yg(i,!0),{ref:t}),n)}),Ov=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Pv=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Dv=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Rv=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Mv={cm:96/2.54,mm:96/25.4,pt:96/72,pc:16,in:96,Q:96/101.6,px:1},Fv=Object.keys(Mv),Lv="NaN";class Bv{static parse(e){var t,[,n,r]=null!==(t=Rv.exec(e))&&void 0!==t?t:[];return new Bv(parseFloat(n),null!==r&&void 0!==r?r:"")}constructor(e,t){this.num=e,this.unit=t,this.num=e,this.unit=t,R(e)&&(this.unit=""),""===t||Dv.test(t)||(this.num=NaN,this.unit=""),Fv.includes(t)&&(this.num=function(e,t){return e*Mv[t]}(e,t),this.unit="px")}add(e){return this.unit!==e.unit?new Bv(NaN,""):new Bv(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new Bv(NaN,""):new Bv(this.num-e.num,this.unit)}multiply(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new Bv(NaN,""):new Bv(this.num*e.num,this.unit||e.unit)}divide(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new Bv(NaN,""):new Bv(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return R(this.num)}}function Uv(e){if(e.includes(Lv))return Lv;for(var t=e;t.includes("*")||t.includes("/");){var n,[,r,a,i]=null!==(n=Ov.exec(t))&&void 0!==n?n:[],o=Bv.parse(null!==r&&void 0!==r?r:""),s=Bv.parse(null!==i&&void 0!==i?i:""),l="*"===a?o.multiply(s):o.divide(s);if(l.isNaN())return Lv;t=t.replace(Ov,l.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var c,[,u,d,h]=null!==(c=Pv.exec(t))&&void 0!==c?c:[],f=Bv.parse(null!==u&&void 0!==u?u:""),p=Bv.parse(null!==h&&void 0!==h?h:""),m="+"===d?f.add(p):f.subtract(p);if(m.isNaN())return Lv;t=t.replace(Pv,m.toString())}return t}var zv=/\(([^()]*)\)/;function Vv(e){var t=e.replace(/\s+/g,"");return t=function(e){for(var t,n=e;null!=(t=zv.exec(n));){var[,r]=t;n=n.replace(zv,Uv(r))}return n}(t),t=Uv(t)}function Wv(e){var t=function(e){try{return Vv(e)}catch(t){return Lv}}(e.slice(5,-1));return t===Lv?"":t}var qv=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Hv=["dx","dy","angle","className","breakAll"];function Gv(){return Gv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Gv.apply(null,arguments)}function Kv(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Xv=/[ \f\n\r\t\v\u2028\u2029]+/,Yv=e=>{var{children:t,breakAll:n,style:r}=e;try{var a=[];return q(t)||(a=n?t.toString().split(""):t.toString().split(Xv)),{wordsWithComputedWidth:a.map(e=>({word:e,width:yv(e,r).width})),spaceWidth:n?0:yv("\xa0",r).width}}catch(i){return null}},Qv=e=>[{words:q(e)?[]:e.toString().split(Xv)}],$v=e=>{var{width:t,scaleToFit:n,children:r,style:a,breakAll:i,maxLines:o}=e;if((t||n)&&!lv){var s=Yv({breakAll:i,children:r,style:a});if(!s)return Qv(r);var{wordsWithComputedWidth:l,spaceWidth:c}=s;return((e,t,n,r,a)=>{var{maxLines:i,children:o,style:s,breakAll:l}=e,c=F(i),u=o,d=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((e,t)=>{var{word:i,width:o}=t,s=e[e.length-1];if(s&&(null==r||a||s.width+o+n<Number(r)))s.words.push(i),s.width+=o+n;else{var l={words:[i],width:o};e.push(l)}return e},[])},h=d(t),f=e=>e.reduce((e,t)=>e.width>t.width?e:t);if(!c||a)return h;if(!(h.length>i||f(h).width>Number(r)))return h;for(var p,m=e=>{var t=u.slice(0,e),n=Yv({breakAll:l,style:s,children:t+"\u2026"}).wordsWithComputedWidth,a=d(n);return[a.length>i||f(a).width>Number(r),a]},g=0,v=u.length-1,y=0;g<=v&&y<=u.length-1;){var b=Math.floor((g+v)/2),x=b-1,[w,N]=m(x),[S]=m(b);if(w||S||(g=b+1),w&&S&&(v=b-1),!w&&S){p=N;break}y++}return p||h})({breakAll:i,children:r,maxLines:o,style:a},l,c,t,n)}return Qv(r)},Jv="#808080",Zv=(0,a.forwardRef)((e,t)=>{var{x:n=0,y:r=0,lineHeight:i="1em",capHeight:o="0.71em",scaleToFit:s=!1,textAnchor:l="start",verticalAnchor:c="end",fill:u=Jv}=e,d=Kv(e,qv),h=(0,a.useMemo)(()=>$v({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:s,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,s,d.style,d.width]),{dx:f,dy:p,angle:m,className:g,breakAll:v}=d,y=Kv(d,Hv);if(!L(n)||!L(r)||0===h.length)return null;var b,x=n+(F(f)?f:0),w=r+(F(p)?p:0);switch(c){case"start":b=Wv("calc(".concat(o,")"));break;case"middle":b=Wv("calc(".concat((h.length-1)/2," * -").concat(i," + (").concat(o," / 2))"));break;default:b=Wv("calc(".concat(h.length-1," * -").concat(i,")"))}var N=[];if(s){var S=h[0].width,{width:E}=d;N.push("scale(".concat(F(E)?E/S:1,")"))}return m&&N.push("rotate(".concat(m,", ").concat(x,", ").concat(w,")")),N.length&&(y.transform=N.join(" ")),a.createElement("text",Gv({},yg(y,!0),{ref:t,x:x,y:w,className:j("recharts-text",g),textAnchor:l,fill:u.includes("url")?Jv:u}),h.map((e,t)=>{var n=e.words.join(v?"":" ");return a.createElement("tspan",{x:x,dy:0===t?b:i,key:"".concat(n,"-").concat(t)},n)}))});Zv.displayName="Text";var ey=["labelRef"];function ty(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ny(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ty(Object(n),!0).forEach(function(t){ry(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ty(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ry(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ay(){return ay=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ay.apply(null,arguments)}var iy=(0,a.createContext)(null),oy=e=>{var{x:t,y:n,width:r,height:i,children:o}=e,s=(0,a.useMemo)(()=>({x:t,y:n,width:r,height:i}),[t,n,r,i]);return a.createElement(iy.Provider,{value:s},o)},sy=()=>{var e=(0,a.useContext)(iy),t=Ha();return e||t},ly=(0,a.createContext)(null),cy=()=>{var e=(0,a.useContext)(ly),t=Wr(dd);return e||t},uy=e=>null!=e&&"function"===typeof e,dy=(e,t,n,r,i)=>{var o,s,{offset:l,className:c}=e,{cx:u,cy:d,innerRadius:h,outerRadius:f,startAngle:p,endAngle:m,clockWise:g}=i,v=(h+f)/2,y=((e,t)=>D(t-e)*Math.min(Math.abs(t-e),360))(p,m),b=y>=0?1:-1;switch(t){case"insideStart":o=p+b*l,s=g;break;case"insideEnd":o=m-b*l,s=!g;break;case"end":o=m+b*l,s=g;break;default:throw new Error("Unsupported position ".concat(t))}s=y<=0?s:!s;var x=aa(u,d,v,o),w=aa(u,d,v,o+359*(s?1:-1)),N="M".concat(x.x,",").concat(x.y,"\n    A").concat(v,",").concat(v,",0,1,").concat(s?0:1,",\n    ").concat(w.x,",").concat(w.y),S=q(e.id)?U("recharts-radial-line-"):e.id;return a.createElement("text",ay({},r,{dominantBaseline:"central",className:j("recharts-radial-bar-label",c)}),a.createElement("defs",null,a.createElement("path",{id:S,d:N})),a.createElement("textPath",{xlinkHref:"#".concat(S)},n))},hy=e=>"cx"in e&&F(e.cx),fy={offset:5};function py(e){var t=tv(e,fy),{viewBox:n,position:r,value:i,children:o,content:s,className:l="",textBreakAll:c,labelRef:u}=t,d=cy(),h=sy(),f=n||("center"===r?h:null!==d&&void 0!==d?d:h);if(!f||q(i)&&q(o)&&!(0,a.isValidElement)(s)&&"function"!==typeof s)return null;var p,m=ny(ny({},t),{},{viewBox:f});if((0,a.isValidElement)(s)){var{labelRef:g}=m,v=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(m,ey);return(0,a.cloneElement)(s,v)}if("function"===typeof s){if(p=(0,a.createElement)(s,m),(0,a.isValidElement)(p))return p}else p=(e=>{var{value:t,formatter:n}=e,r=q(e.children)?t:e.children;return"function"===typeof n?n(r):r})(t);var y=hy(f),b=yg(t,!0);if(y&&("insideStart"===r||"insideEnd"===r||"end"===r))return dy(t,r,p,b,f);var x=y?((e,t,n)=>{var{cx:r,cy:a,innerRadius:i,outerRadius:o,startAngle:s,endAngle:l}=e,c=(s+l)/2;if("outside"===n){var{x:u,y:d}=aa(r,a,o+t,c);return{x:u,y:d,textAnchor:u>=r?"start":"end",verticalAnchor:"middle"}}if("center"===n)return{x:r,y:a,textAnchor:"middle",verticalAnchor:"middle"};if("centerTop"===n)return{x:r,y:a,textAnchor:"middle",verticalAnchor:"start"};if("centerBottom"===n)return{x:r,y:a,textAnchor:"middle",verticalAnchor:"end"};var h=(i+o)/2,{x:f,y:p}=aa(r,a,h,c);return{x:f,y:p,textAnchor:"middle",verticalAnchor:"middle"}})(f,t.offset,t.position):((e,t)=>{var n,{parentViewBox:r,offset:a,position:i}=e;null==r||hy(r)||(n=r);var{x:o,y:s,width:l,height:c}=t,u=c>=0?1:-1,d=u*a,h=u>0?"end":"start",f=u>0?"start":"end",p=l>=0?1:-1,m=p*a,g=p>0?"end":"start",v=p>0?"start":"end";if("top"===i)return ny(ny({},{x:o+l/2,y:s-u*a,textAnchor:"middle",verticalAnchor:h}),n?{height:Math.max(s-n.y,0),width:l}:{});if("bottom"===i)return ny(ny({},{x:o+l/2,y:s+c+d,textAnchor:"middle",verticalAnchor:f}),n?{height:Math.max(n.y+n.height-(s+c),0),width:l}:{});if("left"===i){var y={x:o-m,y:s+c/2,textAnchor:g,verticalAnchor:"middle"};return ny(ny({},y),n?{width:Math.max(y.x-n.x,0),height:c}:{})}if("right"===i){var b={x:o+l+m,y:s+c/2,textAnchor:v,verticalAnchor:"middle"};return ny(ny({},b),n?{width:Math.max(n.x+n.width-b.x,0),height:c}:{})}var x=n?{width:l,height:c}:{};return"insideLeft"===i?ny({x:o+m,y:s+c/2,textAnchor:v,verticalAnchor:"middle"},x):"insideRight"===i?ny({x:o+l-m,y:s+c/2,textAnchor:g,verticalAnchor:"middle"},x):"insideTop"===i?ny({x:o+l/2,y:s+d,textAnchor:"middle",verticalAnchor:f},x):"insideBottom"===i?ny({x:o+l/2,y:s+c-d,textAnchor:"middle",verticalAnchor:h},x):"insideTopLeft"===i?ny({x:o+m,y:s+d,textAnchor:v,verticalAnchor:f},x):"insideTopRight"===i?ny({x:o+l-m,y:s+d,textAnchor:g,verticalAnchor:f},x):"insideBottomLeft"===i?ny({x:o+m,y:s+c-d,textAnchor:v,verticalAnchor:h},x):"insideBottomRight"===i?ny({x:o+l-m,y:s+c-d,textAnchor:g,verticalAnchor:h},x):i&&"object"===typeof i&&(F(i.x)||M(i.x))&&(F(i.y)||M(i.y))?ny({x:o+z(i.x,l),y:s+z(i.y,c),textAnchor:"end",verticalAnchor:"end"},x):ny({x:o+l/2,y:s+c/2,textAnchor:"middle",verticalAnchor:"middle"},x)})(t,f);return a.createElement(Zv,ay({ref:u,className:j("recharts-label",l)},b,x,{breakAll:c}),p)}py.displayName="Label";var my=(e,t,n)=>{if(!e)return null;var r={viewBox:t,labelRef:n};return!0===e?a.createElement(py,ay({key:"label-implicit"},r)):L(e)?a.createElement(py,ay({key:"label-implicit",value:e},r)):(0,a.isValidElement)(e)?e.type===py?(0,a.cloneElement)(e,ny({key:"label-implicit"},r)):a.createElement(py,ay({key:"label-implicit",content:e},r)):uy(e)?a.createElement(py,ay({key:"label-implicit",content:e},r)):e&&"object"===typeof e?a.createElement(py,ay({},e,{key:"label-implicit"},r)):null};function gy(e){var{label:t}=e,n=sy();return my(t,n)||null}var vy=["viewBox"],yy=["viewBox"];function by(){return by=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},by.apply(null,arguments)}function xy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function wy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xy(Object(n),!0).forEach(function(t){Sy(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xy(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ny(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Sy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ey extends a.Component{constructor(e){super(e),this.tickRefs=a.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(e,t){var{viewBox:n}=e,r=Ny(e,vy),a=this.props,{viewBox:i}=a,o=Ny(a,yy);return!_v(n,i)||!_v(r,o)||!_v(t,this.state)}getTickLineCoord(e){var t,n,r,a,i,o,{x:s,y:l,width:c,height:u,orientation:d,tickSize:h,mirror:f,tickMargin:p}=this.props,m=f?-1:1,g=e.tickSize||h,v=F(e.tickCoord)?e.tickCoord:e.coordinate;switch(d){case"top":t=n=e.coordinate,o=(r=(a=l+ +!f*u)-m*g)-m*p,i=v;break;case"left":r=a=e.coordinate,i=(t=(n=s+ +!f*c)-m*g)-m*p,o=v;break;case"right":r=a=e.coordinate,i=(t=(n=s+ +f*c)+m*g)+m*p,o=v;break;default:t=n=e.coordinate,o=(r=(a=l+ +f*u)+m*g)+m*p,i=v}return{line:{x1:t,y1:r,x2:n,y2:a},tick:{x:i,y:o}}}getTickTextAnchor(){var{orientation:e,mirror:t}=this.props;switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}getTickVerticalAnchor(){var{orientation:e,mirror:t}=this.props;switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}renderAxisLine(){var{x:e,y:t,width:n,height:r,orientation:i,mirror:o,axisLine:s}=this.props,l=wy(wy(wy({},yg(this.props,!1)),yg(s,!1)),{},{fill:"none"});if("top"===i||"bottom"===i){var c=+("top"===i&&!o||"bottom"===i&&o);l=wy(wy({},l),{},{x1:e,y1:t+c*r,x2:e+n,y2:t+c*r})}else{var u=+("left"===i&&!o||"right"===i&&o);l=wy(wy({},l),{},{x1:e+u*n,y1:t,x2:e+u*n,y2:t+r})}return a.createElement("line",by({},l,{className:j("recharts-cartesian-axis-line",P()(s,"className"))}))}static renderTickItem(e,t,n){var r,i=j(t.className,"recharts-cartesian-axis-tick-value");if(a.isValidElement(e))r=a.cloneElement(e,wy(wy({},t),{},{className:i}));else if("function"===typeof e)r=e(wy(wy({},t),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";"boolean"!==typeof e&&(o=j(o,e.className)),r=a.createElement(Zv,by({},t,{className:o}),n)}return r}renderTicks(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],{tickLine:r,stroke:i,tick:o,tickFormatter:s,unit:l,padding:c,tickTextProps:u}=this.props,d=Av(wy(wy({},this.props),{},{ticks:n}),e,t),h=this.getTickTextAnchor(),f=this.getTickVerticalAnchor(),p=hg(this.props),m=yg(o,!1),g=wy(wy({},p),{},{fill:"none"},yg(r,!1)),v=d.map((e,t)=>{var{line:n,tick:v}=this.getTickLineCoord(e),y=wy(wy(wy(wy({textAnchor:h,verticalAnchor:f},p),{},{stroke:"none",fill:i},m),v),{},{index:t,payload:e,visibleTicksCount:d.length,tickFormatter:s,padding:c},u);return a.createElement(Tv,by({className:"recharts-cartesian-axis-tick",key:"tick-".concat(e.value,"-").concat(e.coordinate,"-").concat(e.tickCoord)},cg(this.props,e,t)),r&&a.createElement("line",by({},g,n,{className:j("recharts-cartesian-axis-tick-line",P()(r,"className"))})),o&&Ey.renderTickItem(o,y,"".concat("function"===typeof s?s(e.value,t):e.value).concat(l||"")))});return v.length>0?a.createElement("g",{className:"recharts-cartesian-axis-ticks"},v):null}render(){var{axisLine:e,width:t,height:n,className:r,hide:i}=this.props;if(i)return null;var{ticks:o}=this.props;return null!=t&&t<=0||null!=n&&n<=0?null:a.createElement(Tv,{className:j("recharts-cartesian-axis",r),ref:e=>{if(e){var t=e.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(t);var n=t[0];if(n){var r=window.getComputedStyle(n).fontSize,a=window.getComputedStyle(n).letterSpacing;r===this.state.fontSize&&a===this.state.letterSpacing||this.setState({fontSize:window.getComputedStyle(n).fontSize,letterSpacing:window.getComputedStyle(n).letterSpacing})}}}},e&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,o),a.createElement(oy,{x:this.props.x,y:this.props.y,width:this.props.width,height:this.props.height},a.createElement(gy,{label:this.props.label}),this.props.children))}}Sy(Ey,"displayName","CartesianAxis"),Sy(Ey,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Cy=["x1","y1","x2","y2","key"],ky=["offset"],Ay=["xAxisId","yAxisId"],_y=["xAxisId","yAxisId"];function jy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Iy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jy(Object(n),!0).forEach(function(t){Ty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jy(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ty(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oy(){return Oy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Oy.apply(null,arguments)}function Py(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Dy=e=>{var{fill:t}=e;if(!t||"none"===t)return null;var{fillOpacity:n,x:r,y:i,width:o,height:s,ry:l}=e;return a.createElement("rect",{x:r,y:i,ry:l,width:o,height:s,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function Ry(e,t){var n;if(a.isValidElement(e))n=a.cloneElement(e,t);else if("function"===typeof e)n=e(t);else{var{x1:r,y1:i,x2:o,y2:s,key:l}=t,c=hg(Py(t,Cy)),{offset:u}=c,d=Py(c,ky);n=a.createElement("line",Oy({},d,{x1:r,y1:i,x2:o,y2:s,fill:"none",key:l}))}return n}function My(e){var{x:t,width:n,horizontal:r=!0,horizontalPoints:i}=e;if(!r||!i||!i.length)return null;var{xAxisId:o,yAxisId:s}=e,l=Py(e,Ay),c=i.map((e,a)=>{var i=Iy(Iy({},l),{},{x1:t,y1:e,x2:t+n,y2:e,key:"line-".concat(a),index:a});return Ry(r,i)});return a.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function Fy(e){var{y:t,height:n,vertical:r=!0,verticalPoints:i}=e;if(!r||!i||!i.length)return null;var{xAxisId:o,yAxisId:s}=e,l=Py(e,_y),c=i.map((e,a)=>{var i=Iy(Iy({},l),{},{x1:e,y1:t,x2:e,y2:t+n,key:"line-".concat(a),index:a});return Ry(r,i)});return a.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function Ly(e){var{horizontalFill:t,fillOpacity:n,x:r,y:i,width:o,height:s,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var u=l.map(e=>Math.round(e+i-i)).sort((e,t)=>e-t);i!==u[0]&&u.unshift(0);var d=u.map((e,l)=>{var c=!u[l+1]?i+s-e:u[l+1]-e;if(c<=0)return null;var d=l%t.length;return a.createElement("rect",{key:"react-".concat(l),y:e,x:r,height:c,width:o,stroke:"none",fill:t[d],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return a.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function By(e){var{vertical:t=!0,verticalFill:n,fillOpacity:r,x:i,y:o,width:s,height:l,verticalPoints:c}=e;if(!t||!n||!n.length)return null;var u=c.map(e=>Math.round(e+i-i)).sort((e,t)=>e-t);i!==u[0]&&u.unshift(0);var d=u.map((e,t)=>{var c=!u[t+1]?i+s-e:u[t+1]-e;if(c<=0)return null;var d=t%n.length;return a.createElement("rect",{key:"react-".concat(t),x:e,y:o,width:c,height:l,stroke:"none",fill:n[d],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return a.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var Uy=(e,t)=>{var{xAxis:n,width:r,height:a,offset:i}=e;return ma(Av(Iy(Iy(Iy({},Ey.defaultProps),n),{},{ticks:ga(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),i.left,i.left+i.width,t)},zy=(e,t)=>{var{yAxis:n,width:r,height:a,offset:i}=e;return ma(Av(Iy(Iy(Iy({},Ey.defaultProps),n),{},{ticks:ga(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),i.top,i.top+i.height,t)},Vy={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Wy(e){var t=Xa(),n=Ya(),r=Ka(),i=Iy(Iy({},tv(e,Vy)),{},{x:F(e.x)?e.x:r.left,y:F(e.y)?e.y:r.top,width:F(e.width)?e.width:r.width,height:F(e.height)?e.height:r.height}),{xAxisId:o,yAxisId:s,x:l,y:c,width:u,height:d,syncWithTicks:h,horizontalValues:f,verticalValues:p}=i,m=Va(),g=Wr(e=>uf(e,"xAxis",o,m)),v=Wr(e=>uf(e,"yAxis",s,m));if(!F(u)||u<=0||!F(d)||d<=0||!F(l)||l!==+l||!F(c)||c!==+c)return null;var y=i.verticalCoordinatesGenerator||Uy,b=i.horizontalCoordinatesGenerator||zy,{horizontalPoints:x,verticalPoints:w}=i;if((!x||!x.length)&&"function"===typeof b){var N=f&&f.length,S=b({yAxis:v?Iy(Iy({},v),{},{ticks:N?f:v.ticks}):void 0,width:t,height:n,offset:r},!!N||h);G(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof S,"]")),Array.isArray(S)&&(x=S)}if((!w||!w.length)&&"function"===typeof y){var E=p&&p.length,C=y({xAxis:g?Iy(Iy({},g),{},{ticks:E?p:g.ticks}):void 0,width:t,height:n,offset:r},!!E||h);G(Array.isArray(C),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof C,"]")),Array.isArray(C)&&(w=C)}return a.createElement("g",{className:"recharts-cartesian-grid"},a.createElement(Dy,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),a.createElement(Ly,Oy({},i,{horizontalPoints:x})),a.createElement(By,Oy({},i,{verticalPoints:w})),a.createElement(My,Oy({},i,{offset:r,horizontalPoints:x,xAxis:g,yAxis:v})),a.createElement(Fy,Oy({},i,{offset:r,verticalPoints:w,xAxis:g,yAxis:v})))}Wy.displayName="CartesianGrid";var qy=["children"],Hy=["dangerouslySetInnerHTML","ticks"],Gy=["id"];function Ky(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xy(){return Xy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xy.apply(null,arguments)}function Yy(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Qy(e){var t=Br(),n=(0,a.useMemo)(()=>{var{children:t}=e;return Yy(e,qy)},[e]);return(0,a.useEffect)(()=>(t(Kp(n)),()=>{t(Xp(n))}),[n,t]),e.children}var $y=e=>{var{xAxisId:t,className:n}=e,r=Wr(Ua),i=Va(),o="xAxis",s=Wr(e=>Kh(e,o,t,i)),l=Wr(e=>df(e,o,t,i)),c=Wr(e=>ef(e,t)),u=Wr(e=>((e,t)=>{var n=La(e),r=Ad(e,t);if(null!=r){var a=tf(e,r.orientation,r.mirror)[t];return null==a?{x:n.left,y:0}:{x:n.left,y:a}}})(e,t)),d=Wr(e=>kd(e,t));if(null==c||null==u||null==d)return null;var{dangerouslySetInnerHTML:h,ticks:f}=e,p=Yy(e,Hy),{id:m}=d,g=Yy(d,Gy);return a.createElement(Ey,Xy({},p,g,{scale:s,x:u.x,y:u.y,width:c.width,height:c.height,className:j("recharts-".concat(o," ").concat(o),n),viewBox:r,ticks:l}))},Jy=e=>{var t,n,r,i,o;return a.createElement(Qy,{interval:null!==(t=e.interval)&&void 0!==t?t:"preserveEnd",id:e.xAxisId,scale:e.scale,type:e.type,padding:e.padding,allowDataOverflow:e.allowDataOverflow,domain:e.domain,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,includeHidden:null!==(n=e.includeHidden)&&void 0!==n&&n,reversed:e.reversed,ticks:e.ticks,height:e.height,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:null!==(r=e.angle)&&void 0!==r?r:0,minTickGap:null!==(i=e.minTickGap)&&void 0!==i?i:5,tick:null===(o=e.tick)||void 0===o||o,tickFormatter:e.tickFormatter},a.createElement($y,e))};class Zy extends a.Component{render(){return a.createElement(Jy,this.props)}}Ky(Zy,"displayName","XAxis"),Ky(Zy,"defaultProps",{allowDataOverflow:Cd.allowDataOverflow,allowDecimals:Cd.allowDecimals,allowDuplicatedCategory:Cd.allowDuplicatedCategory,height:Cd.height,hide:!1,mirror:Cd.mirror,orientation:Cd.orientation,padding:Cd.padding,reversed:Cd.reversed,scale:Cd.scale,tickCount:Cd.tickCount,type:Cd.type,xAxisId:0});var eb=["dangerouslySetInnerHTML","ticks"],tb=["id"];function nb(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rb(){return rb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rb.apply(null,arguments)}function ab(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function ib(e){var t=Br();return(0,a.useEffect)(()=>(t(Yp(e)),()=>{t(Qp(e))}),[e,t]),null}var ob=e=>{var t,{yAxisId:n,className:r,width:i,label:o}=e,s=(0,a.useRef)(null),l=(0,a.useRef)(null),c=Wr(Ua),u=Va(),d=Br(),h="yAxis",f=Wr(e=>Kh(e,h,n,u)),p=Wr(e=>rf(e,n)),m=Wr(e=>((e,t)=>{var n=La(e),r=Id(e,t);if(null!=r){var a=nf(e,r.orientation,r.mirror)[t];return null==a?{x:0,y:n.top}:{x:a,y:n.top}}})(e,n)),g=Wr(e=>df(e,h,n,u)),v=Wr(e=>jd(e,n));if((0,a.useLayoutEffect)(()=>{var e;if("auto"===i&&p&&!uy(o)&&!(0,a.isValidElement)(o)&&null!=v){var t=s.current,r=null===t||void 0===t||null===(e=t.tickRefs)||void 0===e?void 0:e.current,{tickSize:c,tickMargin:u}=t.props,h=(e=>{var{ticks:t,label:n,labelGapWithTick:r=5,tickSize:a=0,tickMargin:i=0}=e,o=0;if(t){t.forEach(e=>{if(e){var t=e.getBoundingClientRect();t.width>o&&(o=t.width)}});var s=n?n.getBoundingClientRect().width:0,l=o+(a+i)+s+(n?r:0);return Math.round(l)}return 0})({ticks:r,label:l.current,labelGapWithTick:5,tickSize:c,tickMargin:u});Math.round(p.width)!==Math.round(h)&&d(Zp({id:n,width:h}))}},[s,null===s||void 0===s||null===(t=s.current)||void 0===t||null===(t=t.tickRefs)||void 0===t?void 0:t.current,null===p||void 0===p?void 0:p.width,p,d,o,n,i]),null==p||null==m||null==v)return null;var{dangerouslySetInnerHTML:y,ticks:b}=e,x=ab(e,eb),{id:w}=v,N=ab(v,tb);return a.createElement(Ey,rb({},x,N,{ref:s,labelRef:l,scale:f,x:m.x,y:m.y,tickTextProps:"auto"===i?{width:void 0}:{width:i},width:p.width,height:p.height,className:j("recharts-".concat(h," ").concat(h),r),viewBox:c,ticks:g}))},sb=e=>{var t,n,r,i,o;return a.createElement(a.Fragment,null,a.createElement(ib,{interval:null!==(t=e.interval)&&void 0!==t?t:"preserveEnd",id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:null!==(n=e.includeHidden)&&void 0!==n&&n,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:null!==(r=e.angle)&&void 0!==r?r:0,minTickGap:null!==(i=e.minTickGap)&&void 0!==i?i:5,tick:null===(o=e.tick)||void 0===o||o,tickFormatter:e.tickFormatter}),a.createElement(ob,e))},lb={allowDataOverflow:_d.allowDataOverflow,allowDecimals:_d.allowDecimals,allowDuplicatedCategory:_d.allowDuplicatedCategory,hide:!1,mirror:_d.mirror,orientation:_d.orientation,padding:_d.padding,reversed:_d.reversed,scale:_d.scale,tickCount:_d.tickCount,type:_d.type,width:_d.width,yAxisId:0};class cb extends a.Component{render(){return a.createElement(sb,this.props)}}nb(cb,"displayName","YAxis"),nb(cb,"defaultProps",lb);var ub=n(7950);function db(){return db=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},db.apply(null,arguments)}function hb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function fb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hb(Object(n),!0).forEach(function(t){pb(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hb(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function pb(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mb(e){return Array.isArray(e)&&L(e[0])&&L(e[1])?e.join(" ~ "):e}var gb=e=>{var{separator:t=" : ",contentStyle:n={},itemStyle:r={},labelStyle:i={},payload:o,formatter:s,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:h,accessibilityLayer:f=!1}=e,p=fb({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),m=fb({margin:0},i),g=!q(d),v=g?d:"",y=j("recharts-default-tooltip",c),b=j("recharts-tooltip-label",u);g&&h&&void 0!==o&&null!==o&&(v=h(d,o));var x=f?{role:"status","aria-live":"assertive"}:{};return a.createElement("div",db({className:y,style:p},x),a.createElement("p",{className:b,style:m},a.isValidElement(v)?v:"".concat(v)),(()=>{if(o&&o.length){var e=(l?Hr()(o,l):o).map((e,n)=>{if("none"===e.type)return null;var i=e.formatter||s||mb,{value:l,name:c}=e,u=l,d=c;if(i){var h=i(l,c,e,n,o);if(Array.isArray(h))[u,d]=h;else{if(null==h)return null;u=h}}var f=fb({display:"block",paddingTop:4,paddingBottom:4,color:e.color||"#000"},r);return a.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(n),style:f},L(d)?a.createElement("span",{className:"recharts-tooltip-item-name"},d):null,L(d)?a.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,a.createElement("span",{className:"recharts-tooltip-item-value"},u),a.createElement("span",{className:"recharts-tooltip-item-unit"},e.unit||""))});return a.createElement("ul",{className:"recharts-tooltip-item-list",style:{padding:0,margin:0}},e)}return null})())},vb="recharts-tooltip-wrapper",yb={visibility:"hidden"};function bb(e){var{coordinate:t,translateX:n,translateY:r}=e;return j(vb,{["".concat(vb,"-right")]:F(n)&&t&&F(t.x)&&n>=t.x,["".concat(vb,"-left")]:F(n)&&t&&F(t.x)&&n<t.x,["".concat(vb,"-bottom")]:F(r)&&t&&F(t.y)&&r>=t.y,["".concat(vb,"-top")]:F(r)&&t&&F(t.y)&&r<t.y})}function xb(e){var{allowEscapeViewBox:t,coordinate:n,key:r,offsetTopLeft:a,position:i,reverseDirection:o,tooltipDimension:s,viewBox:l,viewBoxDimension:c}=e;if(i&&F(i[r]))return i[r];var u=n[r]-s-(a>0?a:0),d=n[r]+a;if(t[r])return o[r]?u:d;var h=l[r];return null==h?0:o[r]?u<h?Math.max(d,h):Math.max(u,h):null==c?0:d+s>h+c?Math.max(u,h):Math.max(d,h)}function wb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Nb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wb(Object(n),!0).forEach(function(t){Sb(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wb(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Sb(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Eb extends a.PureComponent{constructor(){super(...arguments),Sb(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Sb(this,"handleKeyDown",e=>{var t,n,r,a;"Escape"===e.key&&this.setState({dismissed:!0,dismissedAtCoordinate:{x:null!==(t=null===(n=this.props.coordinate)||void 0===n?void 0:n.x)&&void 0!==t?t:0,y:null!==(r=null===(a=this.props.coordinate)||void 0===a?void 0:a.y)&&void 0!==r?r:0}})})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,t;this.state.dismissed&&((null===(e=this.props.coordinate)||void 0===e?void 0:e.x)===this.state.dismissedAtCoordinate.x&&(null===(t=this.props.coordinate)||void 0===t?void 0:t.y)===this.state.dismissedAtCoordinate.y||(this.state.dismissed=!1))}render(){var{active:e,allowEscapeViewBox:t,animationDuration:n,animationEasing:r,children:i,coordinate:o,hasPayload:s,isAnimationActive:l,offset:c,position:u,reverseDirection:d,useTranslate3d:h,viewBox:f,wrapperStyle:p,lastBoundingBox:m,innerRef:g,hasPortalFromProps:v}=this.props,{cssClasses:y,cssProperties:b}=function(e){var t,n,r,{allowEscapeViewBox:a,coordinate:i,offsetTopLeft:o,position:s,reverseDirection:l,tooltipBox:c,useTranslate3d:u,viewBox:d}=e;return t=c.height>0&&c.width>0&&i?function(e){var{translateX:t,translateY:n,useTranslate3d:r}=e;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}({translateX:n=xb({allowEscapeViewBox:a,coordinate:i,key:"x",offsetTopLeft:o,position:s,reverseDirection:l,tooltipDimension:c.width,viewBox:d,viewBoxDimension:d.width}),translateY:r=xb({allowEscapeViewBox:a,coordinate:i,key:"y",offsetTopLeft:o,position:s,reverseDirection:l,tooltipDimension:c.height,viewBox:d,viewBoxDimension:d.height}),useTranslate3d:u}):yb,{cssProperties:t,cssClasses:bb({translateX:n,translateY:r,coordinate:i})}}({allowEscapeViewBox:t,coordinate:o,offsetTopLeft:c,position:u,reverseDirection:d,tooltipBox:{height:m.height,width:m.width},useTranslate3d:h,viewBox:f}),x=v?{}:Nb(Nb({transition:l&&e?"transform ".concat(n,"ms ").concat(r):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&s?"visible":"hidden",position:"absolute",top:0,left:0}),w=Nb(Nb({},x),{},{visibility:!this.state.dismissed&&e&&s?"visible":"hidden"},p);return a.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:w,ref:g},i)}}var Cb=n(4332),kb=n.n(Cb);var Ab,_b,jb,Ib,Tb,Ob,Pb,Db,Rb,Mb,Fb,Lb,Bb,Ub;function zb(){}function Vb(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Wb(e){this._context=e}function qb(e){this._context=e}function Hb(e){this._context=e}Wb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Vb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Vb(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},qb.prototype={areaStart:zb,areaEnd:zb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Vb(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Hb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Vb(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};class Gb{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}function Kb(e){this._context=e}function Xb(e){this._context=e}function Yb(e){return new Xb(e)}function Qb(e){return e<0?-1:1}function $b(e,t,n){var r=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(r||a<0&&-0),o=(n-e._y1)/(a||r<0&&-0),s=(i*a+o*r)/(r+a);return(Qb(i)+Qb(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(s))||0}function Jb(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Zb(e,t,n){var r=e._x0,a=e._y0,i=e._x1,o=e._y1,s=(i-r)/3;e._context.bezierCurveTo(r+s,a+s*t,i-s,o-s*n,i,o)}function ex(e){this._context=e}function tx(e){this._context=new nx(e)}function nx(e){this._context=e}function rx(e){this._context=e}function ax(e){var t,n,r=e.length-1,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function ix(e,t){this._context=e,this._t=t}function ox(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Kb.prototype={areaStart:zb,areaEnd:zb,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},Xb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},ex.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Zb(this,this._t0,Jb(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Zb(this,Jb(this,n=$b(this,e,t)),n);break;default:Zb(this,this._t0,n=$b(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(tx.prototype=Object.create(ex.prototype)).point=function(e,t){ex.prototype.point.call(this,t,e)},nx.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,i){this._context.bezierCurveTo(t,e,r,n,i,a)}},rx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=ax(e),a=ax(t),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(r[0][i],a[0][i],r[1][i],a[1][i],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},ix.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const sx=Math.PI,lx=2*sx,cx=1e-6,ux=lx-cx;function dx(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class hx{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?dx:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return dx;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append(Ab||(Ab=ox(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(_b||(_b=ox(["Z"]))))}lineTo(e,t){this._append(jb||(jb=ox(["L",",",""])),this._x1=+e,this._y1=+t)}quadraticCurveTo(e,t,n,r){this._append(Ib||(Ib=ox(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}bezierCurveTo(e,t,n,r,a,i){this._append(Tb||(Tb=ox(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+a,this._y1=+i)}arcTo(e,t,n,r,a){if(e=+e,t=+t,n=+n,r=+r,(a=+a)<0)throw new Error("negative radius: ".concat(a));let i=this._x1,o=this._y1,s=n-e,l=r-t,c=i-e,u=o-t,d=c*c+u*u;if(null===this._x1)this._append(Ob||(Ob=ox(["M",",",""])),this._x1=e,this._y1=t);else if(d>cx)if(Math.abs(u*s-l*c)>cx&&a){let h=n-i,f=r-o,p=s*s+l*l,m=h*h+f*f,g=Math.sqrt(p),v=Math.sqrt(d),y=a*Math.tan((sx-Math.acos((p+d-m)/(2*g*v)))/2),b=y/v,x=y/g;Math.abs(b-1)>cx&&this._append(Db||(Db=ox(["L",",",""])),e+b*c,t+b*u),this._append(Rb||(Rb=ox(["A",",",",0,0,",",",",",""])),a,a,+(u*h>c*f),this._x1=e+x*s,this._y1=t+x*l)}else this._append(Pb||(Pb=ox(["L",",",""])),this._x1=e,this._y1=t);else;}arc(e,t,n,r,a,i){if(e=+e,t=+t,i=!!i,(n=+n)<0)throw new Error("negative radius: ".concat(n));let o=n*Math.cos(r),s=n*Math.sin(r),l=e+o,c=t+s,u=1^i,d=i?r-a:a-r;null===this._x1?this._append(Mb||(Mb=ox(["M",",",""])),l,c):(Math.abs(this._x1-l)>cx||Math.abs(this._y1-c)>cx)&&this._append(Fb||(Fb=ox(["L",",",""])),l,c),n&&(d<0&&(d=d%lx+lx),d>ux?this._append(Lb||(Lb=ox(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,u,e-o,t-s,n,n,u,this._x1=l,this._y1=c):d>cx&&this._append(Bb||(Bb=ox(["A",",",",0,",",",",",",",""])),n,n,+(d>=sx),u,this._x1=e+n*Math.cos(a),this._y1=t+n*Math.sin(a)))}rect(e,t,n,r){this._append(Ub||(Ub=ox(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}toString(){return this._}}function fx(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError("invalid digits: ".concat(n));t=e}return e},()=>new hx(t)}function px(e){return e[0]}function mx(e){return e[1]}function gx(e,t){var n=Yr(!0),r=null,a=Yb,i=null,o=fx(s);function s(s){var l,c,u,d=(s=Xr(s)).length,h=!1;for(null==r&&(i=a(u=o())),l=0;l<=d;++l)!(l<d&&n(c=s[l],l,s))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(c,l,s),+t(c,l,s));if(u)return i=null,u+""||null}return e="function"===typeof e?e:void 0===e?px:Yr(e),t="function"===typeof t?t:void 0===t?mx:Yr(t),s.x=function(t){return arguments.length?(e="function"===typeof t?t:Yr(+t),s):e},s.y=function(e){return arguments.length?(t="function"===typeof e?e:Yr(+e),s):t},s.defined=function(e){return arguments.length?(n="function"===typeof e?e:Yr(!!e),s):n},s.curve=function(e){return arguments.length?(a=e,null!=r&&(i=a(r)),s):a},s.context=function(e){return arguments.length?(null==e?r=i=null:i=a(r=e),s):r},s}function vx(e,t,n){var r=null,a=Yr(!0),i=null,o=Yb,s=null,l=fx(c);function c(c){var u,d,h,f,p,m=(c=Xr(c)).length,g=!1,v=new Array(m),y=new Array(m);for(null==i&&(s=o(p=l())),u=0;u<=m;++u){if(!(u<m&&a(f=c[u],u,c))===g)if(g=!g)d=u,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=u-1;h>=d;--h)s.point(v[h],y[h]);s.lineEnd(),s.areaEnd()}g&&(v[u]=+e(f,u,c),y[u]=+t(f,u,c),s.point(r?+r(f,u,c):v[u],n?+n(f,u,c):y[u]))}if(p)return s=null,p+""||null}function u(){return gx().defined(a).curve(o).context(i)}return e="function"===typeof e?e:void 0===e?px:Yr(+e),t="function"===typeof t?t:Yr(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?mx:Yr(+n),c.x=function(t){return arguments.length?(e="function"===typeof t?t:Yr(+t),r=null,c):e},c.x0=function(t){return arguments.length?(e="function"===typeof t?t:Yr(+t),c):e},c.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:Yr(+e),c):r},c.y=function(e){return arguments.length?(t="function"===typeof e?e:Yr(+e),n=null,c):t},c.y0=function(e){return arguments.length?(t="function"===typeof e?e:Yr(+e),c):t},c.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:Yr(+e),c):n},c.lineX0=c.lineY0=function(){return u().x(e).y(t)},c.lineY1=function(){return u().x(e).y(n)},c.lineX1=function(){return u().x(r).y(t)},c.defined=function(e){return arguments.length?(a="function"===typeof e?e:Yr(!!e),c):a},c.curve=function(e){return arguments.length?(o=e,null!=i&&(s=o(i)),c):o},c.context=function(e){return arguments.length?(null==e?i=s=null:s=o(i=e),c):i},c}function yx(){return yx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yx.apply(null,arguments)}function bx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bx(Object(n),!0).forEach(function(t){wx(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bx(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function wx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Nx={curveBasisClosed:function(e){return new qb(e)},curveBasisOpen:function(e){return new Hb(e)},curveBasis:function(e){return new Wb(e)},curveBumpX:function(e){return new Gb(e,!0)},curveBumpY:function(e){return new Gb(e,!1)},curveLinearClosed:function(e){return new Kb(e)},curveLinear:Yb,curveMonotoneX:function(e){return new ex(e)},curveMonotoneY:function(e){return new tx(e)},curveNatural:function(e){return new rx(e)},curveStep:function(e){return new ix(e,.5)},curveStepAfter:function(e){return new ix(e,1)},curveStepBefore:function(e){return new ix(e,0)}},Sx=e=>hu(e.x)&&hu(e.y),Ex=e=>e.x,Cx=e=>e.y,kx=e=>{var t,{type:n="linear",points:r=[],baseLine:a,layout:i,connectNulls:o=!1}=e,s=((e,t)=>{if("function"===typeof e)return e;var n="curve".concat(H(e));return"curveMonotone"!==n&&"curveBump"!==n||!t?Nx[n]||Yb:Nx["".concat(n).concat("vertical"===t?"Y":"X")]})(n,i),l=o?r.filter(Sx):r;if(Array.isArray(a)){var c=o?a.filter(e=>Sx(e)):a,u=l.map((e,t)=>xx(xx({},e),{},{base:c[t]}));return(t="vertical"===i?vx().y(Cx).x1(Ex).x0(e=>e.base.x):vx().x(Ex).y1(Cx).y0(e=>e.base.y)).defined(Sx).curve(s),t(u)}return(t="vertical"===i&&F(a)?vx().y(Cx).x1(Ex).x0(a):F(a)?vx().x(Ex).y1(Cx).y0(a):gx().x(Ex).y(Cx)).defined(Sx).curve(s),t(l)},Ax=e=>{var{className:t,points:n,path:r,pathRef:i}=e;if((!n||!n.length)&&!r)return null;var o=n&&n.length?kx(e):r;return a.createElement("path",yx({},hg(e),((e,t)=>{if(!e||"function"===typeof e||"boolean"===typeof e)return null;var n=e;if((0,a.isValidElement)(e)&&(n=e.props),"object"!==typeof n&&"function"!==typeof n)return null;var r={};return Object.keys(n).forEach(e=>{og(e)&&(r[e]=t||(t=>n[e](n,t)))}),r})(e),{className:j("recharts-curve",t),d:null===o?void 0:o,ref:i}))},_x=["x","y","top","left","width","height","className"];function jx(){return jx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jx.apply(null,arguments)}function Ix(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Tx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ox=(e,t,n,r,a,i)=>"M".concat(e,",").concat(a,"v").concat(r,"M").concat(i,",").concat(t,"h").concat(n),Px=e=>{var{x:t=0,y:n=0,top:r=0,left:i=0,width:o=0,height:s=0,className:l}=e,c=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,_x),u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ix(Object(n),!0).forEach(function(t){Tx(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ix(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({x:t,y:n,top:r,left:i,width:o,height:s},c);return F(t)&&F(n)&&F(o)&&F(s)&&F(r)&&F(i)?a.createElement("path",jx({},yg(u,!0),{className:j("recharts-cross",l),d:Ox(t,n,o,s,r,i)})):null};function Dx(){}function Rx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Mx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rx(Object(n),!0).forEach(function(t){Fx(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rx(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Fx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Lx=(e,t,n)=>e.map(e=>{return"".concat((r=e,r.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())))," ").concat(t,"ms ").concat(n);var r}).join(","),Bx=(e,t)=>Object.keys(t).reduce((n,r)=>Mx(Mx({},n),{},{[r]:e(r,t[r])}),{});function Ux(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function zx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ux(Object(n),!0).forEach(function(t){Vx(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ux(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Vx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Wx=(e,t,n)=>e+(t-e)*n,qx=e=>{var{from:t,to:n}=e;return t!==n},Hx=(e,t,n)=>{var r=Bx((t,n)=>{if(qx(n)){var[r,a]=e(n.from,n.to,n.velocity);return zx(zx({},n),{},{from:r,velocity:a})}return n},t);return n<1?Bx((e,t)=>qx(t)?zx(zx({},t),{},{velocity:Wx(t.velocity,r[e].velocity,n),from:Wx(t.from,r[e].from,n)}):t,t):Hx(e,r,n-1)};function Gx(e,t,n,r,a,i){var o,s=r.reduce((n,r)=>zx(zx({},n),{},{[r]:{from:e[r],velocity:0,to:t[r]}}),{}),l=null,c=r=>{o||(o=r);var u=(r-o)/n.dt;s=Hx(n,s,u),a(zx(zx(zx({},e),t),Bx((e,t)=>t.from,s))),o=r,Object.values(s).filter(qx).length&&(l=i.setTimeout(c))};return()=>(l=i.setTimeout(c),()=>{l()})}const Kx=(e,t,n,r,a,i)=>{var o,s,l=(o=e,s=t,[Object.keys(o),Object.keys(s)].reduce((e,t)=>e.filter(e=>t.includes(e))));return!0===n.isStepper?Gx(e,t,n,l,a,i):function(e,t,n,r,a,i,o){var s,l=null,c=a.reduce((n,r)=>zx(zx({},n),{},{[r]:[e[r],t[r]]}),{}),u=a=>{s||(s=a);var d=(a-s)/r,h=Bx((e,t)=>Wx(...t,n(d)),c);if(i(zx(zx(zx({},e),t),h)),d<1)l=o.setTimeout(u);else{var f=Bx((e,t)=>Wx(...t,n(1)),c);i(zx(zx(zx({},e),t),f))}};return()=>(l=o.setTimeout(u),()=>{l()})}(e,t,n,r,l,a,i)};var Xx=1e-4,Yx=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],Qx=(e,t)=>e.map((e,n)=>e*t**n).reduce((e,t)=>e+t),$x=(e,t)=>n=>{var r=Yx(e,t);return Qx(r,n)},Jx=function(){for(var e,t,n,r,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];if(1===i.length)switch(i[0]){case"linear":[e,n,t,r]=[0,0,1,1];break;case"ease":[e,n,t,r]=[.25,.1,.25,1];break;case"ease-in":[e,n,t,r]=[.42,0,1,1];break;case"ease-out":[e,n,t,r]=[.42,0,.58,1];break;case"ease-in-out":[e,n,t,r]=[0,0,.58,1];break;default:var s=i[0].split("(");"cubic-bezier"===s[0]&&4===s[1].split(")")[0].split(",").length&&([e,n,t,r]=s[1].split(")")[0].split(",").map(e=>parseFloat(e)))}else 4===i.length&&([e,n,t,r]=i);var l,c,u=$x(e,t),d=$x(n,r),h=(l=e,c=t,e=>{var t=[...Yx(l,c).map((e,t)=>e*t).slice(1),0];return Qx(t,e)}),f=e=>e>1?1:e<0?0:e,p=e=>{for(var t=e>1?1:e,n=t,r=0;r<8;++r){var a=u(n)-t,i=h(n);if(Math.abs(a-t)<Xx||i<Xx)return d(n);n=f(n-a/i)}return d(n)};return p.isStepper=!1,p},Zx=e=>{if("string"===typeof e)switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Jx(e);case"spring":return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{stiff:t=100,damping:n=8,dt:r=17}=e,a=(e,a,i)=>{var o=i+(-(e-a)*t-i*n)*r/1e3,s=i*r/1e3+e;return Math.abs(s-a)<Xx&&Math.abs(o)<Xx?[a,0]:[s,o]};return a.isStepper=!0,a.dt=r,a}();default:if("cubic-bezier"===e.split("(")[0])return Jx(e)}return"function"===typeof e?e:null};class ew{setTimeout(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=performance.now(),r=null,a=i=>{i-n>=t?e(i):"function"===typeof requestAnimationFrame&&(r=requestAnimationFrame(a))};return r=requestAnimationFrame(a),()=>{cancelAnimationFrame(r)}}}function tw(){return function(e){var t=()=>null,n=!1,r=null,a=i=>{if(!n){if(Array.isArray(i)){if(!i.length)return;var o=i,[s,...l]=o;return"number"===typeof s?void(r=e.setTimeout(a.bind(null,l),s)):(a(s),void(r=e.setTimeout(a.bind(null,l))))}"string"===typeof i&&t(i),"object"===typeof i&&t(i),"function"===typeof i&&i()}};return{stop:()=>{n=!0},start:e=>{n=!1,r&&(r(),r=null),a(e)},subscribe:e=>(t=e,()=>{t=()=>null}),getTimeoutController:()=>e}}(new ew)}var nw=(0,a.createContext)(tw);var rw={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},aw={t:0},iw={t:1};function ow(e){var t=tv(e,rw),{isActive:n,canBegin:r,duration:i,easing:o,begin:s,onAnimationEnd:l,onAnimationStart:c,children:u}=t,d=function(e,t){var n=(0,a.useContext)(nw);return(0,a.useMemo)(()=>null!==t&&void 0!==t?t:n(e),[e,t,n])}(t.animationId,t.animationManager),[h,f]=(0,a.useState)(n?aw:iw),p=(0,a.useRef)(null);return(0,a.useEffect)(()=>{n||f(iw)},[n]),(0,a.useEffect)(()=>{if(!n||!r)return Dx;var e=Kx(aw,iw,Zx(o),i,f,d.getTimeoutController());return d.start([c,s,()=>{p.current=e()},i,l]),()=>{d.stop(),p.current&&p.current(),l()}},[n,r,i,o,s,c,l,d]),u(h.t)}function sw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"animation-",n=(0,a.useRef)(U(t)),r=(0,a.useRef)(e);return r.current!==e&&(n.current=U(t),r.current=e),n.current}function lw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function cw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lw(Object(n),!0).forEach(function(t){uw(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lw(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function uw(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dw(){return dw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dw.apply(null,arguments)}var hw=(e,t,n,r,a)=>{var i,o=Math.min(Math.abs(n)/2,Math.abs(r)/2),s=r>=0?1:-1,l=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0;if(o>0&&a instanceof Array){for(var u=[0,0,0,0],d=0;d<4;d++)u[d]=a[d]>o?o:a[d];i="M".concat(e,",").concat(t+s*u[0]),u[0]>0&&(i+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+l*u[0],",").concat(t)),i+="L ".concat(e+n-l*u[1],",").concat(t),u[1]>0&&(i+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,",\n        ").concat(e+n,",").concat(t+s*u[1])),i+="L ".concat(e+n,",").concat(t+r-s*u[2]),u[2]>0&&(i+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,",\n        ").concat(e+n-l*u[2],",").concat(t+r)),i+="L ".concat(e+l*u[3],",").concat(t+r),u[3]>0&&(i+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,",\n        ").concat(e,",").concat(t+r-s*u[3])),i+="Z"}else if(o>0&&a===+a&&a>0){var h=Math.min(o,a);i="M ".concat(e,",").concat(t+s*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+l*h,",").concat(t,"\n            L ").concat(e+n-l*h,",").concat(t,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+n,",").concat(t+s*h,"\n            L ").concat(e+n,",").concat(t+r-s*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+n-l*h,",").concat(t+r,"\n            L ").concat(e+l*h,",").concat(t+r,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e,",").concat(t+r-s*h," Z")}else i="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return i},fw={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},pw=e=>{var t=tv(e,fw),n=(0,a.useRef)(null),[r,i]=(0,a.useState)(-1);(0,a.useEffect)(()=>{if(n.current&&n.current.getTotalLength)try{var e=n.current.getTotalLength();e&&i(e)}catch(t){}},[]);var{x:o,y:s,width:l,height:c,radius:u,className:d}=t,{animationEasing:h,animationDuration:f,animationBegin:p,isAnimationActive:m,isUpdateAnimationActive:g}=t,v=(0,a.useRef)(l),y=(0,a.useRef)(c),b=(0,a.useRef)(o),x=(0,a.useRef)(s),w=sw((0,a.useMemo)(()=>({x:o,y:s,width:l,height:c,radius:u}),[o,s,l,c,u]),"rectangle-");if(o!==+o||s!==+s||l!==+l||c!==+c||0===l||0===c)return null;var N=j("recharts-rectangle",d);if(!g)return a.createElement("path",dw({},yg(t,!0),{className:N,d:hw(o,s,l,c,u)}));var S=v.current,E=y.current,C=b.current,k=x.current,A="0px ".concat(-1===r?1:r,"px"),_="".concat(r,"px 0px"),I=Lx(["strokeDasharray"],f,"string"===typeof h?h:void 0);return a.createElement(ow,{animationId:w,key:w,canBegin:r>0,duration:f,easing:h,isActive:g,begin:p},e=>{var r,i=W(S,l,e),d=W(E,c,e),h=W(C,o,e),f=W(k,s,e);return n.current&&(v.current=i,y.current=d,b.current=h,x.current=f),r=m?e>0?{transition:I,strokeDasharray:_}:{strokeDasharray:A}:{strokeDasharray:_},a.createElement("path",dw({},yg(t,!0),{className:N,d:hw(h,f,i,d,u),ref:n,style:cw(cw({},r),t.style)}))})};function mw(e){var{cx:t,cy:n,radius:r,startAngle:a,endAngle:i}=e;return{points:[aa(t,n,r,a),aa(t,n,r,i)],cx:t,cy:n,radius:r,startAngle:a,endAngle:i}}function gw(){return gw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gw.apply(null,arguments)}var vw=e=>{var{cx:t,cy:n,radius:r,angle:a,sign:i,isExternal:o,cornerRadius:s,cornerIsExternal:l}=e,c=s*(o?1:-1)+r,u=Math.asin(s/c)/na,d=l?a:a+i*u,h=l?a-i*u:a;return{center:aa(t,n,c,d),circleTangency:aa(t,n,r,d),lineTangency:aa(t,n,c*Math.cos(u*na),h),theta:u}},yw=e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:i,endAngle:o}=e,s=((e,t)=>D(t-e)*Math.min(Math.abs(t-e),359.999))(i,o),l=i+s,c=aa(t,n,a,i),u=aa(t,n,a,l),d="M ".concat(c.x,",").concat(c.y,"\n    A ").concat(a,",").concat(a,",0,\n    ").concat(+(Math.abs(s)>180),",").concat(+(i>l),",\n    ").concat(u.x,",").concat(u.y,"\n  ");if(r>0){var h=aa(t,n,r,i),f=aa(t,n,r,l);d+="L ".concat(f.x,",").concat(f.y,"\n            A ").concat(r,",").concat(r,",0,\n            ").concat(+(Math.abs(s)>180),",").concat(+(i<=l),",\n            ").concat(h.x,",").concat(h.y," Z")}else d+="L ".concat(t,",").concat(n," Z");return d},bw={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},xw=e=>{var t=tv(e,bw),{cx:n,cy:r,innerRadius:i,outerRadius:o,cornerRadius:s,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:h}=t;if(o<i||u===d)return null;var f,p=j("recharts-sector",h),m=o-i,g=z(s,m,0,!0);return f=g>0&&Math.abs(u-d)<360?(e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:a,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:s,startAngle:l,endAngle:c}=e,u=D(c-l),{circleTangency:d,lineTangency:h,theta:f}=vw({cx:t,cy:n,radius:a,angle:l,sign:u,cornerRadius:i,cornerIsExternal:s}),{circleTangency:p,lineTangency:m,theta:g}=vw({cx:t,cy:n,radius:a,angle:c,sign:-u,cornerRadius:i,cornerIsExternal:s}),v=s?Math.abs(l-c):Math.abs(l-c)-f-g;if(v<0)return o?"M ".concat(h.x,",").concat(h.y,"\n        a").concat(i,",").concat(i,",0,0,1,").concat(2*i,",0\n        a").concat(i,",").concat(i,",0,0,1,").concat(2*-i,",0\n      "):yw({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:l,endAngle:c});var y="M ".concat(h.x,",").concat(h.y,"\n    A").concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(d.x,",").concat(d.y,"\n    A").concat(a,",").concat(a,",0,").concat(+(v>180),",").concat(+(u<0),",").concat(p.x,",").concat(p.y,"\n    A").concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(m.x,",").concat(m.y,"\n  ");if(r>0){var{circleTangency:b,lineTangency:x,theta:w}=vw({cx:t,cy:n,radius:r,angle:l,sign:u,isExternal:!0,cornerRadius:i,cornerIsExternal:s}),{circleTangency:N,lineTangency:S,theta:E}=vw({cx:t,cy:n,radius:r,angle:c,sign:-u,isExternal:!0,cornerRadius:i,cornerIsExternal:s}),C=s?Math.abs(l-c):Math.abs(l-c)-w-E;if(C<0&&0===i)return"".concat(y,"L").concat(t,",").concat(n,"Z");y+="L".concat(S.x,",").concat(S.y,"\n      A").concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(N.x,",").concat(N.y,"\n      A").concat(r,",").concat(r,",0,").concat(+(C>180),",").concat(+(u>0),",").concat(b.x,",").concat(b.y,"\n      A").concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(x.x,",").concat(x.y,"Z")}else y+="L".concat(t,",").concat(n,"Z");return y})({cx:n,cy:r,innerRadius:i,outerRadius:o,cornerRadius:Math.min(g,m/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):yw({cx:n,cy:r,innerRadius:i,outerRadius:o,startAngle:u,endAngle:d}),a.createElement("path",gw({},yg(t,!0),{className:p,d:f}))};function ww(e,t,n){var r,a,i,o;if("horizontal"===e)i=r=t.x,a=n.top,o=n.top+n.height;else if("vertical"===e)o=a=t.y,r=n.left,i=n.left+n.width;else if(null!=t.cx&&null!=t.cy){if("centric"!==e)return mw(t);var{cx:s,cy:l,innerRadius:c,outerRadius:u,angle:d}=t,h=aa(s,l,c,d),f=aa(s,l,u,d);r=h.x,a=h.y,i=f.x,o=f.y}return[{x:r,y:a},{x:i,y:o}]}function Nw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Sw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nw(Object(n),!0).forEach(function(t){Ew(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nw(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ew(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Cw=()=>{var e=Wr(vd),t=Wr(dp),n=Wr(lp);return Ea(Sw(Sw({},e),{},{scale:n}),t)};function kw(){return kw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kw.apply(null,arguments)}function Aw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Aw(Object(n),!0).forEach(function(t){jw(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Aw(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function jw(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Iw(e){var t,n,{coordinate:r,payload:i,index:o,offset:s,tooltipAxisBandSize:l,layout:c,cursor:u,tooltipEventType:d,chartName:h}=e,f=r,p=i,m=o;if(!u||!f||"ScatterChart"!==h&&"axis"!==d)return null;if("ScatterChart"===h)t=f,n=Px;else if("BarChart"===h)t=function(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:"horizontal"===e?t.x-a:n.left+.5,y:"horizontal"===e?n.top+.5:t.y-a,width:"horizontal"===e?r:n.width-1,height:"horizontal"===e?n.height-1:r}}(c,f,s,l),n=pw;else if("radial"===c){var{cx:g,cy:v,radius:y,startAngle:b,endAngle:x}=mw(f);t={cx:g,cy:v,startAngle:b,endAngle:x,innerRadius:y,outerRadius:y},n=xw}else t={points:ww(c,f,s)},n=Ax;var w="object"===typeof u&&"className"in u?u.className:void 0,N=_w(_w(_w(_w({stroke:"#ccc",pointerEvents:"none"},s),t),yg(u,!1)),{},{payload:p,payloadIndex:m,className:j("recharts-tooltip-cursor",w)});return(0,a.isValidElement)(u)?(0,a.cloneElement)(u,N):(0,a.createElement)(n,N)}function Tw(e){var t=Cw(),n=Ka(),r=$a(),i=Wr(Bu);return a.createElement(Iw,kw({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:n,layout:r,tooltipAxisBandSize:t,chartName:i}))}function Ow(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Pw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ow(Object(n),!0).forEach(function(t){Dw(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ow(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Dw(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rw(e){return e.dataKey}var Mw=[],Fw={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!lv,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Lw(e){var t=tv(e,Fw),{active:n,allowEscapeViewBox:r,animationDuration:i,animationEasing:o,content:s,filterNull:l,isAnimationActive:c,offset:u,payloadUniqBy:d,position:h,reverseDirection:f,useTranslate3d:p,wrapperStyle:m,cursor:g,shared:v,trigger:y,defaultIndex:b,portal:x,axisId:w}=t,N=Br(),S="number"===typeof b?String(b):b;(0,a.useEffect)(()=>{N(or({shared:v,trigger:y,axisId:w,active:n,defaultIndex:S}))},[N,v,y,w,n,S]);var E=Ha(),C=rg(),k=function(e){return Wr(t=>bf(t,e))}(v),{activeIndex:A,isActive:_}=Wr(e=>Rp(e,k,y,S)),j=Wr(e=>Dp(e,k,y,S)),I=Wr(e=>Pp(e,k,y,S)),T=Wr(e=>Op(e,k,y,S)),O=j,P=(0,a.useContext)(Ug),D=null!==n&&void 0!==n?n:_,[R,M]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[t,n]=(0,a.useState)({height:0,left:0,top:0,width:0}),r=(0,a.useCallback)(e=>{if(null!=e){var r=e.getBoundingClientRect(),a={height:r.height,left:r.left,top:r.top,width:r.width};(Math.abs(a.height-t.height)>1||Math.abs(a.left-t.left)>1||Math.abs(a.top-t.top)>1||Math.abs(a.width-t.width)>1)&&n({height:a.height,left:a.left,top:a.top,width:a.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,r]}([O,D]),F="axis"===k?I:void 0;Bg(k,y,T,F,A,D);var L=null!==x&&void 0!==x?x:P;if(null==L)return null;var B=null!==O&&void 0!==O?O:Mw;D||(B=Mw),l&&B.length&&(B=function(e,t,n){return!0===t?kb()(e,n):"function"===typeof t?kb()(e,t):e}(O.filter(e=>null!=e.value&&(!0!==e.hide||t.includeHidden)),d,Rw));var U=B.length>0,z=a.createElement(Eb,{allowEscapeViewBox:r,animationDuration:i,animationEasing:o,isAnimationActive:c,active:D,coordinate:T,hasPayload:U,offset:u,position:h,reverseDirection:f,useTranslate3d:p,viewBox:E,wrapperStyle:m,lastBoundingBox:R,innerRef:M,hasPortalFromProps:Boolean(x)},function(e,t){return a.isValidElement(e)?a.cloneElement(e,t):"function"===typeof e?a.createElement(e,t):a.createElement(gb,t)}(s,Pw(Pw({},t),{},{payload:B,label:F,active:D,coordinate:T,accessibilityLayer:C})));return a.createElement(a.Fragment,null,(0,ub.createPortal)(z,L),D&&a.createElement(Tw,{cursor:g,tooltipEventType:k,coordinate:T,payload:O,index:A}))}var Bw=e=>null;Bw.displayName="Cell";var Uw=n(356),zw=n.n(Uw),Vw=["valueAccessor"],Ww=["dataKey","clockWise","id","textBreakAll"];function qw(){return qw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qw.apply(null,arguments)}function Hw(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Gw=e=>Array.isArray(e.value)?zw()(e.value):e.value,Kw=(0,a.createContext)(void 0),Xw=Kw.Provider,Yw=(0,a.createContext)(void 0),Qw=Yw.Provider;function $w(e){var{valueAccessor:t=Gw}=e,n=Hw(e,Vw),{dataKey:r,clockWise:i,id:o,textBreakAll:s}=n,l=Hw(n,Ww),c=(0,a.useContext)(Kw),u=(0,a.useContext)(Yw),d=c||u;return d&&d.length?a.createElement(Tv,{className:"recharts-label-list"},d.map((e,i)=>{var c,u=q(r)?t(e,i):fa(e&&e.payload,r),d=q(o)?{}:{id:"".concat(o,"-").concat(i)};return a.createElement(py,qw({},yg(e,!0),l,d,{fill:null!==(c=n.fill)&&void 0!==c?c:e.fill,parentViewBox:e.parentViewBox,value:u,textBreakAll:s,viewBox:e.viewBox,key:"label-".concat(i),index:i}))})):null}function Jw(e){var{label:t}=e;return t?!0===t?a.createElement($w,{key:"labelList-implicit"}):a.isValidElement(t)||uy(t)?a.createElement($w,{key:"labelList-implicit",content:t}):"object"===typeof t?a.createElement($w,qw({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}$w.displayName="LabelList";var Zw="Invariant failed";var eN=n(9397),tN=n.n(eN);function nN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function rN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nN(Object(n),!0).forEach(function(t){aN(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function aN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iN(){return iN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},iN.apply(null,arguments)}var oN=(e,t,n,r,a)=>{var i,o=n-r;return i="M ".concat(e,",").concat(t),i+="L ".concat(e+n,",").concat(t),i+="L ".concat(e+n-o/2,",").concat(t+a),i+="L ".concat(e+n-o/2-r,",").concat(t+a),i+="L ".concat(e,",").concat(t," Z")},sN={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},lN=e=>{var t=tv(e,sN),{x:n,y:r,upperWidth:i,lowerWidth:o,height:s,className:l}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:h}=t,f=(0,a.useRef)(),[p,m]=(0,a.useState)(-1),g=(0,a.useRef)(i),v=(0,a.useRef)(o),y=(0,a.useRef)(s),b=(0,a.useRef)(n),x=(0,a.useRef)(r),w=sw(e,"trapezoid-");if((0,a.useEffect)(()=>{if(f.current&&f.current.getTotalLength)try{var e=f.current.getTotalLength();e&&m(e)}catch(t){}},[]),n!==+n||r!==+r||i!==+i||o!==+o||s!==+s||0===i&&0===o||0===s)return null;var N=j("recharts-trapezoid",l);if(!h)return a.createElement("g",null,a.createElement("path",iN({},yg(t,!0),{className:N,d:oN(n,r,i,o,s)})));var S=g.current,E=v.current,C=y.current,k=b.current,A=x.current,_="0px ".concat(-1===p?1:p,"px"),I="".concat(p,"px 0px"),T=Lx(["strokeDasharray"],u,c);return a.createElement(ow,{animationId:w,key:w,canBegin:p>0,duration:u,easing:c,isActive:h,begin:d},e=>{var l=W(S,i,e),c=W(E,o,e),u=W(C,s,e),d=W(k,n,e),h=W(A,r,e);f.current&&(g.current=l,v.current=c,y.current=u,b.current=d,x.current=h);var p=e>0?{transition:T,strokeDasharray:I}:{strokeDasharray:_};return a.createElement("path",iN({},yg(t,!0),{className:N,d:oN(d,h,l,c,u),ref:f,style:rN(rN({},p),t.style)}))})};Math.abs,Math.atan2;const cN=Math.cos,uN=(Math.max,Math.min,Math.sin),dN=Math.sqrt,hN=Math.PI,fN=2*hN;const pN={draw(e,t){const n=dN(t/hN);e.moveTo(n,0),e.arc(0,0,n,0,fN)}},mN={draw(e,t){const n=dN(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},gN=dN(1/3),vN=2*gN,yN={draw(e,t){const n=dN(t/vN),r=n*gN;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},bN={draw(e,t){const n=dN(t),r=-n/2;e.rect(r,r,n,n)}},xN=uN(hN/10)/uN(7*hN/10),wN=uN(fN/10)*xN,NN=-cN(fN/10)*xN,SN={draw(e,t){const n=dN(.8908130915292852*t),r=wN*n,a=NN*n;e.moveTo(0,-n),e.lineTo(r,a);for(let i=1;i<5;++i){const t=fN*i/5,o=cN(t),s=uN(t);e.lineTo(s*n,-o*n),e.lineTo(o*r-s*a,s*r+o*a)}e.closePath()}},EN=dN(3),CN={draw(e,t){const n=-dN(t/(3*EN));e.moveTo(0,2*n),e.lineTo(-EN*n,-n),e.lineTo(EN*n,-n),e.closePath()}},kN=-.5,AN=dN(3)/2,_N=1/dN(12),jN=3*(_N/2+1),IN={draw(e,t){const n=dN(t/jN),r=n/2,a=n*_N,i=r,o=n*_N+n,s=-i,l=o;e.moveTo(r,a),e.lineTo(i,o),e.lineTo(s,l),e.lineTo(kN*r-AN*a,AN*r+kN*a),e.lineTo(kN*i-AN*o,AN*i+kN*o),e.lineTo(kN*s-AN*l,AN*s+kN*l),e.lineTo(kN*r+AN*a,kN*a-AN*r),e.lineTo(kN*i+AN*o,kN*o-AN*i),e.lineTo(kN*s+AN*l,kN*l-AN*s),e.closePath()}};dN(3),dN(3);var TN=["type","size","sizeType"];function ON(){return ON=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ON.apply(null,arguments)}function PN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function DN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?PN(Object(n),!0).forEach(function(t){RN(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function RN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var MN={symbolCircle:pN,symbolCross:mN,symbolDiamond:yN,symbolSquare:bN,symbolStar:SN,symbolTriangle:CN,symbolWye:IN},FN=Math.PI/180,LN=e=>{var{type:t="circle",size:n=64,sizeType:r="area"}=e,i=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,TN),o=DN(DN({},i),{},{type:t,size:n,sizeType:r}),s="circle";"string"===typeof t&&(s=t);var{className:l,cx:c,cy:u}=o,d=yg(o,!0);return c===+c&&u===+u&&n===+n?a.createElement("path",ON({},d,{className:j("recharts-symbols",l),transform:"translate(".concat(c,", ").concat(u,")"),d:(()=>{var e=(e=>{var t="symbol".concat(H(e));return MN[t]||pN})(s),t=function(e,t){let n=null,r=fx(a);function a(){let a;if(n||(n=a=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),a)return n=null,a+""||null}return e="function"===typeof e?e:Yr(e||pN),t="function"===typeof t?t:Yr(void 0===t?64:+t),a.type=function(t){return arguments.length?(e="function"===typeof t?t:Yr(t),a):e},a.size=function(e){return arguments.length?(t="function"===typeof e?e:Yr(+e),a):t},a.context=function(e){return arguments.length?(n=null==e?null:e,a):n},a}().type(e).size(((e,t,n)=>{if("area"===t)return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return.5*e*e/Math.sqrt(3);case"square":return e*e;case"star":var r=18*FN;return 1.25*e*e*(Math.tan(r)-Math.tan(2*r)*Math.tan(r)**2);case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}})(n,r,s));return t()})()})):null};LN.registerSymbol=(e,t)=>{MN["symbol".concat(H(e))]=t};var BN=["option","shapeType","propTransformer","activeClassName","isActive"];function UN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function zN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?UN(Object(n),!0).forEach(function(t){VN(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function VN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WN(e,t){return zN(zN({},t),e)}function qN(e){var{shapeType:t,elementProps:n}=e;switch(t){case"rectangle":return a.createElement(pw,n);case"trapezoid":return a.createElement(lN,n);case"sector":return a.createElement(xw,n);case"symbols":if(function(e){return"symbols"===e}(t))return a.createElement(LN,n);break;default:return null}}function HN(e){var t,{option:n,shapeType:r,propTransformer:i=WN,activeClassName:o="recharts-active-shape",isActive:s}=e,l=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,BN);if((0,a.isValidElement)(n))t=(0,a.cloneElement)(n,zN(zN({},l),function(e){return(0,a.isValidElement)(e)?e.props:e}(n)));else if("function"===typeof n)t=n(l);else if(tN()(n)&&"boolean"!==typeof n){var c=i(n,l);t=a.createElement(qN,{shapeType:r,elementProps:c})}else{var u=l;t=a.createElement(qN,{shapeType:r,elementProps:u})}return s?a.createElement(Tv,{className:o},t):t}var GN=["x","y"];function KN(){return KN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},KN.apply(null,arguments)}function XN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function YN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?XN(Object(n),!0).forEach(function(t){QN(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function QN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $N(e,t){var{x:n,y:r}=e,a=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,GN),i="".concat(n),o=parseInt(i,10),s="".concat(r),l=parseInt(s,10),c="".concat(t.height||a.height),u=parseInt(c,10),d="".concat(t.width||a.width),h=parseInt(d,10);return YN(YN(YN(YN(YN({},t),a),o?{x:o}:{}),l?{y:l}:{}),{},{height:u,width:h,name:t.name,radius:t.radius})}function JN(e){return a.createElement(HN,KN({shapeType:"rectangle",propTransformer:$N,activeClassName:"recharts-active-bar"},e))}var ZN=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(n,r)=>{if(F(e))return e;var a=F(n)||q(n);return a?e(n,r):(a||function(e){if(!e)throw new Error(Zw)}(!1),t)}},eS=(e,t)=>{var n=Br();return(r,a)=>i=>{null===e||void 0===e||e(r,a,i),n(sr({activeIndex:String(a),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}},tS=e=>{var t=Br();return(n,r)=>a=>{null===e||void 0===e||e(n,r,a),t(lr())}},nS=(e,t)=>{var n=Br();return(r,a)=>i=>{null===e||void 0===e||e(r,a,i),n(ur({activeIndex:String(a),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}};function rS(e){var{fn:t,args:n}=e,r=Br(),i=Va();return(0,a.useEffect)(()=>{if(!i){var e=t(n);return r(ar(e)),()=>{r(ir(e))}}},[t,n,r,i]),null}var aS=["children"];var iS={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},oS=(0,a.createContext)(iS);function sS(e){var{children:t}=e,n=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,aS);return a.createElement(oS.Provider,{value:n},t)}function lS(e,t){var n,r,a=Wr(t=>Ad(t,e)),i=Wr(e=>Id(e,t)),o=null!==(n=null===a||void 0===a?void 0:a.allowDataOverflow)&&void 0!==n?n:Cd.allowDataOverflow,s=null!==(r=null===i||void 0===i?void 0:i.allowDataOverflow)&&void 0!==r?r:_d.allowDataOverflow;return{needClip:o||s,needClipX:o,needClipY:s}}function cS(e){var{xAxisId:t,yAxisId:n,clipPathId:r}=e,i=Xg(),{needClipX:o,needClipY:s,needClip:l}=lS(t,n);if(!l)return null;var{x:c,y:u,width:d,height:h}=i;return a.createElement("clipPath",{id:"clipPath-".concat(r)},a.createElement("rect",{x:o?c:c-d/2,y:s?u:u-h/2,width:o?d:2*d,height:s?h:2*h}))}function uS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function dS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uS(Object(n),!0).forEach(function(t){hS(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function hS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fS=Dr([Fd,(e,t,n,r,a)=>a],(e,t)=>e.filter(e=>"bar"===e.type).find(e=>e.id===t)),pS=Dr([fS],e=>null===e||void 0===e?void 0:e.maxBarSize),mS=(e,t,n)=>{var r=null!==n&&void 0!==n?n:e;if(!q(r))return z(r,t,0)},gS=Dr([Qa,Fd,(e,t)=>t,(e,t,n)=>n,(e,t,n,r)=>r],(e,t,n,r,a)=>t.filter(t=>"horizontal"===e?t.xAxisId===n:t.yAxisId===r).filter(e=>e.isPanorama===a).filter(e=>!1===e.hide).filter(e=>"bar"===e.type)),vS=Dr([gS,e=>e.rootProps.barSize,(e,t,n)=>"horizontal"===Qa(e)?af(e,"xAxis",t):af(e,"yAxis",n)],(e,t,n)=>{var r=e.filter(xd),a=e.filter(e=>null==e.stackId),i=r.reduce((e,t)=>(e[t.stackId]||(e[t.stackId]=[]),e[t.stackId].push(t),e),{}),o=Object.entries(i).map(e=>{var[r,a]=e;return{stackId:r,dataKeys:a.map(e=>e.dataKey),barSize:mS(t,n,a[0].barSize)}});return[...o,...a.map(e=>({stackId:void 0,dataKeys:[e.dataKey].filter(e=>null!=e),barSize:mS(t,n,e.barSize)}))]}),yS=(e,t,n,r)=>{var a,i;return"horizontal"===Qa(e)?(a=ff(e,"xAxis",t,r),i=hf(e,"xAxis",t,r)):(a=ff(e,"yAxis",n,r),i=hf(e,"yAxis",n,r)),Ea(a,i)};var bS,xS=Dr([vS,Mu,e=>e.rootProps.barGap,Fu,(e,t,n,r,a)=>{var i,o,s=fS(e,t,n,r,a);if(null!=s){var l,c,u=Qa(e),d=Mu(e),{maxBarSize:h}=s,f=q(h)?d:h;return"horizontal"===u?(l=ff(e,"xAxis",t,r),c=hf(e,"xAxis",t,r)):(l=ff(e,"yAxis",n,r),c=hf(e,"yAxis",n,r)),null!==(i=null!==(o=Ea(l,c,!0))&&void 0!==o?o:f)&&void 0!==i?i:0}},yS,pS],(e,t,n,r,a,i,o)=>{var s=q(o)?t:o,l=function(e,t,n,r,a){var i=r.length;if(!(i<1)){var o,s=z(e,n,0,!0),l=[];if(hu(r[0].barSize)){var c=!1,u=n/i,d=r.reduce((e,t)=>e+(t.barSize||0),0);(d+=(i-1)*s)>=n&&(d-=(i-1)*s,s=0),d>=n&&u>0&&(c=!0,d=i*(u*=.9));var h={offset:((n-d)/2|0)-s,size:0};o=r.reduce((e,t)=>{var n,r=[...e,{stackId:t.stackId,dataKeys:t.dataKeys,position:{offset:h.offset+h.size+s,size:c?u:null!==(n=t.barSize)&&void 0!==n?n:0}}];return h=r[r.length-1].position,r},l)}else{var f=z(t,n,0,!0);n-2*f-(i-1)*s<=0&&(s=0);var p=(n-2*f-(i-1)*s)/i;p>1&&(p>>=0);var m=hu(a)?Math.min(p,a):p;o=r.reduce((e,t,n)=>[...e,{stackId:t.stackId,dataKeys:t.dataKeys,position:{offset:f+(p+s)*n+(p-m)/2,size:m}}],l)}return o}}(n,r,a!==i?a:i,e,s);return a!==i&&null!=l&&(l=l.map(e=>dS(dS({},e),{},{position:dS(dS({},e.position),{},{offset:e.position.offset-a/2})}))),l}),wS=Dr([xS,fS],(e,t)=>{if(null!=e&&null!=t){var n=e.find(e=>e.stackId===t.stackId&&null!=t.dataKey&&e.dataKeys.includes(t.dataKey));if(null!=n)return n.position}}),NS=Dr([(e,t,n,r)=>"horizontal"===Qa(e)?th(e,"yAxis",n,r):th(e,"xAxis",t,r),fS],(e,t)=>{var n=pd(t);if(e&&null!=n&&null!=t){var{stackId:r}=t;if(null!=r){var a=e[r];if(a){var{stackedData:i}=a;if(i)return i.find(e=>e.key===n)}}}}),SS=Dr([La,Ua,(e,t,n,r)=>ff(e,"xAxis",t,r),(e,t,n,r)=>ff(e,"yAxis",n,r),(e,t,n,r)=>hf(e,"xAxis",t,r),(e,t,n,r)=>hf(e,"yAxis",n,r),wS,Qa,du,yS,NS,fS,(e,t,n,r,a,i)=>i],(e,t,n,r,a,i,o,s,l,c,u,d,h)=>{var{chartData:f,dataStartIndex:p,dataEndIndex:m}=l;if(null!=d&&null!=o&&null!=t&&("horizontal"===s||"vertical"===s)&&null!=n&&null!=r&&null!=a&&null!=i&&null!=c){var g,{data:v}=d;if(null!=(g=null!=v&&v.length>0?v:null===f||void 0===f?void 0:f.slice(p,m+1)))return function(e){var{layout:t,barSettings:{dataKey:n,minPointSize:r},pos:a,bandSize:i,xAxis:o,yAxis:s,xAxisTicks:l,yAxisTicks:c,stackedData:u,displayedData:d,offset:h,cells:f,parentViewBox:p}=e,m="horizontal"===t?s:o,g=u?m.scale.domain():null,v=(e=>{var{numericAxis:t}=e,n=t.scale.domain();if("number"===t.type){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]})({numericAxis:m});return d.map((e,d)=>{var m,y,b,x,w,N;u?m=((e,t)=>{if(!t||2!==t.length||!F(t[0])||!F(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!F(e[0])||e[0]<n)&&(a[0]=n),(!F(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a})(u[d],g):(m=fa(e,n),Array.isArray(m)||(m=[v,m]));var S=ZN(r,QS)(m[1],d);if("horizontal"===t){var E,[C,k]=[s.scale(m[0]),s.scale(m[1])];y=xa({axis:o,ticks:l,bandSize:i,offset:a.offset,entry:e,index:d}),b=null!==(E=null!==k&&void 0!==k?k:C)&&void 0!==E?E:void 0,x=a.size;var A=C-k;if(w=R(A)?0:A,N={x:y,y:h.top,width:x,height:h.height},Math.abs(S)>0&&Math.abs(w)<Math.abs(S)){var _=D(w||S)*(Math.abs(S)-Math.abs(w));b-=_,w+=_}}else{var[j,I]=[o.scale(m[0]),o.scale(m[1])];if(y=j,b=xa({axis:s,ticks:c,bandSize:i,offset:a.offset,entry:e,index:d}),x=I-j,w=a.size,N={x:h.left,y:b,width:h.width,height:w},Math.abs(S)>0&&Math.abs(x)<Math.abs(S))x+=D(x||S)*(Math.abs(S)-Math.abs(x))}return null==y||null==b||null==x||null==w?null:LS(LS({},e),{},{x:y,y:b,width:x,height:w,value:u?m:m[1],payload:e,background:N,tooltipPosition:{x:y+x/2,y:b+w/2},parentViewBox:p},f&&f[d]&&f[d].props)}).filter(Boolean)}({layout:s,barSettings:d,pos:o,parentViewBox:t,bandSize:c,xAxis:n,yAxis:r,xAxisTicks:a,yAxisTicks:i,stackedData:u,displayedData:g,offset:e,cells:h})}}),ES=()=>{};function CS(e){var{legendPayload:t}=e,n=Br(),r=Va();return(0,a.useEffect)(()=>r?ES:(n(Sm(t)),()=>{n(Em(t))}),[n,r,t]),null}function kS(e){var{legendPayload:t}=e,n=Br(),r=Wr(Qa);return(0,a.useEffect)(()=>"centric"!==r&&"radial"!==r?ES:(n(Sm(t)),()=>{n(Em(t))}),[n,r,t]),null}var AS=null!==(bS=i["useId".toString()])&&void 0!==bS?bS:()=>{var[e]=a.useState(()=>U("uid-"));return e};var _S=(0,a.createContext)(void 0),jS=e=>{var{id:t,type:n,children:r}=e,i=function(e,t){var n=AS();return t||(e?"".concat(e,"-").concat(n):n)}("recharts-".concat(n),t);return a.createElement(_S.Provider,{value:i},r(i))};function IS(e){var t=Br(),n=(0,a.useRef)(null);return(0,a.useEffect)(()=>{null===n.current?t(nm(e)):n.current!==e&&t(rm({prev:n.current,next:e})),n.current=e},[t,e]),(0,a.useEffect)(()=>()=>{n.current&&(t(am(n.current)),n.current=null)},[t]),null}function TS(e){var t=Br();return(0,a.useEffect)(()=>(t(im(e)),()=>{t(om(e))}),[t,e]),null}var OS=["onMouseEnter","onMouseLeave","onClick"],PS=["value","background","tooltipPosition"],DS=["id"],RS=["onMouseEnter","onClick","onMouseLeave"];function MS(){return MS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},MS.apply(null,arguments)}function FS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function LS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?FS(Object(n),!0).forEach(function(t){BS(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function BS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function US(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var zS=e=>{var{dataKey:t,name:n,fill:r,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:r,value:ka(n,t),payload:e}]};function VS(e){var{dataKey:t,stroke:n,strokeWidth:r,fill:a,name:i,hide:o,unit:s}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:r,fill:a,dataKey:t,nameKey:void 0,name:ka(i,t),hide:o,type:e.tooltipType,color:e.fill,unit:s}}}function WS(e){var t=Wr(gp),{data:n,dataKey:r,background:i,allOtherBarProps:o}=e,{onMouseEnter:s,onMouseLeave:l,onClick:c}=o,u=US(o,OS),d=eS(s,r),h=tS(l),f=nS(c,r);if(!i||null==n)return null;var p=yg(i,!1);return a.createElement(a.Fragment,null,n.map((e,n)=>{var{value:o,background:s,tooltipPosition:l}=e,c=US(e,PS);if(!s)return null;var m=d(e,n),g=h(e,n),v=f(e,n),y=LS(LS(LS(LS(LS({option:i,isActive:String(n)===t},c),{},{fill:"#eee"},s),p),cg(u,e,n)),{},{onMouseEnter:m,onMouseLeave:g,onClick:v,dataKey:r,index:n,className:"recharts-bar-background-rectangle"});return a.createElement(JN,MS({key:"background-bar-".concat(n)},y))}))}function qS(e){var{showLabels:t,children:n,rects:r}=e,i=null===r||void 0===r?void 0:r.map(e=>{var t={x:e.x,y:e.y,width:e.width,height:e.height};return LS(LS({},t),{},{value:e.value,payload:e.payload,parentViewBox:e.parentViewBox,viewBox:t,fill:e.fill})});return a.createElement(Xw,{value:t?i:void 0},n)}function HS(e){var{shape:t,activeBar:n,baseProps:r,entry:i,index:o,dataKey:s}=e,l=Wr(gp),c=Wr(yp),u=n&&String(o)===l&&(null==c||s===c),d=u?n:t;return a.createElement(JN,MS({},r,i,{isActive:u,option:d,index:o,dataKey:s}))}function GS(e){var{shape:t,baseProps:n,entry:r,index:i,dataKey:o}=e;return a.createElement(JN,MS({},n,r,{isActive:!1,option:t,index:i,dataKey:o}))}function KS(e){var{data:t,props:n}=e,r=hg(n),{id:i}=r,o=US(r,DS),{shape:s,dataKey:l,activeBar:c}=n,{onMouseEnter:u,onClick:d,onMouseLeave:h}=n,f=US(n,RS),p=eS(u,l),m=tS(h),g=nS(d,l);return t?a.createElement(a.Fragment,null,t.map((e,t)=>a.createElement(Tv,MS({className:"recharts-bar-rectangle"},cg(f,e,t),{onMouseEnter:p(e,t),onMouseLeave:m(e,t),onClick:g(e,t),key:"rectangle-".concat(null===e||void 0===e?void 0:e.x,"-").concat(null===e||void 0===e?void 0:e.y,"-").concat(null===e||void 0===e?void 0:e.value,"-").concat(t)}),c?a.createElement(HS,{shape:s,activeBar:c,baseProps:o,entry:e,index:t,dataKey:l}):a.createElement(GS,{shape:s,baseProps:o,entry:e,index:t,dataKey:l})))):null}function XS(e){var{props:t,previousRectanglesRef:n}=e,{data:r,layout:i,isAnimationActive:o,animationBegin:s,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,h=n.current,f=sw(t,"recharts-bar-"),[p,m]=(0,a.useState)(!1),g=!p,v=(0,a.useCallback)(()=>{"function"===typeof u&&u(),m(!1)},[u]),y=(0,a.useCallback)(()=>{"function"===typeof d&&d(),m(!0)},[d]);return a.createElement(qS,{showLabels:g,rects:r},a.createElement(ow,{animationId:f,begin:s,duration:l,isActive:o,easing:c,onAnimationEnd:v,onAnimationStart:y,key:f},e=>{var o=1===e?r:null===r||void 0===r?void 0:r.map((t,n)=>{var r=h&&h[n];if(r)return LS(LS({},t),{},{x:W(r.x,t.x,e),y:W(r.y,t.y,e),width:W(r.width,t.width,e),height:W(r.height,t.height,e)});if("horizontal"===i){var a=W(0,t.height,e);return LS(LS({},t),{},{y:t.y+t.height-a,height:a})}var o=W(0,t.width,e);return LS(LS({},t),{},{width:o})});return e>0&&(n.current=null!==o&&void 0!==o?o:null),null==o?null:a.createElement(Tv,null,a.createElement(KS,{props:t,data:o}))}),a.createElement(Jw,{label:t.label}),t.children)}function YS(e){var t=(0,a.useRef)(null);return a.createElement(XS,{previousRectanglesRef:t,props:e})}var QS=0,$S=(e,t)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:fa(e,t)}};class JS extends a.PureComponent{render(){var{hide:e,data:t,dataKey:n,className:r,xAxisId:i,yAxisId:o,needClip:s,background:l,id:c}=this.props;if(e||null==t)return null;var u=j("recharts-bar",r),d=c;return a.createElement(Tv,{className:u,id:c},s&&a.createElement("defs",null,a.createElement(cS,{clipPathId:d,xAxisId:i,yAxisId:o})),a.createElement(Tv,{className:"recharts-bar-rectangles",clipPath:s?"url(#clipPath-".concat(d,")"):void 0},a.createElement(WS,{data:t,dataKey:n,background:l,allOtherBarProps:this.props}),a.createElement(YS,this.props)))}}var ZS={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!lv,legendType:"rect",minPointSize:QS,xAxisId:0,yAxisId:0};function eE(e){var t,{xAxisId:n,yAxisId:r,hide:i,legendType:o,minPointSize:s,activeBar:l,animationBegin:c,animationDuration:u,animationEasing:d,isAnimationActive:h}=e,{needClip:f}=lS(n,r),p=$a(),m=Va(),g=vg(e.children,Bw),v=Wr(t=>SS(t,n,r,m,e.id,g));if("vertical"!==p&&"horizontal"!==p)return null;var y=null===v||void 0===v?void 0:v[0];return t=null==y||null==y.height||null==y.width?0:"vertical"===p?y.height/2:y.width/2,a.createElement(sS,{xAxisId:n,yAxisId:r,data:v,dataPointFormatter:$S,errorBarOffset:t},a.createElement(JS,MS({},e,{layout:p,needClip:f,data:v,xAxisId:n,yAxisId:r,hide:i,legendType:o,minPointSize:s,activeBar:l,animationBegin:c,animationDuration:u,animationEasing:d,isAnimationActive:h})))}function tE(e){var t=tv(e,ZS),n=Va();return a.createElement(jS,{id:t.id,type:"bar"},e=>{return a.createElement(a.Fragment,null,a.createElement(CS,{legendPayload:zS(t)}),a.createElement(rS,{fn:VS,args:t}),a.createElement(IS,{type:"bar",id:e,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:(r=t.stackId,null==r?void 0:String(r)),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),a.createElement(eE,MS({},t,{id:e})));var r})}function nE(e){var t=Br();return(0,a.useEffect)(()=>{t(Fm(e))},[t,e]),null}tE.displayName="Bar";var rE=["width","height","layout"];function aE(){return aE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},aE.apply(null,arguments)}var iE={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index",layout:"radial"},oE=(0,a.forwardRef)(function(e,t){var n,r=tv(e.categoricalChartProps,iE),{width:i,height:o,layout:s}=r,l=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(r,rE);if(!fu(i)||!fu(o))return null;var{chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:h}=e,f={chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:h,eventEmitter:void 0};return a.createElement(Zm,{preloadedState:{options:f},reduxStoreName:null!==(n=r.id)&&void 0!==n?n:c},a.createElement(eg,{chartData:r.data}),a.createElement(tg,{width:i,height:o,layout:s,margin:r.margin}),a.createElement(ng,{accessibilityLayer:r.accessibilityLayer,barCategoryGap:r.barCategoryGap,maxBarSize:r.maxBarSize,stackOffset:r.stackOffset,barGap:r.barGap,barSize:r.barSize,syncId:r.syncId,syncMethod:r.syncMethod,className:r.className}),a.createElement(nE,{cx:r.cx,cy:r.cy,startAngle:r.startAngle,endAngle:r.endAngle,innerRadius:r.innerRadius,outerRadius:r.outerRadius}),a.createElement(Jg,aE({width:i,height:o},l,{ref:t})))}),sE=["item"],lE={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},cE=(0,a.forwardRef)((e,t)=>{var n=tv(e,lE);return a.createElement(oE,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:sE,tooltipPayloadSearcher:Jt,categoricalChartProps:n,ref:t})}),uE=e=>e.graphicalItems.polarItems,dE=Dr([hd,fd],Md),hE=Dr([uE,Pd,dE],Bd),fE=Dr([hE],qd),pE=Dr([fE,uu],Gd),mE=Dr([pE,Pd,hE],Xd),gE=Dr([pE,Pd,hE],(e,t,n)=>n.length>0?e.flatMap(e=>n.flatMap(n=>{var r;return{value:fa(e,null!==(r=t.dataKey)&&void 0!==r?r:n.dataKey),errorDomain:[]}})).filter(Boolean):null!=(null===t||void 0===t?void 0:t.dataKey)?e.map(e=>({value:fa(e,t.dataKey),errorDomain:[]})):e.map(e=>({value:e,errorDomain:[]}))),vE=()=>{},yE=Dr([Pd,kh,vE,gE,vE,Qa,hd],Ah),bE=Dr([Pd,Qa,pE,mE,Lu,hd,yE],Ih),xE=Dr([bE,Pd,Ph],Rh);Dr([Pd,bE,xE,hd],Fh);function wE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function NE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wE(Object(n),!0).forEach(function(t){SE(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function SE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var EE=Dr([uE,(e,t)=>t],(e,t)=>e.filter(e=>"pie"===e.type).find(e=>e.id===t)),CE=[],kE=(e,t,n)=>0===(null===n||void 0===n?void 0:n.length)?CE:n,AE=Dr([uu,EE,kE],(e,t,n)=>{var r,{chartData:a}=e;if(null!=t&&((r=null!=(null===t||void 0===t?void 0:t.data)&&t.data.length>0?t.data:a)&&r.length||null==n||(r=n.map(e=>NE(NE({},t.presentationProps),e.props))),null!=r))return r}),_E=Dr([AE,EE,kE],(e,t,n)=>{if(null!=e&&null!=t)return e.map((e,r)=>{var a,i,o=fa(e,t.nameKey,t.name);return i=null!==n&&void 0!==n&&null!==(a=n[r])&&void 0!==a&&null!==(a=a.props)&&void 0!==a&&a.fill?n[r].props.fill:"object"===typeof e&&null!=e&&"fill"in e?e.fill:t.fill,{value:ka(o,t.dataKey),color:i,payload:e,type:t.legendType}})}),jE=Dr([AE,EE,kE,La],(e,t,n,r)=>{if(null!=t&&null!=e)return function(e){var t,n,r,{pieSettings:a,displayedData:i,cells:o,offset:s}=e,{cornerRadius:l,startAngle:c,endAngle:u,dataKey:d,nameKey:h,tooltipType:f}=a,p=Math.abs(a.minAngle),m=VE(c,u),g=Math.abs(m),v=i.length<=1?0:null!==(t=a.paddingAngle)&&void 0!==t?t:0,y=i.filter(e=>0!==fa(e,d,0)).length,b=g-y*p-(g>=360?y:y-1)*v,x=i.reduce((e,t)=>{var n=fa(t,d,0);return e+(F(n)?n:0)},0);x>0&&(n=i.map((e,t)=>{var n,i=fa(e,d,0),u=fa(e,h,t),g=zE(a,s,e),y=(F(i)?i:0)/x,w=RE(RE({},e),o&&o[t]&&o[t].props),N=(n=t?r.endAngle+D(m)*v*(0!==i?1:0):c)+D(m)*((0!==i?p:0)+y*b),S=(n+N)/2,E=(g.innerRadius+g.outerRadius)/2,C=[{name:u,value:i,payload:w,dataKey:d,type:f}],k=aa(g.cx,g.cy,E,S);return r=RE(RE(RE(RE({},a.presentationProps),{},{percent:y,cornerRadius:l,name:u,tooltipPayload:C,midAngle:S,middleRadius:E,tooltipPosition:k},w),g),{},{value:fa(e,d),startAngle:n,endAngle:N,payload:w,paddingAngle:D(m)*v})}));return n}({offset:r,pieSettings:t,displayedData:e,cells:n})}),IE=["onMouseEnter","onClick","onMouseLeave"],TE=["id"],OE=["id"];function PE(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function DE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function RE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?DE(Object(n),!0).forEach(function(t){ME(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ME(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FE(){return FE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FE.apply(null,arguments)}function LE(e){var t=(0,a.useMemo)(()=>vg(e.children,Bw),[e.children]),n=Wr(n=>_E(n,e.id,t));return null==n?null:a.createElement(kS,{legendPayload:n})}function BE(e){var{dataKey:t,nameKey:n,sectors:r,stroke:a,strokeWidth:i,fill:o,name:s,hide:l,tooltipType:c}=e;return{dataDefinedOnItem:r.map(e=>e.tooltipPayload),positions:r.map(e=>e.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:o,dataKey:t,nameKey:n,name:ka(s,t),hide:l,type:c,color:o,unit:""}}}var UE=(e,t)=>e>t?"start":e<t?"end":"middle",zE=(e,t,n)=>{var{top:r,left:a,width:i,height:o}=t,s=ia(i,o),l=a+z(e.cx,i,i/2),c=r+z(e.cy,o,o/2),u=z(e.innerRadius,s,0),d=((e,t,n)=>z("function"===typeof t?t(e):t,n,.8*n))(n,e.outerRadius,s);return{cx:l,cy:c,innerRadius:u,outerRadius:d,maxRadius:e.maxRadius||Math.sqrt(i*i+o*o)/2}},VE=(e,t)=>D(t-e)*Math.min(Math.abs(t-e),360);function WE(e){var{sectors:t,props:n,showLabels:r}=e,{label:i,labelLine:o,dataKey:s}=n;if(!r||!i||!t)return null;var l=hg(n),c=yg(i,!1),u=yg(o,!1),d="object"===typeof i&&"offsetRadius"in i&&"number"===typeof i.offsetRadius&&i.offsetRadius||20,h=t.map((e,t)=>{var n=(e.startAngle+e.endAngle)/2,r=aa(e.cx,e.cy,e.outerRadius+d,n),h=RE(RE(RE(RE({},l),e),{},{stroke:"none"},c),{},{index:t,textAnchor:UE(r.x,e.cx)},r),f=RE(RE(RE(RE({},l),e),{},{fill:"none",stroke:e.fill},u),{},{index:t,points:[aa(e.cx,e.cy,e.outerRadius,n),r],key:"line"});return a.createElement(Tv,{key:"label-".concat(e.startAngle,"-").concat(e.endAngle,"-").concat(e.midAngle,"-").concat(t)},o&&((e,t)=>{if(a.isValidElement(e))return a.cloneElement(e,t);if("function"===typeof e)return e(t);var n=j("recharts-pie-label-line","boolean"!==typeof e?e.className:"");return a.createElement(Ax,FE({},t,{type:"linear",className:n}))})(o,f),((e,t,n)=>{if(a.isValidElement(e))return a.cloneElement(e,t);var r=n;if("function"===typeof e&&(r=e(t),a.isValidElement(r)))return r;var i,o=j("recharts-pie-label-text",(i=e)&&"object"===typeof i&&"className"in i&&"string"===typeof i.className?i.className:"");return a.createElement(Zv,FE({},t,{alignmentBaseline:"middle",className:o}),r)})(i,h,fa(e,s)))});return a.createElement(Tv,{className:"recharts-pie-labels"},h)}function qE(e){var{sectors:t,props:n,showLabels:r}=e,{label:i}=n;return"object"===typeof i&&null!=i&&"position"in i?a.createElement(Jw,{label:n.label}):a.createElement(WE,{sectors:t,props:n,showLabels:r})}function HE(e){var{sectors:t,activeShape:n,inactiveShape:r,allOtherPieProps:i}=e,o=Wr(gp),{onMouseEnter:s,onClick:l,onMouseLeave:c}=i,u=PE(i,IE),d=eS(s,i.dataKey),h=tS(c),f=nS(l,i.dataKey);return null==t||0===t.length?null:a.createElement(a.Fragment,null,t.map((e,s)=>{if(0===(null===e||void 0===e?void 0:e.startAngle)&&0===(null===e||void 0===e?void 0:e.endAngle)&&1!==t.length)return null;var l=n&&String(s)===o,c=l?n:o?r:null,p=RE(RE({},e),{},{stroke:e.stroke,tabIndex:-1,[Pa]:s,[Da]:i.dataKey});return a.createElement(Tv,FE({tabIndex:-1,className:"recharts-pie-sector"},cg(u,e,s),{onMouseEnter:d(e,s),onMouseLeave:h(e,s),onClick:f(e,s),key:"sector-".concat(null===e||void 0===e?void 0:e.startAngle,"-").concat(null===e||void 0===e?void 0:e.endAngle,"-").concat(e.midAngle,"-").concat(s)}),a.createElement(HN,FE({option:c,isActive:l,shapeType:"sector"},p)))}))}function GE(e){var{showLabels:t,sectors:n,children:r}=e,i=(0,a.useMemo)(()=>t&&n?n.map(e=>({value:e.value,payload:e.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:e.cx,cy:e.cy,innerRadius:e.innerRadius,outerRadius:e.outerRadius,startAngle:e.startAngle,endAngle:e.endAngle,clockWise:!1},fill:e.fill})):[],[n,t]);return a.createElement(Qw,{value:t?i:void 0},r)}function KE(e){var{props:t,previousSectorsRef:n}=e,{sectors:r,isAnimationActive:i,animationBegin:o,animationDuration:s,animationEasing:l,activeShape:c,inactiveShape:u,onAnimationStart:d,onAnimationEnd:h}=t,f=sw(t,"recharts-pie-"),p=n.current,[m,g]=(0,a.useState)(!1),v=(0,a.useCallback)(()=>{"function"===typeof h&&h(),g(!1)},[h]),y=(0,a.useCallback)(()=>{"function"===typeof d&&d(),g(!0)},[d]);return a.createElement(GE,{showLabels:!m,sectors:r},a.createElement(ow,{animationId:f,begin:o,duration:s,isActive:i,easing:l,onAnimationStart:y,onAnimationEnd:v,key:f},e=>{var i=[],o=r&&r[0],s=null===o||void 0===o?void 0:o.startAngle;return null===r||void 0===r||r.forEach((t,n)=>{var r=p&&p[n],a=n>0?P()(t,"paddingAngle",0):0;if(r){var o=W(r.endAngle-r.startAngle,t.endAngle-t.startAngle,e),l=RE(RE({},t),{},{startAngle:s+a,endAngle:s+o+a});i.push(l),s=l.endAngle}else{var{endAngle:c,startAngle:u}=t,d=W(0,c-u,e),h=RE(RE({},t),{},{startAngle:s+a,endAngle:s+d+a});i.push(h),s=h.endAngle}}),n.current=i,a.createElement(Tv,null,a.createElement(HE,{sectors:i,activeShape:c,inactiveShape:u,allOtherPieProps:t}))}),a.createElement(qE,{showLabels:!m,sectors:r,props:t}),t.children)}var XE={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!lv,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function YE(e){var{id:t}=e,n=PE(e,TE),{hide:r,className:i,rootTabIndex:o}=e,s=(0,a.useMemo)(()=>vg(e.children,Bw),[e.children]),l=Wr(e=>jE(e,t,s)),c=(0,a.useRef)(null),u=j("recharts-pie",i);return r||null==l?(c.current=null,a.createElement(Tv,{tabIndex:o,className:u})):a.createElement(a.Fragment,null,a.createElement(rS,{fn:BE,args:RE(RE({},e),{},{sectors:l})}),a.createElement(Tv,{tabIndex:o,className:u},a.createElement(KE,{props:RE(RE({},n),{},{sectors:l}),previousSectorsRef:c})))}function QE(e){var t=tv(e,XE),{id:n}=t,r=PE(t,OE),i=hg(r);return a.createElement(jS,{id:n,type:"pie"},e=>a.createElement(a.Fragment,null,a.createElement(TS,{type:"pie",id:e,data:r.data,dataKey:r.dataKey,hide:r.hide,angleAxisId:0,radiusAxisId:0,name:r.name,nameKey:r.nameKey,tooltipType:r.tooltipType,legendType:r.legendType,fill:r.fill,cx:r.cx,cy:r.cy,startAngle:r.startAngle,endAngle:r.endAngle,paddingAngle:r.paddingAngle,minAngle:r.minAngle,innerRadius:r.innerRadius,outerRadius:r.outerRadius,cornerRadius:r.cornerRadius,presentationProps:i}),a.createElement(LE,FE({},r,{id:e})),a.createElement(YE,FE({},r,{id:e}))))}QE.displayName="Pie";const $E=()=>(0,w.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm animate-pulse",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,w.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-xl"}),(0,w.jsx)("div",{className:"w-16 h-6 bg-gray-200 rounded"})]}),(0,w.jsx)("div",{className:"w-20 h-8 bg-gray-200 rounded mb-2"}),(0,w.jsx)("div",{className:"w-32 h-4 bg-gray-200 rounded"})]}),JE=()=>(0,w.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((e,t)=>(0,w.jsx)($E,{},t))}),ZE=e=>{let{height:t="h-64"}=e;return(0,w.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm animate-pulse ".concat(t),children:[(0,w.jsx)("div",{className:"w-48 h-6 bg-gray-200 rounded mb-4"}),(0,w.jsx)("div",{className:"flex items-end space-x-2 h-40",children:[...Array(5)].map((e,t)=>(0,w.jsx)("div",{className:"bg-gray-200 rounded-t flex-1",style:{height:"".concat(80*Math.random()+20,"%")}},t))})]})},eC=()=>(0,w.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm animate-pulse",children:[(0,w.jsx)("div",{className:"w-32 h-6 bg-gray-200 rounded mb-4"}),(0,w.jsx)("div",{className:"space-y-4",children:[...Array(5)].map((e,t)=>(0,w.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,w.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-full"}),(0,w.jsxs)("div",{className:"flex-1",children:[(0,w.jsx)("div",{className:"w-48 h-4 bg-gray-200 rounded mb-2"}),(0,w.jsx)("div",{className:"w-24 h-3 bg-gray-200 rounded"})]}),(0,w.jsx)("div",{className:"w-12 h-3 bg-gray-200 rounded"})]},t))})]}),tC=()=>(0,w.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden animate-pulse",children:[(0,w.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,w.jsx)("div",{className:"w-32 h-6 bg-gray-200 rounded"})}),(0,w.jsx)("div",{className:"p-6",children:[...Array(8)].map((e,t)=>(0,w.jsxs)("div",{className:"flex items-center space-x-4 py-3 border-b border-gray-100 last:border-b-0",children:[(0,w.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),(0,w.jsxs)("div",{className:"flex-1",children:[(0,w.jsx)("div",{className:"w-32 h-4 bg-gray-200 rounded mb-2"}),(0,w.jsx)("div",{className:"w-48 h-3 bg-gray-200 rounded"})]}),(0,w.jsx)("div",{className:"w-16 h-4 bg-gray-200 rounded"}),(0,w.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded"})]},t))})]}),nC=()=>(0,w.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm animate-pulse",children:[(0,w.jsx)("div",{className:"w-40 h-6 bg-gray-200 rounded mb-4"}),(0,w.jsx)("div",{className:"flex items-center justify-center h-48",children:(0,w.jsx)("div",{className:"w-32 h-32 bg-gray-200 rounded-full"})}),(0,w.jsx)("div",{className:"mt-4 space-y-2",children:[...Array(4)].map((e,t)=>(0,w.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,w.jsx)("div",{className:"w-3 h-3 bg-gray-200 rounded"}),(0,w.jsx)("div",{className:"w-20 h-3 bg-gray-200 rounded"})]},t))})]}),rC=()=>(0,w.jsxs)("div",{className:"space-y-6",children:[(0,w.jsxs)("div",{className:"animate-pulse",children:[(0,w.jsx)("div",{className:"w-64 h-8 bg-gray-200 rounded mb-2"}),(0,w.jsx)("div",{className:"w-96 h-4 bg-gray-200 rounded"})]}),(0,w.jsx)(JE,{}),(0,w.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,w.jsx)(ZE,{}),(0,w.jsx)(nC,{})]}),(0,w.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,w.jsx)(eC,{}),(0,w.jsx)("div",{className:"lg:col-span-1",children:(0,w.jsx)(tC,{})})]})]}),aC=e=>{let{isLoading:t,skeleton:n,children:r,className:a="",showShimmer:i=!0}=e;return t?(0,w.jsx)("div",{className:"".concat(i?"animate-pulse":""," ").concat(a),children:n}):r},iC=(0,a.memo)(e=>{let{title:t,value:n,icon:r,change:a,changeType:i,color:o,isLoading:s}=e;return(0,w.jsx)(aC,{isLoading:s,skeleton:(0,w.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm animate-pulse",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,w.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-xl"}),(0,w.jsx)("div",{className:"w-16 h-6 bg-gray-200 rounded"})]}),(0,w.jsx)("div",{className:"w-20 h-8 bg-gray-200 rounded mb-2"}),(0,w.jsx)("div",{className:"w-32 h-4 bg-gray-200 rounded"})]}),children:(0,w.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,w.jsx)("div",{className:"w-12 h-12 ".concat(o," rounded-xl flex items-center justify-center"),children:(0,w.jsx)(r,{className:"w-6 h-6 text-white"})}),a&&(0,w.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ".concat("positive"===i?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:[(0,w.jsx)(S.A,{className:"w-3 h-3"}),a,"%"]})]}),(0,w.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-1",children:(null===n||void 0===n?void 0:n.toLocaleString())||"0"}),(0,w.jsx)("p",{className:"text-gray-600 text-sm",children:t})]})})}),oC=(0,a.memo)(e=>{let{data:t,isLoading:n}=e;return(0,w.jsx)(aC,{isLoading:n,skeleton:(0,w.jsx)(ZE,{}),children:(0,w.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,w.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Enrollment & Attendance Trend"}),(0,w.jsx)(Q,{width:"100%",height:300,children:(0,w.jsxs)(sv,{data:t,children:[(0,w.jsx)(Wy,{strokeDasharray:"3 3"}),(0,w.jsx)(Zy,{dataKey:"month"}),(0,w.jsx)(cb,{}),(0,w.jsx)(Lw,{}),(0,w.jsx)(tE,{dataKey:"students",fill:"#3B82F6",radius:[4,4,0,0]}),(0,w.jsx)(tE,{dataKey:"attendance",fill:"#8B5CF6",radius:[4,4,0,0]})]})})]})})}),sC=(0,a.memo)(e=>{let{data:t,isLoading:n}=e;return(0,w.jsx)(aC,{isLoading:n,skeleton:(0,w.jsx)(nC,{}),children:(0,w.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,w.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Department Distribution"}),(0,w.jsx)(Q,{width:"100%",height:300,children:(0,w.jsxs)(cE,{children:[(0,w.jsx)(QE,{data:t,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",children:t.map((e,t)=>(0,w.jsx)(Bw,{fill:e.color},"cell-".concat(t)))}),(0,w.jsx)(Lw,{})]})}),(0,w.jsx)("div",{className:"grid grid-cols-2 gap-2 mt-4",children:t.map((e,t)=>(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,w.jsx)("span",{className:"text-sm text-gray-600 truncate",children:e.name})]},t))})]})})}),lC=(0,a.memo)(e=>{let{activities:t,isLoading:n}=e;return(0,w.jsx)(aC,{isLoading:n,skeleton:(0,w.jsx)(eC,{}),children:(0,w.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,w.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Activities"}),(0,w.jsx)(E.A,{className:"w-5 h-5 text-gray-400"})]}),(0,w.jsx)("div",{className:"space-y-4 max-h-64 overflow-y-auto",children:t.length>0?t.map(e=>(0,w.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,w.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat("success"===e.type?"bg-green-100":"bg-blue-100"),children:"success"===e.type?(0,w.jsx)(C.A,{className:"w-4 h-4 text-green-600"}):(0,w.jsx)(c.A,{className:"w-4 h-4 text-blue-600"})}),(0,w.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,w.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.action}),(0,w.jsx)("p",{className:"text-xs text-gray-600 truncate",children:e.user})]}),(0,w.jsx)("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:e.time})]},e.id)):(0,w.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,w.jsx)(E.A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,w.jsx)("p",{className:"text-sm",children:"No recent activities"})]})})]})})}),cC=e=>{let{analytics:t,loadingStates:n,onRefresh:r}=e;const a=[{title:"Total Students",value:t.totalStudents,icon:l.A,color:"bg-gradient-to-r from-blue-500 to-blue-600",change:12,changeType:"positive"},{title:"Total Teachers",value:t.totalTeachers,icon:c.A,color:"bg-gradient-to-r from-purple-500 to-purple-600",change:5,changeType:"positive"},{title:"Total Parents",value:t.totalParents,icon:u.A,color:"bg-gradient-to-r from-pink-500 to-pink-600",change:8,changeType:"positive"},{title:"Avg Attendance",value:t.averageAttendance,icon:k.A,color:"bg-gradient-to-r from-green-500 to-green-600",change:3,changeType:"positive"}];return(0,w.jsxs)("div",{className:"space-y-6",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Dashboard Overview"}),(0,w.jsx)("p",{className:"text-gray-600",children:"Welcome to the school management system"})]}),(0,w.jsxs)("button",{onClick:r,disabled:n.overview,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:[(0,w.jsx)(A.A,{className:"w-4 h-4 ".concat(n.overview?"animate-spin":"")}),"Refresh"]})]}),(0,w.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:a.map((e,t)=>(0,w.jsx)(iC,(0,N.A)((0,N.A)({},e),{},{isLoading:n.overview}),t))}),(0,w.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,w.jsx)(oC,{data:t.monthlyData,isLoading:n.analytics}),(0,w.jsx)(sC,{data:t.departmentData,isLoading:n.analytics})]}),(0,w.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,w.jsx)(lC,{activities:t.recentActivities,isLoading:n.activities}),(0,w.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,w.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,w.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,w.jsxs)("button",{className:"p-4 bg-blue-50 hover:bg-blue-100 rounded-xl transition-colors text-center",children:[(0,w.jsx)(c.A,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),(0,w.jsx)("span",{className:"text-sm font-medium text-blue-900",children:"Add User"})]}),(0,w.jsxs)("button",{className:"p-4 bg-green-50 hover:bg-green-100 rounded-xl transition-colors text-center",children:[(0,w.jsx)(k.A,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),(0,w.jsx)("span",{className:"text-sm font-medium text-green-900",children:"View Reports"})]}),(0,w.jsxs)("button",{className:"p-4 bg-purple-50 hover:bg-purple-100 rounded-xl transition-colors text-center",children:[(0,w.jsx)(u.A,{className:"w-6 h-6 text-purple-600 mx-auto mb-2"}),(0,w.jsx)("span",{className:"text-sm font-medium text-purple-900",children:"Manage Classes"})]}),(0,w.jsxs)("button",{className:"p-4 bg-orange-50 hover:bg-orange-100 rounded-xl transition-colors text-center",children:[(0,w.jsx)(S.A,{className:"w-6 h-6 text-orange-600 mx-auto mb-2"}),(0,w.jsx)("span",{className:"text-sm font-medium text-orange-900",children:"Analytics"})]})]})]})]})]})},uC=(0,a.memo)(cC);var dC=n(9292);const hC=(0,o.A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var fC=n(797),pC=n(7104),mC=n(1884),gC=n(6210);const vC=(0,o.A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),yC=(0,o.A)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);var bC=n(9855),xC=n(5686);const wC=e=>{let{users:t,type:n,searchTerm:r,onEdit:i,onDelete:o,onResetPassword:s,onApprove:l,filters:c={}}=e;const[u,d]=(0,a.useState)(null),h=t.filter(e=>{var t,a;const i=(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(r.toLowerCase()))||(null===(a=e.email)||void 0===a?void 0:a.toLowerCase().includes(r.toLowerCase()));let o=!0;return c.statusFilter&&"all"!==c.statusFilter&&(o=o&&e.status===c.statusFilter),c.classFilter&&"all"!==c.classFilter&&"students"===n&&(o=o&&e.class===c.classFilter),c.subjectFilter&&"all"!==c.subjectFilter&&"teachers"===n&&(o=o&&e.subject===c.subjectFilter),i&&o}),f=e=>{const t={active:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",inactive:"bg-red-100 text-red-800"};return t[e]||t.active},p=e=>{let{user:t}=e;return(0,w.jsxs)("div",{className:"flex items-center space-x-1",children:["pending"===t.status&&l&&(0,w.jsx)("button",{onClick:()=>l(t.id),className:"p-2 text-green-600 hover:text-green-900 hover:bg-green-100 rounded-lg transition-all duration-200",title:"Approve",children:(0,w.jsx)(gC.A,{className:"w-4 h-4"})}),(0,w.jsx)("button",{onClick:()=>i(t,n),className:"p-2 text-blue-600 hover:text-blue-900 hover:bg-blue-100 rounded-lg transition-all duration-200",title:"Edit",children:(0,w.jsx)(vC,{className:"w-4 h-4"})}),(0,w.jsx)("button",{onClick:()=>s(t.id),className:"p-2 text-purple-600 hover:text-purple-900 hover:bg-purple-100 rounded-lg transition-all duration-200",title:"Reset Password",children:(0,w.jsx)(yC,{className:"w-4 h-4"})}),(0,w.jsx)("button",{onClick:()=>o(t.id,n),className:"p-2 text-red-600 hover:text-red-900 hover:bg-red-100 rounded-lg transition-all duration-200",title:"Delete",children:(0,w.jsx)(bC.A,{className:"w-4 h-4"})})]})},m=e=>{var t,r;let{user:a}=e;return(0,w.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm hover:shadow-md transition-all duration-200",children:[(0,w.jsxs)("div",{className:"flex items-start justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center space-x-3 flex-1",children:[(0,w.jsx)("div",{className:"h-12 w-12 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold",children:(null===(t=a.name)||void 0===t||null===(r=t.charAt(0))||void 0===r?void 0:r.toUpperCase())||"U"}),(0,w.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,w.jsx)("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:a.name}),(0,w.jsx)("p",{className:"text-xs text-gray-600 truncate",children:a.email}),(0,w.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,w.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat(f(a.status||"active")),children:a.status||"Active"}),"students"===n&&a.class&&(0,w.jsxs)("span",{className:"text-xs text-gray-500",children:["Class ",a.class]}),"teachers"===n&&a.subject&&(0,w.jsx)("span",{className:"text-xs text-gray-500",children:a.subject})]})]})]}),(0,w.jsxs)("div",{className:"relative",children:[(0,w.jsx)("button",{onClick:()=>d(u===a.id?null:a.id),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all duration-200",children:(0,w.jsx)(xC.A,{className:"w-4 h-4"})}),u===a.id&&(0,w.jsxs)("div",{className:"absolute right-0 top-10 z-10 w-48 bg-white border border-gray-200 rounded-lg shadow-lg py-1",children:["pending"===a.status&&l&&(0,w.jsxs)("button",{onClick:()=>{l(a.id),d(null)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:[(0,w.jsx)(gC.A,{className:"w-4 h-4"}),(0,w.jsx)("span",{children:"Approve"})]}),(0,w.jsxs)("button",{onClick:()=>{i(a,n),d(null)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:[(0,w.jsx)(vC,{className:"w-4 h-4"}),(0,w.jsx)("span",{children:"Edit"})]}),(0,w.jsxs)("button",{onClick:()=>{s(a.id),d(null)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm text-purple-700 hover:bg-purple-50",children:[(0,w.jsx)(yC,{className:"w-4 h-4"}),(0,w.jsx)("span",{children:"Reset Password"})]}),(0,w.jsxs)("button",{onClick:()=>{o(a.id,n),d(null)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:[(0,w.jsx)(bC.A,{className:"w-4 h-4"}),(0,w.jsx)("span",{children:"Delete"})]})]})]})]}),(0,w.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-gray-600",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{className:"font-medium",children:"Phone:"})," ",a.phone||"N/A"]}),"teachers"===n&&a.department&&(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{className:"font-medium",children:"Dept:"})," ",a.department]}),"parents"===n&&a.occupation&&(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{className:"font-medium",children:"Occupation:"})," ",a.occupation]}),"parents"===n&&a.children&&(0,w.jsxs)("div",{className:"col-span-2",children:[(0,w.jsx)("span",{className:"font-medium",children:"Children:"})," ",a.children.length||0]})]})]})},g=e=>{var t,r,a;const i=(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,w.jsxs)("div",{className:"flex items-center",children:[(0,w.jsx)("div",{className:"h-10 w-10 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold",children:(null===(t=e.name)||void 0===t||null===(r=t.charAt(0))||void 0===r?void 0:r.toUpperCase())||"U"}),(0,w.jsxs)("div",{className:"ml-4",children:[(0,w.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,w.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.id||"N/A"]})]})]})}),(0,w.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,w.jsx)("div",{className:"text-sm text-gray-900",children:e.email})})]});switch(n){case"students":return(0,w.jsxs)(w.Fragment,{children:[i,(0,w.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,w.jsx)("div",{className:"text-sm text-gray-900",children:e.class||"N/A"})}),(0,w.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,w.jsx)("div",{className:"text-sm text-gray-900",children:e.phone||"N/A"})})]});case"teachers":return(0,w.jsxs)(w.Fragment,{children:[i,(0,w.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,w.jsx)("div",{className:"text-sm text-gray-900",children:e.subject||"N/A"})}),(0,w.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,w.jsx)("div",{className:"text-sm text-gray-900",children:e.department||"N/A"})}),(0,w.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,w.jsx)("div",{className:"text-sm text-gray-900",children:e.phone||"N/A"})})]});case"parents":return(0,w.jsxs)(w.Fragment,{children:[i,(0,w.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,w.jsx)("div",{className:"text-sm text-gray-900",children:e.occupation||"N/A"})}),(0,w.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,w.jsxs)("div",{className:"text-sm text-gray-900",children:[(null===(a=e.children)||void 0===a?void 0:a.length)||0," children"]})}),(0,w.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,w.jsx)("div",{className:"text-sm text-gray-900",children:e.phone||"N/A"})})]});default:return(0,w.jsxs)(w.Fragment,{children:[i,(0,w.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,w.jsx)("div",{className:"text-sm text-gray-900",children:e.phone||"N/A"})})]})}};return a.useEffect(()=>{const e=()=>d(null);return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]),(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsxs)("div",{className:"block lg:hidden space-y-3",children:[h.map(e=>(0,w.jsx)(m,{user:e},e.id)),0===h.length&&(0,w.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,w.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,w.jsx)(dC.A,{className:"w-8 h-8 text-gray-400"})}),(0,w.jsxs)("p",{className:"text-lg font-medium",children:["No ",n," found"]}),(0,w.jsx)("p",{className:"text-sm",children:"Try adjusting your search or filters"})]})]}),(0,w.jsxs)("div",{className:"hidden lg:block bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,w.jsx)("div",{className:"overflow-x-auto",children:(0,w.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,w.jsx)("thead",{className:"bg-gray-50",children:(0,w.jsx)("tr",{children:(()=>{const e=["Name","Email","Phone","Status","Actions"];switch(n){case"students":return["Name","Email","Class","Phone","Status","Actions"];case"teachers":return["Name","Email","Subject","Department","Phone","Status","Actions"];case"parents":return["Name","Email","Occupation","Children","Phone","Status","Actions"];default:return e}})().map(e=>(0,w.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e},e))})}),(0,w.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(e=>(0,w.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[g(e),(0,w.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,w.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(f(e.status||"active")),children:e.status||"Active"})}),(0,w.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,w.jsx)(p,{user:e})})]},e.id))})]})}),0===h.length&&(0,w.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,w.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,w.jsx)(dC.A,{className:"w-8 h-8 text-gray-400"})}),(0,w.jsxs)("p",{className:"text-lg font-medium",children:["No ",n," found"]}),(0,w.jsx)("p",{className:"text-sm",children:"Try adjusting your search or filters"})]})]})]})},NC=e=>{let{searchTerm:t,setSearchTerm:n,statusFilter:r,setStatusFilter:a,classFilter:i,setClassFilter:o,subjectFilter:s,setSubjectFilter:l,type:c}=e;return(0,w.jsx)("div",{className:"bg-white rounded-2xl p-4 sm:p-6 shadow-sm border border-gray-100 mb-6",children:(0,w.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,w.jsx)("div",{className:"w-full",children:(0,w.jsxs)("div",{className:"relative",children:[(0,w.jsx)(dC.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,w.jsx)("input",{type:"text",placeholder:"Search ".concat(c,"..."),value:t,onChange:e=>n(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base"})]})}),(0,w.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[(0,w.jsxs)("select",{value:r,onChange:e=>a(e.target.value),className:"px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base",children:[(0,w.jsx)("option",{value:"all",children:"All Status"}),(0,w.jsx)("option",{value:"active",children:"Active"}),(0,w.jsx)("option",{value:"pending",children:"Pending"}),(0,w.jsx)("option",{value:"inactive",children:"Inactive"})]}),"students"===c&&(0,w.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base",children:[(0,w.jsx)("option",{value:"all",children:"All Classes"}),(0,w.jsx)("option",{value:"1",children:"Class 1"}),(0,w.jsx)("option",{value:"2",children:"Class 2"}),(0,w.jsx)("option",{value:"3",children:"Class 3"}),(0,w.jsx)("option",{value:"4",children:"Class 4"}),(0,w.jsx)("option",{value:"5",children:"Class 5"}),(0,w.jsx)("option",{value:"6",children:"Class 6"}),(0,w.jsx)("option",{value:"7",children:"Class 7"}),(0,w.jsx)("option",{value:"8",children:"Class 8"}),(0,w.jsx)("option",{value:"9",children:"Class 9"}),(0,w.jsx)("option",{value:"10",children:"Class 10"})]}),"teachers"===c&&(0,w.jsxs)("select",{value:s,onChange:e=>l(e.target.value),className:"px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base",children:[(0,w.jsx)("option",{value:"all",children:"All Subjects"}),(0,w.jsx)("option",{value:"Mathematics",children:"Mathematics"}),(0,w.jsx)("option",{value:"Science",children:"Science"}),(0,w.jsx)("option",{value:"English",children:"English"}),(0,w.jsx)("option",{value:"Social Studies",children:"Social Studies"}),(0,w.jsx)("option",{value:"Physics",children:"Physics"}),(0,w.jsx)("option",{value:"Chemistry",children:"Chemistry"}),(0,w.jsx)("option",{value:"Biology",children:"Biology"}),(0,w.jsx)("option",{value:"Computer Science",children:"Computer Science"})]})]})]})})},SC=e=>{let{type:t,users:n,onAdd:r,onEdit:i,onDelete:o,onResetPassword:s,onApprove:l,onBulkUpload:c,onBack:u}=e;const[d,h]=(0,a.useState)(""),[f,p]=(0,a.useState)("all"),[m,g]=(0,a.useState)("all"),[v,y]=(0,a.useState)("all");return(0,w.jsxs)("div",{className:"space-y-6",children:[(0,w.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,w.jsx)("button",{onClick:u,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-xl transition-all duration-200",children:(0,w.jsx)(hC,{className:"w-5 h-5 transform rotate-180"})}),(0,w.jsxs)("div",{children:[(0,w.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:(()=>{switch(t){case"students":return"Student Management";case"teachers":return"Teacher Management";case"parents":return"Parent Management";default:return"User Management"}})()}),(0,w.jsxs)("p",{className:"text-gray-600 text-sm sm:text-base",children:["Manage ",t," in your school"]})]})]}),(0,w.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3",children:[(0,w.jsxs)("button",{onClick:c,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-200 text-sm sm:text-base",children:[(0,w.jsx)(fC.A,{className:"w-4 h-4 sm:w-5 sm:h-5"}),(0,w.jsx)("span",{children:"Bulk Upload"})]}),(0,w.jsxs)("button",{className:"flex items-center justify-center space-x-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-xl hover:bg-blue-200 transition-all duration-200 text-sm sm:text-base",children:[(0,w.jsx)(pC.A,{className:"w-4 h-4 sm:w-5 sm:h-5"}),(0,w.jsx)("span",{children:"Export"})]}),(0,w.jsxs)("button",{onClick:()=>r(t),className:"flex items-center justify-center space-x-2 px-4 sm:px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl hover:shadow-lg transition-all duration-300 text-sm sm:text-base",children:[(0,w.jsx)(mC.A,{className:"w-4 h-4 sm:w-5 sm:h-5"}),(0,w.jsxs)("span",{children:["Add ",t.slice(0,-1)]})]})]})]}),(0,w.jsx)(NC,{searchTerm:d,setSearchTerm:h,statusFilter:f,setStatusFilter:p,classFilter:m,setClassFilter:g,subjectFilter:v,setSubjectFilter:y,type:t}),(0,w.jsx)(wC,{users:n,type:t,searchTerm:d,onEdit:i,onDelete:o,onResetPassword:s,onApprove:l,filters:{statusFilter:f,classFilter:m,subjectFilter:v}})]})};var EC=n(4459),CC=n(5327),kC=n(1286);const AC=(0,o.A)("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);var _C=n(8006);const jC=e=>{let{type:t="text",name:n,placeholder:r,value:a,onChange:i,required:o=!1,icon:s,options:l=null,rows:c=null}=e;const u="w-full px-3 sm:px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base";return"select"===t&&l?(0,w.jsxs)("div",{className:"relative",children:[s&&(0,w.jsx)(s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),(0,w.jsxs)("select",{name:n,value:a,onChange:i,required:o,className:"".concat(u," ").concat(s?"pl-9 sm:pl-10":""),children:[(0,w.jsx)("option",{value:"",children:r}),l.map(e=>(0,w.jsx)("option",{value:e.value,children:e.label},e.value))]})]}):"textarea"===t?(0,w.jsxs)("div",{className:"relative",children:[s&&(0,w.jsx)(s,{className:"absolute left-3 top-4 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),(0,w.jsx)("textarea",{name:n,placeholder:r,value:a,onChange:i,required:o,rows:c||3,className:"".concat(u," ").concat(s?"pl-9 sm:pl-10":"")})]}):(0,w.jsxs)("div",{className:"relative",children:[s&&(0,w.jsx)(s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),(0,w.jsx)("input",{type:t,name:n,placeholder:r,value:a,onChange:i,required:o,className:"".concat(u," ").concat(s?"pl-9 sm:pl-10":"")})]})},IC=e=>{let{isOpen:t,onClose:n,modalType:r,formData:a,onInputChange:i,onSubmit:o,loading:s,selectedUser:c}=e;if(!t)return null;const d=[{name:"name",placeholder:"Full Name",icon:EC.A,required:!0},{name:"email",placeholder:"Email Address",type:"email",icon:CC.A,required:!0},{name:"phone",placeholder:"Phone Number",icon:kC.A,required:!0}];c||d.push({name:"password",placeholder:"Password",type:"password",required:!0});const h=[...d,...(()=>{switch(r){case"students":return[{name:"class",placeholder:"Select Class",type:"select",icon:l.A,options:Array.from({length:10},(e,t)=>({value:t+1,label:"Class ".concat(t+1)}))},{name:"dateOfBirth",placeholder:"Date of Birth",type:"date",icon:k.A},{name:"parentContact",placeholder:"Parent Contact",icon:kC.A},{name:"admissionDate",placeholder:"Admission Date",type:"date",icon:k.A}];case"teachers":return[{name:"subject",placeholder:"Select Subject",type:"select",icon:u.A,options:[{value:"Mathematics",label:"Mathematics"},{value:"Science",label:"Science"},{value:"English",label:"English"},{value:"Social Studies",label:"Social Studies"},{value:"Physics",label:"Physics"},{value:"Chemistry",label:"Chemistry"},{value:"Biology",label:"Biology"},{value:"Computer Science",label:"Computer Science"}]},{name:"department",placeholder:"Department",icon:AC},{name:"employeeId",placeholder:"Employee ID"},{name:"designation",placeholder:"Designation",icon:AC},{name:"qualification",placeholder:"Qualification (e.g., PhD, M.Tech)"},{name:"experience",placeholder:"Years of Experience"},{name:"dateOfJoining",placeholder:"Date of Joining",type:"date",icon:k.A}];case"parents":return[{name:"occupation",placeholder:"Occupation",icon:AC},{name:"alternatePhone",placeholder:"Alternate Phone Number",icon:kC.A},{name:"emergencyContact",placeholder:"Emergency Contact",icon:kC.A},{name:"relationship",placeholder:"Select Relationship",type:"select",options:[{value:"Father",label:"Father"},{value:"Mother",label:"Mother"},{value:"Guardian",label:"Guardian"},{value:"Grandfather",label:"Grandfather"},{value:"Grandmother",label:"Grandmother"},{value:"Uncle",label:"Uncle"},{value:"Aunt",label:"Aunt"},{value:"Other",label:"Other"}]}];default:return[]}})()];return(0,w.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4 safe-area-top safe-area-bottom",children:(0,w.jsxs)("div",{className:"bg-white rounded-2xl sm:rounded-3xl shadow-2xl w-full max-w-2xl max-h-[95vh] sm:max-h-[90vh] overflow-hidden",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200",children:[(0,w.jsx)("h2",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:(()=>{const e=c?"Edit":"Add",t=(null===r||void 0===r?void 0:r.slice(0,-1))||"User";return"".concat(e," ").concat(t.charAt(0).toUpperCase()+t.slice(1))})()}),(0,w.jsx)("button",{onClick:n,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-xl transition-all duration-200",children:(0,w.jsx)(f.A,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),(0,w.jsxs)("div",{className:"p-4 sm:p-6 overflow-y-auto max-h-[calc(95vh-120px)] sm:max-h-[calc(90vh-120px)]",children:[(0,w.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[h.map((e,t)=>(0,w.jsx)("div",{className:"address"===e.name?"sm:col-span-2":"",children:(0,w.jsx)(jC,(0,N.A)((0,N.A)({},e),{},{value:a[e.name]||"",onChange:i}))},e.name)),(0,w.jsx)("div",{className:"sm:col-span-2",children:(0,w.jsx)(jC,{type:"textarea",name:"address",placeholder:"Address",value:a.address||"",onChange:i,icon:_C.A,rows:3})})]}),(0,w.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 mt-6",children:[(0,w.jsx)("button",{onClick:n,className:"w-full sm:flex-1 bg-gray-500 text-white py-3 rounded-xl font-semibold hover:bg-gray-600 transition-all duration-300",children:"Cancel"}),(0,w.jsx)("button",{onClick:o,disabled:s,className:"w-full sm:flex-1 bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 disabled:opacity-50",children:s?"Processing...":c?"Update":"Add"})]})]})]})})};var TC=n(2054),OC=n(5088),PC=n(7819);const DC=e=>{var t,n,r;let{request:a,onApprove:i,onReject:o,loading:s}=e;return(0,w.jsxs)("div",{className:"bg-white rounded-xl sm:rounded-2xl p-4 sm:p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-300",children:[(0,w.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,w.jsxs)("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:[(0,w.jsx)("div",{className:"h-10 w-10 sm:h-12 sm:w-12 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold flex-shrink-0",children:(null===(t=a.parentName)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase())||"P"}),(0,w.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,w.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 truncate",children:a.parentName}),(0,w.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"Parent Registration Request"})]})]}),(0,w.jsxs)("div",{className:"flex items-center space-x-1 px-2 sm:px-3 py-1 rounded-full border text-xs sm:text-sm font-medium flex-shrink-0 ".concat((e=>{switch(e){case"approved":return"bg-green-100 text-green-800 border-green-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(a.status)),children:[(e=>{switch(e){case"approved":return(0,w.jsx)(TC.A,{className:"w-4 h-4"});case"rejected":return(0,w.jsx)(f.A,{className:"w-4 h-4"});case"pending":return(0,w.jsx)(OC.A,{className:"w-4 h-4"});default:return(0,w.jsx)(PC.A,{className:"w-4 h-4"})}})(a.status),(0,w.jsx)("span",{className:"capitalize hidden sm:inline",children:a.status})]})]}),(0,w.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:gap-4 mb-4",children:[(0,w.jsxs)("div",{className:"flex items-center space-x-2 text-xs sm:text-sm text-gray-600 min-w-0",children:[(0,w.jsx)(CC.A,{className:"w-4 h-4 flex-shrink-0"}),(0,w.jsx)("span",{className:"truncate",children:a.parentEmail})]}),(0,w.jsxs)("div",{className:"flex items-center space-x-2 text-xs sm:text-sm text-gray-600",children:[(0,w.jsx)(kC.A,{className:"w-4 h-4 flex-shrink-0"}),(0,w.jsx)("span",{children:a.parentPhone})]}),(0,w.jsxs)("div",{className:"flex items-center space-x-2 text-xs sm:text-sm text-gray-600 min-w-0",children:[(0,w.jsx)(EC.A,{className:"w-4 h-4 flex-shrink-0"}),(0,w.jsxs)("span",{className:"truncate",children:["Child: ",a.childName]})]}),(0,w.jsxs)("div",{className:"flex items-center space-x-2 text-xs sm:text-sm text-gray-600",children:[(0,w.jsx)(k.A,{className:"w-4 h-4 flex-shrink-0"}),(0,w.jsx)("span",{children:new Date(1e3*(null===(r=a.createdAt)||void 0===r?void 0:r.seconds)||Date.now()).toLocaleDateString()})]})]}),(0,w.jsxs)("div",{className:"bg-gray-50 rounded-lg sm:rounded-xl p-3 sm:p-4 mb-4",children:[(0,w.jsx)("h4",{className:"text-xs sm:text-sm font-medium text-gray-900 mb-2",children:"Child Information"}),(0,w.jsxs)("div",{className:"grid grid-cols-1 gap-2 text-xs sm:text-sm text-gray-600",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{className:"font-medium",children:"Name:"})," ",a.childName]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{className:"font-medium",children:"Class:"})," ",a.childClass]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{className:"font-medium",children:"Student ID:"})," ",a.childStudentId]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{className:"font-medium",children:"School:"})," ",a.childSchool]})]})]}),"pending"===a.status&&(0,w.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:[(0,w.jsx)("button",{onClick:()=>o(a.id),disabled:s,className:"flex-1 bg-red-500 text-white py-3 px-4 rounded-xl font-medium hover:bg-red-600 transition-all duration-200 disabled:opacity-50 text-sm sm:text-base min-h-12 touch-manipulation",children:"Reject"}),(0,w.jsx)("button",{onClick:()=>i(a.id,a),disabled:s,className:"flex-1 bg-green-500 text-white py-3 px-4 rounded-xl font-medium hover:bg-green-600 transition-all duration-200 disabled:opacity-50 text-sm sm:text-base min-h-12 touch-manipulation",children:"Approve"})]}),"rejected"===a.status&&a.rejectionReason&&(0,w.jsx)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-xl",children:(0,w.jsxs)("p",{className:"text-xs sm:text-sm text-red-800",children:[(0,w.jsx)("span",{className:"font-medium",children:"Rejection Reason:"})," ",a.rejectionReason]})})]})},RC=e=>{let{isOpen:t,onClose:n,requests:r,onApprove:a,onReject:i,loading:o}=e;if(!t)return null;const s=r.filter(e=>"pending"===e.status),l=r.filter(e=>"pending"!==e.status);return(0,w.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 safe-area-top safe-area-bottom",children:(0,w.jsxs)("div",{className:"bg-white rounded-2xl sm:rounded-3xl shadow-2xl w-full max-w-4xl max-h-[95vh] overflow-hidden animate-slide-up",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200",children:[(0,w.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,w.jsx)("h2",{className:"text-lg sm:text-2xl font-bold text-gray-900 truncate",children:"Child Registration Requests"}),(0,w.jsxs)("p",{className:"text-sm sm:text-base text-gray-600",children:[s.length," pending request",1!==s.length?"s":""]})]}),(0,w.jsx)("button",{onClick:n,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-xl transition-all duration-200 flex-shrink-0",children:(0,w.jsx)(f.A,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),(0,w.jsx)("div",{className:"p-4 sm:p-6 overflow-y-auto max-h-[calc(95vh-80px)]",children:0===r.length?(0,w.jsxs)("div",{className:"text-center py-8 sm:py-12 text-gray-500",children:[(0,w.jsx)(TC.A,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-300 mx-auto mb-4"}),(0,w.jsx)("h3",{className:"text-base sm:text-lg font-medium mb-2",children:"No Requests Found"}),(0,w.jsx)("p",{className:"text-sm sm:text-base",children:"There are no child registration requests at the moment."})]}):(0,w.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[s.length>0&&(0,w.jsxs)("div",{children:[(0,w.jsxs)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:["Pending Requests (",s.length,")"]}),(0,w.jsx)("div",{className:"space-y-3 sm:space-y-4",children:s.map(e=>(0,w.jsx)(DC,{request:e,onApprove:a,onReject:i,loading:o},e.id))})]}),l.length>0&&(0,w.jsxs)("div",{children:[(0,w.jsxs)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:["Processed Requests (",l.length,")"]}),(0,w.jsx)("div",{className:"space-y-3 sm:space-y-4",children:l.map(e=>(0,w.jsx)(DC,{request:e,onApprove:a,onReject:i,loading:o},e.id))})]})]})})]})})};var MC=n(6667),FC=n(1121);const LC={data:null,timestamp:null,ttl:3e5},BC=async()=>{try{if(LC.data&&LC.timestamp&&Date.now()-LC.timestamp<LC.ttl)return console.log("\ud83d\udccb Using cached dashboard data"),{success:!0,data:LC.data,fromCache:!0};console.log("\ud83d\udcca Fetching optimized dashboard overview data...");const[e,t,n,r]=await Promise.all([(0,MC.d_)((0,MC.P)((0,MC.rJ)(FC.db,"users"),(0,MC._M)("role","==","student"))),(0,MC.d_)((0,MC.P)((0,MC.rJ)(FC.db,"users"),(0,MC._M)("role","==","teacher"))),(0,MC.d_)((0,MC.P)((0,MC.rJ)(FC.db,"users"),(0,MC._M)("role","==","parent"))),(0,MC.GG)((0,MC.P)((0,MC.rJ)(FC.db,"attendance"),(0,MC._M)("timestamp",">=",MC.Dc.fromDate(new Date(Date.now()-2592e6))),(0,MC.My)("timestamp","desc"),(0,MC.AB)(1e3)))]),a=e.data().count,i=t.data().count,o=n.data().count,s=r.docs.map(e=>e.data()),l=s.filter(e=>"present"===e.status).length,c=s.length,u={totalStudents:a,totalTeachers:i,totalParents:o,avgAttendance:c>0?Math.round(l/c*100):85,totalRecords:c,lastUpdated:(new Date).toISOString()};return LC.data=u,LC.timestamp=Date.now(),{success:!0,data:u}}catch(e){return console.error("\u274c Error fetching optimized dashboard overview:",e),{success:!1,error:e.message}}},UC=async()=>{try{console.log("\ud83d\udcc8 Fetching optimized enrollment trend data...");return{success:!0,data:[{month:"May",students:1250,attendance:87},{month:"Jun",students:1280,attendance:89},{month:"Jul",students:1320,attendance:91},{month:"Aug",students:1350,attendance:88},{month:"Sep",students:1380,attendance:90}]}}catch(e){return console.error("\u274c Error fetching enrollment trend:",e),{success:!1,error:e.message}}},zC=async()=>{try{console.log("\ud83d\udcca Fetching optimized department distribution...");return{success:!0,data:[{name:"Computer Science",value:45},{name:"Mathematics",value:30},{name:"Science",value:35},{name:"Literature",value:25},{name:"Arts",value:20}]}}catch(e){return console.error("\u274c Error fetching department distribution:",e),{success:!1,error:e.message}}},VC=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{console.log("\ud83d\udc65 Fetching optimized users data (role: ".concat(e||"all",")..."));let r=(0,MC.rJ)(FC.db,"users");e&&(r=(0,MC.P)(r,(0,MC._M)("role","==",e))),r=(0,MC.P)(r,(0,MC.My)("createdAt","desc"),(0,MC.AB)(t)),n&&(r=(0,MC.P)(r,(0,MC.HM)(n)));const a=await(0,MC.GG)(r),i={students:[],teachers:[],parents:[]};return a.docs.forEach(e=>{const t=(0,N.A)({id:e.id},e.data());i[t.role+"s"]&&i[t.role+"s"].push(t)}),{success:!0,data:i,lastDoc:a.docs[a.docs.length-1]||null,hasMore:a.docs.length===t}}catch(r){return console.error("\u274c Error fetching users:",r),{success:!1,error:r.message}}},WC=e=>{const t=new Date-e,n=Math.floor(t/6e4),r=Math.floor(t/36e5),a=Math.floor(t/864e5);return n<60?"".concat(n,"m ago"):r<24?"".concat(r,"h ago"):"".concat(a,"d ago")},qC=()=>{const{showError:e}=(0,x.E$)(),t=(0,a.useRef)(!0),[n,r]=(0,a.useState)({students:[],teachers:[],parents:[]}),[i,o]=(0,a.useState)({totalStudents:0,totalTeachers:0,totalParents:0,averageAttendance:0,monthlyData:[],departmentData:[],recentActivities:[]}),[s,l]=(0,a.useState)({overview:!0,analytics:!0,users:!0,activities:!0}),[c,u]=(0,a.useState)(!0),[d,h]=(0,a.useState)(null),[f,p]=(0,a.useState)(!0),[m,g]=(0,a.useState)(!1),v=(0,a.useCallback)((e,n)=>{t.current&&l(t=>{const r=(0,N.A)((0,N.A)({},t),{},{[e]:n}),a=Object.values(r).some(e=>e);return u(a),r})},[]),y=(0,a.useCallback)(async function(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t.current)try{n&&(LC.data=null,LC.timestamp=null,console.log("\ud83d\uddd1\ufe0f Dashboard cache cleared")),console.log("\ud83d\udd04 Loading dashboard data (optimized)...");try{v("overview",!0),console.log("\ud83d\udd04 Loading overview data...");const n=await BC();if(!t.current)return;if(n.success){const e=n.data;e&&(o(t=>(0,N.A)((0,N.A)({},t),{},{totalStudents:e.totalStudents||0,totalTeachers:e.totalTeachers||0,totalParents:e.totalParents||0,averageAttendance:e.averageAttendance||0})),console.log("\u2705 Overview data loaded:",e))}else e("Failed to load overview data")}catch(a){console.error("\u274c Error loading overview:",a),e("Failed to load overview data")}finally{t.current&&v("overview",!1)}const i=[(async()=>{try{v("analytics",!0),console.log("\ud83d\udd04 Loading analytics data...");const[e,n]=await Promise.all([UC(),zC()]);if(!t.current)return;if(e.success&&o(t=>(0,N.A)((0,N.A)({},t),{},{monthlyData:e.data})),n.success){const e=n.data.map((e,t)=>(0,N.A)((0,N.A)({},e),{},{color:["#3B82F6","#8B5CF6","#EC4899","#F59E0B","#10B981","#F97316"][t%6]}));o(t=>(0,N.A)((0,N.A)({},t),{},{departmentData:e}))}console.log("\u2705 Analytics data loaded")}catch(a){console.error("\u274c Error loading analytics:",a),t.current&&e("Failed to load analytics data")}finally{t.current&&v("analytics",!1)}})(),(async()=>{try{v("activities",!0),console.log("\ud83d\udd04 Loading activities data...");const e=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;try{console.log("\ud83d\udccb Fetching optimized recent activities...");return{success:!0,data:(await(0,MC.GG)((0,MC.P)((0,MC.rJ)(FC.db,"users"),(0,MC.My)("createdAt","desc"),(0,MC.AB)(e)))).docs.map((e,t)=>{var n;const r=e.data(),a=(null===(n=r.createdAt)||void 0===n?void 0:n.toDate())||new Date,i=WC(a);return{id:e.id,title:"New ".concat(r.role," registered"),description:r.name||"Unknown User",timeAgo:i,type:"student"===r.role?"student_registered":"teacher"===r.role?"teacher_added":"user_registered"}})}}catch(a){return console.error("\u274c Error fetching recent activities:",a),{success:!1,error:a.message}}}();if(!t.current)return;e.success&&(o(t=>(0,N.A)((0,N.A)({},t),{},{recentActivities:e.data})),console.log("\u2705 Activities data loaded"))}catch(a){console.error("\u274c Error loading activities:",a),t.current&&e("Failed to load activities data")}finally{t.current&&v("activities",!1)}})(),(async()=>{try{v("users",!0),h(null),p(!0),console.log("\ud83d\udd04 Loading users data...");const e=await VC(null,50,null);if(!t.current)return;e.success&&(r(e.data),h(e.lastDoc),p(e.hasMore)),console.log("\u2705 Users data loaded")}catch(a){console.error("\u274c Error loading users:",a),t.current&&e("Failed to load users data")}finally{t.current&&v("users",!1)}})()];await Promise.allSettled(i)}catch(a){console.error("\u274c Error loading dashboard data:",a),t.current&&e("Failed to load dashboard data: "+a.message)}},[e,v]),b=(0,a.useCallback)(async()=>{if(f&&!s.users&&t.current)try{v("users",!0),console.log("\ud83d\udd04 Loading more users data...");const e=await VC(null,50,d);if(!t.current)return;e.success&&(r(t=>({students:[...t.students,...e.data.students],teachers:[...t.teachers,...e.data.teachers],parents:[...t.parents,...e.data.parents]})),h(e.lastDoc),p(e.hasMore)),console.log("\u2705 More users data loaded")}catch(n){console.error("\u274c Error loading more users:",n),t.current&&e("Failed to load more users")}finally{t.current&&v("users",!1)}},[f,s.users,d,e,v]);return(0,a.useEffect)(()=>{m||(g(!0),y())},[m,y]),(0,a.useEffect)(()=>()=>{t.current=!1},[]),{users:n,analytics:i,dashboardLoading:c,loadingStates:s,hasMoreUsers:f,loadDashboardData:y,loadMoreUsers:b,refreshData:()=>y(!0)}};var HC=n(5400);const GC=(0,o.A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),KC=(0,o.A)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),XC=e=>{let{enabled:t=!1}=e;const[n,r]=(0,a.useState)({loadTime:0,renderTime:0,memoryUsage:0,networkRequests:0}),[i,o]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if(!t)return;const e=performance.now(),n=()=>{const t=performance.now()-e;let n=0;"memory"in performance&&(n=Math.round(performance.memory.usedJSHeapSize/1048576));const a=performance.getEntriesByType("resource").length;r({loadTime:Math.round(e),renderTime:Math.round(t),memoryUsage:n,networkRequests:a})},a=setTimeout(n,1e3),i=setInterval(n,5e3);return()=>{clearTimeout(a),clearInterval(i)}},[t]),t?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("button",{onClick:()=>o(!i),className:"fixed bottom-4 right-4 z-50 p-3 bg-blue-600 text-white rounded-full shadow-lg hover:bg-blue-700 transition-colors",title:"Performance Monitor",children:(0,w.jsx)(E.A,{className:"w-5 h-5"})}),i&&(0,w.jsxs)("div",{className:"fixed bottom-20 right-4 z-50 bg-white rounded-lg shadow-xl border border-gray-200 p-4 w-64",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,w.jsx)("h3",{className:"font-semibold text-gray-900",children:"Performance"}),(0,w.jsx)("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600",children:"\xd7"})]}),(0,w.jsxs)("div",{className:"space-y-3",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)(OC.A,{className:"w-4 h-4 text-blue-500"}),(0,w.jsx)("span",{className:"text-sm text-gray-600",children:"Load Time"})]}),(0,w.jsxs)("span",{className:"text-sm font-medium",children:[n.loadTime,"ms"]})]}),(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)(GC,{className:"w-4 h-4 text-green-500"}),(0,w.jsx)("span",{className:"text-sm text-gray-600",children:"Render Time"})]}),(0,w.jsxs)("span",{className:"text-sm font-medium",children:[n.renderTime,"ms"]})]}),n.memoryUsage>0&&(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)(KC,{className:"w-4 h-4 text-orange-500"}),(0,w.jsx)("span",{className:"text-sm text-gray-600",children:"Memory"})]}),(0,w.jsxs)("span",{className:"text-sm font-medium",children:[n.memoryUsage,"MB"]})]}),(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)(E.A,{className:"w-4 h-4 text-purple-500"}),(0,w.jsx)("span",{className:"text-sm text-gray-600",children:"Requests"})]}),(0,w.jsx)("span",{className:"text-sm font-medium",children:n.networkRequests})]})]}),(0,w.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,w.jsx)("div",{className:"text-xs font-medium text-center py-1 px-2 rounded ".concat(n.renderTime<1e3?"bg-green-100 text-green-700":n.renderTime<3e3?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:n.renderTime<1e3?"Excellent":n.renderTime<3e3?"Good":"Needs Optimization"})})]})]}):null},YC=e=>{var t,n;let{onLogout:r}=e;const{userData:i}=(0,b.A)(),{confirmDialog:o,showSuccess:S}=(0,x.E$)(),[E,C]=(0,a.useState)("overview"),[k,A]=(0,a.useState)(null),[_,j]=(0,a.useState)(!1),[I,T]=(0,a.useState)(!1),O=(0,a.useRef)(null),{users:P,analytics:D,dashboardLoading:R,loadingStates:M,loadDashboardData:F,refreshData:L}=qC(),{childRequests:B,pendingRequestsCount:U,loading:z,loadChildRequests:V,handleApproveChildRequest:W,handleRejectChildRequest:q}=(()=>{const{userData:e}=(0,b.A)(),{showSuccess:t,showError:n}=(0,x.E$)(),[r,i]=(0,a.useState)([]),[o,s]=(0,a.useState)(0),[l,c]=(0,a.useState)(!1),u=async()=>{try{const e=await(0,HC.Q4)();if(e.success){i(e.requests);const t=e.requests.filter(e=>"pending"===e.status).length;s(t),console.log("\u2705 Loaded child requests:",e.requests.length,"total,",t,"pending")}}catch(e){console.error("\u274c Error loading child requests:",e)}};return(0,a.useEffect)(()=>{u()},[]),{childRequests:r,pendingRequestsCount:o,loading:l,loadChildRequests:u,handleApproveChildRequest:async(r,a)=>{try{c(!0);const a=await(0,HC.vf)(r,null===e||void 0===e?void 0:e.uid,(null===e||void 0===e?void 0:e.name)||"Admin");return a.success?(t(a.message),await u(),{success:!0}):(n(a.error),{success:!1,error:a.error})}catch(i){return console.error("\u274c Error approving child request:",i),n("Failed to approve request"),{success:!1,error:"Failed to approve request"}}finally{c(!1)}},handleRejectChildRequest:async function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{c(!0);const i=await(0,HC.hi)(r,null===e||void 0===e?void 0:e.uid,(null===e||void 0===e?void 0:e.name)||"Admin",a);return i.success?(t(i.message),await u(),{success:!0}):(n(i.error),{success:!1,error:i.error})}catch(i){return console.error("\u274c Error rejecting child request:",i),n("Failed to reject request"),{success:!1,error:"Failed to reject request"}}finally{c(!1)}}}})(),{loading:H,showAddModal:G,setShowAddModal:K,modalType:X,selectedUser:Y,formData:Q,handleAddUser:$,handleEditUser:J,handleDeleteUser:Z,handleSubmitUser:ee,handleInputChange:te,handleResetPassword:ne}=(e=>{const{showSuccess:t,showError:n,confirmDialog:r}=(0,x.E$)(),[i,o]=(0,a.useState)(!1),[s,l]=(0,a.useState)(!1),[c,u]=(0,a.useState)(""),[d,h]=(0,a.useState)(null),[f,p]=(0,a.useState)({name:"",email:"",password:"",phone:"",class:"",subject:"",department:"",employeeId:"",designation:"",address:"",dateOfBirth:"",parentContact:"",admissionDate:"",qualification:"",experience:"",dateOfJoining:"",salary:"",occupation:"",alternatePhone:"",emergencyContact:"",relationship:"",children:[]}),m=()=>{p({name:"",email:"",password:"",phone:"",class:"",subject:"",department:"",employeeId:"",designation:"",address:"",dateOfBirth:"",parentContact:"",admissionDate:"",qualification:"",experience:"",dateOfJoining:"",salary:"",occupation:"",alternatePhone:"",emergencyContact:"",relationship:"",children:[]})};return{loading:i,showAddModal:s,setShowAddModal:l,modalType:c,selectedUser:d,formData:f,handleAddUser:e=>{u(e),l(!0),m(),h(null)},handleEditUser:(e,t)=>{h(e),u(t),l(!0),p((0,N.A)((0,N.A)({},f),{},{name:e.name||"",email:e.email||"",phone:e.phone||"",class:e.class||"",subject:e.subject||"",department:e.department||"",employeeId:e.employeeId||"",designation:e.designation||"",address:e.address||"",dateOfBirth:e.dateOfBirth||"",parentContact:e.parentContact||"",admissionDate:e.admissionDate||"",qualification:e.qualification||"",experience:e.experience||"",dateOfJoining:e.dateOfJoining||"",salary:e.salary||"",occupation:e.occupation||"",alternatePhone:e.alternatePhone||"",emergencyContact:e.emergencyContact||"",relationship:e.relationship||"",children:e.children||[]}))},handleDeleteUser:async(n,a)=>{await r("Delete User","Are you sure you want to delete this ".concat(a.slice(0,-1),"? This action cannot be undone."))&&(t("".concat(a.slice(0,-1)," deleted successfully")),e&&e())},handleSubmitUser:async()=>{try{if(o(!0),!f.name||!f.email||!d&&!f.password)return void n("Please fill in all required fields");if("teachers"===c){const r={name:f.name,email:f.email,password:f.password,phone:f.phone,subject:f.subject,department:f.department,employeeId:f.employeeId,designation:f.designation,qualification:f.qualification,experience:f.experience,dateOfJoining:f.dateOfJoining,salary:f.salary,address:f.address},a=d?{success:!0,message:"Teacher updated successfully"}:await(0,y.jT)(r);a.success?(t(a.message),l(!1),m(),h(null),e&&e()):n(a.error)}else if("students"===c){const r={name:f.name,email:f.email,password:f.password,phone:f.phone,class:f.class,dateOfBirth:f.dateOfBirth,parentContact:f.parentContact,admissionDate:f.admissionDate,address:f.address},a=d?{success:!0,message:"Student updated successfully"}:await(0,y.s5)(r);a.success?(t(a.message),l(!1),m(),h(null),e&&e()):n(a.error)}else if("parents"===c){const r={name:f.name,email:f.email,password:f.password,phone:f.phone,occupation:f.occupation,alternatePhone:f.alternatePhone,emergencyContact:f.emergencyContact,relationship:f.relationship,address:f.address,children:f.children},a=d?{success:!0,message:"Parent updated successfully"}:await(0,y.JY)(r);a.success?(t(a.message),l(!1),m(),h(null),e&&e()):n(a.error)}}catch(r){console.error("\u274c Error submitting user:",r),n("Failed to save user")}finally{o(!1)}},handleInputChange:e=>{const{name:t,value:n}=e.target;p(e=>(0,N.A)((0,N.A)({},e),{},{[t]:n}))},handleResetPassword:async e=>{await r("Reset Password","This will send a password reset email to the user. Continue?")&&t("Password reset email sent successfully")},resetForm:m}})(()=>{F(),V()}),re=[{id:"overview",label:"Overview",icon:s},{id:"students",label:"Students",icon:l.A},{id:"teachers",label:"Teachers",icon:c.A},{id:"parents",label:"Parents",icon:u.A},{id:"analytics",label:"Analytics",icon:d},{id:"requests",label:"Requests",icon:h,badge:U}];return R&&!D.totalStudents?(0,w.jsxs)("div",{className:"min-h-screen bg-gray-50 flex",children:[(0,w.jsxs)("div",{className:"w-64 bg-white shadow-lg",children:[(0,w.jsx)("div",{className:"p-6",children:(0,w.jsxs)("div",{className:"flex items-center space-x-3 animate-pulse",children:[(0,w.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-xl"}),(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{className:"w-24 h-5 bg-gray-200 rounded mb-2"}),(0,w.jsx)("div",{className:"w-32 h-3 bg-gray-200 rounded"})]})]})}),(0,w.jsx)("div",{className:"px-6 space-y-2",children:[...Array(6)].map((e,t)=>(0,w.jsx)("div",{className:"w-full h-12 bg-gray-200 rounded-lg animate-pulse"},t))})]}),(0,w.jsx)("div",{className:"flex-1 p-6",children:(0,w.jsx)(rC,{})})]}):(0,w.jsxs)("div",{className:"min-h-screen bg-gray-50 flex relative",children:[(0,w.jsx)("input",{type:"file",ref:O,onChange:e=>{const t=e.target.files[0];t&&(console.log("File selected:",t.name),S("File uploaded successfully"))},accept:".csv,.xlsx,.xls",className:"hidden"}),I&&(0,w.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>T(!1)}),(0,w.jsxs)("div",{className:"\n        fixed lg:static inset-y-0 left-0 z-50 \n        w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out\n        ".concat(I?"translate-x-0":"-translate-x-full lg:translate-x-0","\n        safe-area-left\n      "),children:[(0,w.jsx)("div",{className:"p-6",children:(0,w.jsxs)("div",{className:"flex items-center justify-between lg:justify-start lg:space-x-3",children:[(0,w.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,w.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center",children:(0,w.jsx)(l.A,{className:"w-6 h-6 text-white"})}),(0,w.jsxs)("div",{children:[(0,w.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"SchoolAdmin"}),(0,w.jsx)("p",{className:"text-sm text-gray-600",children:"Management Portal"})]})]}),(0,w.jsx)("button",{onClick:()=>T(!1),className:"lg:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors",children:(0,w.jsx)(f.A,{className:"w-5 h-5 text-gray-600"})})]})}),(0,w.jsx)("nav",{className:"mt-6 px-3",children:re.map(e=>(0,w.jsxs)("button",{onClick:()=>(e=>{if("requests"===e)return j(!0),void T(!1);["students","teachers","parents"].includes(e)?(A(e),C("management")):(C(e),A(null)),T(!1)})(e.id),className:"w-full flex items-center justify-between px-3 py-3 mb-1 text-left rounded-lg transition-all duration-200 ".concat(E===e.id||k===e.id?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[(0,w.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,w.jsx)(e.icon,{className:"w-5 h-5"}),(0,w.jsx)("span",{className:"font-medium",children:e.label})]}),e.badge>0&&(0,w.jsx)("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full min-w-[20px] text-center",children:e.badge})]},e.id))}),(0,w.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-6 border-t border-gray-200 bg-white safe-area-bottom",children:[(0,w.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,w.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold",children:(null===i||void 0===i||null===(t=i.name)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase())||"A"}),(0,w.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,w.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:(null===i||void 0===i?void 0:i.name)||"Admin"}),(0,w.jsx)("p",{className:"text-xs text-gray-600 truncate",children:null===i||void 0===i?void 0:i.email})]})]}),(0,w.jsxs)("button",{onClick:async()=>{await o("Logout Confirmation","Are you sure you want to logout?")&&(await(0,y.y4)(),r&&r())},className:"w-full flex items-center space-x-2 px-3 py-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-all duration-200",children:[(0,w.jsx)(p.A,{className:"w-4 h-4"}),(0,w.jsx)("span",{className:"text-sm",children:"Logout"})]})]})]}),(0,w.jsx)("div",{className:"flex-1 overflow-auto lg:ml-0",children:(0,w.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 safe-area-top safe-area-right",children:[(0,w.jsx)("div",{className:"lg:hidden mb-6",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsx)("button",{onClick:()=>T(!0),className:"p-2 rounded-lg bg-white border border-gray-200 hover:bg-gray-50 transition-colors",children:(0,w.jsx)(m,{className:"w-6 h-6 text-gray-600"})}),(0,w.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,w.jsxs)("button",{onClick:()=>j(!0),className:"relative p-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-all duration-200",children:[(0,w.jsx)(g.A,{className:"w-5 h-5 text-gray-600"}),U>0&&(0,w.jsx)("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:U})]}),(0,w.jsx)("button",{className:"p-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-all duration-200",children:(0,w.jsx)(v.A,{className:"w-5 h-5 text-gray-600"})})]})]})}),(0,w.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 sm:mb-8 gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:k?"".concat(k.charAt(0).toUpperCase()+k.slice(1)," Management"):"overview"===E?"Dashboard Overview":E.charAt(0).toUpperCase()+E.slice(1)}),(0,w.jsx)("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:k?"Manage ".concat(k," in your school"):"Welcome to your school management dashboard"})]}),(0,w.jsxs)("div",{className:"hidden lg:flex items-center space-x-4",children:[(0,w.jsxs)("button",{onClick:()=>j(!0),className:"relative p-3 bg-white border border-gray-200 rounded-xl hover:bg-gray-50 transition-all duration-200",children:[(0,w.jsx)(g.A,{className:"w-5 h-5 text-gray-600"}),U>0&&(0,w.jsx)("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:U})]}),(0,w.jsx)("button",{className:"p-3 bg-white border border-gray-200 rounded-xl hover:bg-gray-50 transition-all duration-200",children:(0,w.jsx)(v.A,{className:"w-5 h-5 text-gray-600"})})]})]}),k?(0,w.jsx)(SC,{type:k,users:P[k]||[],onAdd:$,onEdit:J,onDelete:Z,onResetPassword:ne,onApprove:e=>{S("Student ".concat(e," approved successfully")),F()},onBulkUpload:()=>{O.current&&O.current.click()},onBack:()=>{A(null),C("overview")}}):"overview"===E?(0,w.jsx)(uC,{analytics:D,loadingStates:M,onRefresh:L}):(0,w.jsx)("div",{className:"text-center py-12 text-gray-500",children:(0,w.jsxs)("p",{children:["Content for ",E," coming soon..."]})})]})}),(0,w.jsx)(IC,{isOpen:G,onClose:()=>K(!1),modalType:X,formData:Q,onInputChange:te,onSubmit:ee,loading:H,selectedUser:Y}),(0,w.jsx)(RC,{isOpen:_,onClose:()=>j(!1),requests:B,onApprove:W,onReject:q,loading:z}),(0,w.jsx)(XC,{enabled:!1})]})}},2965:(e,t,n)=>{"use strict";n.d(t,{$b:()=>a,Vy:()=>c});const r=[];var a;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(a||(a={}));const i={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},o=a.INFO,s={[a.DEBUG]:"log",[a.VERBOSE]:"log",[a.INFO]:"info",[a.WARN]:"warn",[a.ERROR]:"error"},l=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=s[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];console[r]("[".concat(n,"]  ").concat(e.name,":"),...i)};class c{constructor(e){this.name=e,this._logLevel=o,this._logHandler=l,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in a))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?i[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.DEBUG,...t),this._logHandler(this,a.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.VERBOSE,...t),this._logHandler(this,a.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.INFO,...t),this._logHandler(this,a.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.WARN,...t),this._logHandler(this,a.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.ERROR,...t),this._logHandler(this,a.ERROR,...t)}}},3257:(e,t)=>{t.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}},3272:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toKey=function(e){var t;return"string"===typeof e||"symbol"===typeof e?e:Object.is(null===e||void 0===e||null===(t=e.valueOf)||void 0===t?void 0:t.call(e),-0)?"-0":String(e)}},3693:(e,t,n)=>{var r=n(7736);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},3738:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3757:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isTypedArray=function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}},3799:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(4704),a=n(1203),i=n(870),o=n(9972);t.isIterateeCall=function(e,t,n){return!!i.isObject(n)&&(!!("number"===typeof t&&a.isArrayLike(n)&&r.isIndex(t)&&t<n.length||"string"===typeof t&&t in n)&&o.eq(n[t],e))}},3808:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8268),a=n(5261);t.matches=function(e){return e=a.cloneDeep(e),t=>r.isMatch(t,e)}},3821:(e,t,n)=>{e.exports=n(2204).sortBy},3986:(e,t,n)=>{"use strict";function r(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}n.d(t,{A:()=>r})},4004:(e,t,n)=>{const r=n(7421),a=n(900),i=n(9642),o=n(8697),s=n(5200),l=n(8511),c=n(7969),u=n(7347);function d(e){return unescape(encodeURIComponent(e)).length}function h(e,t,n){const r=[];let a;for(;null!==(a=e.exec(n));)r.push({data:a[0],index:a.index,mode:t,length:a[0].length});return r}function f(e){const t=h(l.NUMERIC,r.NUMERIC,e),n=h(l.ALPHANUMERIC,r.ALPHANUMERIC,e);let a,i;c.isKanjiModeEnabled()?(a=h(l.BYTE,r.BYTE,e),i=h(l.KANJI,r.KANJI,e)):(a=h(l.BYTE_KANJI,r.BYTE,e),i=[]);return t.concat(n,a,i).sort(function(e,t){return e.index-t.index}).map(function(e){return{data:e.data,mode:e.mode,length:e.length}})}function p(e,t){switch(t){case r.NUMERIC:return a.getBitsLength(e);case r.ALPHANUMERIC:return i.getBitsLength(e);case r.KANJI:return s.getBitsLength(e);case r.BYTE:return o.getBitsLength(e)}}function m(e,t){let n;const l=r.getBestModeForData(e);if(n=r.from(t,l),n!==r.BYTE&&n.bit<l.bit)throw new Error('"'+e+'" cannot be encoded with mode '+r.toString(n)+".\n Suggested mode is: "+r.toString(l));switch(n!==r.KANJI||c.isKanjiModeEnabled()||(n=r.BYTE),n){case r.NUMERIC:return new a(e);case r.ALPHANUMERIC:return new i(e);case r.KANJI:return new s(e);case r.BYTE:return new o(e)}}t.fromArray=function(e){return e.reduce(function(e,t){return"string"===typeof t?e.push(m(t,null)):t.data&&e.push(m(t.data,t.mode)),e},[])},t.fromString=function(e,n){const a=function(e){const t=[];for(let n=0;n<e.length;n++){const a=e[n];switch(a.mode){case r.NUMERIC:t.push([a,{data:a.data,mode:r.ALPHANUMERIC,length:a.length},{data:a.data,mode:r.BYTE,length:a.length}]);break;case r.ALPHANUMERIC:t.push([a,{data:a.data,mode:r.BYTE,length:a.length}]);break;case r.KANJI:t.push([a,{data:a.data,mode:r.BYTE,length:d(a.data)}]);break;case r.BYTE:t.push([{data:a.data,mode:r.BYTE,length:d(a.data)}])}}return t}(f(e,c.isKanjiModeEnabled())),i=function(e,t){const n={},a={start:{}};let i=["start"];for(let o=0;o<e.length;o++){const s=e[o],l=[];for(let e=0;e<s.length;e++){const c=s[e],u=""+o+e;l.push(u),n[u]={node:c,lastCount:0},a[u]={};for(let e=0;e<i.length;e++){const o=i[e];n[o]&&n[o].node.mode===c.mode?(a[o][u]=p(n[o].lastCount+c.length,c.mode)-p(n[o].lastCount,c.mode),n[o].lastCount+=c.length):(n[o]&&(n[o].lastCount=c.length),a[o][u]=p(c.length,c.mode)+4+r.getCharCountIndicator(c.mode,t))}}i=l}for(let r=0;r<i.length;r++)a[i[r]].end=0;return{map:a,table:n}}(a,n),o=u.find_path(i.map,"start","end"),s=[];for(let t=1;t<o.length-1;t++)s.push(i.table[o[t]].node);return t.fromArray(function(e){return e.reduce(function(e,t){const n=e.length-1>=0?e[e.length-1]:null;return n&&n.mode===t.mode?(e[e.length-1].data+=t.data,e):(e.push(t),e)},[])}(s))},t.rawSplit=function(e){return t.fromArray(f(e,c.isKanjiModeEnabled()))}},4143:(e,t,n)=>{"use strict";n.d(t,{A:()=>jm});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function a(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function i(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(o,s)}l((r=r.apply(e,t||[])).next())})}function o(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var s=function(){function e(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(e,t){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},e.prototype.registerFlag=function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+r+"."),this.set(e,r)}},e.prototype.get=function(e){return e in this.flags||(this.flags[e]=this.evaluateFlag(e)),this.flags[e]},e.prototype.getNumber=function(e){return this.get(e)},e.prototype.getBool=function(e){return this.get(e)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)},e.prototype.evaluateFlag=function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},e.prototype.setFlags=function(e){this.flags=Object.assign({},e)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var e=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var t,n,r=(t=this.global.location.search,n={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(n,t[0],t[1]),t.join("=")}),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach(function(t){var n=t.split(":"),r=n[0],a=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(""+ +t===t)return+t;throw new Error("Could not parse value flag value "+t+" for flag "+e+".")}(r,a)})}},e}();function l(){return c}var c=null,u=new Map,d=new Map;function h(e,t){var n=g(e,t);return u.get(n)}function f(e){for(var t=u.entries(),n=[];;){var r=t.next(),a=r.done,i=r.value;if(a)break;var o=i[0],s=i[1];o.split("_")[0]===e&&n.push(s)}return n}function p(e){var t=e.kernelName,n=e.backendName,r=g(t,n);if(u.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");u.set(r,e)}function m(e){var t=e.kernelName;d.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),d.set(t,e)}function g(e,t){return t+"_"+e}function v(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function y(e,t,n){return Math.max(e,Math.min(t,n))}function b(e){return e%2==0?e:e+1}function x(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function w(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function N(e,t,n){void 0===n&&(n=""),w(k(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function S(e){w(null!=e,function(){return"The input to the tensor constructor must be a non-null value."})}function E(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=!1),null==t&&(t=[]),Array.isArray(e)||U(e)&&!n)for(var r=0;r<e.length;++r)E(e[r],t,n);else t.push(e);return t}function C(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function k(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function A(e){return e%1==0}function _(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function j(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function I(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function T(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise(function(r,a){var i=0,o=function(){if(e())r();else{i++;var s=t(i);null!=n&&i>=n?a():setTimeout(o,s)}};o()})}function O(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+a);r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found "+e[a]+" at dim "+a);if(-1===r){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(0===n)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function P(e,t){var n=t.length;return w((e=null==e?t.map(function(e,t){return t}):[].concat(e)).every(function(e){return e>=-n&&e<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),w(e.every(function(e){return A(e)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(e){return e<0?n+e:e})}function D(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:P(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function R(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function M(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type "+e);n=new Array(t)}return n}function F(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function L(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function B(e,t){return"complex64"!==t&&("float32"!==t||"complex64"===e)&&("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)}function U(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function z(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)}function V(e){if(null==e)return 0;var t=0;return e.forEach(function(e){return t+=e.length}),t}function W(e){return"string"==typeof e||e instanceof String}function q(e){return"boolean"==typeof e}function H(e){return"number"==typeof e}function G(e){return Array.isArray(e)?G(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":H(e)?"float32":W(e)?"string":q(e)?"bool":"float32"}function K(e){return!!(e&&e.constructor&&e.call&&e.apply)}function X(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Y(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function Q(e,t,n){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=E(e)),n&&F(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var r=new Uint8Array(e.length),a=0;a<r.length;++a)0!==Math.round(e[a])&&(r[a]=1);return r}throw new Error("Unknown data type "+t)}function $(e,t){if(0===e.length)return t[0];var n=e.reduce(function(e,t){return e*t});if(0===n)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function e(t,n,r){var a=new Array;if(1===n.length)for(var i=n[0],o=0;o<i;o++)a[o]=r[t+o];else{i=n[0];var s=n.slice(1),l=s.reduce(function(e,t){return e*t});for(o=0;o<i;o++)a[o]=e(t+o*l,s,r)}return a}(0,e,t)}function J(e,t){for(var n=Z(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Z(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type "+t)}function ee(){return l().platform.now()}function te(e){e.forEach(function(t){w(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function ne(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",l().platform.encode(e,t)}function re(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",l().platform.decode(e,t)}function ae(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function ie(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}Object.freeze({shuffle:v,clamp:y,nearestLargerEven:b,sum:x,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var a=Number(e[r])-Number(t[r]);n+=a*a}return n},assert:w,assertShapesMatch:N,assertNonNull:S,flatten:E,sizeFromShape:C,isScalarShape:function(e){return 0===e.length},arraysEqual:k,isInt:A,tanh:_,sizeToSquarishShape:j,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return v(t),t},rightPad:I,repeatedTry:T,inferFromImplicitShape:O,parseAxisParam:P,squeezeShape:D,getTypedArrayFromDType:R,getArrayFromDType:M,checkConversionForErrors:F,isValidDtype:L,hasEncodingLoss:B,isTypedArray:U,bytesPerElement:z,bytesFromStringArray:V,isString:W,isBoolean:q,isNumber:H,inferDtype:G,isFunction:K,nearestDivisor:X,computeStrides:Y,toTypedArray:Q,toNestedArray:$,makeOnesTypedArray:J,makeZerosTypedArray:Z,now:ee,assertNonNegativeIntegerDimensions:te,fetch:function(e,t){return l().platform.fetch(e,t)},encodeString:ne,decodeString:re,locToIndex:ae,indexToLoc:ie});var oe=function(){function e(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new se)}return e.prototype.profileKernel=function(e,t,n){var r,a=this,i=this.backendTimer.time(function(){r=n()});return r.forEach(function(n){n.data().then(function(r){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found "+a+" in the result of '"+n+"'"),!0}}(r,n.dtype,e),i.then(function(i){var o="";null!=i.getExtraProfileInfo&&(o=i.getExtraProfileInfo()),a.logger.logKernelProfile(e,n,r,i.kernelMs,t,o)})})}),r},e}(),se=function(){function e(){}return e.prototype.logKernelProfile=function(e,t,n,r,a,i){var o="number"==typeof r?I(r+"ms",9):r.error,s=I(e,25),l=t.rank,c=t.size,u=I(t.shape.toString(),14),d="";for(var h in a){var f=a[h].shape||t.shape,p=f.length;d+=h+": "+p+"D "+(p>0?f:"")+" "}console.log("%c"+s+"\t%c"+o+"\t%c"+l+"D "+u+"\t%c"+c+"\t%c"+d+"\t%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}();function le(e,t,n){return I(Array.isArray(e)?parseFloat(e[0].toFixed(7))+" + "+parseFloat(e[1].toFixed(7))+"j":W(e)?"'"+e+"'":"bool"===n?ce(e):parseFloat(e.toFixed(7)).toString(),t)}function ce(e){return 0===e?"false":"true"}function ue(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var de=function(){function e(e,t,n){var r=this;if(this.dtype=t,this.shape=e.slice(),this.size=C(e),null!=n){var a=n.length;w(a===this.size,function(){return"Length of values '"+a+"' does not match the size inferred by the shape '"+r.size+"'."})}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||M(t,this.size),this.strides=Y(e)}return e.prototype.set=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),w(n.length===this.rank,function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+t.rank+")"});var a=this.locToIndex(n);this.values[a]=e},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=0,r=0,a=e;r<a.length;r++){var i=a[r];if(i<0||i>=this.shape[n]){var o="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(o)}n++}for(var s=e[e.length-1],l=0;l<e.length-1;++l)s+=this.strides[l]*e[l];return this.values[s]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return he().makeTensor(this.values,this.shape,this.dtype)},e}(),he=null,fe=null,pe=null,me=function(){function e(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=C(e),this.strides=Y(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),w(1===this.size,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),this.reshape([e,t,n,r,a])},e.prototype.asType=function(e){return this.throwIfDisposed(),fe.cast(this,e)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return i(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,fe.buffer(this.shape,this.dtype,e)]}})})},e.prototype.bufferSync=function(){return fe.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return i(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,$(this.shape,e)]}})})},e.prototype.arraySync=function(){return $(this.shape,this.dataSync())},e.prototype.data=function(){return i(this,void 0,void 0,function(){var e,t;return o(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=he().read(this.dataId),"string"!==this.dtype?[3,2]:[4,e];case 1:t=n.sent();try{return[2,t.map(function(e){return re(e)})]}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}case 2:return[2,e]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var e=he().readSync(this.dataId);if("string"===this.dtype)try{return e.map(function(e){return re(e)})}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},e.prototype.bytes=function(){return i(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,he().read(this.dataId)];case 1:return e=t.sent(),"string"===this.dtype?[2,e]:[2,new Uint8Array(e.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(he().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(e){return void 0===e&&(e=!1),fe.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),fe.reshape(this,e)},e.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),fe.expandDims(this,e)},e.prototype.cumsum=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=!1),void 0===n&&(n=!1),fe.cumsum(this,e,t,n)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),fe.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),fe.clone(this)},e.prototype.oneHot=function(e,t,n){return this.throwIfDisposed(),fe.oneHot(this,e,t,n)},e.prototype.toString=function(e){return void 0===e&&(e=!1),function(e,t,n,r){var a=Y(t),i=function(e,t,n,r){var a=C(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,l="complex64"===n?ue(e):e;if(s>1)for(var c=0;c<a/i;c++)for(var u=c*i,d=0;d<i;d++)o[d]=Math.max(o[d],le(l[u+d],0,n).length);return o}(e,t,n,a),o=t.length,s=function e(t,n,r,a,i,o){void 0===o&&(o=!0);var s="complex64"===r?2:1,l=n[0],c=n.length;if(0===c)return"complex64"===r?[le(ue(t)[0],0,r)]:"bool"===r?[ce(t[0])]:[t[0].toString()];if(1===c){if(l>20){var u=3*s,d=Array.from(t.slice(0,u)),h=Array.from(t.slice((l-3)*s,l*s));return"complex64"===r&&(d=ue(d),h=ue(h)),["["+d.map(function(e,t){return le(e,i[t],r)}).join(", ")+", ..., "+h.map(function(e,t){return le(e,i[l-3+t],r)}).join(", ")+"]"]}return["["+("complex64"===r?ue(t):Array.from(t)).map(function(e,t){return le(e,i[t],r)}).join(", ")+"]"]}var f=n.slice(1),p=a.slice(1),m=a[0]*s,g=[];if(l>20){for(var v=0;v<3;v++){var y=(b=v*m)+m;g.push.apply(g,e(t.slice(b,y),f,r,p,i,!1))}for(g.push("..."),v=l-3;v<l;v++)y=(b=v*m)+m,g.push.apply(g,e(t.slice(b,y),f,r,p,i,v===l-1))}else for(v=0;v<l;v++){var b;y=(b=v*m)+m,g.push.apply(g,e(t.slice(b,y),f,r,p,i,v===l-1))}var x=2===c?",":"";for(g[0]="["+g[0]+x,v=1;v<g.length-1;v++)g[v]=" "+g[v]+x;var w=",\n";for(v=2;v<c;v++)w+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(o?"":w),g}(e,t,n,a,i),l=["Tensor"];return r&&(l.push("  dtype: "+n),l.push("  rank: "+o),l.push("  shape: ["+t+"]"),l.push("  values:")),l.push(s.map(function(e){return"    "+e}).join("\n")),l.join("\n")}(this.dataSync(),this.shape,this.dtype,e)},e.prototype.tile=function(e){return this.throwIfDisposed(),fe.tile(this,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),fe.gather(this,e,t)},e.prototype.matMul=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),this.throwIfDisposed(),fe.matMul(this,e,t,n)},e.prototype.dot=function(e){return this.throwIfDisposed(),fe.dot(this,e)},e.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),fe.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),fe.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),fe.reverse(this,e)},e.prototype.concat=function(t,n){return void 0===n&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),fe.concat([this].concat(t),n)},e.prototype.split=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),fe.split(this,e,t)},e.prototype.stack=function(e,t){return void 0===t&&(t=0),fe.stack([this,e],t)},e.prototype.unstack=function(e){return void 0===e&&(e=0),fe.unstack(this,e)},e.prototype.pad=function(e,t){return void 0===t&&(t=0),fe.pad(this,e,t)},e.prototype.batchNormalization=function(e,t,n,r,a){return void 0===n&&(n=.001),pe("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,a,r,n)},e.prototype.batchNorm=function(e,t,n,r,a){return void 0===a&&(a=.001),this.throwIfDisposed(),fe.batchNorm(this,e,t,n,r,a)},e.prototype.all=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),fe.all(this,e,t)},e.prototype.any=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),fe.any(this,e,t)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),fe.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),fe.sum(this,e,t)},e.prototype.prod=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),fe.prod(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),fe.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),fe.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),fe.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),fe.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),fe.argMax(this,e)},e.prototype.cast=function(e){return this.throwIfDisposed(),fe.cast(this,e)},e.prototype.add=function(e){return this.throwIfDisposed(),fe.add(this,e)},e.prototype.addStrict=function(e){return this.throwIfDisposed(),fe.addStrict(this,e)},e.prototype.atan2=function(e){return this.throwIfDisposed(),fe.atan2(this,e)},e.prototype.sub=function(e){return this.throwIfDisposed(),fe.sub(this,e)},e.prototype.subStrict=function(e){return this.throwIfDisposed(),fe.subStrict(this,e)},e.prototype.pow=function(e){return this.throwIfDisposed(),fe.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),fe.powStrict(this,e)},e.prototype.mul=function(e){return this.throwIfDisposed(),fe.mul(this,e)},e.prototype.mulStrict=function(e){return this.throwIfDisposed(),fe.mulStrict(this,e)},e.prototype.div=function(e){return this.throwIfDisposed(),fe.div(this,e)},e.prototype.divNoNan=function(e){return this.throwIfDisposed(),fe.divNoNan(this,e)},e.prototype.floorDiv=function(e){return this.throwIfDisposed(),fe.floorDiv(this,e)},e.prototype.divStrict=function(e){return this.throwIfDisposed(),fe.divStrict(this,e)},e.prototype.minimum=function(e){return this.throwIfDisposed(),fe.minimum(this,e)},e.prototype.minimumStrict=function(e){return this.throwIfDisposed(),fe.minimumStrict(this,e)},e.prototype.maximum=function(e){return this.throwIfDisposed(),fe.maximum(this,e)},e.prototype.maximumStrict=function(e){return this.throwIfDisposed(),fe.maximumStrict(this,e)},e.prototype.mod=function(e){return this.throwIfDisposed(),fe.mod(this,e)},e.prototype.modStrict=function(e){return this.throwIfDisposed(),fe.modStrict(this,e)},e.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),fe.squaredDifferenceStrict(this,e)},e.prototype.transpose=function(e){return this.throwIfDisposed(),fe.transpose(this,e)},e.prototype.notEqual=function(e){return this.throwIfDisposed(),fe.notEqual(this,e)},e.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),fe.notEqualStrict(this,e)},e.prototype.less=function(e){return this.throwIfDisposed(),fe.less(this,e)},e.prototype.lessStrict=function(e){return this.throwIfDisposed(),fe.lessStrict(this,e)},e.prototype.equal=function(e){return this.throwIfDisposed(),fe.equal(this,e)},e.prototype.equalStrict=function(e){return this.throwIfDisposed(),fe.equalStrict(this,e)},e.prototype.lessEqual=function(e){return this.throwIfDisposed(),fe.lessEqual(this,e)},e.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),fe.lessEqualStrict(this,e)},e.prototype.greater=function(e){return this.throwIfDisposed(),fe.greater(this,e)},e.prototype.greaterStrict=function(e){return this.throwIfDisposed(),fe.greaterStrict(this,e)},e.prototype.greaterEqual=function(e){return this.throwIfDisposed(),fe.greaterEqual(this,e)},e.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),fe.greaterEqualStrict(this,e)},e.prototype.logicalAnd=function(e){return this.throwIfDisposed(),fe.logicalAnd(this,e)},e.prototype.logicalOr=function(e){return this.throwIfDisposed(),fe.logicalOr(this,e)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),fe.logicalNot(this)},e.prototype.logicalXor=function(e){return this.throwIfDisposed(),fe.logicalXor(this,e)},e.prototype.where=function(e,t){return this.throwIfDisposed(),fe.where(e,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),fe.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),fe.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),fe.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),fe.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),fe.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),fe.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),fe.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),fe.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),fe.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),fe.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),fe.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),fe.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),fe.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),fe.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),fe.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),fe.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),fe.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),fe.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),fe.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),fe.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),fe.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),fe.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),fe.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),fe.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),fe.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),fe.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),fe.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),fe.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),fe.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),fe.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),fe.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),fe.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),fe.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),fe.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),fe.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),fe.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),fe.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),fe.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),fe.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),fe.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),fe.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),fe.round(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),fe.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),fe.softmax(this,e)},e.prototype.logSoftmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),fe.logSoftmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),fe.image.resizeBilinear(this,e,t)},e.prototype.resizeNearestNeighbor=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),fe.image.resizeNearestNeighbor(this,e,t)},e.prototype.conv1d=function(e,t,n,r,a,i){return void 0===r&&(r="NWC"),void 0===a&&(a=1),this.throwIfDisposed(),fe.conv1d(this,e,t,n,r,a,i)},e.prototype.conv2d=function(e,t,n,r,a,i){return void 0===r&&(r="NHWC"),void 0===a&&(a=[1,1]),this.throwIfDisposed(),fe.conv2d(this,e,t,n,r,a,i)},e.prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),fe.conv2dTranspose(this,e,t,n,r,a)},e.prototype.depthwiseConv2D=function(e,t,n,r,a,i){return void 0===r&&(r="NHWC"),void 0===a&&(a=[1,1]),this.throwIfDisposed(),fe.depthwiseConv2d(this,e,t,n,r,a,i)},e.prototype.separableConv2d=function(e,t,n,r,a,i){return void 0===a&&(a=[1,1]),void 0===i&&(i="NHWC"),this.throwIfDisposed(),fe.separableConv2d(this,e,t,n,r,a,i)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),fe.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),fe.maxPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(e,t,n,r){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=.5),fe.localResponseNormalization(this,e,t,n,r)},e.prototype.pool=function(e,t,n,r,a){return this.throwIfDisposed(),fe.pool(this,e,t,n,r,a)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),he().makeVariable(this,e,t,n)},e.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),fe.unsortedSegmentSum(this,e,t)},e.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),fe.batchToSpaceND(this,e,t)},e.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),fe.spaceToBatchND(this,e,t)},e.prototype.topk=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.throwIfDisposed(),fe.topk(this,e,t)},e.prototype.stridedSlice=function(e,t,n,r,a,i,o,s){return void 0===r&&(r=0),void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),this.throwIfDisposed(),fe.stridedSlice(this,e,t,n,r,a,i,o,s)},e.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),fe.depthToSpace(this,e,t)},e.prototype.fft=function(){return this.throwIfDisposed(),fe.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),fe.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),fe.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),fe.spectral.irfft(this)},e}();Object.defineProperty(me,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.dataId&&null!=e.shape&&null!=e.dtype}});var ge,ve,ye,be,xe,we=function(e){function t(t,n,r,a){var i=e.call(this,t.shape,t.dtype,t.dataId,a)||this;return i.trainable=n,i.name=r,i}return a(t,e),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!k(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");he().disposeTensor(this),this.dataId=e.dataId,he().incRef(this,null)},t.prototype.dispose=function(){he().disposeVariable(this),this.isDisposedInternal=!0},t}(me);Object.defineProperty(we,Symbol.hasInstance,{value:function(e){return e instanceof me&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(ge||(ge={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(ve||(ve={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(ye||(ye={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(be||(be={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(xe||(xe={}));var Ne={float32:be,int32:ve,bool:ye,complex64:xe};function Se(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast "+e+" with "+t)}return Ne[e][t]}function Ee(e){return Se(e,"int32")}function Ce(e,t){if(e.dtype===t.dtype)return[e,t];var n=Se(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function ke(e,t){w(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function Ae(e){var t=[];return function e(t,n,r){if(null!=t)if(t instanceof me)n.push(t);else if(a=t,Array.isArray(a)||"object"==typeof a){var a,i=t;for(var o in i){var s=i[o];r.has(s)||(r.add(s),e(s,n,r))}}}(e,t,new Set),t}Object.freeze({makeTypesMatch:Ce,assertTypesMatch:ke,isTensorInList:function(e,t){return t.some(function(t){return t.id===e.id})},getTensorsInContainer:Ae});var _e,je=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},e}(),Ie=function(){function e(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new je}return e.prototype.ready=function(){return i(this,void 0,void 0,function(){var e,t,n;return o(this,function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then(function(){})];if(null!=this.backendInstance)return[2];e=this.getSortedBackends(),t=0,r.label=1;case 1:return t<e.length?(n=e[t],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]},e.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},e.prototype.registerBackend=function(e,t,n){return void 0===n&&(n=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)},e.prototype.setBackend=function(e){return i(this,void 0,void 0,function(){var t,n,r;return o(this,function(a){switch(a.label){case 0:if(null==this.registryFactory[e])throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,null!=this.registry[e]?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),n=t.success,t.asyncInit?[4,n]:[3,2]);case 1:return r=a.sent(),[3,3];case 2:r=n,a.label=3;case 3:if(!r)return[2,!1];a.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new oe(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var e=this;f(this.backendName).forEach(function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)})},e.prototype.disposeRegisteredKernels=function(e){var t=this;f(e).forEach(function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])})},e.prototype.initializeBackend=function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var a=++this.pendingBackendInitId,i=r.then(function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)}).catch(function(n){return!(a<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(n.stack||n.message),!1)});return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(t){return console.warn("Initialization of backend "+e+" failed"),console.warn(t.stack||t.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t);r.disposeData(t),n.backend=e,e.move(t,a,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(e,t){var n,r=this,a=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun(function(){return r.startScope(a)},function(){return r.endScope(n)},function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n})},e.prototype.scopedRun=function(e,t,n){e();try{var r=n();return t(),r}catch(e){throw t(),e}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],function(e){return{x:function(){return e.toFloat()}}},[]),t},e.prototype.runKernel=function(e,t,n,r,a){return this.runKernelFunc(null,t,null,e,n,r,a)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach(function(e){a+="complex64"===e.dtype?3:1});var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+o+" data ids) after running '"+e+"'")},e.prototype.runKernelFunc=function(e,t,n,r,a,i,o){var s,l=this;void 0===i&&(i=[]),void 0===o&&(o=[]);var c=[],u=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var d,f=function(e){u&&(c=e.map(function(e){return l.keep(l.clone(e))}))},p=this.state.numBytes,m=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,v=h(r,this.backendName);return d=null!=v?function(){var e=l.backend.numDataIds();g=v.kernelFunc({inputs:t,attrs:a,backend:l.backend});var n=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(r,e,n);var s=n.map(function(e){var t=e.dataId,n=e.shape,r=e.dtype;return l.makeTensorFromDataId(t,n,r)}),c=s.filter(function(e,t){return o[t]});return f((i||[]).slice().concat(c)),s}:function(){var t=l.backend.numDataIds();g=l.tidy(function(){return e(l.backend,f)});var n=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(r,t,n),n},this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){s=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(r,t,function(){return d()}):d()}),u&&this.addTapeNode(r,t,s,n,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-m,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map(function(e){return t[e].shape}),outputShapes:s.map(function(e){return e.shape})}),Array.isArray(g)?s:s[0]},e.prototype.makeTensor=function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&W(e[0])&&(a=e.map(function(e){return ne(e)}));var i=r.write(a,t,n),o=new me(t,n,i,this.nextTensorId());if(this.incRef(o,r),"string"===n){var s=this.state.tensorInfo.get(i),l=V(a);this.state.numBytes+=l-s.bytes,s.bytes=l}return o},e.prototype.makeTensorFromDataId=function(e,t,n,r){var a=new me(t,n=n||"float32",e,this.nextTensorId());return this.incRef(a,r),a},e.prototype.makeVariable=function(e,t,n,r){void 0===t&&(t=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.asType(r));var a=new we(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},e.prototype.incRef=function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*z(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof we||this.track(e)},e.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},e.prototype.disposeVariable=function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]},e.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},e.prototype.profile=function(e){return i(this,void 0,void 0,function(){var t,n;return o(this,function(r){return this.state.profiling=!0,t=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(e){return e.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},e.prototype.addTapeNode=function(e,t,n,r,a){var i=this,o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},s=function(e){return d.get(e)}(e);null!=s&&(r=s.gradFunc),null!=r&&(o.gradient=function(e){return e=e.map(function(e,t){if(null==e){var r=n[t],a=Z(r.size,r.dtype);return i.makeTensor(a,r.shape,r.dtype)}return e}),r(e.length>1?e:e[0],a)}),this.state.activeTape.push(o)},e.prototype.keep=function(e){return e.kept=!0,e},e.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},e.prototype.endScope=function(e){for(var t=this,n=Ae(e),r=new Set(n.map(function(e){return e.id})),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(function(e){e.kept||e.scopeId!==o.id||t.track(e)})},e.prototype.gradients=function(e,t,n,r){var a=this;if(void 0===r&&(r=!1),w(t.length>0,function(){return"gradients() received an empty list of xs."}),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var i=this.scopedRun(function(){return a.startTape()},function(){return a.endTape()},function(){return a.tidy("forward",e)});w(i instanceof me,function(){return"The result y returned by f() must be a tensor."});var o=function(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(i=0;i<e.length;i++){var o=(p=e[i]).inputs;for(var s in o){for(var l=o[s],c=!1,u=0;u<t.length;u++)if(r[l.id]){p.outputs.forEach(function(e){return r[e.id]=!0}),c=!0,a[p.id]=!0;break}if(c)break}}var d={};d[n.id]=!0;var h={};for(i=e.length-1;i>=0;i--)for(o=(p=e[i]).inputs,u=0;u<p.outputs.length;u++)if(d[p.outputs[u].id]){for(var s in o)d[o[s].id]=!0,h[p.id]=!0;break}var f=[];for(i=0;i<e.length;i++){var p;if(a[(p=e[i]).id]&&h[p.id]){var m={};for(var s in p.inputs){var g=p.inputs[s];r[g.id]&&(m[s]=g)}var v=Object.assign({},p);v.inputs=m,v.outputs=p.outputs,f.push(v)}}return f}(this.state.activeTape,t,i);if(!r&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var e,r,s={};s[i.id]=null==n?(r=J(C(e=i.shape),"float32"),Te.makeTensor(r,e,"float32")):n,function(e,t,n){for(var r=function(r){var a=t[r],i=[];if(a.outputs.forEach(function(t){var n=e[t.id];null!=n?i.push(n):i.push(null)}),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+a.kernelName+".");var o=a.gradient(i),s=function(t){if(!(t in o))throw new Error("Cannot backprop through input "+t+". Available gradients found: "+Object.keys(o)+".");var r=n(function(){return o[t]()});if("float32"!==r.dtype)throw new Error("Error in gradient for op "+a.kernelName+". The gradient of input "+t+" must have 'float32' dtype, but has '"+r.dtype+"'");var i=a.inputs[t];if(!k(r.shape,i.shape))throw new Error("Error in gradient for op "+a.kernelName+". The gradient of input '"+t+"' has shape '"+r.shape+"', which does not match the shape of the input '"+i.shape+"'");if(null==e[i.id])e[i.id]=r;else{var s=e[i.id];e[i.id]=s.add(r),s.dispose()}};for(var l in a.inputs)s(l)},a=t.length-1;a>=0;a--)r(a)}(s,o,function(e){return a.tidy(e)});var l=t.map(function(e){return s[e.id]});return 0===a.state.gradientDepth&&(a.state.activeTape.forEach(function(e){for(var t=0,n=e.saved;t<n.length;t++)n[t].dispose()}),a.state.activeTape=null),{value:i,grads:l}})},e.prototype.customGrad=function(e){var t=this;return w(K(e),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var n,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];w(r.every(function(e){return e instanceof me}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var i={};return r.forEach(function(e,t){i[t]=e}),t.runKernelFunc(function(t,a){return w((n=e.apply(void 0,r.concat([a]))).value instanceof me,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),w(K(n.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),n.value},i,function(e,t){var a=n.gradFunc(e,t),i=Array.isArray(a)?a:[a];w(i.length===r.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),w(i.every(function(e){return e instanceof me}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var o={};return i.forEach(function(e,t){o[t]=function(){return e}}),o})}},e.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},e.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},e.prototype.time=function(e){return i(this,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return t=ee(),[4,this.backend.time(e)];case 1:return(n=r.sent()).wallMs=ee()-t,[2,n]}})})},e.prototype.track=function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new je,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),Te=function(){var e=function(){if(null==_e){var e=void 0;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof n.g)e=n.g;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}_e=e}return _e}();if(null==e._tfengine){var t=new s(e);e._tfengine=new Ie(t)}return function(e){c=e}(e._tfengine.ENV),he=function(){return e._tfengine},e._tfengine}();function Oe(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var Pe=l();Pe.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Pe.registerFlag("IS_BROWSER",function(){return Oe()}),Pe.registerFlag("IS_NODE",function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node}),Pe.registerFlag("IS_CHROME",function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Pe.registerFlag("PROD",function(){return!1}),Pe.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Pe.getBool("DEBUG")}),Pe.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Pe.registerFlag("IS_TEST",function(){return!1});var De,Re,Me,Fe={},Le={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Be(e,t){Fe[e]=t}function Ue(e){e in Fe||(Fe[e]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return t.addEventListener("webglcontextlost",function(t){t.preventDefault(),delete Fe[e]},!1),1===e?t.getContext("webgl",Le)||t.getContext("experimental-webgl",Le):t.getContext("webgl2",Le)}(e));var t=Fe[e];return t.isContextLost()?(delete Fe[e],Ue(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Fe[e])}function ze(e,t){return[t,e]}function Ve(e){var t=C(e);return j(Math.ceil(t/4))}function We(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function qe(e,t){var n,r,a,i,o,s,c,u,d,h=e;return 2===l().getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,a=h.RGBA16F,i=h.RGBA32F,o=h.RED,s=4,c=1,u=h.HALF_FLOAT,d=h.FLOAT):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=h.RGBA,o=e.RGBA,s=4,c=4,u=null!=t?t.HALF_FLOAT_OES:null,d=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:c,textureTypeHalfFloat:u,textureTypeFloat:d}}function He(e,t,n){var r=n();return t&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+Ke(e,t))}(e),r}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(De||(De={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Re||(Re={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Me||(Me={}));function Ge(e){return!!(l().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function Ke(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Xe(e,t,n){return vt(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function Ye(e,t,n){var r=vt(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(He(e,t,function(){return e.shaderSource(r,n)}),He(e,t,function(){return e.compileShader(r)}),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function Qe(e,t,n){var r=vt(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(He(e,t,function(){return e.shaderSource(r,n)}),He(e,t,function(){return e.compileShader(r)}),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw function(e,t){var n=Ze.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map(function(e,t){return I((t+1).toString(),i)+e}),s=0,l=0;l<o.length;l++)s=Math.max(o[l].length,s);var c=o.slice(0,r-1),u=o.slice(r-1,r),d=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+I(u[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join("\n"))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var $e,Je,Ze=/ERROR: [0-9]+:([0-9]+):/g;function et(e,t){return vt(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function tt(e,t,n){if(He(e,t,function(){return e.linkProgram(n)}),!1===e.getProgramParameter(n,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function nt(e,t,n){if(He(e,t,function(){return e.validateProgram(n)}),!1===e.getProgramParameter(n,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function rt(e,t,n){var r=vt(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return He(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),He(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function at(e,t,n){var r=vt(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return He(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),He(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function it(e,t){return vt(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function ot(e,t){var n=l().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function st(e,t){return vt(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function lt(e,t,n,r,a,i,o,s){var l=e.getAttribLocation(n,r);return-1!==l&&(He(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,a)}),He(e,t,function(){return e.vertexAttribPointer(l,i,e.FLOAT,!1,o,s)}),He(e,t,function(){return e.enableVertexAttribArray(l)}),!0)}function ct(e,t,n,r){yt(e,r),He(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),He(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function ut(e,t,n,r){return vt(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function dt(e,t,n){return e.getUniformLocation(t,n)}function ht(e,t,n,r,a,i){He(e,t,function(){return ct(e,t,r,i)}),He(e,t,function(){return e.uniform1i(a,i)})}function ft(e,t,n,r){He(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),He(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function pt(e,t,n){He(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),He(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function mt(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+gt(e,t))}function gt(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function vt(e,t,n,r){var a=He(e,t,function(){return n()});if(null==a)throw new Error(r);return a}function yt(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function bt(e,t){return void 0===t&&(t=2),C(e.slice(0,e.length-t))}function xt(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function wt(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[bt(e)].concat(xt(e))),t}function Nt(e,t){var n;void 0===t&&(t=!1);var r=l().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,1===(e=e.map(function(t,n){return n>=e.length-2?b(e[n]):e[n]})).length&&(e=[2,e[0]])),2!==e.length){var a=D(e);e=a.newShape}var i=C(e);if(e.length<=1&&i<=r)return[1,i];if(2===e.length&&e[0]<=r&&e[1]<=r)return e;if(3===e.length&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var o=bt(e),s=2,c=2;return e.length&&(s=(n=xt(e))[0],c=n[1]),j(i=o*(s/2)*(c/2)).map(function(e){return 2*e})}return j(i)}function St(e){return e%2==0}function Et(e,t){if(k(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(St(n)&&St(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&St(e[0])&&St(t[0])}function Ct(e){if(null==$e){var t=Ue(e);$e=t.getParameter(t.MAX_TEXTURE_SIZE)}return $e}function kt(e){if(null==Je){var t=Ue(e);Je=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Je)}function At(e){if(0===e)return 0;var t=Ue(e);return _t(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:_t(t,"EXT_disjoint_timer_query")?1:0}function _t(e,t){return null!=e.getExtension(t)}function jt(e){try{if(null!=Ue(e))return!0}catch(e){return!1}return!1}function It(e){if(0===e)return!1;var t=Ue(e);if(1===e){if(!_t(t,"OES_texture_float"))return!1}else if(!_t(t,"EXT_color_buffer_float"))return!1;return Ot(t)}function Tt(e){if(0===e)return!1;var t=Ue(e);if(1!==e){if(_t(t,"EXT_color_buffer_float"))return Ot(t);if(_t(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(e,t){var n=qe(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(a),i}(t,n)}return!1}return!!_t(t,"OES_texture_float")&&!!_t(t,"WEBGL_color_buffer_float")&&Ot(t)}function Ot(e){var t=qe(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function Pt(e){return 2===e&&null!=Ue(e).fenceSync}var Dt=Object.freeze({callAndCheck:He,canBeRepresented:Ge,getWebGLErrorMessage:Ke,getExtensionOrThrow:Xe,createVertexShader:Ye,createFragmentShader:Qe,createProgram:et,linkProgram:tt,validateProgram:nt,createStaticVertexBuffer:rt,createStaticIndexBuffer:at,getNumChannels:function(){return 2===l().getNumber("WEBGL_VERSION")?1:4},createTexture:it,validateTextureSize:ot,createFramebuffer:st,bindVertexBufferToProgramAttribute:lt,bindTextureUnit:ct,unbindTextureUnit:function(e,t,n){yt(e,n),He(e,t,function(){return e.activeTexture(e.TEXTURE0+n)}),He(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:ut,getProgramUniformLocation:dt,bindTextureToProgramUniformSampler:ht,bindCanvasToFramebuffer:function(e,t){He(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),He(e,t,function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)}),He(e,t,function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)})},bindColorTextureToFramebuffer:ft,unbindColorTextureFromFramebuffer:pt,validateFramebuffer:mt,getFramebufferErrorMessage:gt,getBatchDim:bt,getRowsCols:xt,getShapeAs3D:wt,getTextureShapeFromLogicalShape:Nt,isReshapeFree:Et,getWebGLMaxTextureSize:Ct,resetMaxTextureSize:function(){$e=null},resetMaxTexturesInShader:function(){Je=null},getMaxTexturesInShader:kt,getWebGLDisjointQueryTimerVersion:At,hasExtension:_t,isWebGLVersionEnabled:jt,isCapableOfRenderingToFloatTexture:It,isDownloadFloatTextureEnabled:Tt,isWebGLFenceEnabled:Pt}),Rt=l();function Mt(e){l().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Ft(e,t){return Te.tidy(e,t)}function Lt(e){Ae(e).forEach(function(e){return e.dispose()})}function Bt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];l().getBool("IS_TEST")||console.warn.apply(console,e)}function Ut(e,t){var n=e;if(U(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||U(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&l().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],Array.isArray(t)||U(t)){w(n.length>0,function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+t.length+" elements"}),w(t.length===n[0],function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+t.length+" elements"});for(var a=n.slice(1),i=0;i<t.length;++i)e(t[i],a,r.concat(i))}else w(0===n.length,function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"})}(e,r,[]),r}function zt(e,t,n,r){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function Vt(e,t,n,r){if(void 0===r&&(r="numeric"),e instanceof me)return zt(r,e.dtype,t,n),e;var a=G(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),zt(r,a,t,n),null==e||!U(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){var i=null==e?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var o=Ut(e,a);U(e)||Array.isArray(e)||(e=[e]);var s="string"!==a?Q(e,a,l().getBool("DEBUG")):E(e,[],!0);return Te.makeTensor(s,o,a)}function Wt(e,t,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(e,r){return Vt(e,t+"["+r+"]",n)},r)}function qt(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Ht(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}function Gt(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map(function(t){return e[t]})]}function Kt(e,t){return Ht(e,t.map(function(e){return 1}),t)}function Xt(e,t,n){w(qt(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function Yt(e,t){if(qt(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach(function(e){return n.push(e)}),n}function Qt(e){return e.map(function(e,t){return[t,e]}).sort(function(e,t){return e[1]-t[1]}).map(function(e){return e[0]})}function $t(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function Jt(e,t){var n=e[0].length;e.forEach(function(e,t){w(e.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+t+"] must be the same as the rank of the rest ("+n+")"})}),w(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(e,a){for(var i=0;i<n;i++)w(i===t||e[i]===r[i],function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+e+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+a+"."})})}function Zt(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function en(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Te.startScope(n);try{var a=r.apply(void 0,e);return a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Te.endScope(a),a}catch(e){throw Te.endScope(null),e}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}Rt.registerFlag("HAS_WEBGL",function(){return Rt.getNumber("WEBGL_VERSION")>0}),Rt.registerFlag("WEBGL_VERSION",function(){return jt(2)?2:jt(1)?1:0}),Rt.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return 2===Rt.get("WEBGL_VERSION")}),Rt.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Rt.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Rt.registerFlag("WEBGL_PACK",function(){return Rt.getBool("HAS_WEBGL")}),Rt.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Rt.getBool("WEBGL_PACK")}),Rt.registerFlag("WEBGL_PACK_CLIP",function(){return Rt.getBool("WEBGL_PACK")}),Rt.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Rt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Rt.getBool("WEBGL_PACK")}),Rt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Rt.getBool("WEBGL_PACK")}),Rt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Rt.getBool("WEBGL_PACK")}),Rt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Rt.getBool("WEBGL_PACK")}),Rt.registerFlag("WEBGL_PACK_REDUCE",function(){return Rt.getBool("WEBGL_PACK")}),Rt.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Rt.getBool("WEBGL_PACK")}),Rt.registerFlag("WEBGL_CONV_IM2COL",function(){return Rt.getBool("WEBGL_PACK")}),Rt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return Ct(Rt.getNumber("WEBGL_VERSION"))}),Rt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return kt(Rt.getNumber("WEBGL_VERSION"))}),Rt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=Rt.getNumber("WEBGL_VERSION");return 0===e?0:At(e)}),Rt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Rt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),Rt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return It(Rt.getNumber("WEBGL_VERSION"))}),Rt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Rt.getBool("WEBGL_FORCE_F16_TEXTURES")&&Rt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Rt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return Tt(Rt.getNumber("WEBGL_VERSION"))}),Rt.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return Pt(Rt.getNumber("WEBGL_VERSION"))}),Rt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Rt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),pe=Mt;var tn=en({complex_:function(e,t){var n=Vt(e,"real","complex"),r=Vt(t,"imag","complex");return N(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),Te.runKernelFunc(function(e){return e.complex(n,r)},{$real:n,$imag:r})}}),nn=en({real_:function(e){var t=Vt(e,"input","real");return Te.runKernelFunc(function(e){return e.real(t)},{$input:t})}}),rn=en({imag_:function(e){var t=Vt(e,"input","imag");return Te.runKernelFunc(function(e){return e.imag(t)},{$input:t})}});function an(e,t,n){return on(e,t,Ut(e,n),n)}function on(e,t,n,r){if(null==r&&(r=G(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!U(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){te(t);var a=C(t),i=C(n);w(a===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+i});for(var o=0;o<n.length;++o){var s=n[o],c=o!==n.length-1||s!==C(t.slice(o));w(n[o]===t[o]||!c,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return U(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?Q(e,r,l().getBool("DEBUG")):E(e,[],!0),Te.makeTensor(e,t,r)}function sn(e,t){if((U(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&U(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return on(e,[],[],t)}function ln(e,t){S(e);var n=Ut(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return on(e,null,n,t)}function cn(e,t,n){if(S(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Ut(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return on(e,t,r,n)}function un(e,t,n){if(S(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=Ut(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return on(e,t,r,n)}function dn(e,t,n){if(S(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Ut(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return on(e,t,r,n)}function hn(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=hn(e,"float32"),r=fn(e,"float32");return tn(n,r)}var a=J(C(e),t);return Te.makeTensor(a,e,t)}function fn(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=fn(e,"float32"),r=fn(e,"float32");return tn(n,r)}var a=Z(C(e),t);return Te.makeTensor(a,e,t)}function pn(e,t,n){return Te.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function mn(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return fn([0],r);var a=Z(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return ln(a,r)}var gn=en({onesLike_:function(e){var t=Vt(e,"x","onesLike");if("complex64"===t.dtype){var n=gn(nn(t)),r=vn(rn(t));return tn(n,r)}return Te.runKernelFunc(function(e){return e.onesLike(t)},{$x:t},function(e,t){return{$x:function(){return vn(e)}}})}}),vn=en({zerosLike_:function(e){var t=Vt(e,"x","zerosLike");return Te.runKernelFunc(function(e){return e.zerosLike(t)},{$x:t},function(e,t){return{$x:function(){return vn(e)}}})}}),yn=en({concat_:function(e,t){void 0===t&&(t=0),w(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=Wt(e,"tensors","concat");"complex64"===n[0].dtype&&n.forEach(function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+e.dtype+". ")}),t=P(t,n[0].shape)[0];var r=Zt(n.map(function(e){return e.shape}),t);if(0===C(r))return an([],r);if(1===(n=n.filter(function(e){return e.size>0})).length)return n[0];var a=n.map(function(e){return e.shape});Jt(a,t);var i=n,o={axis:t};return Te.runKernelFunc(function(e){return e.concat(n,t)},i,function(e){var n=a.map(function(e){return e[t]});return Sn(e,n,t).map(function(e){return function(){return e}})},"Concat",o)}}),bn=en({concat1d_:function(e){return yn(e,0)}}),xn=en({concat2d_:function(e,t){return yn(e,t)}}),wn=en({concat3d_:function(e,t){return yn(e,t)}}),Nn=en({concat4d_:function(e,t){return yn(e,t)}}),Sn=en({split_:function(e,t,n){void 0===n&&(n=0);var r,a=Vt(e,"x","split");return n=P(n,a.shape)[0],"number"==typeof t?(w(a.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(a.shape[n]/t)):(w(a.shape[n]===t.reduce(function(e,t){return e+t}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),Te.runKernelFunc(function(e){return e.split(a,r,n)},{$x:a},function(e){return{$x:function(){return yn(e,n)}}})}});function En(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self&&self;var Cn=En(function(e){!function(e,t){function n(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function r(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function a(e,t){var a=new n(e),i=t&&t.state,o=a.next;return o.int32=function(){return 4294967296*a.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,i&&("object"==typeof i&&r(i,a),o.state=function(){return r(a,{})}),o}t&&t.exports?t.exports=a:this.alea=a}(0,e)}),kn=En(function(e){!function(e,t){function n(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function a(e,t){var a=new n(e),i=t&&t.state,o=function(){return(a.next()>>>0)/4294967296};return o.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=a.next,o.quick=o,i&&("object"==typeof i&&r(i,a),o.state=function(){return r(a,{})}),o}t&&t.exports?t.exports=a:this.xor128=a}(0,e)}),An=En(function(e){!function(e,t){function n(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function a(e,t){var a=new n(e),i=t&&t.state,o=function(){return(a.next()>>>0)/4294967296};return o.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=a.next,o.quick=o,i&&("object"==typeof i&&r(i,a),o.state=function(){return r(a,{})}),o}t&&t.exports?t.exports=a:this.xorwow=a}(0,e)}),_n=En(function(e){!function(e,t){function n(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function r(e,t){return t.x=e.x.slice(),t.i=e.i,t}function a(e,t){null==e&&(e=+new Date);var a=new n(e),i=t&&t.state,o=function(){return(a.next()>>>0)/4294967296};return o.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=a.next,o.quick=o,i&&(i.x&&r(i,a),o.state=function(){return r(a,{})}),o}t&&t.exports?t.exports=a:this.xorshift7=a}(0,e)}),jn=En(function(e){!function(e,t){function n(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],l=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,l=Math.max(l,t.length)),a=0,i=-32;i<l;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function r(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function a(e,t){null==e&&(e=+new Date);var a=new n(e),i=t&&t.state,o=function(){return(a.next()>>>0)/4294967296};return o.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=a.next,o.quick=o,i&&(i.X&&r(i,a),o.state=function(){return r(a,{})}),o}t&&t.exports?t.exports=a:this.xor4096=a}(0,e)}),In=En(function(e){!function(e,t){function n(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function r(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function a(e,t){var a=new n(e),i=t&&t.state,o=function(){return(a.next()>>>0)/4294967296};return o.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=a.next,o.quick=o,i&&("object"==typeof i&&r(i,a),o.state=function(){return r(a,{})}),o}t&&t.exports?t.exports=a:this.tychei=a}(0,e)}),Tn=En(function(e){!function(t,r){var a,i=this,o=256,s="random",l=r.pow(o,6),c=r.pow(2,52),u=2*c,d=255;function h(e,n,d){var h=[],v=m(function e(t,n){var r,a=[],i=typeof t;if(n&&"object"==i)for(r in t)try{a.push(e(t[r],n-1))}catch(e){}return a.length?a:"string"==i?t:t+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[e,g(t)]:null==e?function(){try{var e;return a&&(e=a.randomBytes)?e=e(o):(e=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(e)),g(e)}catch(e){var n=i.navigator,r=n&&n.plugins;return[+new Date,i,r,i.screen,g(t)]}}():e,3),h),y=new f(h),b=function(){for(var e=y.g(6),t=l,n=0;e<c;)e=(e+n)*o,t*=o,n=y.g(1);for(;e>=u;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,m(g(y.S),t),(n.pass||d||function(e,t,n,a){return a&&(a.S&&p(a,y),e.state=function(){return p(y,{})}),n?(r[s]=e,t):e})(b,v,"global"in n?n.global:this==r,n.state)}function f(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);a<o;)s[a]=a++;for(a=0;a<o;a++)s[a]=s[i=d&i+e[a%n]+(t=s[a])],s[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,s=r.S;e--;)t=s[a=d&a+1],n=n*o+s[d&(s[a]=s[i=d&i+t])+(s[i]=t)];return r.i=a,r.j=i,n})(o)}function p(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){for(var n,r=e+"",a=0;a<r.length;)t[d&a]=d&(n^=19*t[d&a])+r.charCodeAt(a++);return g(t)}function g(e){return String.fromCharCode.apply(0,e)}if(r["seed"+s]=h,m(r.random(),t),e.exports){e.exports=h;try{a=n(8082)}catch(e){}}}([],Math)});Tn.alea=Cn,Tn.xor128=kn,Tn.xorwow=An,Tn.xorshift7=_n,Tn.xor4096=jn,Tn.tychei=In;var On=Tn.alea,Pn=function(){function e(e,t,n,r,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=a||Math.random();this.random=On(i.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},e.prototype.convertValue=function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)},e.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},e}(),Dn=function(){function e(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;var a=r||Math.random();this.randu=On(a.toString()),this.randn=new Pn(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var e,t,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(a=this.randu())<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)},e.prototype.convertValue=function(e){return"float32"===this.dtype?e:Math.round(e)},e}(),Rn=function(){function e(e,t,n,r){var a=this;if(void 0===e&&(e=0),void 0===t&&(t=1),this.canReturnFloat=function(){return null==a.dtype||"float32"===a.dtype},this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=On(r)}return e.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function Mn(e,t,n){return void 0===t&&(t="float32"),t=t||"float32",te(e),new de(e,t,n)}var Fn=en({batchToSpaceND_:function(e,t,n){var r=Vt(e,"x","batchToSpaceND"),a=t.reduce(function(e,t){return e*t});return w(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),w(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),w(r.shape[0]%a==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a}),Te.runKernelFunc(function(e){return e.batchToSpaceND(r,t,n)},{$x:r},function(e){return{$x:function(){return e.spaceToBatchND(t,n)}}})}}),Ln=en({broadcastTo_:function(e,t){var n=Vt(e,"broadcastTo","x"),r=n.shape;if(t.some(function(e){return!(e>0)||e%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var a=n.shape.slice();a.length<t.length;)a.unshift(1);n=n.reshape(a)}for(var i=Array.from(t),o=t.length-1;o>=0;o--)if(n.shape[o]===t[o])i[o]=1;else if(1!==n.shape[o])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=i.map(function(e,t){return e>1?t:-1}).filter(function(e){return e>=0});return 0===s.length?n.clone():Te.runKernelFunc(function(e){return e.tile(n,i)},{input:n},function(e){return{input:function(){return e.sum(s,!0)}}})}}),Bn=en({cast_:function(e,t){var n=Vt(e,"x","cast");if(!L(t))throw new Error("Failed to cast to unknown dtype "+t);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={dtype:t};return Te.runKernelFunc(function(e){return e.cast(n,t)},{x:n},function(e){return{x:function(){return e.clone()}}},"Cast",r)}}),Un=en({clone_:function(e){var t=Vt(e,"x","clone",null);return Te.runKernelFunc(function(){return Te.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(e){return{$x:function(){return e.toFloat()}}})}}),zn=en({cumsum_:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var a=Vt(e,"x","cumsum"),i=Yt([t|=0],a.rank),o=a;null!=i&&(o=a.transpose(i));var s=$t(1,a.rank)[0],l=Te.runKernelFunc(function(e){return e.cumsum(o,s,n,r)},{permutedX:o},function(e){return{permutedX:function(){return e.cumsum(t,n,!r)}}});return null!=i&&(l=l.transpose(i)),l}}),Vn=en({depthToSpace_:function(e,t,n){void 0===n&&(n="NHWC");var r=Vt(e,"x","depthToSpace"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];return w(a*t>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+a+" and "+t+"  for depthToSpace with input shape\n      "+r.shape}),w(i*t>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+t+" for depthToSpace with input shape\n          "+r.shape}),w(o%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+o+" for depthToSpace with input shape "+r.shape}),Te.runKernelFunc(function(e){return e.depthToSpace(r,t,n)},{$x:r})}}),Wn=en({expandDims_:function(e,t){void 0===t&&(t=0);var n=Vt(e,"x","expandDims",null);w(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(w(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),nr(n,r)}}),qn=en({eye_:function(e,t,n,r){void 0===r&&(r="float32"),null==t&&(t=e);for(var a=Mn([e,t],r),i=e<=t?e:t,o=0;o<i;++o)a.set(1,o,o);var s=a.toTensor().as2D(e,t);if(null==n)return s;if(1===n.length)return or(Wn(s,0),[n[0],1,1]);if(2===n.length)return or(Wn(Wn(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return or(Wn(Wn(Wn(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),Hn=en({multinomial_:function(e,t,n,r){void 0===r&&(r=!1);var a=Vt(e,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=1===o?a.as2D(1,-1):a,l=Te.runKernelFunc(function(e){return e.multinomial(s,r,t,n)},{logits2D:s});return 1===o?l.as1D():l}}),Gn=en({oneHot_:function(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=Vt(e,"indices","oneHot","int32"),i=a.shape.concat([t]);return a=a.flatten(),Te.runKernelFunc(function(e){return e.oneHot(a,t,n,r)},{$indices:a},function(e){return{$indices:function(){return fn(a.shape,"float32")}}}).reshape(i)}}),Kn=en({pad_:function(e,t,n){void 0===n&&(n=0);var r=Vt(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:n};return Te.runKernelFunc(function(e){return e.pad(r,t,n)},{x:r},function(e){var n=t.map(function(e){return e[0]});return{x:function(){return e.slice(n,r.shape)}}},"PadV2",a)}}),Xn=en({pad1d_:function(e,t,n){return void 0===n&&(n=0),w(2===t.length,function(){return"Invalid number of paddings. Must be length of 2."}),Kn(e,[t],n)}}),Yn=en({pad2d_:function(e,t,n){return void 0===n&&(n=0),w(2===t.length&&2===t[0].length&&2===t[1].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Kn(e,t,n)}}),Qn=en({pad3d_:function(e,t,n){return void 0===n&&(n=0),w(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Kn(e,t,n)}}),$n=en({pad4d_:function(e,t,n){return void 0===n&&(n=0),w(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Kn(e,t,n)}}),Jn=en({rand_:function(e,t,n){var r=C(e),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return Te.makeTensor(a,e,n)}}),Zn=en({randomNormal_:function(e,t,n,r,a){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new Pn(t,n,r,!1,a),o=Mn(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),er=en({randomGamma_:function(e,t,n,r,a){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var i=new Dn(t,n,r,a),o=Mn(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),tr=en({randomUniform_:function(e,t,n,r,a){void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var i=Mn(e,r),o=new Rn(t,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}}),nr=en({reshape_:function(e,t){var n=Vt(e,"x","reshape",null);t=O(t,n.size),w(n.size===C(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return Te.runKernelFunc(function(e){return e.reshape(n,t)},{x:n},function(e){return{x:function(){return e.reshape(n.shape)}}},"Reshape",r)}}),rr=en({spaceToBatchND_:function(e,t,n){var r=Vt(e,"x","spaceToBatchND");return w(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),w(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),w(r.shape.reduce(function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]==0:e},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),Te.runKernelFunc(function(e){return e.spaceToBatchND(r,t,n)},{$x:r},function(e){return{$x:function(){return e.batchToSpaceND(t,n)}}})}}),ar=en({squeeze_:function(e,t){var n=Vt(e,"x","squeeze");return nr(n,D(n.shape,t).newShape)}}),ir=en({stack_:function(e,t){void 0===t&&(t=0);var n=Wt(e,"tensors","stack");if(w(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),1===n.length)return n[0].expandDims(t);var r=n[0].rank,a=n[0].shape,i=n[0].dtype;w(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(e){N(a,e.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(e){w(i===e.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var o=n.map(function(e){return e.expandDims(t)});return yn(o,t)}}),or=en({tile_:function(e,t){var n=Vt(e,"x","tile",null);w(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],a={reps:t};return Te.runKernelFunc(function(e,r){var a=e.tile(n,t);return r([n]),a},{x:n},function(e,n){var r=n[0];return{x:function(){var n=vn(r);if(1===r.rank)for(var a=0;a<t[0];++a)n=n.add(e.slice([a*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(a=0;a<t[0];++a)for(var i=0;i<t[1];++i)n=n.add(e.slice([a*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(a=0;a<t[0];++a)for(i=0;i<t[1];++i)for(var o=0;o<t[2];++o)n=n.add(e.slice([a*r.shape[0],i*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(a=0;a<t[0];++a)for(i=0;i<t[1];++i)for(o=0;o<t[2];++o)for(var s=0;s<t[3];++s)n=n.add(e.slice([a*r.shape[0],i*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}},"Tile",a,r)}}),sr=en({truncatedNormal_:function(e,t,n,r,a){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new Pn(t,n,r,!0,a),o=Mn(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),lr=en({unstack_:function(e,t){void 0===t&&(t=0),t=t||0;var n=Vt(e,"x","unstack");w(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return Te.runKernelFunc(function(e){return e.unstack(n,t)},{x:n},function(e){return{x:function(){return ir(e,t)}}},"Unpack",r)}});function cr(e,t,n,r){void 0===r&&(r=!0);var a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function ur(e,t,n){void 0===n&&(n=!0);var r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{var i=[],o=[];for(a=1;a<e;++a)a>=2*t+1||a%2==1?o.push(a):i.push(a);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function dr(e,t,n,r){void 0===r&&(r=!0);var a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function hr(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function fr(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function pr(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],a=1,i=0;i<n.length-1;++i)a*=n[i];var o=e.shape,s=n.slice();s.pop();var l=1;for(i=r;i<e.rank;++i)l*=o[i],s.push(o[i]);var c=Y(e.shape).map(function(e){return e/l}).concat([1]).slice(0,r);return[s,a,l,c]}Object.freeze({prepareAndValidate:pr});function mr(e){return e<=30?e:X(e,Math.floor(Math.sqrt(e)))}function gr(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+a+".";if(n.rank<a)throw new Error(i+" update.rank < "+a+". ");if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < "+(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != "+(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+t.shape[o]+").");for(o=0;o<n.rank-a;++o)if(n.shape[o+a]!==e[o+r])throw new Error(i+" updates.shape["+(o+a)+"] ("+n.shape[o+a]+") != shape["+(o+a)+"] ("+e[o+a]+")")}function vr(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(0===e.size)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}gr(n,t,e)}function yr(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,o=1,s=a;s<i;++s)o*=n[s];var l=a<1?1:a;return{sliceRank:a,numUpdates:C(t.shape)/l,sliceSize:o,strides:Y(n.slice(0,a)).concat([1]),outputSize:C(n)}}Object.freeze({validateUpdateShape:gr,validateInput:vr,calculateShapes:yr});function br(e,t,n){w(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),w(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(r){w(t[r]+n[r]<=e.shape[r],function(){return"Error in slice"+e.rank+"D: begin["+r+"] + size["+r+"] ("+(t[r]+n[r])+") would overflow input.shape["+r+"] ("+e.shape[r]+")"})},a=0;a<e.rank;++a)r(a)}function xr(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function wr(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function Nr(e,t,n,r,a){var i=t[a],o=n[a]||1;(e&1<<a||null==i)&&(i=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),y(0,i,s-1)}function Sr(e,t,n,r,a){var i=t[a],o=n[a]||1;(e&1<<a||null==i)&&(i=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),o>0?y(0,i,s):y(-1,i,s-1)}function Er(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(a=r+1;a<n.length;a++)if(t[a]>0||n[a]!==e[a])return!1;return!0}function Cr(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}Object.freeze({assertParamsValid:br,maskToAxes:xr,computeOutShape:wr,startForAxis:Nr,stopForAxis:Sr,isSliceContinous:Er,computeFlatOffset:Cr});function kr(e){return Te.customGrad(e)}var Ar=en({softmax_:function(e,t){void 0===t&&(t=-1);var n=Vt(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return Te.runKernelFunc(function(e,r){var a=e.softmax(n,t);return r([a]),a},{logits:n},function(e,n){var r=n[0],a=e.mul(r);return{logits:function(){return a.sub(a.sum([t],!0).mul(r))}}},"Softmax",{dim:t},[],[!0])}}),_r=en({logSoftmax_:function(e,t){void 0===t&&(t=-1);var n=Vt(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return kr(function(e,n){var r=e.max(t,!0),a=e.sub(r),i=a.toFloat().sub(a.exp().sum(t,!0).log());return n([i]),{value:i,gradFunc:function(e,n){var r=n[0].exp();return e.sub(e.sum(t,!0).mul(r))}}})(n)}}),jr=function(){function e(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},e.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},e.prototype.has=function(e){return this.data.has(e)},e.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),Ir=function(){function e(){}return e.prototype.time=function(e){return Tr("time")},e.prototype.read=function(e){return Tr("read")},e.prototype.readSync=function(e){return Tr("readSync")},e.prototype.numDataIds=function(){return Tr("numDataIds")},e.prototype.disposeData=function(e){return Tr("disposeData")},e.prototype.write=function(e,t,n){return Tr("write")},e.prototype.move=function(e,t,n,r){return Tr("move")},e.prototype.memory=function(){return Tr("memory")},e.prototype.floatPrecision=function(){return Tr("floatPrecision")},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.batchMatMul=function(e,t,n,r){return Tr("batchMatMul")},e.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,Tr("fusedBatchMatMul")},e.prototype.slice=function(e,t,n){return Tr("slice")},e.prototype.stridedSlice=function(e,t,n,r){return Tr("stridedSlice")},e.prototype.unstack=function(e,t){return Tr("unstack")},e.prototype.reverse=function(e,t){return Tr("reverse")},e.prototype.concat=function(e,t){return Tr("concat")},e.prototype.neg=function(e){return Tr("neg")},e.prototype.add=function(e,t){return Tr("add")},e.prototype.addN=function(e){return Tr("addN")},e.prototype.subtract=function(e,t){return Tr("subtract")},e.prototype.multiply=function(e,t){return Tr("multiply")},e.prototype.realDivide=function(e,t){return Tr("realDivide")},e.prototype.floorDiv=function(e,t){return Tr("floorDiv")},e.prototype.sum=function(e,t){return Tr("sum")},e.prototype.prod=function(e,t){return Tr("prod")},e.prototype.unsortedSegmentSum=function(e,t,n){return Tr("unsortedSegmentSum")},e.prototype.argMin=function(e,t){return Tr("argMin")},e.prototype.argMax=function(e,t){return Tr("argMax")},e.prototype.equal=function(e,t){return Tr("equal")},e.prototype.notEqual=function(e,t){return Tr("notEqual")},e.prototype.less=function(e,t){return Tr("less")},e.prototype.lessEqual=function(e,t){return Tr("lessEqual")},e.prototype.greater=function(e,t){return Tr("greater")},e.prototype.greaterEqual=function(e,t){return Tr("greaterEqual")},e.prototype.logicalNot=function(e){return Tr("logicalNot")},e.prototype.logicalAnd=function(e,t){return Tr("logicalAnd")},e.prototype.logicalOr=function(e,t){return Tr("logicalOr")},e.prototype.where=function(e){return Tr("where")},e.prototype.select=function(e,t,n){return Tr("select")},e.prototype.topk=function(e,t,n){return Tr("topk")},e.prototype.min=function(e,t){return Tr("min")},e.prototype.minimum=function(e,t){return Tr("minimum")},e.prototype.mod=function(e,t){return Tr("mod")},e.prototype.max=function(e,t){return Tr("max")},e.prototype.maximum=function(e,t){return Tr("maximum")},e.prototype.all=function(e,t){return Tr("all")},e.prototype.any=function(e,t){return Tr("any")},e.prototype.squaredDifference=function(e,t){return Tr("squaredDifference")},e.prototype.ceil=function(e){return Tr("ceil")},e.prototype.floor=function(e){return Tr("floor")},e.prototype.round=function(e){return Tr("round")},e.prototype.sign=function(e){return Tr("sign")},e.prototype.isNaN=function(e){return Tr("isNaN")},e.prototype.isInf=function(e){return Tr("isInf")},e.prototype.isFinite=function(e){return Tr("isFinite")},e.prototype.pow=function(e,t){return Tr("pow")},e.prototype.exp=function(e){return Tr("exp")},e.prototype.expm1=function(e){return Tr("expm1")},e.prototype.softmax=function(e,t){return Tr("softmax")},e.prototype.log=function(e){return Tr("log")},e.prototype.log1p=function(e){return Tr("log1p")},e.prototype.sqrt=function(e){return Tr("sqrt")},e.prototype.rsqrt=function(e){return Tr("rsqrt")},e.prototype.square=function(e){return Tr("square")},e.prototype.reciprocal=function(e){return Tr("reciprocal")},e.prototype.relu=function(e){return Tr("relu")},e.prototype.relu6=function(e){return Tr("relu6")},e.prototype.prelu=function(e,t){return Tr("prelu")},e.prototype.elu=function(e){return Tr("elu")},e.prototype.eluDer=function(e,t){return Tr("eluDer")},e.prototype.selu=function(e){return Tr("selu")},e.prototype.int=function(e){return Tr("int")},e.prototype.clip=function(e,t,n){return Tr("clip")},e.prototype.abs=function(e){return Tr("abs")},e.prototype.complexAbs=function(e){return Tr("complexAbs")},e.prototype.sigmoid=function(e){return Tr("sigmoid")},e.prototype.softplus=function(e){return Tr("softplus")},e.prototype.sin=function(e){return Tr("sin")},e.prototype.cos=function(e){return Tr("cos")},e.prototype.tan=function(e){return Tr("tan")},e.prototype.asin=function(e){return Tr("asin")},e.prototype.acos=function(e){return Tr("acos")},e.prototype.atan=function(e){return Tr("atan")},e.prototype.atan2=function(e,t){return Tr("atan2")},e.prototype.sinh=function(e){return Tr("sinh")},e.prototype.cosh=function(e){return Tr("cosh")},e.prototype.tanh=function(e){return Tr("tanh")},e.prototype.asinh=function(e){return Tr("asinh")},e.prototype.acosh=function(e){return Tr("acosh")},e.prototype.atanh=function(e){return Tr("atanh")},e.prototype.erf=function(e){return Tr("erf")},e.prototype.step=function(e,t){return Tr("step")},e.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Tr("fusedConv2d")},e.prototype.conv2d=function(e,t,n){return Tr("conv2d")},e.prototype.conv2dDerInput=function(e,t,n){return Tr("conv2dDerInput")},e.prototype.conv2dDerFilter=function(e,t,n){return Tr("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Tr("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(e,t,n){return Tr("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(e,t,n){return Tr("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){return Tr("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(e,t,n){return Tr("conv3d")},e.prototype.conv3dDerInput=function(e,t,n){return Tr("conv3dDerInput")},e.prototype.conv3dDerFilter=function(e,t,n){return Tr("conv3dDerFilter")},e.prototype.maxPool=function(e,t){return Tr("maxPool")},e.prototype.maxPoolBackprop=function(e,t,n,r){return Tr("maxPoolBackprop")},e.prototype.avgPool=function(e,t){return Tr("avgPool")},e.prototype.avgPoolBackprop=function(e,t,n){return Tr("avgPoolBackprop")},e.prototype.avgPool3d=function(e,t){return Tr("avgPool3d")},e.prototype.avgPool3dBackprop=function(e,t,n){return Tr("avgPool3dBackprop")},e.prototype.maxPool3d=function(e,t){return Tr("maxPool3d")},e.prototype.maxPool3dBackprop=function(e,t,n,r){return Tr("maxPool3dBackprop")},e.prototype.reshape=function(e,t){return Tr("reshape")},e.prototype.cast=function(e,t){return Tr("cast")},e.prototype.tile=function(e,t){return Tr("tile")},e.prototype.pad=function(e,t,n){return Tr("pad")},e.prototype.transpose=function(e,t){return Tr("transpose")},e.prototype.gather=function(e,t,n){return Tr("gather")},e.prototype.gatherND=function(e,t){return Tr("gatherND")},e.prototype.scatterND=function(e,t,n){return Tr("scatterND")},e.prototype.batchToSpaceND=function(e,t,n){return Tr("batchToSpaceND")},e.prototype.spaceToBatchND=function(e,t,n){return Tr("spaceToBatchND")},e.prototype.resizeBilinear=function(e,t,n,r){return Tr("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(e,t,n){return Tr("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(e,t,n,r){return Tr("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){return Tr("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(e,t,n,r,a,i){return Tr("batchNormalization")},e.prototype.localResponseNormalization4D=function(e,t,n,r,a){return Tr("localResponseNormalization4D")},e.prototype.LRNGrad=function(e,t,n,r,a,i,o){return Tr("LRNGrad")},e.prototype.multinomial=function(e,t,n,r){return Tr("multinomial")},e.prototype.oneHot=function(e,t,n,r){return Tr("oneHot")},e.prototype.cumsum=function(e,t,n,r){return Tr("cumsum")},e.prototype.nonMaxSuppression=function(e,t,n,r,a){return Tr("nonMaxSuppression")},e.prototype.fft=function(e){return Tr("fft")},e.prototype.ifft=function(e){return Tr("ifft")},e.prototype.complex=function(e,t){return Tr("complex")},e.prototype.real=function(e){return Tr("real")},e.prototype.imag=function(e){return Tr("imag")},e.prototype.cropAndResize=function(e,t,n,r,a,i){return Tr("cropAndResize")},e.prototype.depthToSpace=function(e,t,n){return Tr("depthToSpace")},e.prototype.split=function(e,t,n){return Tr("split")},e.prototype.sparseToDense=function(e,t,n,r){return Tr("sparseToDense")},e.prototype.diag=function(e){return Tr("diag")},e.prototype.fill=function(e,t,n){return Tr("fill")},e.prototype.onesLike=function(e){return Tr("onesLike")},e.prototype.zerosLike=function(e){return Tr("zerosLike")},e.prototype.linspace=function(e,t,n){return Tr("linspace")},e.prototype.dispose=function(){return Tr("dispose")},e}();function Tr(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Or(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function Pr(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function Dr(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function Rr(e,t,n,r,a,i,o){void 0===o&&(o="channelsLast");var s,l=Ur(t),c=l[0],u=l[1];if("channelsLast"===o)s=[c,u,e[3],e[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);s=[c,u,e[1],e[1]]}return Fr(e,s,n,r,a,i,!1,o)}function Mr(e,t,n,r,a,i,o){void 0===o&&(o="NDHWC");var s,l,c=zr(t),u=c[0],d=c[1],h=c[2];if("NDHWC"===o)l="channelsLast",s=[u,d,h,e[4],e[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat "+o);l="channelsFirst",s=[u,d,h,e[1],e[1]]}return Lr(e,s,n,r,a,!1,l,i)}function Fr(e,t,n,r,a,i,o,s){void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var l=[-1,-1,-1,-1],c=l[0],u=l[1],d=l[2],h=l[3];if("channelsLast"===s)c=e[0],u=e[1],d=e[2],h=e[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=e[0],h=e[1],u=e[2],d=e[3]}var f,p=t[0],m=t[1],g=t[3],v=Ur(n),y=v[0],b=v[1],x=Ur(r),N=x[0],S=x[1],E=Vr(p,N),C=Vr(m,S),k=function(e,t,n,r,a,i,o,s){var l,c,u;if("number"==typeof e){l={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var d=function(e,t,n,r,a){null==r&&(r=Br(e,t,n));var i=e[1],o=Wr((e[0]-t+2*r)/n+1,a);w(A(o),function(){return"The output # of rows ("+o+") must be an integer. Change the stride and/or zero pad parameters"});var s=Wr((i-t+2*r)/n+1,a);return w(A(s),function(){return"The output # of columns ("+s+") must be an integer. Change the stride and/or zero pad parameters"}),[o,s]}([t,n],i,r,e,s);c=d[0],u=d[1]}else if("same"===e){c=Math.ceil(t/r),u=Math.ceil(n/a);var h=Math.max(0,(c-1)*r+i-t),f=Math.max(0,(u-1)*a+o-n),p=Math.floor(h/2),m=h-p,g=Math.floor(f/2);l={top:p,bottom:m,left:g,right:f-g,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);l={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-i+1)/r),u=Math.ceil((n-o+1)/a)}return{padInfo:l,outHeight:c,outWidth:u}}(a,u,d,y,b,E,C,i),_=k.padInfo,j=k.outHeight,I=k.outWidth,T=o?g*h:g;return"channelsFirst"===s?f=[c,T,j,I]:"channelsLast"===s&&(f=[c,j,I,T]),{batchSize:c,dataFormat:s,inHeight:u,inWidth:d,inChannels:h,outHeight:j,outWidth:I,outChannels:T,padInfo:_,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:m,effectiveFilterHeight:E,effectiveFilterWidth:C,dilationHeight:N,dilationWidth:S,inShape:e,outShape:f,filterShape:t}}function Lr(e,t,n,r,a,i,o,s){void 0===i&&(i=!1),void 0===o&&(o="channelsLast");var l=[-1,-1,-1,-1,-1],c=l[0],u=l[1],d=l[2],h=l[3],f=l[4];if("channelsLast"===o)c=e[0],u=e[1],d=e[2],h=e[3],f=e[4];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);c=e[0],f=e[1],u=e[2],d=e[3],h=e[4]}var p,m=t[0],g=t[1],v=t[2],y=t[4],b=zr(n),x=b[0],N=b[1],S=b[2],E=zr(r),C=E[0],k=E[1],_=E[2],j=Vr(m,C),I=Vr(g,k),T=Vr(v,_),O=function(e,t,n,r,a,i,o,s,l,c,u){var d,h,f,p;if("number"==typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var m=function(e,t,n,r,a,i){null==a&&(a=Br(e,t,r));var o=e[1],s=e[2],l=Wr((e[0]-t+2*a)/r+1,i);w(A(l),function(){return"The output # of depths ("+l+") must be an integer. Change the stride and/or zero pad parameters"});var c=Wr((o-t+2*a)/r+1,i);w(A(c),function(){return"The output # of rows ("+c+") must be an integer. Change the stride and/or zero pad parameters"});var u=Wr((s-t+2*a)/r+1,i);return w(A(u),function(){return"The output # of columns ("+u+") must be an integer. Change the stride and/or zero pad parameters"}),[l,c,u,1]}([t,n,r,1],s,0,a,e,u);h=m[0],f=m[1],p=m[2]}else if("same"===e){var g=((h=Math.ceil(t/a))-1)*a+s-t,v=((f=Math.ceil(n/i))-1)*i+l-n,y=((p=Math.ceil(r/o))-1)*o+c-r,b=Math.floor(g/2),x=g-b,N=Math.floor(v/2),S=v-N,E=Math.floor(y/2);d={top:N,bottom:S,left:E,right:y-E,front:b,back:x,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((t-s+1)/a),f=Math.ceil((n-l+1)/i),p=Math.ceil((r-c+1)/o)}return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}(a,u,d,h,x,N,S,j,I,T,s),P=O.padInfo,D=O.outDepth,R=O.outHeight,M=O.outWidth,F=i?y*f:y;return"channelsFirst"===o?p=[c,F,D,R,M]:"channelsLast"===o&&(p=[c,D,R,M,F]),{batchSize:c,dataFormat:o,inDepth:u,inHeight:d,inWidth:h,inChannels:f,outDepth:D,outHeight:R,outWidth:M,outChannels:F,padInfo:P,strideDepth:x,strideHeight:N,strideWidth:S,filterDepth:m,filterHeight:g,filterWidth:v,effectiveFilterDepth:j,effectiveFilterHeight:I,effectiveFilterWidth:T,dilationDepth:C,dilationHeight:k,dilationWidth:_,inShape:e,outShape:p,filterShape:t}}function Br(e,t,n,r){void 0===r&&(r=1);var a=Vr(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function Ur(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function zr(e){return"number"==typeof e?[e,e,e]:e}function Vr(e,t){return t<=1?e:e+(e-1)*(t-1)}function Wr(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function qr(e){var t=Ur(e),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function Hr(e,t){return qr(e)||qr(t)}function Gr(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function Kr(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=fn(e.shape),a=e.toFloat(),i=n.complex(a,r);return r.dispose(),a.dispose(),i}if(!B(e.dtype,t))return Te.makeTensorFromDataId(e.dataId,e.shape,t);if("complex64"===e.dtype){var o=n.real(e);return i=o.cast(t),o.dispose(),i}if("int32"===t)return n.int(e);if("bool"===t){var s=sn(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function Xr(e,t){return Te.makeTensorFromDataId(e.dataId,t,e.dtype)}function Yr(e,t,n){var r=(t-e)/(n-1),a=Z(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return ln(a,"float32")}Object.freeze({castTensor:Kr,reshapeTensor:Xr,linspaceImpl:Yr,upcastType:Se,axesAreInnerMostDims:qt,combineLocations:Ht,computeOutAndReduceShapes:Gt,expandShapeToKeepDim:Kt,assertAxesAreInnerMostDims:Xt,getAxesPermutation:Yt,getUndoAxesPermutation:Qt,getInnerMostAxes:$t,getBroadcastDims:Or,getReductionAxes:Pr,assertAndGetBroadcastShape:Dr,assertParamsConsistent:Jt,computeOutShape:Zt,computePool2DInfo:Rr,computePool3DInfo:Mr,computeConv2DInfo:Fr,computeConv3DInfo:Lr,computeDefaultPad:Br,tupleValuesAreOne:qr,eitherStridesOrDilationsAreOne:Hr,convertConv2DDataFormat:Gr,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:mr});function Qr(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function $r(e,t){return{real:e[2*t],imag:e[2*t+1]}}function Jr(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function Zr(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function ea(e,t,n){var r=function(e,t,n){return function(e,t,n){for(var r=0,a=e.length,i=0,o=!1;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||ta)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function ta(e,t){return e>t?1:e<t?-1:0}function na(e,t,n,r,a){return aa(e,t,n,r,a,0).selectedIndices}function ra(e,t,n,r,a,i){var o=aa(e,t,n,r,a,i,!0);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function aa(e,t,n,r,a,i,o,s){void 0===o&&(o=!1),void 0===s&&(s=!1);for(var l=Array.from(t).map(function(e,t){return{score:e,boxIndex:t,suppressBeginIndex:0}}).filter(function(e){return e.score>a}).sort(sa),c=i>0?-.5/i:0,u=[],d=[];u.length<n&&l.length>0;){var h=l.pop(),f=h.score,p=h.boxIndex,m=h.suppressBeginIndex;if(f<a)break;for(var g=!1,v=u.length-1;v>=m;--v){var y=ia(e,p,u[v]);if(y>=r){g=!0;break}if(h.score=h.score*oa(r,c,y),h.score<=a)break}h.suppressBeginIndex=u.length,g||(h.score===f?(u.push(p),d.push(h.score)):h.score>a&&ea(l,h,sa))}var b=u.length;return s&&(u.fill(0,b),d.fill(0,b)),{selectedIndices:ln(u,"int32"),selectedScores:ln(d,"float32"),numValidOutputs:sn(b,"int32")}}function ia(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),u=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),h=Math.max(a[1],a[3]),f=(s-i)*(l-o),p=(d-c)*(h-u);if(f<=0||p<=0)return 0;var m=Math.max(i,c),g=Math.max(o,u),v=Math.min(s,d),y=Math.min(l,h),b=Math.max(v-m,0)*Math.max(y-g,0);return b/(f+p-b)}function oa(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function sa(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function la(e,t,n){var r=new Array(e.rank).fill(0),a=e.shape.slice();return t.map(function(t){a[n]=t;var i=e.slice(r,a);return r[n]+=t,i})}function ca(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var a=Mn(n,e.dtype);for(r=0;r<a.values.length;++r){for(var i=a.indexToLoc(r),o=new Array(e.rank),s=0;s<o.length;s++)o[s]=i[s]%e.shape[s];var l=e.locToIndex(o);a.values[r]=e.values[l]}return a.toTensor()}function ua(e,t,n,r,a){for(var i=t[t.length-1],o=[e.length/i,i],s=o[0],l=o[1],c=R(n,s*r),u=R("int32",s*r),d=0;d<s;d++){for(var h=d*l,f=e.subarray(h,h+l),p=[],m=0;m<f.length;m++)p.push({value:f[m],index:m});p.sort(function(e,t){return t.value-e.value});var g=d*r,v=c.subarray(g,g+r),y=u.subarray(g,g+r);for(m=0;m<r;m++)v[m]=p[m].value,y[m]=p[m].index}var b=t.slice();return b[b.length-1]=r,[an(c,b,n),an(u,b,"int32")]}function da(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var a=Mn(e,"int32"),i=Mn([n.length,e.length],"int32");for(r=0;r<n.length;r++){var o=a.indexToLoc(n[r]),s=r*e.length;i.values.set(o,s)}return i.toTensor()}var ha=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(e,t){return"T"+t});var n=[];this.variableNames.forEach(function(e){n.push("float v"+e+" = get"+e+"AtOutCoords();")});var r=this.variableNames.map(function(e){return"v"+e}).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},fa=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(e,t){return"T"+t});var n=[];this.variableNames.forEach(function(e){n.push("vec4 v"+e+" = get"+e+"AtOutCoords();")});var r=this.variableNames.map(function(e){return"v"+e}).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},pa=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,a=e.batchSize,i=e.inSize,o=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o];var s="max"===t?">":"<",l=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+l+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+s+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function ma(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(t){return e+"."+t})}function ga(e,t){return 1===t?[e]:ma(e,t)}function va(){var e,t,n,r,a,i,o,s,c,u;return 2===l().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",c="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",c="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:c,defineRound:u}}function ya(e,t,n){void 0===n&&(n="index");var r=Y(t);return r.map(function(t,a){return"int "+e[a]+" = "+n+" / "+t+"; "+(a===r.length-1?"int "+e[a+1]+" = "+n+" - "+e[a]+" * "+t:"index -= "+e[a]+" * "+t)+";"}).join("")}function ba(e){var t=Y(e).map(function(e){return e.toString()});return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+t[0]+" + coords.y * "+t[1]+" + coords.z;\n  }\n"}var xa="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function wa(e,t,n,r){var a=[];e.forEach(function(e){var t=C(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?a.push("uniform float "+e.name+(t>1?"["+t+"]":"")+";"):(a.push("uniform sampler2D "+e.name+";"),a.push("uniform int offset"+e.name+";"))});var i,o,s=a.join("\n"),l=e.map(function(e){return function(e,t,n){void 0===n&&(n=!1);var r="";r+=n?Sa(e):Na(e);var a=e.shapeInfo.logicalShape,i=t.logicalShape;return a.length<=i.length&&(r+=n?function(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,l=Or(e.shapeInfo.logicalShape,t.logicalShape),c=Ia(s),u=s-o,d=["x","y","z","w","u","v"];n=0===o?"":s<2&&l.length>=1?"coords = 0;":l.map(function(e){return"coords."+d[e+u]+" = 0;"}).join("\n");var h;h=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map(function(e,t){return"coords."+d[t+u]}).join(", ");var f="return outputValue;",p=1===C(e.shapeInfo.logicalShape),m=1===C(t.logicalShape);if(1!==o||p||m){if(p&&!m)f=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(l.length){var g=o-2,v=o-1;l.indexOf(g)>-1&&l.indexOf(v)>-1?f="return vec4(outputValue.x);":l.indexOf(g)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(v)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+i+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+a+"("+h+");\n      "+f+"\n    }\n  "}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===l&&null==e.shapeInfo.flatOffset&&k(o,i))return"\n      float "+a+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var c,u=Ia(l),d=Or(e.shapeInfo.logicalShape,t.logicalShape),h=l-s,f=["x","y","z","w","u","v"];c=0===s?"":l<2&&d.length>=1?"coords = 0;":d.map(function(e){return"coords."+f[e+h]+" = 0;"}).join("\n");var p;return p=l<2&&s>0?"coords":e.shapeInfo.logicalShape.map(function(e,t){return"coords."+f[t+h]}).join(", "),"\n    float "+a+"() {\n      "+u+" coords = getOutputCoords();\n      "+c+"\n      return get"+r+"("+p+");\n    }\n  "}(e,t)),r}(e,t,r)}).join("\n"),c=t.texShape,u=va(),d=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+e.texture2D+"(textureSampler, uv).r;\n    }\n  "}(u),h=function(e){return e.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+e.varyingFs+" vec2 resultUV;\n    "+e.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+e.defineSpecialNaN+"\n    "+e.defineSpecialInf+"\n    "+e.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+Ea+"\n    "+Ca+"\n    "+ka+"\n  "}(u);return t.isPacked?(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(k(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=e,r=t,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=(i=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+a[0]+", "+a[1]+"));\n      int index = resTexRC.x * "+a[1]+" + resTexRC.y;\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+i+");\n      int c = imod(index, "+i+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),a=r*Math.ceil(e[e.length-2]/2),i=a,o="",s="b, r, c",l=2;l<e.length-1;l++)o="\n      int b"+l+" = index / "+(i*=e[e.length-l-1])+";\n      index -= b"+l+" * "+i+";\n    "+o,s="b"+l+", "+s;return"\n    ivec"+e.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+o+"\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+e.length+"("+s+");\n    }\n  "}(e,t)}var n,r,a,i,o}(t.logicalShape,c),o=function(e){return"\n    void setOutput(vec4 val) {\n      "+e.output+" = val;\n    }\n  "}(u)):(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){return 1===t[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+t[1]+".0);\n      }\n    ":1===t[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+t[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      return resTexRC.x * "+t[1]+" + resTexRC.y;\n    }\n  "}(0,t);case 2:return function(e,t){return k(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+t[0]+", "+t[1]+"));\n      }\n    ":1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      int r = index / "+e[1]+";\n      int c = index - r * "+e[1]+";\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=t,r=ya(["r","c","d"],e),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(e,t){var n=ya(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(e,t);case 5:return function(e,t){var n=ya(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+t[0]+",\n                             "+t[1]+"));\n\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(e,t);case 6:return function(e,t){var n=ya(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(e,t);default:throw new Error(e.length+"-D output sampling is not yet supported")}var n,r}(t.logicalShape,c),o=function(e){return"\n    void setOutput(float val) {\n      "+e.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(u)),r&&(h+=Aa),[h,d,o,s,i,l,n].join("\n")}function Na(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float "+n+"() {return "+t+";}";var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===a&&1===i)return"\n      float "+n+"() {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var o=e.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+o[0]+", "+o[1]+", "+_a(t)+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+ja(e)+"\n      }\n    ";var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float "+n+"(int index) {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var o=_a(t);return 1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+o+") + 0.5) / "+a+".0);\n        return sampleTexture("+t+", uv);\n      }\n    ":1===a?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+o+") + 0.5) / "+i+".0, 0.5);\n        return sampleTexture("+t+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+a+", "+i+", index + "+o+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape;if(null!=a&&k(t,a)){var i=a[0];return"\n    float "+r+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+a[1]+".0, "+i+".0);\n      return sampleTexture("+n+", uv);\n    }\n  "}var o=D(t),s=o.newShape,l=o.keptDims,c=s;if(c.length<t.length)return"\n      "+Na(Ta(e,c))+"\n      float "+r+"(int row, int col) {\n        return "+r+"("+Oa(["row","col"],l)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+t[1]+", 1)));\n        "+ja(e)+"\n      }\n    ";var u=a[0],d=a[1],h=_a(n);return 1===d?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+h+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+u+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":1===u?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+h+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+d+".0, 0.5);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n  float "+r+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+t[1]+" + col + "+h+";\n    vec2 uv = uvFromFlat("+u+", "+d+", index);\n    return sampleTexture("+n+", uv);\n  }\n"}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[1]*t[2],i=t[2],o=D(t),s=o.newShape,l=o.keptDims,c=s;if(c.length<t.length)return"\n        "+Na(Ta(e,c))+"\n        float "+r+"(int row, int col, int depth) {\n          return "+r+"("+Oa(["row","col","depth"],l)+");\n        }\n      ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+a+", "+i+", 1)));\n        "+ja(e)+"\n      }\n    ";var u=e.shapeInfo.texShape,d=u[0],h=u[1],f=e.shapeInfo.flatOffset;return h===a&&null==f?"\n        float "+r+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+i+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+h+".0, "+d+".0);\n          return sampleTexture("+n+", uv);\n        }\n      ":h===i&&null==f?"\n    float "+r+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+t[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+h+".0, "+d+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n      float "+r+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+a+" + col * "+i+" + depth + "+_a(n)+";\n        vec2 uv = uvFromFlat("+d+", "+h+", index);\n        return sampleTexture("+n+", uv);\n      }\n  "}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[3],i=t[2]*a,o=t[1]*i,s=D(t),l=s.newShape,c=s.keptDims;if(l.length<t.length)return"\n      "+Na(Ta(e,l))+"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        return "+r+"("+Oa(["row","col","depth","depth2"],c)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+o+", "+i+", "+a+", 1)));\n        "+ja(e)+"\n      }\n    ";var u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],f=d[1];return f===o&&null==u?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+i+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+f+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":f===a&&null==u?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+t[1]*t[2]+", "+t[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+f+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+o+" + col * "+i+" +\n          depth * "+a+" + depth2;\n      vec2 uv = uvFromFlat("+h+", "+f+", index + "+_a(n)+");\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,s=t[1]*o,l=D(t),c=l.newShape,u=l.keptDims;if(c.length<t.length)return"\n      "+Na(Ta(e,c))+"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+r+"("+Oa(["row","col","depth","depth2","depth3"],u)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+s+", "+o+", "+i+", "+a+")) +\n          depth3;\n        "+ja(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,f=h[0],p=h[1];return p===s&&null==d?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+o+", "+i+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+p+".0, "+f+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":p===a&&null==d?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]+",\n               "+t[2]*t[3]+", "+t[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+p+".0, "+f+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+o+" + depth * "+i+" +\n          depth2 * "+a+" + depth3 + "+_a(n)+";\n      vec2 uv = uvFromFlat("+f+", "+p+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=D(t),i=a.newShape,o=a.keptDims;if(i.length<t.length)return"\n      "+Na(Ta(e,i))+"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+r+"("+Oa(["row","col","depth","depth2","depth3","depth4"],o)+");\n      }\n    ";var s=t[5],l=t[4]*s,c=t[3]*l,u=t[2]*c,d=t[1]*u;if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+d+", "+u+", "+c+", "+l+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+s+", 1)));\n        "+ja(e)+"\n      }\n    ";var h=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,p=f[0],m=f[1];return m===d&&null==h?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+u+", "+c+", "+l+", "+s+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":m===s&&null==h?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]*t[4]+",\n               "+t[2]*t[3]*t[4]+",\n               "+t[3]*t[4]+",\n               "+t[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+d+" + col * "+u+" + depth * "+c+" +\n          depth2 * "+l+" + depth3 * "+s+" + depth4 + "+_a(n)+";\n      vec2 uv = uvFromFlat("+p+", "+m+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function Sa(e){var t;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 "+("get"+(t=e.name).charAt(0).toUpperCase()+t.slice(1))+"() {\n      return "+va().texture2D+"("+t+", halfCR);\n    }\n  ";case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=va();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+a[0]+", "+a[1]+", index);\n      return "+i.texture2D+"("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=a[0],o=a[1],s=va();if(null!=a&&k(t,a))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+o+".0, "+i+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(t[1]/2)+", "+l[0]+", "+l[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===t[0])return"\n        "+Sa(Ta(e,t.slice(1)))+"\n        vec4 "+r+"(int b, int row, int col) {\n          return "+r+"("+Oa(["b","row","col"],[1,2])+");\n        }\n      ";var o=i[0],s=i[1],l=Math.ceil(t[2]/2);return"\n    vec4 "+r+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+o+", "+s+", "+l*Math.ceil(t[1]/2)+", "+l+", b, row, col);\n      return "+va().texture2D+"("+n+", uv);\n    }\n  "}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=o[0],l=o[1],c=Math.ceil(t[n-1]/2),u=c*Math.ceil(t[n-2]/2),d="int b, int row, int col",h="b * "+u+" + (row / 2) * "+c+" + (col / 2)",f=2;f<n-1;f++)d="int b"+f+", "+d,h="b"+f+" * "+(u*=t[n-f-1])+" + "+h;return"\n    vec4 "+a+"("+d+") {\n      int index = "+h+";\n      int texR = index / "+l+";\n      int texC = index - texR * "+l+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+l+", "+s+");\n      return "+va().texture2D+"("+r+", uv);\n    }\n  "}(e)}}var Ea="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Ca="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",ka="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Aa="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function _a(e){return"offset"+e}function ja(e){var t=e.name,n=C(e.shapeInfo.logicalShape);return n<2?"return "+t+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+t+"[i];\n      }\n    }\n  "}function Ia(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Ta(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Oa(e,t){return t.map(function(t){return e[t]}).join(", ")}var Pa=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,w(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var a=e[e.length-1],i=Math.ceil(a/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var o,s,l=this.outputShape,c=l.length,u=Ia(c),d=ga("coords",c);if(1===i){var h=Ia(s=c+1);o="\n        "+h+" sourceLocR = "+h+"("+d.join()+", 0);\n        ++"+d[c-1]+";\n        "+h+" sourceLocG = "+h+"("+d.join()+", 0);\n        ++"+d[c-2]+";\n        "+h+" sourceLocA = "+h+"("+d.join()+", 0);\n        --"+d[c-1]+";\n        "+h+" sourceLocB = "+h+"("+d.join()+", 0);\n        --"+d[c-2]+";"}else s=c,o="\n        "+u+" sourceLocR = coords;\n        ++"+d[c-1]+";\n        "+u+" sourceLocG = coords;\n        ++"+d[c-2]+";\n        "+u+" sourceLocA = coords;\n        --"+d[c-1]+";\n        "+u+" sourceLocB = coords;\n        --"+d[c-2]+";";var f=["x","y","z","w","u","v"].slice(0,s),p="."+f[s-1],m=f.map(function(e){return"int "+e}),g=ga("sourceLocR",s-1).concat("inIdx.r"),v=ga("sourceLocG",s-1).concat("inIdx.g"),y=ga("sourceLocB",s-1).concat("inIdx.b"),b=ga("sourceLocA",s-1).concat("inIdx.a"),x="max"===n?"greaterThan":"lessThan",N=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+v.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+b.join()+")));",S="vec4(\n            getAChannel("+g.join()+"),\n            hasNextCol ? getAChannel("+v.join()+") : 0.,\n            hasNextRow ? getAChannel("+y.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+b.join()+") : 0.)",E=r?"":"\n      float getBestIndicesAChannel("+m.join()+") {\n        return getChannel(getBestIndicesA("+f.join()+"),\n                                          vec2("+f.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+m.join()+") {\n        return getChannel(getA("+f.join()+"),\n                               vec2("+f.slice(-2).join()+"));\n      }\n      "+E+"\n      void main() {\n        "+u+" coords = getOutputCoords();\n        bool hasNextCol = "+d[c-1]+" < "+(l[c-1]-1)+";\n        bool hasNextRow = "+d[c-2]+" < "+(l[c-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+p+", sourceLocG"+p+",\n          sourceLocB"+p+", sourceLocA"+p+") * "+t+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+S+";\n\n        for (int i = 0; i < "+t+"; i++) {\n          inIdx = srcIdx;\n          "+N+"\n          vec4 candidate = "+S+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+x+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},Da=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.top,u=l-1-e.padInfo.left,d=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2("+c+", "+u+");\n      const float avgMultiplier = float("+d+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+i+") {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+l+";\n            wC+= "+o+") {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ra=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=u-1-e.padInfo.front,p=d-1-e.padInfo.top,m=h-1-e.padInfo.left,g=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3("+f+", "+p+", "+m+");\n      const float avgMultiplier = float("+g+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+u+";\n            wD += "+s+") {\n          float dyD = float(dyDCorner + wD) / "+a+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+d+";\n              wR += "+l+") {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+h+";\n                wC += "+c+") {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ma=function(e,t,n,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Dr(e,t),Dr(e,n);var o="0.0";null!=r&&(Dr(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";null!=a&&(Dr(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+o+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},Fa=function(e,t,n,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Dr(e,t),Dr(e,n);var o="vec4(0.0)";null!=r&&(Dr(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=a&&(Dr(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = "+o+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+i+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},La=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Dr(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+e+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},Ba="return a + b;",Ua="return a - b;",za="return a * b;",Va="return (a < 0.) ? b * a : a;",Wa=function(e,t,n){this.variableNames=["A","B"],this.outputShape=Dr(t,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},qa="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",Ha=function(e,t,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Dr(t,n);var a=this.outputShape.length,i="";if(r)if(0===a||1===C(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          "+Ia(a)+" coords = getOutputCoords();\n        ",1===a)i+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var o=ga("coords",a);i+="\n            bool nextRowOutOfBounds =\n              ("+o[a-2]+" + 1) >= "+this.outputShape[a-2]+";\n            bool nextColOutOfBounds =\n              ("+o[a-1]+" + 1) >= "+this.outputShape[a-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+i+"\n\n        setOutput(result);\n      }\n    "},Ga=function(){function e(e){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),Ka=function(){function e(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),Xa=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},Ya=function(e){this.outputShape=[],this.outputShape=Zt(e,1),this.variableNames=e.map(function(e,t){return"T"+t});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var a=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+a+"));")}var i=t.length,o=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+o+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},Qa=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Zt(e,t);var n=this.outputShape,r=n.length,a=Ia(r),i=ga("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(e,t){return"T"+t});var s=new Array(e.length-1);s[0]=e[0][t];for(var l=1;l<s.length;l++)s[l]=s[l-1]+e[l][t];var c=o[t],u=o.slice(-2),d=o.join(),h="if ("+c+" < "+s[0]+") {\n        return getChannel(\n            getT0("+d+"), vec2("+u.join()+"));\n        }";for(l=1;l<s.length;l++){var f=s[l-1];h+="\n        if ("+c+" < "+s[l]+"  && "+c+" >= "+s[l-1]+") {\n          return getChannel(\n            getT"+l+"("+$a(o,c,f)+"),\n            vec2("+$a(u,c,f)+"));\n        }"}var p=s.length,m=s[s.length-1];h+="\n        return getChannel(\n          getT"+p+"("+$a(o,c,m)+"),\n          vec2("+$a(u,c,m)+"));",this.userCode="\n      float getValue("+o.map(function(e){return"int "+e})+") {\n        "+h+"\n      }\n\n      void main() {\n        "+a+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+i+"), 0., 0., 0.);\n\n        "+i[r-1]+" = "+i[r-1]+" + 1;\n        if ("+i[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+i+");\n        }\n\n        "+i[r-2]+" = "+i[r-2]+" + 1;\n        if ("+i[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+i+");\n        }\n\n        "+i[r-1]+" = "+i[r-1]+" - 1;\n        if ("+i[r-2]+" < "+n[r-2]+" &&\n            "+i[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+i+");\n        }\n        setOutput(result);\n      }\n    "};function $a(e,t,n){var r=e.indexOf(t);return e.map(function(e,t){return t===r?e+" - "+n:e}).join()}var Ja=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+a+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              if ("+i+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Za=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i="channelsLast"===e.dataFormat,o=t-1-e.padInfo.top,s=n-1-e.padInfo.left,l=i?1:2,c=i?2:3,u=i?3:1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+u+"];\n\n        ivec2 dyCorner = ivec2(coords["+l+"], coords["+c+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n\n              if ("+i+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ei=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,o=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yF = 0; yF < "+e.outDepth+"; yF++) {\n            int xF = wF + yF * "+t+" - "+a+";\n\n            if (xF < 0 || xF >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n              int xR = wR + yR * "+n+" - "+i+";\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n                int xC = wC + yC * "+r+" - "+o+";\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ti=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,l=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3("+s+", "+l+", "+c+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+t+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+a+".0;\n\n          if (dyF < 0.0 || dyF >= "+e.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+t+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ni=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+i+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+a+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ri=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+i+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ai=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.padInfo.top,i=e.padInfo.left,o=e.strideHeight,s=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,h=4*Math.floor(e.inChannels/4),f=e.inChannels%4,p="channelsLast"===e.dataFormat,m=p?1:2,g=p?2:3,v=p?3:1,y="",b="";n&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+a+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+v+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+m+"], coords["+g+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+u+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+d+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+h+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+p+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===f)+") {\n\n              if ("+p+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+h+") *\n                    getW(wR, wC, "+h+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+h+", xR, xC) *\n                    getW(wR, wC, "+h+", d2);\n              }\n\n            } else if ("+(2===f)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+h+", d2),\n                getW(wR, wC, "+h+" + 1, d2)\n              );\n\n              if ("+p+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+h+"),\n                  getX(batch, xR, xC, "+h+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+h+", xR, xC),\n                  getX(batch, "+h+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===f)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+h+", d2),\n                getW(wR, wC, "+h+" + 1, d2),\n                getW(wR, wC, "+h+" + 2, d2)\n              );\n\n              if ("+p+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+h+"),\n                  getX(batch, xR, xC, "+h+" + 1),\n                  getX(batch, xR, xC, "+h+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+h+", xR, xC),\n                  getX(batch, "+h+" + 1, xR, xC),\n                  getX(batch, "+h+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+x+"\n        "+b+"\n        setOutput(result);\n      }\n    "},ii=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.filterDepth,d=e.filterHeight,h=e.filterWidth,f=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+a+", "+i+", "+o+");\n      const ivec3 pads = ivec3("+t+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+u+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+d+"; wR++) {\n            int xR = xRCorner + wR * "+l+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+h+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+f+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===p)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+f+") *\n                  getW(wF, wR, wC, "+f+", d2);\n              } else if ("+(2===p)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===p)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1),\n                  getX(batch, xF, xR, xC, "+f+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2),\n                  getW(wF, wR, wC, "+f+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},oi=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.inHeight,i=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,p=e.outChannels/e.inChannels,m="",g="";n&&(m=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",g="result = activation(result);");var v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+m+"\n\n      const ivec2 strides = ivec2("+l+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+p+";\n        int q = d2 - d1 * "+p+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+h+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+a+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+f+"; wC++) {\n            int xC = xCCorner + wC * "+d+";\n\n            if (xC < 0 || xC >= "+i+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+v+"\n        "+g+"\n        setOutput(result);\n      }\n    "},si=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var a=e.inHeight,i=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,p=f,m="int xR; int xC; int xCOffset;",g=0;g<h;g++)for(var v=0;v<f;v++)m+="\n          vec4 xTexelR"+g+"C"+2*v+" = vec4(0.);\n          vec4 wR"+g+"C"+v+" = vec4(0.);\n          vec4 xR"+g+"C"+v+" = vec4(0.);";for(g=0;g<h;g++)for(var y=0;y<p;y++){if(m+="\n          xR = xRCorner + "+g*u+";\n          xC = xCCorner + "+(v=2*y)*d+";\n        ",1===c){if(v<f&&(m+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+a+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+g+"C"+v+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    xTexelR"+g+"C"+v+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+g+"C"+v+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+a+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+g+"C"+v+" = vec4(previous.zw, xTexelR"+g+"C"+v+".xy);\n                } else {\n                  xR"+g+"C"+v+" = vec4(0, 0, xTexelR"+g+"C"+v+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+a+" && xC >= 0 && xC < "+i+") {\n                  xTexelR"+g+"C"+v+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+g+"C"+v+" = vec4(0.);\n                }\n\n                xR"+g+"C"+v+" = xTexelR"+g+"C"+v+";\n              ",v+1<f)){var x=s%2==0?b(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(m+="\n                  xCOffset = xC + "+s%2+" + "+x+";\n\n                  if(xR >= 0 && xR < "+a+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+g+"C"+(v+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",d>1&&(m+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+a+" &&\n                      xCOffset >= 0 && xCOffset < "+i+") {\n                      xTexelR"+g+"C"+v+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+g+"C"+v+" = vec4(0.);\n                    }\n                  "),m+="\n                  xR"+g+"C"+(v+1)+" = vec4(\n                    xTexelR"+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+".xy);\n                "):m+="\n                  xCOffset = xC + "+x+";\n\n                  if(xR >= 0 && xR < "+a+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+g+"C"+(v+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+g+"C"+(v+1)+" = xTexelR"+g+"C"+(v+2)+";\n                "}}else v<f&&(m+="\n              if(xR >= 0 && xR < "+a+") {\n            ",s%2==1?(m+="\n                xCOffset = xC + 1 - "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+g+"C"+v+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+g+"C"+v+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+i+") {\n                  xTexelR"+g+"C"+(v+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+g+"C"+(v+2)+" = vec4(0.);\n                }\n\n                xR"+g+"C"+v+" = vec4(\n                  xTexelR"+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+".zw);\n              ",v+1<f&&(m+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+c+";\n                  if(xCOffset >= 0 && xCOffset < "+i+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+g+"C"+(v+1)+" = vec4(xTexelR"+g+"C"+(v+2)+".xy, final.xy);\n                ")):(m+="\n                if(xC >= 0 && xC < "+i+") {\n                  xTexelR"+g+"C"+v+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+g+"C"+v+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+g+"C"+(v+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+g+"C"+(v+2)+" = vec4(0.);\n                }\n\n                xR"+g+"C"+v+" = vec4(\n                  xTexelR"+g+"C"+v+".xy, xTexelR"+g+"C"+(v+2)+".xy);\n              ",v+1<f&&(m+="\n                  xR"+g+"C"+(v+1)+" = vec4(\n                    xTexelR"+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+".zw);\n                ")),m+="}");v<f&&(m+="\n            vec4 wTexelR"+g+"C"+v+" = getW("+g+", "+v+", d1, q);\n            wR"+g+"C"+v+" = vec4(wTexelR"+g+"C"+v+".xz, wTexelR"+g+"C"+v+".xz);\n          ",v+1<f&&(m+="\n              vec4 wTexelR"+g+"C"+(v+1)+" = getW("+g+", "+(v+1)+", d1, q);\n              wR"+g+"C"+(v+1)+" =\n                vec4(wTexelR"+g+"C"+(v+1)+".xz, wTexelR"+g+"C"+(v+1)+".xz);"))}for(g=0;g<h;g++)for(v=0;v<f;v++)m+="dotProd += xR"+g+"C"+v+" * wR"+g+"C"+v+";";var w="",N="";n&&(w=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",N="result = activation(result);");var S=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+w+"\n\n      const ivec2 strides = ivec2("+l+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+m+"\n\n        vec4 result = dotProd;\n        "+S+"\n        "+N+"\n        setOutput(result);\n      }\n    "},li=function(e,t,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],o=e[1],s=e[2],l=e[3],c=t[0],u=n[0],d=n[1];this.outputShape=[c,u,d,l];var h="bilinear"===r?1:0,f=[o-1+".0",s-1+".0"],p=f[0],m=f[1],g=u>1?[""+(o-1)/(u-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],v=g[0],y=g[1],b=g[2],x=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m],w=x[0],N=x[1],S=x[2];this.userCode="\n      const float height_ratio = float("+v+");\n      const float width_ratio = float("+w+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+i+") {\n          return;\n        }\n\n        float height_scale = "+y+";\n        float width_scale = "+N+";\n\n        float in_y = "+b+";\n        if( in_y < 0.0 || in_y > "+p+" ) {\n          setOutput(float("+a+"));\n          return;\n        }\n        float in_x = "+S+";\n        if( in_x < 0.0 || in_x > "+m+" ) {\n          setOutput(float("+a+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+h+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},ci=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,a=e[e.length-1],i=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+a+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+Ia(r)+" coords = getOutputCoords();\n        int end = "+ui(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+a+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+i+" end) {\n            continue;\n          }\n          if (idx == end && "+t+") {\n            continue;\n          }\n          "+ui(r,"coords")+" = idx;\n          val += getX("+function(e,t){if(1===e)return""+t;if(2===e)return t+".x, "+t+".y";if(3===e)return t+".x, "+t+".y, "+t+".z";if(4===e)return t+".x, "+t+".y, "+t+".z, "+t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function ui(e,t){if(1===e)return""+t;if(2===e)return t+".y";if(3===e)return t+".z";if(4===e)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var di=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=De.DENSE;var t=Ve(e),n=va();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+ya(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},hi=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=De.DENSE;var t=Ve(e),n=va();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+ya(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},fi=function(){function e(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+t+";\n      int offset_h = imod(h, "+t+");\n      int in_w = w / "+t+";\n      int offset_w = imod(w, "+t+");\n      int offset_d = (offset_h * "+t+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return e.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),pi=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},mi=function(e){this.variableNames=["A"],this.outTexUsage=Re.DOWNLOAD;var t=va();this.outputShape=e,this.userCode="\n      "+xa+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+t.output+" = encode_float(x);\n      }\n    "},gi=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Re.DOWNLOAD;var t=va();this.outputShape=e,this.userCode="\n      "+xa+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+t.output+" = encode_float(x);\n      }\n    "},vi=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=va(),a=t[0],i=t[1];this.outputShape=e;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode="\n      "+ba(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+i+";\n        int c = imod(flatIndex, "+i+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+a+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+o+", 0., 0., 0.);\n      }\n    "},yi=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=va(),a=t[0],i=t[1];this.outputShape=e;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var l=0;l<=1;l++)for(var c=0;c<=1;c++){var u=2*l+c;o+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+e[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+l+" < "+e[1]+") {\n              localCoords[1] += "+l+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+i+";\n              c = imod(flatIndex, "+i+");\n              uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+a+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+u+"] = values[0];\n              } else if(offset == 1) {\n                result["+u+"] = values[1];\n              } else if(offset == 2) {\n                result["+u+"] = values[2];\n              } else {\n                result["+u+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+ba(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+o+"\n\n        "+r.output+" = "+s+";\n      }\n    "},bi=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var a=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode="\n      const float exponentMultiplier = "+a+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+e+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+i+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},xi=function(){function e(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}},e}(),wi=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var a=Ia(this.rank),i=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],i=0;i<e.length;i++)i===t?a.push("int(getIndices("+r[i]+"))"):a.push(""+r[i]);return a.join()}(e,n);this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},Ni=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Ia(t.length),a=Ia(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+a+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+i+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function Si(e,t){var n=va();return Ye(e,t,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function Ei(e,t){return rt(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Ci(e,t){return at(e,t,new Uint16Array([0,1,2,2,1,3]))}function ki(e,t,n,r,a,i,o){ot(n,r);var s=it(e,t),l=e.TEXTURE_2D;return He(e,t,function(){return e.bindTexture(l,s)}),He(e,t,function(){return e.texParameteri(l,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),He(e,t,function(){return e.texParameteri(l,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),He(e,t,function(){return e.texParameteri(l,e.TEXTURE_MIN_FILTER,e.NEAREST)}),He(e,t,function(){return e.texParameteri(l,e.TEXTURE_MAG_FILTER,e.NEAREST)}),He(e,t,function(){return e.texImage2D(l,0,a,n,r,0,i,o,null)}),He(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function Ai(e,t,n,r,a){var i=ze(n,r);return ki(e,t,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,e.FLOAT)}function _i(e,t,n,r,a){var i=ze(n,r);return ki(e,t,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function ji(e,t,n,r,a){var i=ze(n,r);return ki(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function Ii(e,t,n,r,a){var i=We(n,r);return ki(e,t,i[0],i[1],a.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function Ti(e,t,n,r,a){var i=We(n,r);return ki(e,t,i[0],i[1],a.internalFormatPackedHalfFloat,e.RGBA,a.textureTypeHalfFloat)}function Oi(e,t,n,r){return He(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),lt(e,t,n,"clipSpacePos",r,3,20,0)&&lt(e,t,n,"uv",r,2,20,12)}function Pi(e,t,n,r,a,i,o){var s,l,c;He(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),i instanceof Uint8Array?(s=new Uint8Array(r*a*4),l=e.UNSIGNED_BYTE,c=e.RGBA):(s=new Float32Array(r*a*4),l=e.FLOAT,c=o.internalFormatPackedFloat),s.set(i),He(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,c,r,a,0,e.RGBA,l,s)}),He(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function Di(e,t,n,r){He(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?He(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):He(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),He(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function Ri(e,t,n,r,a){var i=e.createBuffer();He(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)});var o=16*n*r;return He(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)}),He(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),He(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),i}function Mi(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function Fi(e,t,n,r,a){var i=ze(n,r),o=i[0],s=i[1],l=new Uint8Array(n*r*4);return He(e,t,function(){return e.readPixels(0,0,o,s,a.downloadTextureFormat,e.UNSIGNED_BYTE,l)}),new Float32Array(l.buffer)}function Li(e,t,n,r,a,i,o,s){var l=e,c=new Float32Array(function(e,t){var n=We(e,t);return n[0]*n[1]*4}(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function Bi(e,t,n,r){var a=new Float32Array(n*r*4);return He(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,a)}),a}var Ui=Object.freeze({createVertexShader:Si,createVertexBuffer:Ei,createIndexBuffer:Ci,createFloat32MatrixTexture:Ai,createFloat16MatrixTexture:_i,createUnsignedBytesMatrixTexture:ji,createPackedMatrixTexture:Ii,createFloat16PackedMatrixTexture:Ti,bindVertexProgramAttributeStreams:Oi,uploadDenseMatrixToTexture:Pi,uploadPixelDataToTexture:Di,createBufferFromOutputTexture:Ri,downloadFloat32MatrixFromBuffer:Mi,downloadByteEncodedFloatMatrixFromOutputTexture:Fi,downloadPackedMatrixFromBuffer:Li,downloadMatrixFromPackedOutputTexture:Bi}),zi=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=l().getNumber("WEBGL_VERSION");null!=e?(this.gl=e,Be(t,e)):this.gl=Ue(t);var n="WEBGL_color_buffer_float";if(1===l().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=Xe(this.gl,this.debug,"OES_texture_float"),_t(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Xe(this.gl,this.debug,"OES_texture_half_float");else if(l().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),_t(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Xe(this.gl,this.debug,"EXT_color_buffer_half_float");else if(l().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",_t(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!_t(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=Ei(this.gl,this.debug),this.indexBuffer=Ci(this.gl,this.debug),this.framebuffer=st(this.gl,this.debug),this.textureConfig=qe(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return l().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;He(t,this.debug,function(){return t.finish()}),He(t,this.debug,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),He(t,this.debug,function(){return t.deleteFramebuffer(e.framebuffer)}),He(t,this.debug,function(){return t.bindBuffer(t.ARRAY_BUFFER,null)}),He(t,this.debug,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}),He(t,this.debug,function(){return t.deleteBuffer(e.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),Ai(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),_i(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),ji(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),Di(this.gl,this.debug,e,t)},e.prototype.uploadDenseMatrixToTexture=function(e,t,n,r){this.throwIfDisposed(),Pi(this.gl,this.debug,e,t,n,r,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),Ti(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),Ii(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(pt(this.gl,this.debug,this.framebuffer),this.outputTexture=null),He(this.gl,this.debug,function(){return t.gl.deleteTexture(e)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,function(){return Fi(r.gl,r.debug,t,n,r.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(e,t,n,r,a,i){return Li(this.gl,e,0,0,0,a,i,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return Mi(this.gl,e,t)},e.prototype.createBufferFromTexture=function(e,t,n){this.bindTextureToFrameBuffer(e);var r=Ri(this.gl,this.debug,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},e.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},e.prototype.createFence=function(e){var t,n,r=this;if(l().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}},e.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,function(){return Bi(r.gl,r.debug,t,n)})},e.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=Qe(t,this.debug,e),r=Si(t,this.debug),a=et(t,this.debug);return He(t,this.debug,function(){return t.attachShader(a,r)}),He(t,this.debug,function(){return t.attachShader(a,n)}),tt(t,this.debug,a),this.debug&&nt(t,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=Oi(t,this.debug,this.program,this.vertexBuffer)),a},e.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&He(this.gl,this.debug,function(){return t.gl.deleteProgram(e)})},e.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&nt(this.gl,this.debug,this.program),He(this.gl,this.debug,function(){return t.gl.useProgram(e)})},e.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?ut(this.gl,this.debug,e,t):dt(this.gl,e,t)},e.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),He(this.gl,this.debug,function(){return n.gl.getAttribLocation(e,t)})},e.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},e.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),ht(this.gl,this.debug,this.program,e,t,n)},e.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},e.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var r=We(t,n),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,a,i)},e.prototype.setOutputMatrixWriteRegion=function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&nt(this.gl,this.debug,this.program),mt(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),He(e,this.debug,function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),He(this.gl,this.debug,function(){return e.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=Xe(this.gl,this.debug,2===l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(2===l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a},e.prototype.endQuery=function(){if(2!==l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(e){return i(this,void 0,void 0,function(){var t=this;return o(this,function(n){switch(n.label){case 0:return[4,T(function(){return t.disposed||t.isQueryAvailable(e,l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return n.sent(),[2,this.getQueryTime(e,l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}return a=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint},e.prototype.pollFence=function(e){var t=this;return new Promise(function(n){t.addItemToPoll(function(){return e.isFencePassed()},function(){return n()})})},e.prototype.pollItems=function(){for(var e=function(e){for(var t=0;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map(function(e){return e.isDoneFn})),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},e.prototype.addItemToPoll=function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||T(function(){return n.pollItems(),0===n.itemsToPoll.length})},e.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),ft(this.gl,this.debug,e,this.framebuffer),this.debug&&mt(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(ft(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&mt(this.gl)):pt(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n},e.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var r=this.gl;ft(r,this.debug,e,this.framebuffer),this.debug&&mt(r),this.outputTexture=e,He(r,this.debug,function(){return r.viewport(0,0,t,n)}),He(r,this.debug,function(){return r.scissor(0,0,t,n)})},e.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,r){var a=this;this.throwIfDisposed(),He(this.gl,this.debug,function(){return a.gl.scissor(e,t,n,r)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}();function Vi(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!k(r,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+i+" must match");if(!e.isUniform||!a.isUniform){var o=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!k(o,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+o+" and "+s+" must match")}})}var Wi=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,a=n.inChannels,i=n.strideWidth,o=n.strideHeight,s=n.padInfo,l=n.outWidth,c=n.dilationWidth,u=n.dilationHeight,d=n.dataFormat,h=s.left,f=s.top,p=a*r,m=va(),g="channelsLast"===d,v=g?0:1,y=g?1:2,b="",x=0;x<=1;x++)for(var w=0;w<=1;w++)b+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+x+";\n\n          if(blockIndex < "+e[1]+" && pos < "+e[0]+") {\n            offsetY = int(blockIndex / ("+l+")) * "+o+" - "+f+";\n            d0 = offsetY + "+u+" * (pos / "+p+");\n\n            if(d0 < "+t[v]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+l+".) * "+i+". - "+h+".);\n              d1 = offsetX + "+c+" * (int(mod(float(pos), "+p+".) / "+a+".));\n\n              if(d1 < "+t[y]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+a+".));\n\n                if ("+g+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+b+"\n\n        "+m.output+" = result;\n      }\n    "},qi=function(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[];var i,o=t,s=e[3]-1;this.outputShape=e;var l="float("+n+") + float("+r+") * sum";i=.5===a?"inversesqrt("+l+")":1===a?"1.0/("+l+")":"exp(log("+l+") * float(-"+a+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+i+";\n        setOutput(val);\n      }\n    "},Hi=function(e,t,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=a,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+t+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+t+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+a+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+a+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},Gi=function(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,o=t,s=e[3]-1;this.outputShape=e;var l="float("+n+") + float("+r+") * sum";i=.5===a?"inversesqrt("+l+")":1===a?"1.0/("+l+")":"exp(log("+l+") * float(-"+a+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+i+";\n        setOutput(result);\n      }\n    "},Ki=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,o=a-1-e.padInfo.top,s=i-1-e.padInfo.left,l=a*i-1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+a+";\n          wR += "+r+") {\n          float dyR = float(dyRCorner + wR) / "+t+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+l+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+i+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Xi=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=s-1-e.padInfo.front,d=l-1-e.padInfo.top,h=c-1-e.padInfo.left,f=s*l*c-1;this.userCode="\n      const ivec3 pads = ivec3("+u+", "+d+", "+h+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+a+") {\n          float dyD = float(dyDCorner + wD) / "+t+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+l+";\n              wR += "+i+") {\n            float dyR = float(dyRCorner + wR) / "+n+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+o+") {\n              float dyC = float(dyCCorner + wC) / "+r+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+f+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+l+" * "+c+" +\n                  wR * "+c+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Yi=function(e,t,n,r,a,i,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===a&&(a=!1),void 0===i&&(i=null),void 0===o&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],l=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",u=r?"rc.z, i * 2":"i * 2, rc.z",d=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],f="",p="";i&&(f=o?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"vec4 activation(vec4 x) {\n          "+i+"\n        }",p="result = activation(result);");var m=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+f+"\n\n      const float sharedDimension = "+l+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+l+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+c+");\n          vec4 b = getMatrixB(rc.x, "+u+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+d[0]+" * "+h[0]+");\n          result += ("+d[1]+" * "+h[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+m+"\n\n        "+p+"\n\n        setOutput(result);\n      }\n    "},Qi=function(){function e(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}},e}(),$i=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},Ji=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(0===t)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=ga("rc",t),r=Ia(t),a=function(e,t,n){if(1===e)return"rc > "+t[0];for(var r="",a=e-2;a<e;a++)r+=n[a]+" >= "+t[a],a<e-1&&(r+="||");return r}(t,e,n),i=function(e,t,n,r){if(1===e)return"";var a=r.slice(-2);return"\n    int r = "+a[0]+";\n    int c = "+a[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+t+";\n    bool rEdge = rp1 >= "+n+";\n  "}(t,e[e.length-1],e[e.length-2],n),o=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i=(0===r?"r":"rp1")+", "+(0===a?"c":"cp1"),o=2;o<e;o++)i=t[t.length-1-o]+","+i;n.push(i)}return n}(n,t);return 1===n?"getA(rc),\n            rc + 1 >= "+e[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(e,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+a+") {\n            setOutput(vec4(0));\n          } else {\n            "+i+"\n\n            setOutput(vec4("+o+"));\n          }\n        }\n      "}},Zi=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(t,n){return t[0]+e[n]+t[1]});var r=e.length,a=Ia(r),i=t.map(function(e){return e[0]}).join(","),o=t.map(function(t,n){return t[0]+e[n]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+a+" start = "+a+"("+i+");\n      "+a+" end = "+a+"("+o+");\n\n      void main() {\n        "+a+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+a+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+o+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},eo=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(t,n){return t[0]+e[n]+t[1]});for(var r=e.length,a=Ia(r),i=t.map(function(e){return e[0]}).join(","),o=t.map(function(t,n){return t[0]+e[n]}).join(","),s=ga("rc",r),l=ga("source",r),c=s[r-1]+" < "+this.outputShape[r-1],u=1===r?"source":"vec2("+l.slice(-2).join()+")",d=[a+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],h=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",p=0,m=1===r?2:4;p<m;p++)f+="\n        "+d[p]+"\n        if ("+h+") {\n          result["+p+"] = float("+n+");\n        } else {\n          "+a+" source = rc - start;\n          result["+p+"] = getChannel(getX("+l.join()+"), "+u+");\n        }\n      ";f+=1===r?"} ":"}}",this.userCode="\n      const "+a+" start = "+a+"("+i+");\n      const "+a+" end = "+a+"("+o+");\n\n      void main() {\n        "+a+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+f+"\n        setOutput(result);\n      }\n    "},to=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,a=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,s=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=e.padInfo.top,d=e.padInfo.left;this.outputShape=e.outShape;var h="avg"===t,f="0.0";if(h||(f="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+a+", "+i+");\n        const ivec2 pads = ivec2("+u+", "+d+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+l+";\n              wR += "+o+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+c+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var p=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(p="avgValue / count");var m=4*Math.floor(r/4),g=r%4,v="\n      if ("+h+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+a+", "+i+");\n      const ivec2 pads = ivec2("+u+", "+d+");\n      const float initializationValue = "+f+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+f+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+l+";\n            wR += "+o+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+v+"\n          }\n\n          int xC = xCCorner + "+m+";\n          if ("+(1===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+v+"\n          } else if ("+(2===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+v+"\n          } else if ("+(3===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+v+"\n          }\n        }\n        setOutput("+p+");\n      }\n    "}},no=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.front,p=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;var g="avg"===t,v="0.0";if(g||(v="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+a+", "+i+", "+o+");\n        const ivec3 pads = ivec3("+f+", "+p+", "+m+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+u+";\n              wD += "+s+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+d+";\n                wR += "+l+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+h+";\n                  wC += "+c+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+d+" * "+h+" +\n                      wR * "+h+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(y="avgValue / count");var b=4*Math.floor(r/4),x=r%4,w="\n      if ("+g+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+a+", "+i+", "+o+");\n      const ivec3 pads = ivec3("+f+", "+p+", "+m+");\n      const float initializationValue = "+v+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+v+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+u+";\n            wD += "+s+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+d+";\n            wR += "+l+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+b+"; wC += 4) {\n              int xC = xCCorner + wC * "+c+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+c+", ch)\n              );\n\n              "+w+"\n            }\n\n            int xC = xCCorner + "+b+";\n            if ("+(1===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(2===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(3===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                initializationValue\n              );\n\n              "+w+"\n            }\n          }\n          setOutput("+y+");\n        }\n      }\n    "}},ro=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,a=e.inSize,i=Math.ceil(a/n);this.outputShape=[r,i];var o="0.0",s="";"prod"===t?o="1.0":"min"===t?(o="1.0 / 1e-20",s="min"):"max"===t&&(o="-1.0 / 1e-20",s="max");var l=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?l="sumValue":"prod"===t?l="prodValue":"all"===t?l="allValue":"any"===t&&(l="anyValue");var c=4*Math.floor(n/4),u=n%4,d="\n      if ("+("sum"===t)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===t)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",h="vec4";"all"===t?(o="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===t&&(o="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");var f="";a%n>0&&(f="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+o+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+f+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+o+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+d+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===u)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+d+"\n        } else if ("+(2===u)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+d+"\n        } else if ("+(3===u)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+d+"\n        }\n        setOutput("+l+");\n      }\n    "},ao=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var a="thisRC = rc;";r%2==1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),n+="\n        "+a+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+ya(["r","c","d"],t)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+ba(e)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+e[1]+";\n        int cols = "+e[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},io=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],i=r[2],o=e.shape,s=o[1],l=o[2],c=[n&&s>1?a-1:a,n&&l>1?i-1:i],u=[n&&s>1?s-1:s,n&&l>1?l-1:l],d=c[0]/u[0],h=c[1]/u[1],f=1/d,p=1/h,m=2*Math.ceil(f)+2,g=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+d+");\n        const float widthScale = float("+h+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+l+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(a-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(i-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},oo=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var a=e[0],i=e[1],o=e[2],s=e[3];this.outputShape=[a,t,n,s];var l=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+l[0]/c[0]+",\n          "+l[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},so=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=e[0],i=e[1],o=e[2],s=e[3];this.outputShape=[a,t,n,s];var l=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+l[0]/c[0]+",\n          "+l[1]/c[1]+",\n          "+l[1]/c[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},lo=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],i=r[2],o=e.shape,s=o[1],l=o[2],c=[n&&s>1?a-1:a,n&&l>1?i-1:i],u=[n&&s>1?s-1:s,n&&l>1?l-1:l],d=c[0]/u[0],h=c[1]/u[1],f=1/d,p=1/h,m=2*Math.ceil(f)+2,g=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+d+");\n        const float widthScale = float("+h+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+l+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+u[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+u[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+a+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},co=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var a=e[0],i=e[1],o=e[2],s=e[3];this.outputShape=[a,t,n,s];var l=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],u=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+l[0]/c[0]+",\n          "+l[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+u+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},uo=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,1!==n){var r=e.map(function(n,r){return function(n){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)}).join(","),a=Ia(n);this.userCode="\n      void main() {\n        "+a+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "},ho=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=ga("rc",n),a=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],o=Ia(n);function s(n){var r=e.map(function(r,a){return function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - "+r[n]+" - 1":""+r[n]}(a,n)});return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+e[0]+" - rc - 1),\n            "+e[0]+" - rc - 1);\n          if("+a+"){\n              result.g = getChannel(getX("+e[0]+" - (rc  + 1) - 1),\n                "+e[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+o+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(e){return s(e)}(r.slice())+";\n          if("+a+"){\n            result.g = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice())+";\n          }\n          if("+i+") {\n            result.b = "+function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            if("+a+") {\n              result.a = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},fo=function(e,t,n,r,a,i,o){void 0===o&&(o=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Ia(a.length),l=Ia(i.length),c="";1===n?c="i":2===n&&(c="i, j");var u="getIndices("+c+")",d="";1===r?d="i":2===r&&(d="i, coords[1]");var h="getUpdates("+d+")",f=t>1?"strides[j]":"strides";this.userCode="\n        "+s+" strides = "+s+"("+a+");\n\n        void main() {\n          "+l+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+e+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+t+"; j++) {\n              int index = round("+u+");\n              flattenedIndex += index * "+f+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += "+h+";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},po=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,a=e.inSize,i=e.numSegments,o=i*Math.ceil(a/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),l=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",u="";a%n>0&&(u="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return initializationValue;\n        }\n      ");var d="";a%n>0&&(d="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+u+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+d+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+i+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+i+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===l)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===l)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===l)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},mo=function(e,t,n){var r,a;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)a="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],l=0;l<t.length;l++)s.push(""+i[l]),l<e&&o.push(""+i[l]);r=o.join(),a=s.join()}var c=Ia(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+a+"));\n        } else {\n          setOutput(getB("+a+"));\n        }\n      }\n    "},go=function(){function e(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,n=Ia(this.rank),r="uniform int start["+this.rank+"];",a=function(e){if(1===e)return"sourceLoc";if(e<=6)return vo.slice(0,e).map(function(e){return"sourceLoc."+e}).join(",");throw Error("Slicing for rank "+e+" is not yet supported")}(this.rank);t="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+e.map(function(e,t){return"sourceLoc."+vo[t]+" = start["+t+"] + coords."+vo[t]+";"}).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+t+"\n        setOutput(getSource("+a+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),vo=["x","y","z","w","u","v"],yo=function(){function e(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=Ia(this.rank),n=ga("coords",this.rank),r=ga("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",i="getChannel(getSource("+r.join()+"), "+a+")",o="\n      result.x = "+i+";\n      if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+i+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+e[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+i+";\n        if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+i+";\n        }\n      }\n    ",l=this.rank<=4?"sourceLoc = coords +\n            "+t+"("+e.map(function(e,t){return"start["+t+"]"}).join()+");":e.map(function(e,t){return r[t]+" = "+n[t]+" + start["+t+"];"}).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+t+" coords = getOutputCoords();\n        "+t+" sourceLoc;\n        "+l+"\n        vec4 result = vec4(0.);\n        "+o+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),bo=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,a=Ia(n.length),i=Ia(n.length),o="";if(1===r)o="coords * strides + begin";else{var s=0;o=n.map(function(e,t){return s++,1===n.length?"coords * strides["+t+"] + begin["+t+"]":"coords["+(s-1)+"] * strides["+t+"] + begin["+t+"]"}).join(",")}this.userCode="\n      "+a+" begin = "+a+"("+e+");\n      "+a+" strides = "+a+"("+t+");\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+o+"));\n      }\n    "},xo=function(){function e(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(e,t,n){var r,a=wo(t,n),i=No(e,a,n);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var o=this.freeTextures[i].shift();return this.usedTextures[i].push(o),o}return this.numUsedTextures++,this.log(),a===Me.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===Me.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===Me.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===Me.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===Me.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(r),r},e.prototype.releaseTexture=function(e,t,n,r){if(null!=this.freeTextures){var a=No(t,wo(n,r),r);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(e),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures[a],o=i.indexOf(e);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(o,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach(function(t){e.gpgpu.deleteMatrixTexture(t)});for(var t in this.usedTextures)this.usedTextures[t].forEach(function(t){e.gpgpu.deleteMatrixTexture(t)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function wo(e,t){if(e===Re.UPLOAD)return Me.PACKED_2X2_FLOAT32;if(e===Re.RENDER||null==e)return function(e){return l().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Me.PACKED_2X2_FLOAT32:Me.UNPACKED_FLOAT32:e?Me.PACKED_2X2_FLOAT16:Me.UNPACKED_FLOAT16}(t);if(e===Re.DOWNLOAD||e===Re.PIXELS)return Me.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function No(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var So=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var a=Ia(this.rank),i=function(e){var t=e.length;if(t>5)throw Error("Tile for rank "+t+" is not yet supported");if(1===t)return"imod(resRC, "+e[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod("+n[a]+", "+e[a]+")");return r.join()}(e);this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},Eo=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var a=Ia(this.rank),i=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank "+t+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(t);this.userCode="\n    void main() {\n      "+a+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},Co=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=Ia(this.rank),i=ma("rc",this.rank),o=new Array(this.rank);for(r=0;r<t.length;r++)o[t[r]]=i[r];var s="vec2("+o.slice(-2).join()+")",l="++"+i[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+o.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+a+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+l+") {\n        result[1] = "+c+";\n      }\n      --"+i[this.rank-1]+";\n      if(++"+i[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+l+") {\n          result[3] = "+c+";\n        }\n      }\n      setOutput(result);\n    }\n    "},ko=1.7580993408473768,Ao=1.0507009873554805,_o=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},jo="if (isnan(x)) return x;",Io="return abs(x);",To=jo+"\n  return (x < 0.0) ? 0.0 : x;\n",Oo=jo+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Po="return (x >= 0.0) ? x : (exp(x) - 1.0);",Do="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+ko+";\n  float scale = "+Ao+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",Ro="return -x;",Mo="return ceil(x);",Fo="return floor(x);",Lo="return exp(x);",Bo="return exp(x) - 1.0;",Uo=jo+"\n  return sin(x);\n",zo=jo+"\n  return cos(x);\n",Vo=jo+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",Wo=jo+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",qo=jo+"\n  return atan(x);\n",Ho=jo+"return log(x + sqrt(x * x + 1.0));",Go=jo+"\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));",Ko=jo+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;",Xo="return x;",Yo="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Qo="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",$o="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Jo=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Zo=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=ga("rc",t),r=Ia(t),a=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),o=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+a+");\n\n        setOutput(getChannel(packedInput, "+o+"));\n      }\n    "},es={};function ts(e,t){if(void 0===t&&(t=!1),"linear"===e)return"return x;";if("relu"===e)return t?Yo:To;if("elu"===e)return t?$o:Po;if("relu6"===e)return t?Qo:Oo;if("prelu"===e)return t?qa:Va;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var ns=function(e){function t(t){var n,r=e.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!l().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var a=Ue(l().getNumber("WEBGL_VERSION"));r.binaryCache=((n=l().getNumber("WEBGL_VERSION"))in es||(es[n]={}),es[n]),r.gpgpu=new zi(a),r.canvas=a.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=t,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=t.gl.canvas;return r.textureManager=new xo(r.gpgpu),r.numMBBeforeWarning=null==l().global.screen?1024:l().global.screen.height*l().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new jr(r,Te),r}return a(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,t,n){if(l().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:Re.UPLOAD}),r},t.prototype.move=function(e,t,n,r){if(l().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:Re.UPLOAD})},t.prototype.readSync=function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensors,i=t.slice,o=t.shape,s=t.isPacked;if(null!=i){var l;l=s?new Jo(o,Xo):new _o(o,Xo);var c=this.runWebGLProgram(l,[{dataId:e,shape:o,dtype:r}],r),u=this.readSync(c.dataId);return this.disposeData(c.dataId),u}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var d,h,f=null!=this.activeTimers;return f&&(d=ee()),h="complex64"===r?Qr(a.real.dataSync(),a.imag.dataSync()):this.getValuesFromTexture(e),f&&(this.downloadWaitMs+=ee()-d),this.convertAndCacheOnCPU(e,h)},t.prototype.read=function(e){return i(this,void 0,void 0,function(){var t,n,r,a,i,s,c,u,d,h,f,p,m,g,v,y,b,x,w,N,S,E;return o(this,function(o){switch(o.label){case 0:if(this.pendingRead.has(e))return t=this.pendingRead.get(e),[2,new Promise(function(e){return t.push(e)})];if(n=this.texData.get(e),r=n.values,a=n.shape,i=n.slice,s=n.dtype,c=n.complexTensors,u=n.isPacked,null!=i)return void 0,d=u?new Jo(a,Xo):new _o(a,Xo),h=this.runWebGLProgram(d,[{dataId:e,shape:a,dtype:s}],s),f=this.read(h.dataId),this.disposeData(h.dataId),[2,f];if(null!=r)return[2,this.convertAndCacheOnCPU(e)];if(!l().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===l().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return p=null,"complex64"!==s&&l().get("WEBGL_BUFFER_SUPPORTED")&&(m=this.decode(e),g=this.texData.get(m.dataId),p=(E=this.gpgpu).createBufferFromTexture.apply(E,[g.texture].concat(Ve(a)))),this.pendingRead.set(e,[]),"complex64"===s?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:o.sent(),o.label=2;case 2:return"complex64"!==s?[3,4]:[4,Promise.all([c.real.data(),c.imag.data()])];case 3:return y=o.sent(),b=y[0],x=y[1],v=Qr(b,x),[3,5];case 4:null==p?v=this.getValuesFromTexture(e):(w=C(a),v=this.gpgpu.downloadFloat32MatrixFromBuffer(p,w)),o.label=5;case 5:return null!=m&&this.disposeData(m.dataId),N=this.convertAndCacheOnCPU(e,v),S=this.pendingRead.get(e),this.pendingRead.delete(e),S.forEach(function(e){return e(N)}),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,N]}})})},t.prototype.checkNumericalProblems=function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!Ge(n)){if(l().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+n+" cannot be represented on this device.")}}},t.prototype.getValuesFromTexture=function(e){var t,n=this.texData.get(e),r=n.shape,a=n.dtype,i=n.isPacked,o=C(r);if(l().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s=this.decode(e),c=this.texData.get(s.dataId),u=(t=this.gpgpu).downloadMatrixFromPackedTexture.apply(t,[c.texture].concat(Ve(r))).subarray(0,o);return this.disposeData(s.dataId),u}var d=l().getBool("WEBGL_PACK")&&!0===i,h=d?wt(r):r,f=d?new gi(h):new mi(h),p=this.runWebGLProgram(f,[{shape:h,dtype:a,dataId:e}],"float32"),m=this.texData.get(p.dataId),g=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,o);return this.disposeData(p.dataId),g},t.prototype.time=function(e){return i(this,void 0,void 0,function(){var t,n,r,a,i,s,c;return o(this,function(o){switch(o.label){case 0:return t=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e(),a=E(this.activeTimers.map(function(e){return e.query})).filter(function(e){return null!=e}),i=E(this.activeTimers.map(function(e){return e.name})).filter(function(e){return null!=e}),this.activeTimers=t,r&&(this.programTimersStack=null),s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return c=o.sent(),s.kernelMs=x(c),s.getExtraProfileInfo=function(){return c.map(function(e,t){return{name:i[t],ms:e}}).map(function(e){return e.name+": "+e.ms}).join(", ")},[3,3];case 2:s.kernelMs={error:"WebGL query timers are not supported in this environment."},o.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,s]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ee(),endMs:null}},t.prototype.endTimer=function(e){return l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=ee(),e)},t.prototype.getQueryTime=function(e){return i(this,void 0,void 0,function(){var t;return o(this,function(n){return l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(t=e).endMs-t.startMs]})})},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var t=this.texData.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,l=s&&s.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return l().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Te.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,t){var n=this;return void 0===t&&(t=128),null!=this.getCPUBackend()&&e.every(function(e){return null==n.texData.get(e.dataId).texture&&e.size<t})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,t){var n=this.makeOutput(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:Te.keep(e.clone()),imag:Te.keep(t.clone())},n},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);if(0===C(n))return an([],n,e.dtype);var r=this.texData.get(e.dataId).isPacked,a=Er(e.shape,t,n);if(r||!a){var i=l().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yo(n):new go(n),o=i.getCustomSetupFunc(t);return this.compileAndRun(i,[e],null,o)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,t,n)},t.prototype.shallowSlice=function(e,t,n){var r=this.texData.get(e.dataId),a=this.makeOutput(n,e.dtype),i=this.texData.get(a.dataId);Object.assign(i,r),i.shape=n,i.dtype=e.dtype;var o=Cr(t,e.strides);r.slice&&(o+=r.slice.flatOffset),i.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||e.dataId};var s=this.dataRefCount.get(i.slice.origDataId)||1;return this.dataRefCount.set(i.slice.origDataId,s+1),a},t.prototype.stridedSlice=function(e,t,n,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,r);var a=wr(t,n,r);if(a.some(function(e){return 0===e}))return an([],a);var i=new bo(t,r,a);return this.compileAndRun(i,[e])},t.prototype.reverse=function(e,t){var n=l().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ho(e.shape,t):new uo(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.concat=function(e,t){if("complex64"===e[0].dtype){var n=e.map(function(e){return nn(e)}),r=e.map(function(e){return rn(e)});return tn(this.concat(n,t),this.concat(r,t))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];if(e.length>l().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(e.length/2),i=this.concat(e.slice(0,a),t),o=this.concat(e.slice(a),t);return this.concat([i,o],t)}if(l().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var s=new Qa(e.map(function(e){return e.shape}),t);return this.compileAndRun(s,e)}var c=Zt(e.map(function(e){return e.shape}),t),u=e.map(function(e){return e.as2D(-1,C(e.shape.slice(t)))}),d=new Ya(u.map(function(e){return e.shape}));return this.compileAndRun(d,u).reshape(c)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Ro,e.dtype);var t=new _o(e.shape,Ro);return this.compileAndRun(t,[e])},t.prototype.batchMatMul=function(e,t,n,r){var a=n?e.shape[2]:e.shape[1],i=r?t.shape[1]:t.shape[2],o=n?e.shape[1]:e.shape[2],s=e.shape[0];if((1===a||1===i)&&o>1e3){n&&(e=e.transpose([0,2,1])),r&&(t=t.transpose([0,2,1]));var l=1===i?e:e.as3D(s,o,1),c=1===i?2:1,u=1===i?t.as3D(s,1,o):t;return this.multiply(l,u).sum(c,!0)}var d=Se(e.dtype,t.dtype),h=new Yi(e.shape,[s,a,i],n,r);return this.compileAndRun(h,[e,t],d)},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.bias,o=e.activation,s=e.preluActivationWeights,l=r?t.shape[2]:t.shape[1],c=a?n.shape[1]:n.shape[2],u=t.shape[0],d=Se(t.dtype,n.dtype),h=null!=i,f=null!=s,p=o?ts(o,!0):null,m=new Yi(t.shape,[u,l,c],r,a,h,p,f),g=[t,n];return i&&g.push(i),s&&g.push(s),this.compileAndRun(m,g,d)},t.prototype.multiply=function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),r=this.texData.get(t.dataId),a=new La("return areal * breal - aimag * bimag;",e.shape,t.shape),i=new La("return areal * bimag + aimag * breal;",e.shape,t.shape),o=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag),this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)],s=this.compileAndRun(a,o),c=this.compileAndRun(i,o),u=this.complex(s,c);return s.dispose(),c.dispose(),u}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,za,e.dtype);var d=new Wa(za,e.shape,t.shape);return this.compileAndRun(d,[e,t],e.dtype)},t.prototype.batchNormalization=function(e,t,n,r,a,i){var o=[e,t,n],s=null;null!=i&&(s=i.shape,o.push(i));var c=null;if(null!=a&&(c=a.shape,o.push(a)),l().getBool("WEBGL_PACK_NORMALIZATION")){var u=new Fa(e.shape,t.shape,n.shape,s,c,r);return this.compileAndRun(u,o)}var d=new Ma(e.shape,t.shape,n.shape,s,c,r);return this.compileAndRun(d,o)},t.prototype.localResponseNormalization4D=function(e,t,n,r,a){var i=l().getBool("WEBGL_PACK_NORMALIZATION")?new Gi(e.shape,t,n,r,a):new qi(e.shape,t,n,r,a);return this.compileAndRun(i,[e])},t.prototype.LRNGrad=function(e,t,n,r,a,i,o){var s=new Hi(t.shape,r,a,i,o);return this.compileAndRun(s,[t,n,e])},t.prototype.tile=function(e,t){if("string"===e.dtype){var n=this.readSync(e.dataId).map(function(e){return re(e)});return ca(Mn(e.shape,e.dtype,n),t)}var r=new So(e.shape,t);return this.compileAndRun(r,[e])},t.prototype.pad=function(e,t,n){var r=l().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new eo(e.shape,t,n):new Zi(e.shape,t,n);return this.compileAndRun(r,[e])},t.prototype.transpose=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,t);var n=l().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Co(e.shape,t):new Eo(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.gather=function(e,t,n){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.gather(e,t,n);var r=new wi(e.shape,t.size,n);return this.compileAndRun(r,[e,t])},t.prototype.batchToSpaceND=function(e,t,n){w(e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var r=t.reduce(function(e,t){return e*t}),a=cr(e.shape,t,r),i=ur(a.length,t.length),o=dr(e.shape,t,r),s=hr(n,t.length),l=fr(o,n,t.length);return e.reshape(a).transpose(i).reshape(o).slice(s,l)},t.prototype.spaceToBatchND=function(e,t,n){w(e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var r=t.reduce(function(e,t){return e*t}),a=[[0,0]];a.push.apply(a,n);for(var i=1+t.length;i<e.shape.length;++i)a.push([0,0]);var o=e.pad(a),s=cr(o.shape,t,r,!1),l=ur(s.length,t.length,!1),c=dr(o.shape,t,r,!1);return o.reshape(s).transpose(l).reshape(c)},t.prototype.reduce=function(e,t,n){var r=e.shape[0],a=e.shape[1],i=mr(a),o=new ro({windowSize:i,inSize:a,batchSize:r},t),s=this.compileAndRun(o,[e],n);return 1===s.shape[1]?s:this.reduce(s,t,n)},t.prototype.argReduce=function(e,t,n){void 0===n&&(n=null);var r=e.shape[0],a=e.shape[1];null!=n&&(r=n.shape[0],a=n.shape[1]);var i=mr(a),o=new pa({windowSize:i,inSize:a,batchSize:r},t,null==n),s=[e];null!=n&&s.push(n);var l=this.compileAndRun(o,s,"int32");return 1===l.shape[1]?l:this.argReduce(e,t,l)},t.prototype.argReducePacked=function(e,t,n){void 0===n&&(n=null);var r=null!=n?n.shape:e.shape,a=mr(r[r.length-1]),i=new Pa(r,a,t,null==n),o=null==n?[e]:[e,n],s=this.compileAndRun(i,o,"int32");return s.rank===e.rank?this.argReducePacked(e,t,s):s},t.prototype.sum=function(e,t){Xt("sum",t,e.rank);var n=Gt(e.shape,t),r=n[0],a=C(n[1]),i=e.as2D(-1,a),o=Ee(e.dtype);return this.reduce(i,"sum",o).reshape(r)},t.prototype.prod=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,t);var n=Gt(e.shape,t),r=n[0],a=C(n[1]),i=e.as2D(-1,a),o=Ee(e.dtype);return this.reduce(i,"prod",o).reshape(r)},t.prototype.unsortedSegmentSum=function(e,t,n){var r=0,a=Yt([r],e.rank),i=e;null!=a&&(i=e.transpose(a),r=$t(1,e.rank)[0]);var o=function(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}(i.shape,r,n),s=C([i.shape[r]]),l=i.as2D(-1,s),c=Ee(e.dtype),u=this.segOpCompute(l,"unsortedSegmentSum",t,c,n).reshape(o);return null!=a&&(u=u.transpose(Qt(a))),u},t.prototype.segOpCompute=function(e,t,n,r,a){var i=e.shape[0],o=e.shape[1],s=function(e,t){var n,r=!1;for(e<=30?(n=e,r=!0):n=X(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=X(e,n+1);return n}(o,a),l=new po({windowSize:s,inSize:o,batchSize:i,numSegments:a},t),c=this.compileAndRun(l,[e,n],r);return c.shape[1]===a?c:(n=mn(0,a).tile([o/s]),this.segOpCompute(c,t,n,r,a))},t.prototype.argMinMaxReduce=function(e,t,n){var r=[t];if(Xt("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,e.rank),!l().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var a=Gt(e.shape,r),i=a[0],o=C(a[1]),s=e.as2D(-1,o);return this.argReduce(s,n).reshape(i)}return this.argReducePacked(e,n)},t.prototype.argMin=function(e,t){return this.argMinMaxReduce(e,t,"min")},t.prototype.argMax=function(e,t){return this.argMinMaxReduce(e,t,"max")},t.prototype.cumsum=function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+t);var a=new ci(e.shape,n,r);return this.compileAndRun(a,[e])},t.prototype.equal=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(equal(a, b));\n","bool");var n=new Wa("return float(a == b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.notEqual=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(notEqual(a, b));\n","bool");var n=new Wa("return float(a != b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.less=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThan(a, b));\n","bool");var n=new Wa("return float(a < b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.lessEqual=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new Wa("return float(a <= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greater=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new Wa("return float(a > b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greaterEqual=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new Wa("return float(a >= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalNot=function(e){var t=new _o(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])},t.prototype.logicalAnd=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new Wa("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalOr=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new Wa("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.select=function(e,t,n){var r=new mo(e.rank,t.shape,t.rank);return this.compileAndRun(r,[e,t,n],Se(t.dtype,n.dtype))},t.prototype.where=function(e){Bt("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return da(e.shape,t)},t.prototype.topk=function(e,t,n){return ua(e.dataSync(),e.shape,e.dtype,t)},t.prototype.min=function(e,t){Xt("min",t,e.rank);var n=Gt(e.shape,t),r=n[0],a=C(n[1]),i=e.as2D(-1,a);return this.reduce(i,"min",i.dtype).reshape(r)},t.prototype.minimum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ha("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Wa("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.mod=function(e,t){var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ha("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Wa("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.max=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,t);Xt("max",t,e.rank);var n=Gt(e.shape,t),r=n[0],a=C(n[1]),i=e.as2D(-1,a);return this.reduce(i,"max",i.dtype).reshape(r)},t.prototype.maximum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ha("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Wa("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.all=function(e,t){Xt("all",t,e.rank);var n=Gt(e.shape,t),r=n[0],a=C(n[1]),i=e.as2D(-1,a);return this.reduce(i,"all",i.dtype).reshape(r)},t.prototype.any=function(e,t){Xt("any",t,e.rank);var n=Gt(e.shape,t),r=n[0],a=C(n[1]),i=e.as2D(-1,a);return this.reduce(i,"any",i.dtype).reshape(r)},t.prototype.realDivide=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new Wa("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,t.shape);return this.compileAndRun(n,[e,t],"float32")},t.prototype.floorDiv=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new Wa("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,t.shape);return this.compileAndRun(n,[e,t],"int32")},t.prototype.add=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,Ba);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.add(e,t);var n=Se(e.dtype,t.dtype);if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,Ba,n);var r=new Wa(Ba,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.packedUnaryOp=function(e,t,n){var r=new Jo(e.shape,t);return this.compileAndRun(r,[e],n)},t.prototype.packedBinaryOp=function(e,t,n,r,a){void 0===a&&(a=!1);var i=new Ha(n,e.shape,t.shape,a);return this.compileAndRun(i,[e,t],r)},t.prototype.complexSeparableBinaryOp=function(e,t,n){var r=this,a=this.texData.get(e.dataId),i=this.texData.get(t.dataId),o=[[a.complexTensors.real,i.complexTensors.real],[a.complexTensors.imag,i.complexTensors.imag]].map(function(a){var i=a[0],o=a[1],s=r.makeComplexComponentTensorInfo(e,i),l=r.makeComplexComponentTensorInfo(t,o),c=new Wa(n,e.shape,t.shape);return r.compileAndRun(c,[s,l],Se(i.dtype,o.dtype))}),s=o[0],l=o[1],c=this.complex(s,l);return s.dispose(),l.dispose(),c},t.prototype.makeComplexComponentTensorInfo=function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}},t.prototype.addN=function(e){if(1===e.length)return e[0];if(e.length>l().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var t=Math.floor(e.length/2),n=this.addN(e.slice(0,t)),r=this.addN(e.slice(t));return this.addN([n,r])}var a=e.map(function(e){return e.dtype}).reduce(function(e,t){return Se(e,t)}),i=e.map(function(e){return e.shape}),o=l().getBool("WEBGL_PACK")?new fa(e[0].shape,i):new ha(e[0].shape,i);return this.compileAndRun(o,e,a)},t.prototype.subtract=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,Ua);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=Se(e.dtype,t.dtype);if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,Ua,e.dtype);var r=new Wa(Ua,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.pow=function(e,t){var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ha("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Wa("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),r=Se(e.dtype,t.dtype);return this.compileAndRun(n,[e,t],r)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Mo,e.dtype);var t=new _o(e.shape,Mo);return this.compileAndRun(t,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Fo,e.dtype);var t=new _o(e.shape,Fo);return this.compileAndRun(t,[e])},t.prototype.sign=function(e){var t=new _o(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])},t.prototype.isNaN=function(e){var t=new _o(e.shape,"return float(isnan(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isInf=function(e){var t=new _o(e.shape,"return float(isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isFinite=function(e){var t=new _o(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.round=function(e){var t=new _o(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Lo,e.dtype);var t=new _o(e.shape,Lo);return this.compileAndRun(t,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Bo,e.dtype);var t=new _o(e.shape,Bo);return this.compileAndRun(t,[e])},t.prototype.softmax=function(e,t){var n=P([t],e.shape),r=this.max(e,n),a=Kt(r.shape,n),i=this.subtract(e,r.reshape(a)),o=this.exp(i),s=this.sum(o,n).reshape(a);return this.realDivide(o,s)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var t=new _o(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(t,[e])},t.prototype.log1p=function(e){var t=new _o(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])},t.prototype.sqrt=function(e){var t=new _o(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var t=new _o(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])},t.prototype.reciprocal=function(e){var t=new _o(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])},t.prototype.relu=function(e){var t;return t=l().getBool("WEBGL_PACK")?new Jo(e.shape,Yo):new _o(e.shape,To),this.compileAndRun(t,[e])},t.prototype.relu6=function(e){var t;return t=l().getBool("WEBGL_PACK")?new Jo(e.shape,Qo):new _o(e.shape,Oo),this.compileAndRun(t,[e])},t.prototype.prelu=function(e,t){var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ha(qa,e.shape,t.shape):new Wa(Va,e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.elu=function(e){if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,$o,e.dtype);var t=new _o(e.shape,Po);return this.compileAndRun(t,[e])},t.prototype.eluDer=function(e,t){var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ha("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,t.shape):new Wa("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.selu=function(e){var t=new _o(e.shape,Do);return this.compileAndRun(t,[e])},t.prototype.int=function(e){var t=new _o(e.shape,"return float(int(x));");return this.compileAndRun(t,[e],"int32")},t.prototype.clip=function(e,t,n){var r,a=(r=l().getBool("WEBGL_PACK_CLIP")?new Ka(e.shape):new Ga(e.shape)).getCustomSetupFunc(t,n);return this.compileAndRun(r,[e],null,a)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Io,e.dtype);var t=new _o(e.shape,Io);return this.compileAndRun(t,[e])},t.prototype.complexAbs=function(e){var t=this.texData.get(e.dataId),n=new Xa(e.shape),r=[this.makeComplexComponentTensorInfo(e,t.complexTensors.real),this.makeComplexComponentTensorInfo(e,t.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(e){var t=new _o(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])},t.prototype.softplus=function(e){var t=new _o(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])},t.prototype.sin=function(e){var t=new _o(e.shape,Uo);return this.compileAndRun(t,[e])},t.prototype.cos=function(e){var t=new _o(e.shape,zo);return this.compileAndRun(t,[e])},t.prototype.tan=function(e){var t=new _o(e.shape,"return tan(x);");return this.compileAndRun(t,[e])},t.prototype.asin=function(e){var t=new _o(e.shape,Vo);return this.compileAndRun(t,[e])},t.prototype.acos=function(e){var t=new _o(e.shape,Wo);return this.compileAndRun(t,[e])},t.prototype.atan=function(e){var t=new _o(e.shape,qo);return this.compileAndRun(t,[e])},t.prototype.atan2=function(e,t){var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ha("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Wa("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.sinh=function(e){var t=new _o(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.cosh=function(e){var t=new _o(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.tanh=function(e){var t=new _o(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])},t.prototype.asinh=function(e){var t=new _o(e.shape,Ho);return this.compileAndRun(t,[e])},t.prototype.acosh=function(e){var t=new _o(e.shape,Go);return this.compileAndRun(t,[e])},t.prototype.atanh=function(e){var t=new _o(e.shape,Ko);return this.compileAndRun(t,[e])},t.prototype.erf=function(e){var t=new _o(e.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(t,[e])},t.prototype.step=function(e,t){var n=new _o(e.shape,function(e){return void 0===e&&(e=0),jo+"\n    return x > 0.0 ? 1.0 : float("+e+");\n  "}(t));return this.compileAndRun(n,[e])},t.prototype.conv2dByMatMul=function(e,t,n,r,a,i){var o=e.shape,s=this.texData.get(e.dataId),c=n.inChannels,u=o[0]*o[1]*o[2],d=n.outChannels,h="channelsLast"===n.dataFormat,f=(1===u||1===d)&&c>1e3,p=o[2]%2!=0&&!!s.isPacked;if(f||!l().getBool("WEBGL_LAZILY_UNPACK")||!l().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!p){var m=h?o[0]*o[1]*o[2]:o[0]*o[2]*o[3],g=this.reshape(e,[1,m,n.inChannels]),v=this.reshape(t,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:g,b:v,transposeA:!1,transposeB:!1,bias:r,activation:a,preluActivationWeights:i}),n.outShape)}var y=h?o[0]*o[1]*(o[2]+1):o[0]*o[2]*(o[3]+1),b={dataId:e.dataId,shape:[1,y,n.inChannels],dtype:e.dtype},x=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,w(Et(s.shape,b.shape),function(){return"packed reshape "+s.shape+" to "+b.shape+" isn't free"});var N=this.reshape(t,[1,n.inChannels,n.outChannels]),S=this.fusedBatchMatMul({a:b,b:N,transposeA:!1,transposeB:!1,bias:r,activation:a,preluActivationWeights:i}),E=this.texData.get(S.dataId);return w(E.isPacked,function(){return"batchMatMul result is expected to be packed"}),s.shape=x,E.shape=n.outShape,Te.makeTensorFromDataId(S.dataId,n.outShape,S.dtype)},t.prototype.conv2dWithIm2Row=function(e,t,n,r,a,i){var o=n.filterWidth,s=n.filterHeight,l=n.inChannels,c=n.outWidth,u=n.outHeight,d="channelsLast"===n.dataFormat,h=o*s*l,f=u*c,p=[h,f],m=e.squeeze([0]),g=t.reshape([1,h,-1]),v=new Wi(p,m.shape,n),y=this.compileAndRun(v,[m]).reshape([1,p[0],p[1]]),b=null!=r,x=null!=i,w=a?ts(a,!0):null,N=new Yi(y.shape,[1,f,n.outChannels],!0,!1,b,w,x),S=[y,g];r&&S.push(r),x&&S.push(i);var E=this.compileAndRun(N,S);return d?E.reshape([1,u,c,n.outChannels]):E.reshape([1,n.outChannels,u,c])},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,n,r,a,i,o);if(l().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,n,r,a,i,o);var s=null!=a,c=null!=o,u=i?ts(i,!1):null,d=new ai(r,s,u,c),h=[t,n];return a&&h.push(a),o&&h.push(o),this.compileAndRun(d,h)},t.prototype.conv2d=function(e,t,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(e,t,n);if(l().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var r=new ai(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerInput=function(e,t,n){var r=new Za(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerFilter=function(e,t,n){var r=new Ja(n);return this.compileAndRun(r,[e,t])},t.prototype.fusedDepthwiseConv2D=function(e){var t,n=e.input,r=e.filter,a=e.convInfo,i=e.bias,o=e.activation,s=e.preluActivationWeights,c=l().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,u=o?ts(o,c):null,d=[n,r],h=null!=i,f=null!=s;return h&&d.push(i),f&&d.push(s),c?(t=new si(a,h,u,f),this.compileAndRun(t,d)):(t=new oi(a,h,u,f),this.compileAndRun(t,d))},t.prototype.depthwiseConv2D=function(e,t,n){var r;return l().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new si(n),this.compileAndRun(r,[e,t])):(r=new oi(n),this.compileAndRun(r,[e,t]))},t.prototype.depthwiseConv2DDerInput=function(e,t,n){var r=new ri(n);return this.compileAndRun(r,[e,t])},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){var r=new ni(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3d=function(e,t,n){var r=new ii(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerInput=function(e,t,n){var r=new ti(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerFilter=function(e,t,n){var r=new ei(n);return this.compileAndRun(r,[e,t])},t.prototype.maxPool=function(e,t){var n=new to(t,"max",!1);return this.compileAndRun(n,[e])},t.prototype.avgPool=function(e,t){var n=new to(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPoolBackprop=function(e,t,n,r){var a=new to(r,"max",!0),i=this.compileAndRun(a,[t]),o=new Ki(r),s=this.compileAndRun(o,[e,i],t.dtype);return i.dispose(),s},t.prototype.avgPoolBackprop=function(e,t,n){var r=new Da(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.cast=function(e,t){return Kr(e,t,this)},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),a=0,i=0;i<e.rank;i++)i!==t&&(r[a++]=e.shape[i]);var o=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var l=new Array(n);for(i=0;i<l.length;i++)o[t]=i,l[i]=this.slice(e,o,s).reshape(r);return l},t.prototype.avgPool3d=function(e,t){var n=new no(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,t,n){var r=new Ra(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.maxPool3d=function(e,t){var n=new no(t,"max",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,t,n,r){var a=new no(r,"max",!0),i=this.compileAndRun(a,[t]),o=new Xi(r),s=this.compileAndRun(o,[e,i],t.dtype);return i.dispose(),s},t.prototype.reshape=function(e,t){var n=this.texData.get(e.dataId);if(n.isPacked&&!Et(e.shape,t)&&(null===n.texture||!Et(n.shape,t))){var r=this.packedReshape(e,t);return Te.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return Xr(e,t)},t.prototype.resizeBilinear=function(e,t,n,r){var a=l().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new so(e.shape,t,n,r):new oo(e.shape,t,n,r);return this.compileAndRun(a,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,t,n){var r=new io(e,t,n);return this.compileAndRun(r,[e])},t.prototype.resizeNearestNeighbor=function(e,t,n,r){var a=new co(e.shape,t,n,r);return this.compileAndRun(a,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){var r=new lo(e,t,n);return this.compileAndRun(r,[e])},t.prototype.multinomial=function(e,t,n,r){var a=t?e:Ar(e),i=a.shape[0],o=a.shape[1],s=new Qi(i,o,n),l=s.getCustomSetupFunc(r);return this.compileAndRun(s,[a],"int32",l)},t.prototype.oneHot=function(e,t,n,r){var a=new $i(e.size,t,n,r);return this.compileAndRun(a,[e])},t.prototype.diag=function(e){var t=new pi(e.size);return this.compileAndRun(t,[e])},t.prototype.nonMaxSuppression=function(e,t,n,r,a){return Bt("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),na(e.dataSync(),t.dataSync(),n,r,a)},t.prototype.cropAndResize=function(e,t,n,r,a,i){var o=new li(e.shape,t.shape,r,a,i);return this.compileAndRun(o,[e,t,n],"float32")},t.prototype.depthToSpace=function(e,t,n){w(t>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+t});var r=e.shape[0],a="NHWC"===n?e.shape[1]:e.shape[2],i="NHWC"===n?e.shape[2]:e.shape[3],o="NHWC"===n?e.shape[3]:e.shape[1],s=a*t,l=i*t,c=o/(t*t),u=new fi("NHWC"===n?[r,s,l,c]:[r,c,s,l],t,n);return this.compileAndRun(u,[e])},t.prototype.split=function(e,t,n){return la(e,t,n)},t.prototype.scatterND=function(e,t,n){var r=yr(0,e,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,l=r.outputSize,c=[l/o,o],u=e.reshape([i,a]),d=t.reshape([i,o]);if(0===l)return Xr(an([]),n);var h=sn(0),f=new fo(i,a,u.rank,d.rank,s,c);return this.compileAndRun(f,[d,u,h]).reshape(n)},t.prototype.sparseToDense=function(e,t,n,r){var a=yr(0,e,n),i=a.sliceRank,o=a.numUpdates,s=a.strides,l=a.outputSize,c=new fo(o,i,e.rank,t.rank,s,[l,1],!1);return this.compileAndRun(c,[t,e,r]).reshape(n)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,t){var n=this.texData.get(e.dataId),r=new bi("return real * expR - imag * expI;",e.shape,t),a=new bi("return real * expI + imag * expR;",e.shape,t),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)],o=this.compileAndRun(r,i),s=this.compileAndRun(a,i),l=this.complex(o,s).as2D(e.shape[0],e.shape[1]);return o.dispose(),s.dispose(),l},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],a=pr(e,t),i=a[0],o=a[1],s=a[2],l=a[3],c=t.reshape([o,r]),u=e.reshape([e.size/s,s]),d=new Ni(r,l,[o,s]);return this.compileAndRun(d,[u,c]).reshape(i)},t.prototype.fill=function(e,t,n){if("string"===(n=n||G(t))){var r=M(n,C(e));return r.fill(t),Te.makeTensor(r,e,n,this)}var a=new xi(e,t),i=a.getCustomSetupFunc(t);return this.compileAndRun(a,[],n,i)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)},t.prototype.linspace=function(e,t,n){return Yr(e,t,n)},t.prototype.makeTensorInfo=function(e,t){var n=this.write(null,e,t);return this.texData.get(n).usage=null,{dataId:n,shape:e,dtype:t}},t.prototype.makeOutput=function(e,t){var n=this.makeTensorInfo(e,t).dataId;return Te.makeTensorFromDataId(n,e,t,this)},t.prototype.unpackTensor=function(e){var t=new Zo(e.shape);return this.runWebGLProgram(t,[e],e.dtype)},t.prototype.packTensor=function(e){var t=new Ji(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,t){var n=[bt(e.shape)].concat(xt(e.shape)),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[bt(t)].concat(xt(t)),i=new ao(a,n),o=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}},t.prototype.decode=function(e){var t,n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype,o=wt(a);return t=r?new hi(o):new di(o),{dtype:i,shape:a,dataId:this.runWebGLProgram(t,[{shape:o,dtype:i,dataId:e}],i,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,t,n,r,a){var i=this;void 0===a&&(a=!1);var o=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(o.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===De.DENSE){var c=Ve(e.outputShape);s.texShape=c.map(function(e){return 2*e})}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===C(o.shape))return s.values=R(o.dtype,0),o;var u=[],d=t.map(function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&C(t.shape)<=l().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!=!!e.packedInputs)t=n.isPacked?i.unpackTensor(t):i.packTensor(t),u.push(t),n=i.texData.get(t.dataId);else if(n.isPacked&&!Et(n.shape,t.shape)){var r=t,a=t.shape;t.shape=n.shape,t=i.packedReshape(t,a),u.push(t),n=i.texData.get(t.dataId),r.shape=a}return i.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}});this.uploadToGPU(o.dataId);var h,f={shape:o.shape,texData:s,isUniform:!1},p=function(e,t,n){var r="";t.concat(n).forEach(function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+=e.shape+"_"+n+"_"+t});var a=e.userCode;return e.constructor.name+"_"+r+"_"+a}(e,d,f),m=this.getAndSaveBinary(p,function(){return function(e,t,n,r){var a=t.userCode,i=n.map(function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}}),o=i.map(function(e){return e.shapeInfo}),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},c=wa(i,s,a,t.packedInputs),u=e.createProgram(c),d=null,h=e.getUniformLocation(u,"NAN",!1);1===l().getNumber("WEBGL_VERSION")&&(d=e.getUniformLocation(u,"INFINITY",!1));for(var f={},p=0;p<t.variableNames.length;p++){var m=t.variableNames[p];f[m]=e.getUniformLocation(u,m,!1),f["offset"+m]=e.getUniformLocation(u,"offset"+m,!1)}return{program:t,source:c,webGLProgram:u,uniformLocations:f,inShapeInfos:o,outShapeInfo:s,infLoc:d,nanLoc:h}}(i.gpgpu,e,d,f)}),g=null!=this.activeTimers;if(g&&(h=this.startTimer()),function(e,t,n,r,a){Vi(t.inShapeInfos,n),Vi([t.outShapeInfo],[r]);var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i,o[0],o[1]):e.setOutputMatrixTexture(i,o[0],o[1]),e.setProgram(t.webGLProgram),1===l().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach(function(n,r){var a=t.program.variableNames[r],i=t.uniformLocations[a],o=t.uniformLocations["offset"+a];if(null!=i)if(n.isUniform)if(C(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),e.gl.uniform1fv(i,s)}else null!=n.texData.slice&&null!=o&&e.gl.uniform1i(o,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,i,r)}),null!=a&&a(e,t.webGLProgram),e.executeProgram()}(this.gpgpu,m,d,f,r),u.forEach(function(e){return i.disposeData(e.dataId)}),g&&(h=this.endTimer(h),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(h)})),!l().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===a){var v=this.unpackTensor(o);return this.disposeData(o.dataId),v}return o},t.prototype.compileAndRun=function(e,t,n,r,a){void 0===a&&(a=!1),n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,a);return Te.makeTensorFromDataId(i.dataId,i.shape,i.dtype)},t.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(l().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Ft(function(){if(!l().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=l().getBool("DEBUG");l().set("DEBUG",!1);var n=e.abs(sn(1e-8)).dataSync()[0];if(l().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var t,n=this.texData.get(e),r=n.shape,a=n.dtype,i=n.values,o=n.texture,s=n.usage,l=n.isPacked;if(null==o){var c,u=null!=this.activeTimers;u&&(c=ee());var d=n.texShape;if(null==d&&(d=Nt(r,l),n.texShape=d),null!=i){var h=wt(r),f=void 0,p=d[1],m=d[0],g=i instanceof Uint8Array;l?(p=(t=We(d[0],d[1]))[0],m=t[1],f=new yi(h,[m,p],g)):f=new vi(h,[m,p],g);var v=this.makeTensorInfo([m,p],a);this.texData.get(v.dataId).usage=g?Re.PIXELS:Re.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),p,m,i);var y=this.runWebGLProgram(f,[v],a,null,!0),b=this.texData.get(y.dataId);n.texture=b.texture,n.texShape=b.texShape,n.isPacked=b.isPacked,n.usage=b.usage,this.disposeData(v.dataId),this.texData.delete(y.dataId),n.values=null,u&&(this.uploadWaitMs+=ee()-c)}else{var x=this.acquireTexture(d,s,a,l);n.texture=x}}},t.prototype.convertAndCacheOnCPU=function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype "+t)}(t,r)),n.values},t.prototype.acquireTexture=function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)},t.prototype.computeBytes=function(e,t){return e[0]*e[1]*z(t)},t}(Ir);Oe()&&Te.registerBackend("webgl",function(){return new ns},2);var rs=en({square_:function(e){var t=Vt(e,"x","square"),n=[t];return Te.runKernelFunc(function(e,n){return n([t]),e.square(t)},{x:t},null,"Square",{},n,[])}}),as="SquaredDifference",is=en({squaredDifference_:function(e,t){var n,r=Vt(e,"a","squaredDifference"),a=Vt(t,"b","squaredDifference");n=Ce(r,a),r=n[0],a=n[1],Dr(r.shape,a.shape);var i={a:r,b:a},o=[r,a];return Te.runKernelFunc(function(e,t){var n=e.squaredDifference(r,a);return t([r,a]),n},i,function(e,t){var n=t[0],r=t[1],a=sn(2);return{a:function(){return e.mul(n.sub(r).mul(a))},b:function(){return e.mul(r.sub(n).mul(a))}}},as,{},o,[])}}),os=en({abs_:function(e){var t=Vt(e,"x","abs");return"complex64"===t.dtype?Te.runKernelFunc(function(e){return e.complexAbs(t)},{$x:t}):Te.runKernelFunc(function(e,n){var r=e.abs(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().step(-1))}}},"Abs")}}),ss=en({acos_:function(e){var t=Vt(e,"x","acos");return Te.runKernelFunc(function(e,n){var r=e.acos(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.divStrict(sn(1).sub(n.toFloat().square()).sqrt()).neg()}}})}}),ls=en({acosh_:function(e){var t=Vt(e,"x","acosh");return Te.runKernelFunc(function(e,n){var r=e.acosh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.divStrict(n.toFloat().square().sub(1).sqrt())}}})}}),cs=en({asin_:function(e){var t=Vt(e,"x","asin");return Te.runKernelFunc(function(e,n){var r=e.asin(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.divStrict(sn(1).sub(n.toFloat().square()).sqrt())}}})}}),us=en({asinh_:function(e){var t=Vt(e,"x","asinh");return Te.runKernelFunc(function(e,n){var r=e.asinh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.divStrict(sn(1).add(n.toFloat().square()).sqrt())}}})}}),ds=en({atan_:function(e){var t=Vt(e,"x","atan");return Te.runKernelFunc(function(e,n){var r=e.atan(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().square().add(1))}}})}}),hs=en({atanh_:function(e){var t=Vt(e,"x","atanh");return Te.runKernelFunc(function(e,n){var r=e.atanh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(sn(1).sub(n.toFloat().square()))}}})}}),fs=en({ceil_:function(e){var t=Vt(e,"x","ceil");return Te.runKernelFunc(function(e){return e.ceil(t)},{$x:t},function(e){return{$x:function(){return vn(e)}}})}}),ps=en({clipByValue_:function(e,t,n){var r=Vt(e,"x","clipByValue");w(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var a=[r],i={min:t,max:n};return Te.runKernelFunc(function(e,a){var i=e.clip(r,t,n);return a([r]),i},{x:r},function(e,r){var a=r[0];return{x:function(){return e.where(a.greaterEqual(t).logicalAnd(a.lessEqual(n)),vn(e))}}},"ClipByValue",i,a)}}),ms=en({cos_:function(e){var t=Vt(e,"x","cos"),n=[t];return Te.runKernelFunc(function(e,n){var r=e.cos(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return n.toFloat().sin().neg().mul(e)}}},"Cos",{},n)}}),gs=en({cosh_:function(e){var t=Vt(e,"x","cosh");return Te.runKernelFunc(function(e,n){var r=e.cosh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return n.toFloat().sinh().mulStrict(e)}}})}}),vs=en({erf_:function(e){var t=Vt(e,"x","erf");return w("int32"===t.dtype||"float32"===t.dtype,function(){return"Input dtype must be `int32` or `float32`."}),"int32"===t.dtype&&(t=t.toFloat()),Te.runKernelFunc(function(e,n){var r=e.erf(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),ys=en({exp_:function(e){var t=Vt(e,"x","exp");return Te.runKernelFunc(function(e,n){var r=e.exp(t);return n([r]),r},{x:t},function(e,t){return{x:function(){return e.mulStrict(t[0])}}},"Exp",{},[],[!0])}}),bs=en({expm1_:function(e){var t=Vt(e,"x","expm1");return Te.runKernelFunc(function(e,n){var r=e.expm1(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.mul(n.exp())}}})}}),xs=en({floor_:function(e){var t=Vt(e,"x","floor");return Te.runKernelFunc(function(e){return e.floor(t)},{$x:t},function(e){return{$x:function(){return vn(e)}}})}}),ws=en({log_:function(e){var t=Vt(e,"x","log"),n=[t];return Te.runKernelFunc(function(e,n){var r=e.log(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.div(n.toFloat())}}},"Log",{},n)}}),Ns=en({log1p_:function(e){var t=Vt(e,"x","log1p");return Te.runKernelFunc(function(e,n){var r=e.log1p(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.add(1))}}})}}),Ss=en({logSigmoid_:function(e){var t=Vt(e,"x","logSigmoid");return Te.runKernelFunc(function(e,n){var r=e.softplus(t.neg()).neg();return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.mul(n.neg().sigmoid())}}})}}),Es=en({neg_:function(e){var t=Vt(e,"x","neg"),n=[t];return Te.runKernelFunc(function(e){return e.neg(t)},{x:t},function(e){return{x:function(){return e.neg()}}},"Neg",{},n)}}),Cs=en({reciprocal_:function(e){var t=Vt(e,"x","reciprocal");return Te.runKernelFunc(function(e,n){var r=e.reciprocal(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.square().neg())}}})}}),ks=en({round_:function(e){var t=Vt(e,"x","round");return Te.runKernelFunc(function(e){return e.round(t)},{$x:t},function(e){return{$x:function(){return vn(e)}}})}}),As=en({rsqrt_:function(e){var t=Vt(e,"x","rsqrt"),n=[t];return Te.runKernelFunc(function(e,n){var r=e.rsqrt(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.div(n.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),_s=en({sigmoid_:function(e){var t=Vt(e,"x","sigmoid");return Te.runKernelFunc(function(e,n){var r=e.sigmoid(t);return n([r]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.mul(n.mul(sn(1).sub(n)))}}},"Sigmoid")}}),js=en({sign_:function(e){var t=Vt(e,"x","sign");return Te.runKernelFunc(function(e){return e.sign(t)},{$x:t},function(e){return{$x:function(){return vn(e)}}})}}),Is=en({isNaN_:function(e){var t=Vt(e,"x","isNaN");return Te.runKernelFunc(function(e){return e.isNaN(t)},{$x:t},function(e){return{$x:function(){return vn(e)}}})}}),Ts=en({isInf_:function(e){var t=Vt(e,"x","isInf");return Te.runKernelFunc(function(e){return e.isInf(t)},{$x:t},function(e){return{$x:function(){return vn(e)}}})}}),Os=en({isFinite_:function(e){var t=Vt(e,"x","isFinite");return Te.runKernelFunc(function(e){return e.isFinite(t)},{$x:t},function(e){return{$x:function(){return vn(e)}}})}}),Ps=en({sin_:function(e){var t=Vt(e,"x","sin"),n=[t];return Te.runKernelFunc(function(e,n){var r=e.sin(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return n.toFloat().cos().mul(e)}}},"Sin",{},n)}}),Ds=en({sinh_:function(e){var t=Vt(e,"x","sinh");return Te.runKernelFunc(function(e,n){var r=e.sinh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return n.toFloat().cosh().mulStrict(e)}}})}}),Rs=en({softplus_:function(e){var t=Vt(e,"x","softplus");return Te.runKernelFunc(function(e,n){var r=e.softplus(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.mul(n.sigmoid())}}})}}),Ms=en({sqrt_:function(e){var t=Vt(e,"x","sqrt");return Te.runKernelFunc(function(e,n){var r=e.sqrt(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().sqrt().mul(2))}}})}}),Fs=en({step_:function(e,t){void 0===t&&(t=0);var n=Vt(e,"x","step");return Te.runKernelFunc(function(e){return e.step(n,t)},{$x:n},function(e){return{$x:function(){return vn(e)}}})}}),Ls=en({tan_:function(e){var t=Vt(e,"x","tan");return Te.runKernelFunc(function(e,n){var r=e.tan(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.cos().square())}}})}}),Bs=en({tanh_:function(e){var t=Vt(e,"x","tanh");return Te.runKernelFunc(function(e,n){var r=e.tanh(t);return n([r]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return sn(1).sub(n.square()).mulStrict(e)}}},"Tanh",{},null,[!0])}});function Us(e,t,n,r,a,i){var o,s,l=Vt(e,"x","batchNorm"),c=Vt(t,"mean","batchNorm"),u=Vt(n,"variance","batchNorm");return null!=a&&(o=Vt(a,"scale","batchNorm")),null!=r&&(s=Vt(r,"offset","batchNorm")),w(2===l.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+l.rank+"."}),w(2===c.rank||1===c.rank,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."}),w(2===u.rank||1===u.rank,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+u.rank+"."}),null!=o&&w(2===o.rank||1===o.rank,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."}),null!=s&&w(2===s.rank||1===s.rank,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Ws(l,c,u,s,o,i)}function zs(e,t,n,r,a,i){var o,s,l=Vt(e,"x","batchNorm"),c=Vt(t,"mean","batchNorm"),u=Vt(n,"variance","batchNorm");return null!=a&&(o=Vt(a,"scale","batchNorm")),null!=r&&(s=Vt(r,"offset","batchNorm")),w(3===l.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+l.rank+"."}),w(3===c.rank||1===c.rank,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."}),w(3===u.rank||1===u.rank,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+u.rank+"."}),null!=o&&w(3===o.rank||1===o.rank,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."}),null!=s&&w(3===s.rank||1===s.rank,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Ws(l,c,u,s,o,i)}function Vs(e,t,n,r,a,i){var o,s,l=Vt(e,"x","batchNorm"),c=Vt(t,"mean","batchNorm"),u=Vt(n,"variance","batchNorm");return null!=a&&(o=Vt(a,"scale","batchNorm")),null!=r&&(s=Vt(r,"offset","batchNorm")),w(4===l.rank,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+l.rank+"."}),w(4===c.rank||1===c.rank,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."}),w(4===u.rank||1===u.rank,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+u.rank+"."}),null!=o&&w(4===o.rank||1===o.rank,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."}),null!=s&&w(4===s.rank||1===s.rank,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Ws(l,c,u,s,o,i)}function Ws(e,t,n,r,a,i){null==i&&(i=.001);var o,s,l,c=Vt(e,"x","batchNorm"),u=Vt(t,"mean","batchNorm"),d=Vt(n,"variance","batchNorm");null!=a&&(o=Vt(a,"scale","batchNorm")),null!=r&&(s=Vt(r,"offset","batchNorm")),w(u.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),w(null==s||u.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),w(null==o||u.rank===o.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),l=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c;var h=[c,u,d,o];return Te.runKernelFunc(function(e,t){var n=e.batchNormalization(l,qs(u),qs(d),i,qs(o),qs(s));return t([c,u,d,o]),n},{x:c,mean:u,variance:d,scale:o,offset:s},function(e,t){var n=t,r=n[0],a=n[1],o=n[2],s=n[3],c=null==s?sn(1):s,u=Pr(a.shape,l.shape),d=[];if(1===a.rank){for(var h=0;h<l.shape.length-1;++h)d.push(l.shape[h]);d.push(1)}var f=r.sub(a),p=e.mul(c),m=As(o.add(sn(i))),g=m.mul(m).mul(m).mul(sn(-.5));return{x:function(){return 1===a.rank?e.mul(or(m.as4D(1,1,1,a.shape[0]),d)).mul(c).reshape(r.shape):e.mul(m).mul(c).reshape(r.shape)},mean:function(){var e=m.mul(sn(-1)).mul(p);return 1===a.rank&&(e=e.sum(u)),e.reshape(a.shape)},variance:function(){var e=g.mul(f).mul(p);return 1===a.rank&&(e=e.sum(u)),e.reshape(a.shape)},scale:function(){var t=f.mul(m),n=e.mul(t);return 1===a.rank&&(n=n.sum(u)),n.reshape(a.shape)},offset:function(){var t=e;return 1===a.rank&&(t=t.sum(u)),t.reshape(a.shape)}}},"BatchNormalization",{varianceEpsilon:i},h).reshape(c.shape)}function qs(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function Hs(){Mt("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var Gs=en({batchNormalization2d_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),Hs(),Us(e,t,n,i,a,r)}}),Ks=en({batchNormalization3d_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),Hs(),zs(e,t,n,i,a,r)}}),Xs=en({batchNormalization4d_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),Hs(),Vs(e,t,n,i,a,r)}}),Ys=en({batchNormalization_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),Hs(),Ws(e,t,n,i,a,r)}}),Qs=en({batchNorm_:Ws}),$s=en({batchNorm2d_:Us}),Js=en({batchNorm3d_:zs}),Zs=en({batchNorm4d_:Vs}),el=en({logicalAnd_:function(e,t){var n=Vt(e,"a","logicalAnd","bool"),r=Vt(t,"b","logicalAnd","bool");return Dr(n.shape,r.shape),Te.runKernelFunc(function(e){return e.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),tl=en({logicalNot_:function(e){var t=Vt(e,"x","logicalNot","bool");return Te.runKernelFunc(function(e){return e.logicalNot(t)},{$x:t})}}),nl=en({logicalOr_:function(e,t){var n=Vt(e,"a","logicalOr","bool"),r=Vt(t,"b","logicalOr","bool");return Dr(n.shape,r.shape),Te.runKernelFunc(function(e){return e.logicalOr(n,r)},{$a:n,$b:r})}}),rl=en({logicalXor_:function(e,t){var n=Vt(e,"a","logicalXor","bool"),r=Vt(t,"b","logicalXor","bool");return Dr(n.shape,r.shape),nl(e,t).logicalAnd(el(e,t).logicalNot())}}),al=en({where_:function(e,t,n){var r=Vt(t,"a","where"),a=Vt(n,"b","where"),i=Vt(e,"condition","where","bool");return N(r.shape,a.shape,"Error in where: "),1===i.rank?w(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):N(i.shape,a.shape,"Error in where: "),Te.runKernelFunc(function(e,t){var n=e.select(i,r,a);return t([i]),n},{$condition:i,$a:r,$b:a},function(e,t){var n=t[0];return{$condition:function(){return vn(n).toFloat()},$a:function(){return e.mul(n.cast(e.dtype))},$b:function(){return e.mul(n.logicalNot().cast(e.dtype))}}})}}),il=function(e){return i(this,void 0,void 0,function(){var t,n,r;return o(this,function(a){switch(a.label){case 0:return[4,(t=Vt(e,"condition","whereAsync","bool")).data()];case 1:return n=a.sent(),r=da(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},ol=en({add_:function(e,t){var n,r=Vt(e,"a","add"),a=Vt(t,"b","add");n=Ce(r,a),r=n[0],a=n[1];var i=Dr(r.shape,a.shape);return Te.runKernelFunc(function(e){return e.add(r,a)},{a:r,b:a},function(e){return{a:function(){var t=e,n=Pr(r.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=Pr(a.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(a.shape)}}},"Add")}}),sl=en({addN_:function(e){w(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),w(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(e,t){return Vt(e,"tensors"+t,"addN")}),n=t[0];t.forEach(function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(e){if(!k(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return Te.runKernelFunc(function(e){return e.addN(t)},r,function(e){var n={};return t.forEach(function(t,r){n[r]=function(){return e.clone()}}),n},"AddN")}}),ll=en({addStrict_:function(e,t){var n=Vt(e,"a","addStrict"),r=Vt(t,"b","addStrict");return N(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),cl=en({atan2_:function(e,t){var n,r=Vt(e,"a","atan2"),a=Vt(t,"b","atan2");n=Ce(r,a),r=n[0],a=n[1];var i=Dr(r.shape,a.shape);return Te.runKernelFunc(function(e,t){var n=e.atan2(r,a);return t([r,a]),n},{$a:r,$b:a},function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=ol(n.square(),r.square()),a=e.mul(r.div(t)),o=Pr(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},$b:function(){var t=ol(n.square(),r.square()),a=Es(e.mul(n.div(t))),o=Pr(r.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(r.shape)}}})}}),ul=en({div_:function(e,t){var n,r=Vt(e,"a","div"),a=Vt(t,"b","div");if(n=Ce(r,a),r=n[0],a=n[1],"int32"===r.dtype&&"int32"===a.dtype)return fl(r,a);var i=Dr(r.shape,a.shape);return Te.runKernelFunc(function(e,t){var n=e.realDivide(r,a);return t([r,a]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),a=Pr(n.shape,i);return a.length>0?t.sum(a).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),a=Pr(r.shape,i);a.length>0&&(t=t.sum(a).reshape(r.shape));var o=r.square();return t.div(o.toFloat()).neg()}}},"Div")}}),dl=en({divNoNan_:function(e,t){var n,r=Vt(e,"a","div"),a=Vt(t,"b","div");r=(n=Ce(r,a))[0],a=n[1];var i=ul(r,a),o=vn(i),s=a.equal(o);return al(s,o,i)}}),hl=en({divStrict_:function(e,t){var n=Vt(e,"a","div"),r=Vt(t,"b","div");return N(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),fl=en({floorDiv_:function(e,t){var n,r=Vt(e,"a","floorDiv"),a=Vt(t,"b","floorDiv");n=Ce(r,a),r=n[0],a=n[1];var i=Dr(r.shape,a.shape);return Te.runKernelFunc(function(e,t){var n=e.floorDiv(r,a);return t([r,a]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),a=Pr(n.shape,i);return a.length>0?t.sum(a).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),a=Pr(r.shape,i);a.length>0&&(t=t.sum(a).reshape(r.shape));var o=r.square();return t.div(o.toFloat()).neg()}}},"FloorDiv")}}),pl=en({maximum_:function(e,t){var n,r=Vt(e,"a","maximum"),a=Vt(t,"b","maximum");return n=Ce(r,a),r=n[0],a=n[1],"bool"===r.dtype&&(r=r.toInt(),a=a.toInt()),Dr(r.shape,a.shape),Te.runKernelFunc(function(e,t){var n=e.maximum(r,a);return t([r,a]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.greaterEqual(r).toFloat())},b:function(){return e.mul(n.less(r).toFloat())}}},"Maximum")}}),ml=en({maximumStrict_:function(e,t){var n=Vt(e,"a","maximumStrict"),r=Vt(t,"b","maximumStrict");return N(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),gl=en({minimum_:function(e,t){var n,r=Vt(e,"a","minimum"),a=Vt(t,"b","minimum");return n=Ce(r,a),r=n[0],a=n[1],"bool"===r.dtype&&(r=r.toInt(),a=a.toInt()),Dr(r.shape,a.shape),Te.runKernelFunc(function(e,t){var n=e.minimum(r,a);return t([r,a]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.lessEqual(r).toFloat())},b:function(){return e.mul(n.greater(r).toFloat())}}},"Minimum")}}),vl=en({minimumStrict_:function(e,t){var n=Vt(e,"a","minimumStrict"),r=Vt(t,"b","minimumStrict");return N(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),yl=en({mod_:function(e,t){var n,r=Vt(e,"a","mod"),a=Vt(t,"b","mod");n=Ce(r,a),r=n[0],a=n[1];var i=Dr(r.shape,a.shape);return Te.runKernelFunc(function(e,t){var n=e.mod(r,a);return t([r,a]),n},{$a:r,$b:a},function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=Pr(n.shape,i);return t.length>0?e.sum(t).reshape(n.shape):e},$b:function(){var t=e.mul(n.div(r).floor().neg()),a=Pr(r.shape,i);return a.length>0?t.sum(a).reshape(r.shape):t}}})}}),bl=en({modStrict_:function(e,t){var n=Vt(e,"a","modStrict"),r=Vt(t,"b","modStrict");return N(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),xl=en({mul_:function(e,t){var n,r=Vt(e,"a","mul"),a=Vt(t,"b","mul");n=Ce(r,a),r=n[0],a=n[1];var i=Dr(r.shape,a.shape);return Te.runKernelFunc(function(e,t){var n=e.multiply(r,a);return t([r,a]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.mul(r.toFloat()),a=Pr(n.shape,i);return a.length>0?t.sum(a).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),a=Pr(r.shape,i);return a.length>0?t.sum(a).reshape(r.shape):t}}},"Mul")}}),wl=en({mulStrict_:function(e,t){var n=Vt(e,"a","mul"),r=Vt(t,"b","mul");return N(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Nl=en({pow_:function(e,t){var n,r=Vt(e,"base","pow"),a=Vt(t,"exp","pow");n=Ce(r,a),r=n[0],a=n[1];var i=Dr(r.shape,a.shape),o=[r,a];return Te.runKernelFunc(function(e,t){var n=e.pow(r,a);return t([r,a,n]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1],a=t[2];return{a:function(){var t=r.toFloat(),a=e.mul(t.mul(n.pow(t.sub(sn(1))))),o=Pr(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},b:function(){var t=n.greater(0),o=n.log().where(t,vn(n)),s=e.mul(a.mul(o)),l=Pr(r.shape,i);return l.length>0&&(s=s.sum(l)),s.reshape(r.shape)}}},"Pow",{},o,[!0])}}),Sl=en({powStrict_:function(e,t){return N(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),El=en({squaredDifferenceStrict_:function(e,t){var n=Vt(e,"a","squaredDifferenceStrict"),r=Vt(t,"b","squaredDifferenceStrict");return N(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Cl=en({sub_:function(e,t){var n,r=Vt(e,"a","sub"),a=Vt(t,"b","sub");n=Ce(r,a),r=n[0],a=n[1];var i=Dr(r.shape,a.shape);return Te.runKernelFunc(function(e){return e.subtract(r,a)},{a:r,b:a},function(e){return{a:function(){var t=e,n=Pr(r.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=Pr(a.shape,i);return n.length>0&&(t=t.sum(n)),t.neg().reshape(a.shape)}}},"Sub")}}),kl=en({subStrict_:function(e,t){var n=Vt(e,"a","subStrict"),r=Vt(t,"b","subStrict");return N(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Al=en({equal_:function(e,t){var n,r=Vt(e,"a","equal"),a=Vt(t,"b","equal");return n=Ce(r,a),r=n[0],a=n[1],Dr(r.shape,a.shape),Te.runKernelFunc(function(e){return e.equal(r,a)},{$a:r,$b:a})}}),_l=en({equalStrict_:function(e,t){var n=Vt(e,"a","equalStrict"),r=Vt(t,"b","equalStrict");return N(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),jl=en({greater_:function(e,t){var n,r=Vt(e,"a","greater"),a=Vt(t,"b","greater");return n=Ce(r,a),r=n[0],a=n[1],Dr(r.shape,a.shape),Te.runKernelFunc(function(e){return e.greater(r,a)},{a:r,b:a},null,"Greater")}}),Il=en({greaterEqual_:function(e,t){var n,r=Vt(e,"a","greaterEqual"),a=Vt(t,"b","greaterEqual");return n=Ce(r,a),r=n[0],a=n[1],Dr(r.shape,a.shape),Te.runKernelFunc(function(e,t){var n=e.greaterEqual(r,a);return t([r,a]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1];return{a:function(){return vn(n)},b:function(){return vn(r)}}},"GreaterEqual")}}),Tl=en({greaterEqualStrict_:function(e,t){var n=Vt(e,"a","greaterEqualStrict"),r=Vt(t,"b","greaterEqualStrict");return N(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),Ol=en({greaterStrict_:function(e,t){var n=Vt(e,"a","greaterStrict"),r=Vt(t,"b","greaterStrict");return N(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),Pl=en({less_:function(e,t){var n,r=Vt(e,"a","less"),a=Vt(t,"b","less");return n=Ce(r,a),r=n[0],a=n[1],Dr(r.shape,a.shape),Te.runKernelFunc(function(e){return e.less(r,a)},{a:r,b:a},null,"Less")}}),Dl=en({lessEqual_:function(e,t){var n,r=Vt(e,"a","lessEqual"),a=Vt(t,"b","lessEqual");return n=Ce(r,a),r=n[0],a=n[1],Dr(r.shape,a.shape),Te.runKernelFunc(function(e,t){var n=e.lessEqual(r,a);return t([r,a]),n},{a:r,b:a},null,"LessEqual")}}),Rl=en({lessEqualStrict_:function(e,t){var n=Vt(e,"a","lessEqualStrict"),r=Vt(t,"b","lessEqualStrict");return N(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),Ml=en({lessStrict_:function(e,t){var n=Vt(e,"a","lessStrict"),r=Vt(t,"b","lessStrict");return N(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),Fl=en({notEqual_:function(e,t){var n,r=Vt(e,"a","notEqual"),a=Vt(t,"b","notEqual");return n=Ce(r,a),r=n[0],a=n[1],Dr(r.shape,a.shape),Te.runKernelFunc(function(e){return e.notEqual(r,a)},{a:r,b:a},null,"NotEqual")}}),Ll=en({notEqualStrict_:function(e,t){var n=Vt(e,"a","notEqualStrict"),r=Vt(t,"b","notEqualStrict");return N(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function Bl(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function Ul(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var zl=en({gather_:function(e,t,n){void 0===n&&(n=0);var r=Vt(e,"x","gather"),a=Vt(t,"indices","gather","int32");n=P(n,r.shape)[0];var i=function(e,t,n){for(var r=e.shape[n],a=[],i=1,o=1,s=0;s<n;s++)a.push(e.shape[s]),i*=e.shape[s];for(s=0;s<t.rank;s++)a.push(t.shape[s]);for(s=n+1;s<e.rank;s++)a.push(e.shape[s]),o*=e.shape[s];return{batchSize:i,sliceSize:o,dimSize:r,outputShape:a}}(r,a,n);return Te.runKernelFunc(function(e,t){var i=e.gather(r,a.flatten(),n);return t([a]),i},{x:r,indices:a},function(e,t){var a=t[0];return{x:function(){var t=r.shape,i=a.size,o=t.slice(0,n),s=o.length,l=t.slice(n,t.length).slice(1),c=l.length,u=Bl(0,s),d=Bl(s+1,s+1+c),h=Ul([o,[i],l]),f=e.reshape(h),p=a.reshape([i]),m=Ul([[s],u,d]),g=f.transpose(m),v=Vl(g,p,r.shape[n]),y=Qt(m);return v.transpose(y)},indices:function(){return a}}},"Gather",{axis:n}).reshape(i.outputShape)}}),Vl=en({unsortedSegmentSum_:function(e,t,n){var r=Vt(e,"x","unsortedSegmentSum"),a=Vt(t,"segmentIds","unsortedSegmentSum","int32");return w(A(n),function(){return"numSegments must be of dtype int"}),Te.runKernelFunc(function(e,t){var i=e.unsortedSegmentSum(r,a,n);return t([a]),i},{$x:r},function(e,t){var n=t[0];return{$x:function(){return function(e,t){for(var n=pl(t,vn(t)),r=zl(e,n),a=Il(t,sn(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=Wn(a,o+1);a=el(a,hn(r.shape,"bool"));var s=vn(r);return al(a,r,s)}(e,n)}}})}});function Wl(e,t,n,r,a,i,o){void 0===i&&(i="NHWC"),w(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,l=t,c=!1;3===t.rank&&(c=!0,l=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),w(4===s.length,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),w(4===l.rank,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+l.rank}),w(4===n.rank,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var u="NHWC"===i?s[3]:s[1],d="NHWC"===i?l.shape[3]:l.shape[1];w(u===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[2]+"."}),w(d===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+n.shape[3]+"."}),null!=o&&w(A(a),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."});var h=Gr(i),f=Fr(s,n.shape,r,1,a,o,!1,h),p=Te.runKernelFunc(function(e,t){var r=e.conv2dDerInput(l,n,f);return t([n,l]),r},{dy4D:l,filter:n},function(e,t){var n=t[0],s=t[1];return{dy4D:function(){return Kl(e,n,r,a,i,1,o)},filter:function(){return Yl(e,s,n.shape,r,a,i,o)}}});return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function ql(e){var t=function(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}(e),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function Hl(e,t,n,r,a){w(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var i=e,o=t,s=!1;4===t.rank&&(s=!0,o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var l=i[4],c=o.shape[4];w(5===i.length,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),w(5===o.rank,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank}),w(5===n.rank,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),w(l===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[3]+"."}),w(c===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."});var u=Lr(i,n.shape,r,1,a),d=Te.runKernelFunc(function(e){return e.conv3dDerInput(o,n,u)},{dy5D:o});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var Gl=en({conv1d_:function(e,t,n,r,a,i,o){void 0===a&&(a="NWC"),void 0===i&&(i=1);var s=Vt(e,"x","conv1d"),l=Vt(t,"filter","conv1d"),c=s,u=!1;2===s.rank&&(u=!0,c=s.as3D(1,s.shape[0],s.shape[1])),w(3===c.rank,function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."}),w(3===l.rank,function(){return"Error in conv1d: filter must be rank 3, but got rank "+l.rank+"."}),null!=o&&w(A(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}),w(c.shape[2]===l.shape[1],function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+l.shape[1]+"."}),w(Hr(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),w("NWC"===a,function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."});var d=l.as4D(1,l.shape[0],l.shape[1],l.shape[2]),h=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),f=Kl(h,d,[1,n],r,"NHWC",[1,i],o);return u?f.as2D(f.shape[2],f.shape[3]):f.as3D(f.shape[0],f.shape[2],f.shape[3])}}),Kl=en({conv2d_:function(e,t,n,r,a,i,o){void 0===a&&(a="NHWC"),void 0===i&&(i=[1,1]);var s=Vt(e,"x","conv2d"),l=Vt(t,"filter","conv2d"),c=s,u=!1;3===s.rank&&(u=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),w(4===c.rank,function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."}),w(4===l.rank,function(){return"Error in conv2d: filter must be rank 4, but got rank "+l.rank+"."}),null!=o&&w(A(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var d="NHWC"===a?c.shape[3]:c.shape[1];w(d===l.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+l.shape[2]+"."}),w(Hr(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var h=Gr(a),f=Fr(c.shape,l.shape,n,i,r,o,!1,h),p=[l,c],m=Te.runKernelFunc(function(e,t){var n=e.conv2d(c,l,f);return t([l,c]),n},{x:c,filter:l},function(e,t){var o=t,s=o[0],l=o[1];return w(qr(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return Ql(l.shape,e,s,n,r,a)},filter:function(){return Yl(l,e,s.shape,n,r,a)}}},"Conv2D",f,p);return u?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),Xl=en({conv3d_:function(e,t,n,r,a,i){void 0===a&&(a="NDHWC"),void 0===i&&(i=[1,1,1]);var o=Vt(e,"x","conv3d"),s=Vt(t,"filter","conv3d"),l=o,c=!1;4===o.rank&&(c=!0,l=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),w(5===l.rank,function(){return"Error in conv3d: input must be rank 5, but got rank "+l.rank+"."}),w(5===s.rank,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),w(l.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+l.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),w(function(e,t){return ql(e)||ql(t)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),w("NDHWC"===a,function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."});var u=Lr(l.shape,s.shape,n,i,r),d=Te.runKernelFunc(function(e,t){var n=e.conv3d(l,s,u);return t([l,s]),n},{x:l,$filter:s},function(e,t){w(ql(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var a=t[0],o=t[1];return{x:function(){return Hl(a.shape,e,o,n,r)},$filter:function(){return function(e,t,n,r,a){var i=e;4===e.rank&&(i=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]));var o=t;4===o.rank&&(o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3])),w(5===i.rank,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+i.shape+"."}),w(5===o.rank,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."}),w(5===n.length,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."}),w(i.shape[4]===n[3],function(){return"Error in conv3dDerFilter: depth of input "+i.shape[4]+") must match input depth in filter ("+n[3]+"."}),w(o.shape[4]===n[4],function(){return"Error in conv3dDerFilter: depth of dy ("+o.shape[4]+") must match output depth for filter ("+n[4]+")."});var s=Lr(i.shape,n,r,1,a);return Te.runKernelFunc(function(e){return e.conv3dDerFilter(i,o,s)},{x5D:i,dy5D:o})}(a,e,o.shape,n,r)}}});return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Yl=en({conv2dDerFilter_:function(e,t,n,r,a,i,o){void 0===i&&(i="NHWC");var s=e;3===e.rank&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var l=t;3===l.rank&&(l=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),w(4===s.rank,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),w(4===l.rank,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+l.shape+"."}),w(4===n.length,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var c="NHWC"===i?s.shape[3]:s.shape[1],u="NHWC"===i?l.shape[3]:l.shape[1];w(c===n[2],function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."}),w(u===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+u+") must match output depth for filter ("+n[3]+")."}),null!=o&&w(A(a),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."});var d=Gr(i),h=Fr(s.shape,n,r,1,a,o,!1,d);return Te.runKernelFunc(function(e){return e.conv2dDerFilter(s,l,h)},{x4D:s,dy4D:l})}}),Ql=en({conv2dDerInput_:Wl}),$l=en({depthwiseConv2d_:function(e,t,n,r,a,i,o){void 0===a&&(a="NHWC"),void 0===i&&(i=[1,1]);var s=Vt(e,"x","depthwiseConv2d"),l=Vt(t,"filter","depthwiseConv2d"),c=s,u=!1;3===s.rank&&(u=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),w(4===c.rank,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."}),w(4===l.rank,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+l.rank+"."}),w(c.shape[3]===l.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+l.shape[2]+"."}),null==i&&(i=[1,1]),w(Hr(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),null!=o&&w(A(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var d=Fr(c.shape,l.shape,n,i,r,o,!0),h=[c,l],f=Te.runKernelFunc(function(e,t){var n=e.depthwiseConv2D(c,l,d);return t([c,l]),n},{x:c,filter:l},function(e,t){w(qr(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var n=t[0],r=t[1];return{x:function(){return Jl(n.shape,e,r,d)},filter:function(){return Zl(n,e,r.shape,d)}}},"DepthwiseConv2dNative",d,h);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),Jl=en({depthwiseConv2dDerInput_:function(e,t,n,r){var a=t,i=!1;3===t.rank&&(i=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=Te.runKernelFunc(function(e){return e.depthwiseConv2DDerInput(a,n,r)},{dy4D:a});return i?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),Zl=en({depthwiseConv2dDerFilter_:function(e,t,n,r){var a=e;3===e.rank&&(a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return 3===i.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),Te.runKernelFunc(function(e){return e.depthwiseConv2DDerFilter(a,i,r)},{x4D:a,dy4D:i})}}),ec=en({separableConv2d_:function(e,t,n,r,a,i,o){void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC");var s=Vt(e,"x","separableConv2d"),l=Vt(t,"depthwiseFilter","separableConv2d"),c=Vt(n,"pointwiseFilter","separableConv2d"),u=s,d=!1;if(3===s.rank&&(d=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");w(4===u.rank,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+u.rank+"."}),w(4===l.rank,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+l.rank+"."}),w(4===c.rank,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+l.rank+"."}),w(1===c.shape[0],function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."}),w(1===c.shape[1],function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."});var h=l.shape[2],f=l.shape[3];w(c.shape[2]===h*f,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+h*f+", but got "+c.shape[2]+"."});var p=$l(u,l,r,a,o,i),m=Kl(p,c,1,"valid",o);return d?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),tc=en({conv2dTranspose_:function(e,t,n,r,a,i){return Wl(n,Vt(e,"x","conv2dTranspose"),Vt(t,"filter","conv2dTranspose"),r,a,"NHWC",i)}}),nc=en({conv3dTranspose_:function(e,t,n,r,a){return Hl(n,Vt(e,"x","conv3dTranspose"),Vt(t,"filter","conv3dTranspose"),r,a)}}),rc=en({matMul_:function(e,t,n,r){var a;void 0===n&&(n=!1),void 0===r&&(r=!1);var i=Vt(e,"a","matMul"),o=Vt(t,"b","matMul");a=Ce(i,o),i=a[0],o=a[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],l=r?o.shape[o.rank-1]:o.shape[o.rank-2],c=n?i.shape[i.rank-1]:i.shape[i.rank-2],u=r?o.shape[o.rank-2]:o.shape[o.rank-1],d=i.shape.slice(0,-2),h=o.shape.slice(0,-2),f=C(d),p=C(h);w(i.rank>=2&&o.rank>=2&&i.rank===o.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+o.rank+"."}),w(k(d,h),function(){return"Error in matMul: outer dimensions ("+d+") and ("+h+") of Tensors with shapes "+i.shape+" and "+o.shape+" must match."}),w(s===l,function(){return"Error in matMul: inner shapes ("+s+") and ("+l+") of Tensors with shapes "+i.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var m=i.shape.slice(0,-2).concat([c,u]),g=n?i.as3D(f,s,c):i.as3D(f,c,s),v=r?o.as3D(p,u,l):o.as3D(p,l,u),y={transposeA:n,transposeB:r};return Te.runKernelFunc(function(e,t){var a=e.batchMatMul(g,v,n,r);return t([g,v]),a},{a:g,b:v},function(e,t){var a=t,i=a[0],o=a[1];return n||r?!n&&r?{a:function(){return e.matMul(o,!1,!1)},b:function(){return e.matMul(i,!0,!1)}}:n&&!r?{a:function(){return o.matMul(e,!1,!0)},b:function(){return i.matMul(e,!1,!1)}}:{a:function(){return o.matMul(e,!0,!0)},b:function(){return e.matMul(i,!0,!0)}}:{a:function(){return e.matMul(o,!1,!0)},b:function(){return i.matMul(e,!0,!1)}}},"BatchMatMul",y).reshape(m)}}),ac=en({dot_:function(e,t){var n=Vt(e,"t1","dot"),r=Vt(t,"t2","dot");w(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];return w(a===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."}),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),ic=en({outerProduct_:function(e,t){var n=Vt(e,"v1","outerProduct"),r=Vt(t,"v2","outerProduct");return w(1===n.rank&&1===r.rank,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),oc=en({reverse_:function(e,t){var n=Vt(e,"x","reverse");if(0===n.rank)return n.clone();var r=P(t,n.shape);return Te.runKernelFunc(function(e){return e.reverse(n,r)},{$x:n},function(e){return{$x:function(){return e.reverse(r)}}}).reshapeAs(n)}}),sc=en({reverse1d_:function(e){var t=Vt(e,"x","reverse");return w(1===t.rank,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),oc(t,0)}}),lc=en({reverse2d_:function(e,t){var n=Vt(e,"x","reverse");return w(2===n.rank,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),oc(n,t)}}),cc=en({reverse3d_:function(e,t){var n=Vt(e,"x","reverse");return w(3===n.rank,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),oc(n,t)}}),uc=en({reverse4d_:function(e,t){var n=Vt(e,"x","reverse");return w(4===n.rank,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),oc(n,t)}});function dc(e,t,n,r,a,i){var o=Vt(e,"x","maxPool"),s=o,l=!1;3===o.rank&&(l=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),null==r&&(r=[1,1]),w(4===s.rank,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),w(Hr(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),null!=i&&w(A(a),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var c=Rr(s.shape,t,n,r,a,i);if(1===c.filterWidth&&1===c.filterHeight&&k(c.inShape,c.outShape))return o.clone();var u=[s],d=Te.runKernelFunc(function(e,t){var n=e.maxPool(s,c);return t([s,n]),n},{x:s},function(e,i){var o=i[0],s=i[1];return{x:function(){return function(e,t,n,r,a,i,o,s){var l=Vt(e,"dy","maxPoolBackprop"),c=Vt(t,"input","maxPoolBackprop"),u=Vt(n,"output","maxPoolBackprop");w(c.rank===l.rank,function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+l.rank+")"}),null==i&&(i=[1,1]),w(Hr(a,i),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"}),w(4===l.rank,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+l.rank+"."}),w(4===c.rank,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."});var d=Rr(c.shape,r,a,i,o,s);return Te.runKernelFunc(function(e){return e.maxPoolBackprop(l,c,u,d)},{$dy:l,$input:c})}(e,o,s,t,n,r,a)}}},"MaxPool",c,u);return l?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function hc(e,t,n,r,a,i){var o=Vt(e,"x","avgPool","float32");null==r&&(r=[1,1]),w(Hr(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=o,l=!1;3===o.rank&&(l=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),w(4===s.rank,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),null!=i&&w(A(a),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var c=Rr(s.shape,t,n,r,a,i);if(1===c.filterWidth&&1===c.filterHeight&&k(c.inShape,c.outShape))return o.clone();var u=Te.runKernelFunc(function(e){return e.avgPool(s,c)},{x:s},function(e){return{x:function(){return function(e,t,n,r,a,i){var o=Vt(e,"dy","avgPoolBackprop"),s=Vt(t,"input","avgPoolBackprop");w(s.rank===o.rank,function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+o.rank+")"}),null==a&&(a=[1,1]),w(Hr(r,a),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+a+"'"});var l=s,c=o,u=!1;3===s.rank&&(u=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),w(4===c.rank,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."}),w(4===l.rank,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+l.rank+"."});var d=Rr(l.shape,n,r,a,i),h=Te.runKernelFunc(function(e){return e.avgPoolBackprop(c,l,d)},{dy4D:c,input4D:l});return u?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}(e,s,t,n,r,a)}}},"AvgPool",c);return u=u.cast(o.dtype),l?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}var fc=en({maxPool_:function(e,t,n,r,a){return dc(e,t,n,1,r,a)}}),pc=en({avgPool_:function(e,t,n,r,a){return hc(e,t,n,1,r,a)}}),mc=en({pool_:function(e,t,n,r,a,i){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var o=Vt(e,"x","maxPool"),s=o,l=!1;3===o.rank&&(l=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),w(Hr(i,a),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"});var c,u=Rr(s.shape,t,i,a,r),d=[u.dilationHeight,u.dilationWidth];c="same"===r?function(e,t){var n=e.map(function(e,n){return e+(e-1)*(t[n]-1)}).map(function(e){return e-1}),r=n.map(function(e){return Math.floor(e/2)}),a=n.map(function(e,t){return e-r[t]});return n.map(function(e,t){return[r[t],a[t]]})}([u.filterHeight,u.filterWidth],d):[[0,0],[0,0]];var h=1===d[0]&&1===d[1],f=function(e,t,n){var r=n.map(function(e){return e[0]}),a=n.map(function(e){return e[1]}),i=e.concat(r,a),o=t.map(function(e,t){return(e-i[t]%e)%e}),s=a.map(function(e,t){return e+o[t]});return[t.map(function(e,t){return[r[t],s[t]]}),t.map(function(e,t){return[0,o[t]]})]}([u.inHeight,u.inWidth],d,c),p=f[0],m=f[1],g=h?r:"valid",v=h?s:rr(s,d,p),y=("avg"===n?function(){return hc(v,t,i,1,g)}:function(){return dc(v,t,i,1,g)})(),b=h?y:Fn(y,d,m);return l?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),gc=en({maxPool3d_:function(e,t,n,r,a,i,o){void 0===i&&(i="NDHWC");var s=Vt(e,"x","maxPool3d"),l=s,c=!1;4===s.rank&&(c=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),w(5===l.rank,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+l.rank+"."}),w("NDHWC"===i,function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),w(Hr(n,o),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),null!=a&&w(A(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var u=Mr(l.shape,t,n,o,r,a,i),d=Te.runKernelFunc(function(e,t){var n=e.maxPool3d(l,u);return t([l,n]),n},{x:l},function(e,i){var s=i[0],l=i[1];return{x:function(){return function(e,t,n,r,a,i,o,s){var l=Vt(e,"dy","maxPool3dBackprop"),c=Vt(t,"input","maxPool3dBackprop"),u=Vt(n,"output","maxPool3dBackprop"),d=l,h=c,f=u,p=!1;4===c.rank&&(p=!0,d=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]),h=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),f=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),w(5===d.rank,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+d.rank+"."}),w(5===h.rank,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+h.rank+"."}),w(5===f.rank,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+f.rank+"."}),null==i&&(i=[1,1,1]),w(Hr(a,i),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"}),null!=s&&w(A(o),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."});var m=Mr(h.shape,r,a,i,o,s),g=Te.runKernelFunc(function(e){return e.maxPool3dBackprop(d,h,f,m)},{dy5D:d,input5D:h});return p?g.as4D(g.shape[1],g.shape[2],g.shape[3],g.shape[4]):g}(e,s,l,t,n,o,r,a)}}});return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),vc=en({avgPool3d_:function(e,t,n,r,a,i,o){void 0===i&&(i="NDHWC");var s=Vt(e,"x","avgPool3d","float32"),l=s,c=!1;4===s.rank&&(c=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),w(5===l.rank,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+l.rank+"."}),w("NDHWC"===i,function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),w(Hr(n,o),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),null!=a&&w(A(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var u=Mr(l.shape,t,n,o,r,a,i),d=Te.runKernelFunc(function(e){return e.avgPool3d(l,u)},{x:l},function(e){return{x:function(){return function(e,t,n,r,a,i,o){var s=Vt(e,"dy","avgPool3dBackprop"),l=Vt(t,"input","avgPool3dBackprop"),c=s,u=l,d=!1;4===l.rank&&(d=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),u=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),w(5===c.rank,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+c.rank+"."}),w(5===u.rank,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+u.rank+"."}),null==a&&(a=[1,1,1]),w(Hr(r,a),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+a+"'"}),null!=o&&w(A(i),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var h=Mr(u.shape,n,r,a,i,o),f=Te.runKernelFunc(function(e){return e.avgPool3dBackprop(c,u,h)},{dy5D:c,input5D:u});return d?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}(e,l,t,n,o,r,a)}}});return d=d.cast(l.dtype),c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),yc=en({slice_:function(e,t,n){var r,a,i=Vt(e,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof t?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(e){w(-1!==e,function(){return"slice() does not support negative begin indexing."})}),a=(a=null==n?new Array(i.rank).fill(-1):"number"==typeof n?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(e,t){return e>=0?e:(w(-1===e,function(){return"Negative size values should be exactly -1 but got "+e+" for the slice() size at index "+t+"."}),i.shape[t]-r[t])}),br(i,r,a);var o=i.shape,s={begin:r,size:a};return Te.runKernelFunc(function(e){return e.slice(i,r,a)},{x:i},function(e){for(var t=[],n=0;n<e.rank;n++)t.push([r[n],o[n]-r[n]-a[n]]);return{x:function(){return e.pad(t)}}},"Slice",s)}}),bc=en({slice1d_:function(e,t,n){var r=Vt(e,"x","slice1d");return w(1===r.rank,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),yc(r,[t],[n])}}),xc=en({slice2d_:function(e,t,n){var r=Vt(e,"x","slice2d");return w(2===r.rank,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),yc(r,t,n)}}),wc=en({slice3d_:function(e,t,n){var r=Vt(e,"x","slice3d");return w(3===r.rank,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),yc(r,t,n)}}),Nc=en({slice4d_:function(e,t,n){var r=Vt(e,"x","slice4d");return w(4===r.rank,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),yc(r,t,n)}});function Sc(e,t,n,r,a){return t.rank<n.rank&&(t=t.reshape(Kt(t.shape,r))),e.rank<n.rank&&(e=e.reshape(Kt(e.shape,r))),{x:function(){var r=e.mul(n.equal(t).cast(e.dtype));return null==a?r:r.transpose(a)}}}var Ec=en({all_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Vt(e,"x","all","bool"),a=P(t,r.shape),i=a,o=Yt(i,r.rank);null!=o&&(r=r.transpose(o),i=$t(i.length,r.rank));var s=Te.runKernelFunc(function(e){return e.all(r,i)},{$x:r});if(n){var l=Kt(s.shape,a);return s.reshape(l)}return s}}),Cc=en({any_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Vt(e,"x","any","bool"),a=P(t,r.shape),i=a,o=Yt(i,r.rank);null!=o&&(r=r.transpose(o),i=$t(i.length,r.rank));var s=Te.runKernelFunc(function(e){return e.any(r,i)},{$x:r});if(n){var l=Kt(s.shape,a);return s.reshape(l)}return s}}),kc=en({argMax_:function(e,t){void 0===t&&(t=0);var n=Vt(e,"x","argMax");null==t&&(t=0);var r=P(t,n.shape),a=Yt(r,n.rank);null!=a&&(n=n.transpose(a),r=$t(r.length,n.rank));var i={axis:r[0]},o=[n];return Te.runKernelFunc(function(e,t){var a=e.argMax(n,r[0]);return t([n]),a},{x:n},function(e,t){var n=t[0];return{x:function(){return vn(n)}}},"ArgMax",i,o)}}),Ac=en({argMin_:function(e,t){void 0===t&&(t=0);var n=Vt(e,"x","argMin");null==t&&(t=0);var r=P(t,n.shape),a=Yt(r,n.rank);return null!=a&&(n=n.transpose(a),r=$t(r.length,n.rank)),Te.runKernelFunc(function(e,t){var a=e.argMin(n,r[0]);return t([n]),a},{$x:n},function(e,t){var n=t[0];return{$x:function(){return vn(n)}}})}}),_c=en({logSumExp_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Vt(e,"x","logSumExp"),a=P(t,r.shape),i=r.max(a,!0),o=r.sub(i).exp().sum(a).log(),s=i.reshape(o.shape).add(o);if(n){var l=Kt(s.shape,a);return s.reshape(l)}return s}}),jc=en({max_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Vt(e,"x","max"),a=r,i=P(t,r.shape),o=i,s=Yt(o,r.rank);null!=s&&(r=r.transpose(s),o=$t(o.length,r.rank));var l=[r],c=Te.runKernelFunc(function(e,t){var n=e.max(r,o);return t([a,n]),n},{x:r},function(e,t){return Sc(e,t[1],t[0],i,s)},"Max",{axes:o},l,[!0]);if(n){var u=Kt(c.shape,i);c=c.reshape(u)}return c}}),Ic=en({mean_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Vt(e,"x","mean"),a=P(t,r.shape),i=C(Gt(r.shape,a)[1]);return kr(function(e){var r=sn(i);return{value:(r.dtype===e.dtype?e:e.cast(r.dtype)).div(r).sum(t,n),gradFunc:function(t){var n=e.shape.slice();return a.forEach(function(e){n[e]=1}),t.reshape(n).mul(hn(e.shape,"float32")).div(i)}}})(r)}}),Tc=en({min_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Vt(e,"x","min"),a=r,i=P(t,r.shape),o=i,s=Yt(o,r.rank);null!=s&&(r=r.transpose(s),o=$t(o.length,r.rank));var l=[r],c=Te.runKernelFunc(function(e,t){var n=e.min(r,o);return t([a,n]),n},{x:r},function(e,t){return Sc(e,t[1],t[0],i,s)},"Min",{axes:o},l,[!0]);if(n){var u=Kt(c.shape,i);c=c.reshape(u)}return c}}),Oc=en({moments_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=P(t,(e=Vt(e,"x","moments")).shape),a=e.mean(r,n),i=a.shape;n||(i=Kt(a.shape,r));var o=e.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:o.mean(r,n)}}}),Pc=en({sum_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Vt(e,"x","sum");"bool"===r.dtype&&(r=r.toInt());var a=P(t,r.shape);return kr(function(e){var t=Yt(a,e.rank),r=a,i=e;null!=t&&(i=e.transpose(t),r=$t(r.length,e.rank));var o=function(t){var n=e.shape.slice();return a.forEach(function(e){n[e]=1}),t.reshape(n).mul(hn(e.shape,"float32"))},s={axes:r},l=Te.runKernelFunc(function(e){return e.sum(i,r)},{x:i},function(e){return{x:function(){return o(e)}}},"Sum",s);if(n){var c=Kt(l.shape,a);l=l.reshape(c)}return{value:l,gradFunc:o}})(r)}}),Dc=en({prod_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Vt(e,"x","prod");"bool"===r.dtype&&(r=r.toInt());var a=P(t,r.shape),i=Yt(a,r.rank),o=a,s=r;null!=i&&(s=r.transpose(i),o=$t(o.length,r.rank));var l=Te.runKernelFunc(function(e){return e.prod(s,o)},{permutedX:s});if(n){var c=Kt(l.shape,a);l=l.reshape(c)}return l}}),Rc=en({elu_:function(e){var t=Vt(e,"x","elu");return Te.runKernelFunc(function(e,n){var r=e.elu(t);return n([r]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return Te.runKernelFunc(function(t){return t.eluDer(e,n)},{dy:e,y:n})}}})}}),Mc=en({leakyRelu_:function(e,t){void 0===t&&(t=.2);var n=Vt(e,"x","leakyRelu");return pl(sn(t).mul(n),n)}}),Fc=en({prelu_:function(e,t){var n=Vt(e,"x","prelu"),r=Vt(t,"alpha","prelu");return Te.runKernelFunc(function(e,t){var a=e.prelu(n,r);return t([n,r]),a},{x:n,alpha:r},function(e,t){var n=t[0],r=t[1],a=n.greater(0);return{x:function(){return al(a,e,e.mul(r))},alpha:function(){var t=al(a,vn(e),e.mul(n)),i=Pr(r.shape,e.shape);return i.length>0&&(t=t.sum(i)),t.reshape(r.shape)}}},"Prelu")}}),Lc=en({relu_:function(e){var t=Vt(e,"x","relu");return"bool"===t.dtype?t.toInt():Te.runKernelFunc(function(e,n){var r=e.relu(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.mulStrict(n.step().toFloat())}}},"Relu")}}),Bc=en({relu6_:function(e){var t=Vt(e,"x","relu6");return"bool"===t.dtype?t.toInt():Te.runKernelFunc(function(e,n){var r=e.relu6(t);return n([t]),r},{x:t},function(e,t){var n=t[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return e.mulStrict(r.toFloat())}}},"Relu6")}}),Uc=en({selu_:function(e){var t=Vt(e,"x","selu");return Te.runKernelFunc(function(e,n){var r=e.selu(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){var t=n.greater(sn(0)),r=sn(ko),a=sn(Ao),i=e.mul(a),o=e.mul(r).mul(n.toFloat().exp());return al(t,i,o)}}})}}),zc=en({transpose_:function(e,t){var n=Vt(e,"x","transpose");if(null==t&&(t=n.shape.map(function(e,t){return t}).reverse()),w(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(e){w(e>=0&&e<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return Te.runKernelFunc(function(e){return e.transpose(n,t)},{x:n},function(e){var n=Qt(t);return{x:function(){return e.transpose(n)}}},"Transpose",r)}}),Vc=en({localResponseNormalization_:function(e,t,n,r,a){void 0===t&&(t=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===a&&(a=.5);var i=Vt(e,"x","localResponseNormalization");w(4===i.rank||3===i.rank,function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+i.rank+"."}),w(A(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var o=i,s=!1;3===i.rank&&(s=!0,o=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var l=Te.runKernelFunc(function(e,i){var s=e.localResponseNormalization4D(o,t,n,r,a);return i([o,s]),s},{x4D:o},function(e,i){var o=i[0],s=i[1];return{x4D:function(){return Te.runKernelFunc(function(i){return i.LRNGrad(e,o,s,t,n,r,a)},{})}}});return s?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),Wc=en({norm_:function(e,t,n,r){void 0===t&&(t="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var a=function e(t,n,r){if(void 0===r&&(r=null),0===t.rank)return t.abs();if(1!==t.rank&&null===r)return e(t.reshape([-1]),n,r);if(1===t.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return t.abs().sum(r);if(n===1/0)return t.abs().max(r);if(n===-1/0)return t.abs().min(r);if("euclidean"===n||2===n)return t.abs().pow(sn(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return t.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return t.abs().sum(r[1]).max(r[0]);if(n===-1/0)return t.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return t.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(e=Vt(e,"x","norm"),t,n),i=a.shape;if(r){var o=P(n,e.shape);i=Kt(a.shape,o)}return a.reshape(i)}}),qc=en({basicLSTMCell_:function(e,t,n,r,a,i){var o=Vt(e,"forgetBias","basicLSTMCell"),s=Vt(t,"lstmKernel","basicLSTMCell"),l=Vt(n,"lstmBias","basicLSTMCell"),c=Vt(r,"data","basicLSTMCell"),u=Vt(a,"c","basicLSTMCell"),d=Vt(i,"h","basicLSTMCell"),h=c.concat(d,1).matMul(s).add(l),f=h.shape[0],p=h.shape[1]/4,m=[f,p],g=h.slice([0,0],m),v=h.slice([0,p],m),y=h.slice([0,2*p],m),b=h.slice([0,3*p],m),x=g.sigmoid().mulStrict(v.tanh()).addStrict(u.mulStrict(o.add(y).sigmoid())),w=x.tanh().mulStrict(b.sigmoid());return[x,w]}}),Hc=en({multiRNNCell_:function(e,t,n,r){for(var a=Vt(t,"data","multiRNNCell"),i=Wt(n,"c","multiRNNCell"),o=Wt(r,"h","multiRNNCell"),s=a,l=[],c=0;c<e.length;c++){var u=e[c](s,i[c],o[c]);l.push(u[0]),l.push(u[1]),s=u[1]}var d=[],h=[];for(c=0;c<l.length;c+=2)d.push(l[c]),h.push(l[c+1]);return[d,h]}}),Gc=en({movingAverage_:function(e,t,n,r,a){void 0===a&&(a=!0);var i=Vt(e,"v","movingAverage"),o=Vt(t,"x","movingAverage"),s=Vt(n,"decay","movingAverage");ke(i,o),w(k(i.shape,o.shape),function(){return"Shape mismatch in v and x"});var l=sn(1),c=l.sub(s),u=o.sub(i).mul(c);if(a){w(null!=r,function(){return"When using zeroDebias: true, step is required."});var d=Vt(r,"step","movingAverage");u=u.div(l.sub(Nl(s,d)))}return i.add(u)}}),Kc=en({stridedSlice_:function(e,t,n,r,a,i,o,s,l){if(void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===l&&(l=0),null==r&&(r=new Array(t.length)),0!==o)throw new Error("ellipsis mask is not yet supported");var c=Vt(e,"x","stridedSlice"),u=xr(s),d=c.shape.slice();u.forEach(function(e){t[e]=0,n[e]=1,d.splice(e,0,1)}),c=c.reshape(d);for(var h=0;h<c.rank;h++)t[h]=Nr(a,t,r,c.shape,h),n[h]=Sr(i,n,r,c.shape,h),r[h]=r[h]||1;var f=xr(l);f.forEach(function(e){n[e]=t[e]+1,r[e]=1});var p=wr(t,n,r),m=p.filter(function(e,t){return-1===f.indexOf(t)});return r.every(function(e){return 1===e})?yc(c,t,p).reshape(m):Te.runKernelFunc(function(e){return e.stridedSlice(c,t,n,r)},{$x:c}).reshape(m)}}),Xc=en({topk_:function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var r=Vt(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var i=Te.runKernelFunc(function(e){return e.topk(r,t,n)},{$x:r});return{values:i[0],indices:i[1]}}}),Yc=en({scatterND_:function(e,t,n){var r=Vt(e,"indices","scatterND","int32"),a=Vt(t,"updates","scatterND");return vr(a,r,n),Te.runKernelFunc(function(e){return e.scatterND(r,a,n)},{indices:r,updates:a},null,"ScatterNd",{shape:n})}}),Qc=en({fft_:function(e){w("complex64"===e.dtype,function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return Te.runKernelFunc(function(e){return e.fft(r)},{input:e}).reshape(e.shape)}}),$c=en({ifft_:function(e){w("complex64"===e.dtype,function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return Te.runKernelFunc(function(e){return e.ifft(r)},{input:e}).reshape(e.shape)}}),Jc=en({rfft_:function(e,t){w("float32"===e.dtype,function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],a=e.size/r;if(null!=t&&t<r){var i=e.shape.map(function(e){return 0}),o=e.shape.map(function(e){return e});o[e.shape.length-1]=t,n=e.slice(i,o),r=t}else if(null!=t&&t>r){var s=e.shape.map(function(e){return e});s[e.shape.length-1]=t-r,n=e.concat(fn(s),e.shape.length-1),r=t}else n=e;var l=n.zerosLike(),c=tn(n,l).as2D(a,r),u=Qc(c),d=Math.floor(r/2)+1,h=nn(u),f=rn(u),p=h.split([d,r-d],h.shape.length-1),m=f.split([d,r-d],f.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=d,tn(p[0],m[0]).reshape(g)}}),Zc=en({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),a=$c(r);return nn(a)}var i=[n,2*(t-1)],o=nn(e).as2D(n,t),s=rn(e).as2D(n,t),l=o.slice([0,1],[n,t-2]).reverse(1),c=s.slice([0,1],[n,t-2]).reverse(1).mul(sn(-1)),u=o.concat(l,1),d=s.concat(c,1);return r=tn(u,d).as2D(i[0],i[1]),a=$c(r),nn(a)}}),eu=Object.freeze({fft:Qc,ifft:$c,rfft:Jc,irfft:Zc}),tu=en({sparseToDense_:function(e,t,n,r){void 0===r&&(r=0);var a=Vt(e,"sparseIndices","sparseToDense","int32"),i=Vt(t,"sparseValues","sparseToDense"),o=Vt(r,"defaultValue","sparseToDense",i.dtype);return function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+e.shape+".");var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+i+".");var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+t.shape+", should be [] or ["+a+"]");if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,n,o),Te.runKernelFunc(function(e){return e.sparseToDense(a,i,n,o)},{$sparseIndices:a,$sparseValues:i,$defaultValue:o})}}),nu=en({gatherND_:function(e,t){var n=Vt(t,"indices","gatherND","int32"),r=Vt(e,"x","gatherND");return Te.runKernelFunc(function(e){return e.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),ru=en({diag_:function(e){var t=Vt(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return Te.runKernelFunc(function(e){return e.diag(t)},{$x:t}).reshape(n)}}),au=en({dropout_:function(e,t,n,r){var a=Vt(e,"x","dropout");if(w("float32"===a.dtype,function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."}),w(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),0===t)return e instanceof me?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(k(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,s=tr(i,0,1,"float32",r).add(o).floor().div(o);return a.mul(s)}});function iu(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return ln(a,"float32")}var ou,su=en({hannWindow_:function(e){return iu(e,.5,.5)}}),lu=en({hammingWindow_:function(e){return iu(e,.54,.46)}}),cu=en({frame_:function(e,t,n,r,a){void 0===r&&(r=!1),void 0===a&&(a=0);for(var i=0,o=[];i+t<=e.size;)o.push(yc(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,l=yn([yc(e,i,t-s),pn([s],a)]);o.push(l),i+=n}return 0===o.length?cn([],[0,t]):yn(o).as2D(o.length,t)}}),uu=en({stft_:function(e,t,n,r,a){var i;void 0===a&&(a=su),null==r&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var o=cu(e,t,n),s=xl(o,a(t)),l=[],c=0;c<o.shape[0];c++)l.push(Jc(s.slice([c,0],[1,t]),r));return yn(l)}}),du=Object.freeze({hannWindow:su,hammingWindow:lu,frame:cu,stft:uu});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(ou||(ou={}));var hu=en({absoluteDifference_:function(e,t,n,r){void 0===r&&(r=ou.SUM_BY_NONZERO_WEIGHTS);var a=Vt(e,"labels","absoluteDifference"),i=Vt(t,"predictions","absoluteDifference"),o=null;null!=n&&(o=Vt(n,"weights","absoluteDifference")),N(a.shape,i.shape,"Error in absoluteDifference: ");var s=a.sub(i).abs();return fu(s,o,r)}}),fu=en({computeWeightedLoss_:function(e,t,n){void 0===n&&(n=ou.SUM_BY_NONZERO_WEIGHTS);var r=Vt(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=Vt(t,"weights","computeWeightedLoss"));var i=null==a?r:r.mul(a);if(n===ou.NONE)return i;if(n===ou.SUM)return i.sum();if(n===ou.MEAN){if(null==a)return i.mean();var o=r.size/a.size,s=i.sum().div(a.sum());return o>1?s.div(sn(o)):s}if(n===ou.SUM_BY_NONZERO_WEIGHTS){if(null==a)return i.sum().div(sn(r.size));var l=a.mul(hn(r.shape)).notEqual(sn(0)).sum().toFloat();return i.sum().div(l)}throw Error("Unknown reduction: "+n)}}),pu=en({cosineDistance_:function(e,t,n,r,a){void 0===a&&(a=ou.SUM_BY_NONZERO_WEIGHTS);var i=Vt(e,"labels","cosineDistance"),o=Vt(t,"predictions","cosineDistance"),s=null;null!=r&&(s=Vt(r,"weights","cosineDistance")),N(i.shape,o.shape,"Error in cosineDistance: ");var l=sn(1).sub(i.mul(o).sum(n,!0));return fu(l,s,a)}}),mu=en({hingeLoss_:function(e,t,n,r){void 0===r&&(r=ou.SUM_BY_NONZERO_WEIGHTS);var a=Vt(e,"labels","hingeLoss"),i=Vt(t,"predictions","hingeLoss"),o=null;null!=n&&(o=Vt(n,"weights","hingeLoss")),N(a.shape,i.shape,"Error in hingeLoss: ");var s=sn(1);a=sn(2).mul(a).sub(s);var l=s.sub(a.mul(i)).relu();return fu(l,o,r)}}),gu=en({huberLoss_:function(e,t,n,r,a){void 0===r&&(r=1),void 0===a&&(a=ou.SUM_BY_NONZERO_WEIGHTS);var i=Vt(e,"labels","huberLoss"),o=Vt(t,"predictions","huberLoss"),s=null;null!=n&&(s=Vt(n,"weights","huberLoss")),N(i.shape,o.shape,"Error in huberLoss: ");var l=sn(r),c=o.sub(i).abs(),u=gl(c,l),d=c.sub(u),h=sn(.5).mul(u.square()).add(l.mul(d));return fu(h,s,a)}}),vu=en({logLoss_:function(e,t,n,r,a){void 0===r&&(r=1e-7),void 0===a&&(a=ou.SUM_BY_NONZERO_WEIGHTS);var i=Vt(e,"labels","logLoss"),o=Vt(t,"predictions","logLoss"),s=null;null!=n&&(s=Vt(n,"weights","logLoss")),N(i.shape,o.shape,"Error in logLoss: ");var l=sn(1),c=sn(r),u=i.mul(o.add(c).log()).neg().sub(l.sub(i).mul(l.sub(o).add(c).log()));return fu(u,s,a)}}),yu=en({meanSquaredError_:function(e,t,n,r){void 0===r&&(r=ou.SUM_BY_NONZERO_WEIGHTS);var a=Vt(e,"labels","meanSquaredError"),i=Vt(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=Vt(n,"weights","meanSquaredError")),N(a.shape,i.shape,"Error in meanSquaredError: ");var s=a.squaredDifference(i);return fu(s,o,r)}}),bu=en({sigmoidCrossEntropy_:function(e,t,n,r,a){void 0===r&&(r=0),void 0===a&&(a=ou.SUM_BY_NONZERO_WEIGHTS);var i=Vt(e,"multiClassLabels","sigmoidCrossEntropy"),o=Vt(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=Vt(n,"weights","sigmoidCrossEntropy")),N(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var l=sn(r),c=sn(1),u=sn(.5);i=i.mul(c.sub(l)).add(u.mul(l))}var d=function(e,t){var n=Vt(e,"labels","sigmoidCrossEntropyWithLogits"),r=Vt(t,"logits","sigmoidCrossEntropyWithLogits");N(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var a=r.relu(),i=r.mul(n),o=r.abs().neg().exp().log1p();return a.sub(i).add(o)}(i,o);return fu(d,s,a)}}),xu=en({softmaxCrossEntropy_:function(e,t,n,r,a){void 0===r&&(r=0),void 0===a&&(a=ou.SUM_BY_NONZERO_WEIGHTS);var i=Vt(e,"onehotLabels","softmaxCrossEntropy"),o=Vt(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=Vt(n,"weights","softmaxCrossEntropy")),N(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var l=sn(r),c=sn(1),u=sn(i.shape[1]);i=i.mul(c.sub(l)).add(l.div(u))}var d=function(e,t,n){if(void 0===n&&(n=-1),-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+t.rank+" and dim was "+n);return kr(function(e,t,r){var a=t.logSumExp([n],!0),i=t.toFloat().sub(a);return r([e,i]),{value:i.mul(e).neg().sum([n]),gradFunc:function(e,t){var r=t[0],a=t[1],i=Kt(e.shape,[n]);return[e.reshape(i).mul(r.toFloat().sub(a.exp())),e.reshape(i).mul(a.exp().sub(r.toFloat()))]}}})(e,t)}(i,o);return fu(d,s,a)}}),wu=Object.freeze({get Reduction(){return ou},absoluteDifference:hu,computeWeightedLoss:fu,cosineDistance:pu,hingeLoss:mu,huberLoss:gu,logLoss:vu,meanSquaredError:yu,sigmoidCrossEntropy:bu,softmaxCrossEntropy:xu});function Nu(e,t){return void 0===t&&(t=!1),Te.tidy(function(){if(2!==e.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],a=qn(n),i=e.clone(),o=cn([[1]],[1,1]),s=o.clone(),l=n>=r?r:n,c=function(e){var t,l=i,c=s,u=a;t=Te.tidy(function(){var t=i.slice([e,e],[n-e,1]),l=t.norm(),c=i.slice([e,e],[1,1]),u=cn([[-1]]).where(c.greater(0),cn([[1]])),d=c.sub(u.mul(l)),h=t.div(d);s=1===h.shape[0]?o.clone():o.concat(h.slice([1,0],[h.shape[0]-1,h.shape[1]]),0);var f=u.matMul(d).div(l).neg(),p=i.slice([e,0],[n-e,r]),m=f.mul(s);if(0===e)i=p.sub(m.matMul(s.transpose().matMul(p)));else{var g=p.sub(m.matMul(s.transpose().matMul(p)));i=i.slice([0,0],[e,r]).concat(g,0)}var v=a.slice([0,e],[n,a.shape[1]-e]);if(0===e)a=v.sub(v.matMul(s).matMul(m.transpose()));else{var y=v.sub(v.matMul(s).matMul(m.transpose()));a=a.slice([0,0],[n,e]).concat(y,1)}return[s,i,a]}),s=t[0],i=t[1],a=t[2],Lt([l,c,u])},u=0;u<l;++u)c(u);return!t&&n>r&&(a=a.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[a,i]})}var Su=en({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=Vt(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var a=r.shape,i=r.shape.slice(-2),o=i[0],s=i[1];if(!(t<=o))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+o+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=o),n<0&&(n=s);var l=mn(0,o,1,"int32").reshape([-1,1]),c=mn(0,s,1,"int32"),u=Cl(l,c),d=el(u.lessEqual(sn(+t,"int32")),u.greaterEqual(sn(-n,"int32"))),h=fn([o,s],r.dtype);return ir(lr(r.reshape([-1,o,s])).map(function(e){return al(d,e,h)})).reshape(a)}}),Eu=en({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,w(null!=e&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(t){w(e[t].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[t].shape[0]+" vs. "+n+")"})},a=1;a<e.length;++a)r(a)}else t=!0,e=Sn(e,e.shape[0],0).map(function(e){return ar(e,[0])});w(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var i=[],o=e,s=function(e){i.push(Te.tidy(function(){var t=o[e];if(e>0)for(var n=0;n<e;++n){var r=Pc(i[n].mulStrict(t)).mul(i[n]);t=t.sub(r)}return t.div(Wc(t,"euclidean"))}))};for(a=0;a<e.length;++a)s(a);return t?ir(i,0):i}}),Cu=en({qr_:function(e,t){if(void 0===t&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(2===e.rank)return Nu(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(e,t){return e*t}),r=lr(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];return r.forEach(function(e){var n=Nu(e,t),r=n[0],o=n[1];a.push(r),i.push(o)}),[ir(a,0).reshape(e.shape),ir(i,0).reshape(e.shape)]}}),ku=Object.freeze({bandPart:Su,gramSchmidt:Eu,qr:Cu});function Au(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),w(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),w(2===e.rank,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),w(4===e.shape[1],function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),w(1===t.rank,function(){return"scores must be a 1D tensor"}),w(t.shape[0]===o,function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+t.shape[0]}),w(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var _u=en({resizeBilinear_:function(e,t,n){void 0===n&&(n=!1);var r=Vt(e,"images","resizeBilinear");w(3===r.rank||4===r.rank,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),w(2===t.length,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],l=Te.runKernelFunc(function(e,t){return t([a]),e.resizeBilinear(a,o,s,n)},{x:a},function(e,t){return{x:function(){return Te.runKernelFunc(function(r){return r.resizeBilinearBackprop(e,t[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:s});return i?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),ju=en({resizeNearestNeighbor_:function(e,t,n){void 0===n&&(n=!1);var r=Vt(e,"images","resizeNearestNeighbor");w(3===r.rank||4===r.rank,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),w(2===t.length,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),w("float32"===r.dtype||"int32"===r.dtype,function(){return"`images` must have `int32` or `float32` as dtype"});var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],l=Te.runKernelFunc(function(e,t){return t([a]),e.resizeNearestNeighbor(a,o,s,n)},{batchImages:a},function(e,t){return{batchImages:function(){return Te.runKernelFunc(function(r){return r.resizeNearestNeighborBackprop(e,t[0],n)},{})}}});return i?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),Iu=en({nonMaxSuppression_:function(e,t,n,r,a){void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY);var i=Vt(e,"boxes","nonMaxSuppression"),o=Vt(t,"scores","nonMaxSuppression"),s=Au(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;var l={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return Te.runKernelFunc(function(e){return e.nonMaxSuppression(i,o,n,r,a)},{boxes:i,scores:o},null,"NonMaxSuppressionV3",l)}}),Tu=en({nonMaxSuppressionWithScore_:function(e,t,n,r,a,i){void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),void 0===i&&(i=0);var o=Vt(e,"boxes","nonMaxSuppression"),s=Vt(t,"scores","nonMaxSuppression"),l=Au(o,s,n,r,a,i),c={maxOutputSize:n=l.maxOutputSize,iouThreshold:r=l.iouThreshold,scoreThreshold:a=l.scoreThreshold,softNmsSigma:i=l.softNmsSigma},u=Te.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},c);return{selectedIndices:u[0],selectedScores:u[1]}}}),Ou=en({cropAndResize_:function(e,t,n,r,a,i){var o=Vt(e,"image","cropAndResize"),s=Vt(t,"boxes","cropAndResize","float32"),l=Vt(n,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var c=s.shape[0];return w(4===o.rank,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."}),w(2===s.rank&&4===s.shape[1],function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."}),w(1===l.rank&&l.shape[0]===c,function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."}),w(2===r.length,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),w(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),w("bilinear"===a||"nearest"===a,function(){return"method must be bilinear or nearest, but was "+a}),Te.runKernelFunc(function(e,t){return e.cropAndResize(o,s,l,r,a,i)},{images:o,boxes:s,boxInd:l},null,"CropAndResize",{method:a,extrapolationValue:i,cropSize:r})}}),Pu=Object.freeze({resizeBilinear:_u,resizeNearestNeighbor:ju,nonMaxSuppression:Iu,nonMaxSuppressionAsync:function(e,t,n,r,a){return void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),i(this,void 0,void 0,function(){var i,s,l,c,u,d,h;return o(this,function(o){switch(o.label){case 0:return i=Vt(e,"boxes","nonMaxSuppressionAsync"),s=Vt(t,"scores","nonMaxSuppressionAsync"),l=Au(i,s,n,r,a),n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,[4,Promise.all([i.data(),s.data()])];case 1:return c=o.sent(),u=c[0],d=c[1],h=na(u,d,n,r,a),i!==e&&i.dispose(),s!==t&&s.dispose(),[2,h]}})})},nonMaxSuppressionWithScore:Tu,nonMaxSuppressionWithScoreAsync:function(e,t,n,r,a,s){return void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),void 0===s&&(s=0),i(this,void 0,void 0,function(){var i,l,c,u,d,h,f;return o(this,function(o){switch(o.label){case 0:return i=Vt(e,"boxes","nonMaxSuppressionAsync"),l=Vt(t,"scores","nonMaxSuppressionAsync"),c=Au(i,l,n,r,a,s),n=c.maxOutputSize,r=c.iouThreshold,a=c.scoreThreshold,s=c.softNmsSigma,[4,Promise.all([i.data(),l.data()])];case 1:return u=o.sent(),d=u[0],h=u[1],f=ra(d,h,n,r,a,s),i!==e&&i.dispose(),l!==t&&l.dispose(),[2,f]}})})},cropAndResize:Ou}),Du=function(e,t){return!(e>0)||"linear"===t},Ru=function(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},Mu=function(e,t){var n=t,r=Pr(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},Fu=function(e,t,n){if("linear"===t)return e;if("relu"===t)return Lc(e);if("elu"===t)return Rc(e);if("relu6"===t)return Bc(e);if("prelu"===t)return Fc(e,n);throw new Error("Unknown fused activation "+t+".")},Lu=en({fusedMatMul_:function(e){var t,n=e.a,r=e.b,a=e.transposeA,i=void 0!==a&&a,o=e.transposeB,s=void 0!==o&&o,l=e.bias,c=e.activation,u=void 0===c?"linear":c,d=e.preluActivationWeights;if(!1===Du(Te.state.gradientDepth,u)){var h=rc(n,r,i,s);return null!=l&&(h=ol(h,l)),Fu(h,u,d)}var f=Vt(n,"a","fused matMul"),p=Vt(r,"b","fused matMul");t=Ce(f,p),f=t[0],p=t[1];var m=i?f.shape[f.rank-2]:f.shape[f.rank-1],g=s?p.shape[p.rank-1]:p.shape[p.rank-2],v=i?f.shape[f.rank-1]:f.shape[f.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],b=f.shape.slice(0,-2),x=p.shape.slice(0,-2),N=C(b),S=C(x);w(f.rank>=2&&p.rank>=2&&f.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+f.rank+" and "+p.rank+"."}),w(k(b,x),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+f.shape+" and "+p.shape+" must match."}),w(m===g,function(){return"Error in fused matMul: inner shapes ("+m+") and ("+g+") of Tensors with shapes "+f.shape+" and "+p.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var E,A,_=f.shape.slice(0,-2).concat([v,y]),j=i?f.as3D(N,m,v):f.as3D(N,v,m),I=s?p.as3D(S,y,g):p.as3D(S,g,y);null!=l&&Dr(_,(E=Ce(E=Vt(l,"bias","fused matMul"),f)[0]).shape),null!=d&&(A=Vt(d,"prelu weights","fused matMul"));var T={a:j,b:I};null!=l&&(T.bias=E),null!=d&&(T.preluActivationWeights=A);var O=[j,I];return Te.runKernelFunc(function(e,t){var n=e.fusedBatchMatMul({a:j,b:I,transposeA:i,transposeB:s,bias:E,activation:u,preluActivationWeights:A});return t([j,I,n]),n},T,function(e,t){var n=t[0],r=t[1],a=t[2],o=Ru(e,a,u),c={};return null!=l&&(c={bias:function(){return Mu(E,o)}}),i||s?!i&&s?Object.assign({a:function(){return o.matMul(r,!1,!1)},b:function(){return o.matMul(n,!0,!1)}},c):i&&!s?Object.assign({a:function(){return r.matMul(o,!1,!0)},b:function(){return n.matMul(o,!1,!1)}},c):Object.assign({a:function(){return r.matMul(o,!0,!0)},b:function(){return o.matMul(n,!0,!0)}},c):Object.assign({a:function(){return o.matMul(r,!1,!0)},b:function(){return n.matMul(o,!0,!1)}},c)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:u},O,[!0]).reshape(_)}}),Bu=en({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,l=void 0===s?[1,1]:s,c=e.dimRoundingMode,u=e.bias,d=e.activation,h=void 0===d?"linear":d,f=e.preluActivationWeights;if(h=h||"linear",!1===Du(Te.state.gradientDepth,h)){var p=Kl(t,n,r,a,o,l,c);return null!=u&&(p=ol(p,u)),Fu(p,h,f)}var m=Vt(t,"x","conv2d"),g=Vt(n,"filter","conv2d"),v=m,y=!1;3===m.rank&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),w(4===v.rank,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),w(4===g.rank,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."}),null!=c&&w(A(a),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+a+"."}),w(v.shape[3]===g.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+g.shape[2]+"."}),w(Hr(r,l),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+l+"'"}),w("NHWC"===o,function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."});var b,x,N=Fr(v.shape,g.shape,r,l,a,c);null!=u&&(b=Ce(b=Vt(u,"bias","fused conv2d"),m)[0],Dr(N.outShape,b.shape)),null!=f&&(x=Vt(f,"prelu weights","fused conv2d"));var S={x:v,filter:g};null!=u&&(S.bias=b),null!=f&&(S.preluActivationWeights=x);var E=[g,v],C=Te.runKernelFunc(function(e,t){var n=e.fusedConv2d({input:v,filter:g,convInfo:N,bias:b,activation:h,preluActivationWeights:x});return t([g,v,n]),n},S,function(e,t){var n=t,i=n[0],o=n[1],s=n[2],c=Ru(e,s,h);w(qr(l),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+l+"'"});var d={};return null!=u&&(d={bias:function(){return Mu(b,c)}}),Object.assign({x:function(){return Ql(o.shape,c,i,r,a)},filter:function(){return Yl(o,c,i.shape,r,a)}},d)},"FusedConv2D",{convInfo:N,activation:h},E,[!0]);return y?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),Uu=en({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,l=void 0===s?[1,1]:s,c=e.dimRoundingMode,u=e.bias,d=e.activation,h=void 0===d?"linear":d,f=e.preluActivationWeights;if(!1===Du(Te.state.gradientDepth,h)){var p=$l(t,n,r,a,o,l,c);return null!=u&&(p=ol(p,u)),Fu(p,h,f)}var m=Vt(t,"x","depthwiseConv2d"),g=Vt(n,"filter","depthwiseConv2d"),v=m,y=!1;3===m.rank&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),w(4===v.rank,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),w(4===g.rank,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),w(v.shape[3]===g.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),null==l&&(l=[1,1]),w(Hr(r,l),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+l+"'"}),null!=c&&w(A(a),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+a+"."});var b,x,N=Fr(v.shape,g.shape,r,l,a,c,!0);null!=u&&(b=Ce(b=Vt(u,"bias","fused conv2d"),m)[0],Dr(N.outShape,b.shape)),null!=f&&(x=Vt(f,"prelu weights","fused depthwiseConv2d"));var S={x:v,filter:g};null!=u&&(S.bias=b),null!=f&&(S.preluActivationWeights=x);var E=[g,v],C=Te.runKernelFunc(function(e,t){var n=e.fusedDepthwiseConv2D({input:v,filter:g,convInfo:N,bias:b,activation:h,preluActivationWeights:x});return t([g,v,n]),n},S,function(e,t){w(qr(l),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+l+"'"});var n=t[0],r=t[1],a=t[2],i=Ru(e,a,h),o={};return null!=u&&(o={bias:function(){return Mu(b,i)}}),Object.assign({x:function(){return Jl(r.shape,i,n,N)},filter:function(){return Zl(r,i,n.shape,N)}},o)},"FusedDepthwiseConv2D",{convInfo:N,activation:h},E,[!0]);return y?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),zu=Object.freeze({matMul:Lu,conv2d:Bu,depthwiseConv2d:Uu}),Vu=Object.freeze({image:Pu,linalg:ku,losses:wu,spectral:eu,fused:zu,signal:du,square:rs,squaredDifference:is,conv1d:Gl,conv2d:Kl,conv3d:Xl,depthwiseConv2d:$l,separableConv2d:ec,conv2dTranspose:tc,conv3dTranspose:nc,op:en,batchNormalization2d:Gs,batchNormalization3d:Ks,batchNormalization4d:Xs,batchNormalization:Ys,batchNorm:Qs,batchNorm2d:$s,batchNorm3d:Js,batchNorm4d:Zs,booleanMaskAsync:function(e,t,n){return i(this,void 0,void 0,function(){var r,a,i,s,l,c,u,d,h,f,p,m,g;return o(this,function(o){switch(o.label){case 0:for(r=Vt(e,"tensor","boolMask"),a=Vt(t,"mask","boolMask","bool"),i=null==n?0:n,s=a.rank,l=r.shape,w(s>0,function(){return"mask cannot be scalar"}),N(l.slice(i,i+s),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,u=i;u<i+s;u++)c*=l[u];return d=l.slice(0,i).concat([c],l.slice(i+s)),h=r.reshape(d),f=a.reshape([-1]),[4,il(f)];case 1:return p=o.sent(),m=p.squeeze([1]),g=zl(h,m,i),e!==r&&r.dispose(),t!==a&&a.dispose(),m.dispose(),h.dispose(),f.dispose(),p.dispose(),[2,g]}})})},complex:tn,real:nn,imag:rn,concat:yn,concat1d:bn,concat2d:xn,concat3d:wn,concat4d:Nn,split:Sn,matMul:rc,dot:ac,outerProduct:ic,reverse:oc,reverse1d:sc,reverse2d:lc,reverse3d:cc,reverse4d:uc,maxPool:fc,avgPool:pc,pool:mc,maxPool3d:gc,avgPool3d:vc,slice:yc,slice1d:bc,slice2d:xc,slice3d:wc,slice4d:Nc,abs:os,acos:ss,acosh:ls,asin:cs,asinh:us,atan:ds,atanh:hs,ceil:fs,clipByValue:ps,cos:ms,cosh:gs,erf:vs,exp:ys,expm1:bs,floor:xs,log:ws,log1p:Ns,logSigmoid:Ss,neg:Es,reciprocal:Cs,round:ks,rsqrt:As,sigmoid:_s,sign:js,isNaN:Is,isInf:Ts,isFinite:Os,sin:Ps,sinh:Ds,softplus:Rs,sqrt:Ms,step:Fs,tan:Ls,tanh:Bs,all:Ec,any:Cc,argMax:kc,argMin:Ac,logSumExp:_c,max:jc,mean:Ic,min:Tc,moments:Oc,sum:Pc,prod:Dc,equal:Al,equalStrict:_l,greater:jl,greaterEqual:Il,greaterEqualStrict:Tl,greaterStrict:Ol,less:Pl,lessEqual:Dl,lessEqualStrict:Rl,lessStrict:Ml,notEqual:Fl,notEqualStrict:Ll,add:ol,addN:sl,addStrict:ll,atan2:cl,div:ul,divNoNan:dl,divStrict:hl,floorDiv:fl,maximum:pl,maximumStrict:ml,minimum:gl,minimumStrict:vl,mod:yl,modStrict:bl,mul:xl,mulStrict:wl,pow:Nl,powStrict:Sl,squaredDifferenceStrict:El,sub:Cl,subStrict:kl,elu:Rc,leakyRelu:Mc,prelu:Fc,relu:Lc,relu6:Bc,selu:Uc,logicalAnd:el,logicalNot:tl,logicalOr:nl,logicalXor:rl,where:al,whereAsync:il,buffer:Mn,print:function(e,t){void 0===t&&(t=!1),console.log(e.toString(t))},batchToSpaceND:Fn,broadcastTo:Ln,cast:Bn,clone:Un,cumsum:zn,depthToSpace:Vn,expandDims:Wn,eye:qn,multinomial:Hn,oneHot:Gn,pad:Kn,pad1d:Xn,pad2d:Yn,pad3d:Qn,pad4d:$n,rand:Jn,randomNormal:Zn,randomGamma:er,randomUniform:tr,reshape:nr,spaceToBatchND:rr,squeeze:ar,stack:ir,tile:or,truncatedNormal:sr,unstack:lr,setdiff1dAsync:function(e,t){return i(this,void 0,void 0,function(){var n,r,a,i,s,l,c,u,d,h;return o(this,function(o){switch(o.label){case 0:return n=Vt(e,"x","setdiff1d"),r=Vt(t,"y","setdiff1d"),w(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),w(1===n.rank,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),w(1===r.rank,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return a=o.sent(),[4,r.data()];case 2:for(i=o.sent(),s=new Set(i),l=0,d=0;d<a.length;d++)s.has(a[d])||l++;for(c=new de([l],n.dtype),u=new de([l],"int32"),d=0,h=0;d<a.length;d++)s.has(a[d])||(c.values[h]=a[d],u.values[h]=d,h++);return[2,[c.toTensor(),u.toTensor()]]}})})},fill:pn,linspace:function(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return Te.runKernelFunc(function(r){return r.linspace(e,t,n)},{})},ones:hn,range:mn,scalar:sn,tensor:an,tensor1d:ln,tensor2d:cn,tensor3d:un,tensor4d:dn,tensor5d:function(e,t,n){if(S(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Ut(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return on(e,t,r,n)},tensor6d:function(e,t,n){if(S(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Ut(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return on(e,t=t||r,r,n)},variable:function(e,t,n,r){return void 0===t&&(t=!0),Te.makeVariable(e,t,n,r)},zeros:fn,onesLike:gn,zerosLike:vn,transpose:zc,softmax:Ar,logSoftmax:_r,localResponseNormalization:Vc,norm:Wc,gather:zl,unsortedSegmentSum:Vl,basicLSTMCell:qc,multiRNNCell:Hc,movingAverage:Gc,stridedSlice:Kc,topk:Xc,scatterND:Yc,fft:Qc,ifft:$c,rfft:Jc,irfft:Zc,sparseToDense:tu,gatherND:nu,diag:ru,dropout:au,hannWindow:su,hammingWindow:lu,frame:cu,stft:uu,inTopKAsync:function(e,t,n){return void 0===n&&(n=1),i(this,void 0,void 0,function(){var r,a,i,s,l,c,u,d,h,f,p,m,g,v;return o(this,function(o){switch(o.label){case 0:return r=Vt(e,"predictions","inTopK"),a=Vt(t,"targets","inTopK"),w(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),w(r.rank-1===a.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+a.rank}),N(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],w(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,r.data()];case 1:return s=o.sent(),[4,a.data()];case 2:for(l=o.sent(),c=[s.length/i,i],d=c[1],h=R("bool",u=c[0]),f=0;f<u;f++){for(p=f*d,m=s.subarray(p,p+d),g=[],v=0;v<m.length;v++)g.push({value:m[v],index:v});for(g.sort(function(e,t){return t.value-e.value}),h[f]=0,v=0;v<n;v++)if(g[v].index===l[f]){h[f]=1;break}}return e!==r&&r.dispose(),t!==a&&a.dispose(),[2,an(h,a.shape,"bool")]}})})}});function Wu(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(e){null!=e&&w("complex64"!==e.dtype,function(){return t+" does not support complex64 tensors."})})}function qu(e,t,n,r){if("linear"===n)return e.linear(t);if("relu"===n)return e.relu(t);if("elu"===n)return e.elu(t);if("relu6"===n)return e.relu6(t);if("prelu"===n)return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var Hu=function(e){function t(){var t=e.call(this)||this;return t.blockSize=48,t.firstUse=!0,t.data=new jr(t,Te),t}return a(t,e),t.prototype.write=function(e,t,n){this.firstUse&&(this.firstUse=!1,l().get("IS_NODE")&&Bt("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:e,dtype:n}),r},t.prototype.move=function(e,t,n,r){this.data.set(e,{values:t,dtype:r})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return i(this,void 0,void 0,function(){return o(this,function(t){return[2,this.readSync(e)]})})},t.prototype.readSync=function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensors;return"complex64"===n?Qr(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map(function(e){return re(e)})}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return Mn(e.shape,e.dtype,n)},t.prototype.makeOutput=function(e,t,n){var r=this.write(e,t,n);return Te.makeTensorFromDataId(r,t,n,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return i(this,void 0,void 0,function(){var t;return o(this,function(n){return t=ee(),e(),[2,{kernelMs:ee()-t}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,t){var n=this.makeOutput(null,e.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:Te.keep(e.clone()),imag:Te.keep(t.clone())},n},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(Wu(e,"slice"),Er(e.shape,t,n)){var r=Cr(t,e.strides),a=C(n);return an(this.readSync(e.dataId).subarray(r,r+a),n,e.dtype)}for(var i=Mn(n,e.dtype),o=this.bufferSync(e),s=0;s<i.size;++s){var l=i.indexToLoc(s).map(function(e,n){return e+t[n]});i.values[s]=o.get.apply(o,l)}return i.toTensor()},t.prototype.stridedSlice=function(e,t,n,r){Wu(e,"stridedSlice");var a=wr(t,n,r);if(a.some(function(e){return 0===e}))return an([],a);for(var i=Mn(a,e.dtype),o=this.bufferSync(e),s=0;s<i.size;s++){for(var l=i.indexToLoc(s),c=new Array(l.length),u=0;u<c.length;u++)c[u]=l[u]*r[u]+t[u];i.set.apply(i,[o.get.apply(o,c)].concat(l))}return i.toTensor()},t.prototype.diag=function(e){for(var t=this.readSync(e.dataId),n=Mn([e.size,e.size],e.dtype),r=n.values,a=0;a<t.length;a++)r[a*e.size+a]=t[a];return n.toTensor()},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),a=0,i=0;i<e.rank;i++)i!==t&&(r[a++]=e.shape[i]);var o=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var l=new Array(n);for(i=0;i<l.length;i++)o[t]=i,l[i]=this.slice(e,o,s).reshape(r);return l},t.prototype.reverse=function(e,t){Wu(e,"reverse");for(var n=Mn(e.shape,e.dtype),r=this.bufferSync(e),a=function(a){var i=n.indexToLoc(a),o=i.slice();t.forEach(function(t){return o[t]=e.shape[t]-1-o[t]}),n.set.apply(n,[r.get.apply(r,o)].concat(i))},i=0;i<n.size;i++)a(i);return n.toTensor()},t.prototype.concat=function(e,t){var n=this;if("complex64"===e[0].dtype){var r=e.map(function(e){return nn(e)}),a=e.map(function(e){return rn(e)});return tn(this.concat(r,t),this.concat(a,t))}var i=e.map(function(e){var n=C(e.shape.slice(t));return e.as2D(-1,n)}),o=Zt(i.map(function(e){return e.shape}),1),s=Mn(o,e[0].dtype).values;if(1===i[0].shape[0]){var l=0;i.forEach(function(e){s.set(n.readSync(e.dataId),l),l+=e.size})}else{var c=0;i.forEach(function(e){for(var t=n.readSync(e.dataId),r=0,a=0;a<e.shape[0];++a)for(var i=a*o[1]+c,l=0;l<e.shape[1];++l)s[i+l]=t[r++];c+=e.shape[1]})}var u=Zt(e.map(function(e){return e.shape}),t);return an(s,u,e[0].dtype)},t.prototype.neg=function(e){return Wu(e,"neg"),this.multiply(sn(-1),e)},t.prototype.add=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),function(e,t,n,r){return{real:e+n,imag:t+r}}):this.broadcastedBinaryOp(e,t,Se(e.dtype,t.dtype),function(e,t){return e+t})},t.prototype.addN=function(e){var t=this;Wu(e,"addN");for(var n=e.map(function(e){return t.readSync(e.dataId)}),r=Mn(e[0].shape,e[0].dtype),a=r.values,i=0;i<e.length;i++)for(var o=n[i],s=0;s<a.length;s++)a[s]+=o[s];return r.toTensor()},t.prototype.softmax=function(e,t){var n=P([t],e.shape),r=this.max(e,n),a=Kt(r.shape,n),i=this.subtract(e,r.reshape(a)),o=this.exp(i),s=this.sum(o,n).reshape(a);return this.realDivide(o,s)},t.prototype.subtract=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),function(e,t,n,r){return{real:e-n,imag:t-r}}):this.broadcastedBinaryOp(e,t,Se(e.dtype,t.dtype),function(e,t){return e-t})},t.prototype.pow=function(e,t){return Wu([e,t],"pow"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.pow(e,t)})},t.prototype.batchMatMul=function(e,t,n,r){Wu([e,t],"matMul");for(var a=n?e.shape[1]:e.shape[2],i=n?e.shape[2]:e.shape[1],o=r?t.shape[1]:t.shape[2],s=e.shape[0],l=this.readSync(e.dataId),c=this.readSync(t.dataId),u=n?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],d=u[0],h=u[1],f=u[2],p=r?[1,t.strides[1],t.strides[0]]:[t.strides[1],1,t.strides[0]],m=p[0],g=p[1],v=p[2],y=i*o,b=Mn([s,i,o],e.dtype),x=b.values,w=this.blockSize,N=0;N<s;N++)for(var S=0;S<i;S+=w)for(var E=0;E<o;E+=w)for(var C=0;C<a;C+=w)for(var k=Math.min(S+w,i),A=Math.min(E+w,o),_=Math.min(C+w,a),j=S;j<k;j++)for(var I=E;I<A;I++){for(var T=0,O=C;O<_;O++)T+=l[N*d+j*h+O*f]*c[O*m+I*g+N*v];x[N*y+(j*o+I)]+=T}return b.toTensor()},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.bias,o=e.activation,s=e.preluActivationWeights,l=this.batchMatMul(t,n,r,a);return i&&(l=this.add(l,i)),o&&(l=qu(this,l,o,s)),l},t.prototype.multiply=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}}):this.broadcastedBinaryOp(e,t,Se(e.dtype,t.dtype),function(e,t){return e*t})},t.prototype.realDivide=function(e,t){return Wu([e,t],"realDivide"),this.broadcastedBinaryOp(e,t,"float32",function(e,t){return e/t})},t.prototype.floorDiv=function(e,t){return Wu([e,t],"floorDiv"),this.broadcastedBinaryOp(e,t,"int32",function(e,t){return Math.floor(e/t)})},t.prototype.sum=function(e,t){Wu(e,"sum"),Xt("sum",t,e.rank);for(var n=Gt(e.shape,t),r=n[0],a=n[1],i=fn(r,Se(e.dtype,"int32")),o=C(a),s=this.readSync(i.dataId),l=this.readSync(e.dataId),c=0;c<s.length;++c){for(var u=c*o,d=0,h=0;h<o;++h)d+=l[u+h];s[c]=d}return i},t.prototype.prod=function(e,t){Wu(e,"sum");for(var n=Gt(e.shape,t),r=n[0],a=n[1],i=fn(r,Se(e.dtype,"int32")),o=C(a),s=this.readSync(i.dataId),l=this.readSync(e.dataId),c=0;c<s.length;++c){for(var u=c*o,d=1,h=0;h<o;++h)d*=l[u+h];s[c]=d}return i},t.prototype.unsortedSegmentSum=function(e,t,n){Wu(e,"unsortedSegmentSum");for(var r=[],a=e.rank-t.rank,i=0;i<a;++i)t=t.expandDims(i+1);for(i=0;i<n;++i){var o=sn(i,"int32"),s=Al(o,t).asType("float32").mul(e).sum(0);r.push(s)}return ir(r)},t.prototype.argMin=function(e,t){Wu(e,"argMin");var n=[t];Xt("argMin",n,e.rank);for(var r=Gt(e.shape,n),a=r[0],i=r[1],o=fn(a,"int32"),s=C(i),l=this.readSync(o.dataId),c=this.readSync(e.dataId),u=0;u<l.length;++u){for(var d=u*s,h=c[d],f=0,p=0;p<s;++p){var m=c[d+p];m<h&&(h=m,f=p)}l[u]=f}return o},t.prototype.argMax=function(e,t){Wu(e,"argMax");var n=[t];Xt("argMax",n,e.rank);for(var r=Gt(e.shape,n),a=r[0],i=r[1],o=fn(a,"int32"),s=C(i),l=this.readSync(o.dataId),c=this.readSync(e.dataId),u=0;u<l.length;++u){for(var d=u*s,h=c[d],f=0,p=0;p<s;++p){var m=c[d+p];m>h&&(h=m,f=p)}l[u]=f}return o},t.prototype.cumsum=function(e,t,n,r){if(Wu(e,"cumsum"),t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+t);for(var a=Se(e.dtype,"int32"),i=fn(e.shape,a),o=this.readSync(i.dataId),s=this.readSync(e.dataId),l=e.shape[e.rank-1],c=r?function(e,t){return e+l-t-1}:function(e,t){return e+t},u=0;u<s.length;u+=l)for(var d=0;d<l;d++){var h=c(u,d);if(0===d)o[h]=n?0:s[h];else{var f=c(u,d-1);o[h]=n?s[f]+o[f]:s[h]+o[f]}}return i},t.prototype.equal=function(e,t){return Wu([e,t],"equal"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e===t?1:0})},t.prototype.notEqual=function(e,t){return Wu([e,t],"notEqual"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e!==t?1:0})},t.prototype.less=function(e,t){return Wu([e,t],"less"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e<t?1:0})},t.prototype.lessEqual=function(e,t){return Wu([e,t],"lessEqual"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e<=t?1:0})},t.prototype.greater=function(e,t){return Wu([e,t],"greater"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e>t?1:0})},t.prototype.greaterEqual=function(e,t){return Wu([e,t],"greaterEqual"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e>=t?1:0})},t.prototype.logicalNot=function(e){Wu(e,"logicalNot");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t[r]?0:1;return this.makeOutput(n,e.shape,"bool")},t.prototype.logicalAnd=function(e,t){return Wu([e,t],"logicalAnd"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e&&t})},t.prototype.logicalOr=function(e,t){return Wu([e,t],"logicalOr"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e||t})},t.prototype.select=function(e,t,n){Wu([e,t,n],"select");for(var r=this.readSync(e.dataId),a=this.readSync(t.dataId),i=this.readSync(n.dataId),o=fn(t.shape,Se(t.dtype,n.dtype)),s=this.readSync(o.dataId),l=0,c=0===e.rank||e.rank>1||1===t.rank?1:C(t.shape.slice(1)),u=0;u<r.length;u++)for(var d=0;d<c;d++)1===r[u]?s[l++]=a[u]:s[l++]=i[u];return o},t.prototype.where=function(e){Wu([e],"where");var t=this.readSync(e.dataId);return da(e.shape,t)},t.prototype.topk=function(e,t,n){return Wu(e,"topk"),ua(this.readSync(e.dataId),e.shape,e.dtype,t)},t.prototype.min=function(e,t){Wu(e,"min"),Xt("min",t,e.rank);for(var n=Gt(e.shape,t),r=n[0],a=n[1],i=fn(r,e.dtype),o=C(a),s=this.readSync(i.dataId),l=this.readSync(e.dataId),c=0;c<s.length;++c){for(var u=c*o,d=l[u],h=0;h<o;++h){var f=l[u+h];f<d&&(d=f)}s[c]=d}return i},t.prototype.minimum=function(e,t){return Wu([e,t],"minimum"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.min(e,t)})},t.prototype.mod=function(e,t){return Wu([e,t],"mod"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})},t.prototype.max=function(e,t){Wu(e,"max"),Xt("max",t,e.rank);for(var n=Gt(e.shape,t),r=n[0],a=n[1],i=fn(r,e.dtype),o=C(a),s=this.readSync(i.dataId),l=this.readSync(e.dataId),c=0;c<s.length;++c){for(var u=c*o,d=l[u],h=0;h<o;++h){var f=l[u+h];f>d&&(d=f)}s[c]=d}return i},t.prototype.maximum=function(e,t){return Wu([e,t],"maximum"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.max(e,t)})},t.prototype.all=function(e,t){Wu(e,"all"),Xt("all",t,e.rank);for(var n=Gt(e.shape,t),r=n[0],a=n[1],i=fn(r,e.dtype),o=C(a),s=this.readSync(i.dataId),l=this.readSync(e.dataId),c=0;c<s.length;++c){for(var u=c*o,d=l[u],h=0;h<o;++h){var f=l[u+h];d=d&&f}s[c]=d}return i},t.prototype.any=function(e,t){Wu(e,"any"),Xt("any",t,e.rank);for(var n=Gt(e.shape,t),r=n[0],a=n[1],i=fn(r,e.dtype),o=C(a),s=this.readSync(i.dataId),l=this.readSync(e.dataId),c=0;c<s.length;++c){for(var u=c*o,d=l[u],h=0;h<o;++h){var f=l[u+h];d=d||f}s[c]=d}return i},t.prototype.squaredDifference=function(e,t){return Wu([e,t],"squaredDifference"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){var n=e-t;return n*n})},t.prototype.ceil=function(e){Wu(e,"ceil");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.ceil(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.floor=function(e){Wu(e,"floor");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.floor(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.sign=function(e){Wu(e,"x");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)t[r]<0?n[r]=-1:t[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,e.shape,"float32")},t.prototype.isNaN=function(e){Wu(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isNaN(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isInf=function(e){Wu(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Math.abs(t[r])===1/0&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isFinite=function(e){Wu(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isFinite(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.round=function(e){Wu(e,"round");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=Math.floor(t[r]);t[r]-a<.5?n[r]=Math.floor(t[r]):t[r]-a>.5?n[r]=Math.ceil(t[r]):n[r]=a%2==0?a:a+1}return this.makeOutput(n,e.shape,"float32")},t.prototype.exp=function(e){Wu(e,"exp");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.exp(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.expm1=function(e){Wu(e,"expm1");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.expm1(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.log=function(e){Wu(e,"log");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.log(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.log1p=function(e){Wu(e,"log1p");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.log1p(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.sqrt=function(e){Wu(e,"sqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.sqrt(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.rsqrt=function(e){Wu(e,"rsqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=1/Math.sqrt(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.reciprocal=function(e){Wu(e,"reciprocal");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/t[r];return this.makeOutput(n,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){Wu(e,"relu");for(var t=fn(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),a=0;a<r.length;++a)n[a]=Math.max(0,r[a]);return t},t.prototype.relu6=function(e){Wu(e,"relu");for(var t=fn(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),a=0;a<r.length;++a)n[a]=Math.min(Math.max(0,r[a]),6);return t},t.prototype.prelu=function(e,t){return Wu([e,t],"prelu"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return e<0?t*e:e})},t.prototype.elu=function(e){Wu(e,"elu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var a=n[r];t[r]=a>=0?a:Math.exp(a)-1}return this.makeOutput(t,e.shape,"float32")},t.prototype.eluDer=function(e,t){Wu([e,t],"eluDer");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),a=this.readSync(e.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=o>=1?a[i]:a[i]*(o+1)}return this.makeOutput(n,t.shape,"float32")},t.prototype.selu=function(e){Wu(e,"selu");for(var t=ko,n=Ao,r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var o=a[i];r[i]=o>=0?n*o:t*(Math.exp(o)-1)}return this.makeOutput(r,e.shape,"float32")},t.prototype.clip=function(e,t,n){Wu(e,"clip");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var o=a[i];r[i]=o>n?n:o<t?t:o}return this.makeOutput(r,e.shape,"float32")},t.prototype.abs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<e.size;++r){var a=n[2*r],i=n[2*r+1];t[r]=Math.hypot(a,i)}return this.makeOutput(t,e.shape,"float32")},t.prototype.int=function(e){Wu(e,"int");for(var t=new Int32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=n[r];return this.makeOutput(t,e.shape,"int32")},t.prototype.sigmoid=function(e){Wu(e,"sigmoid");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(t,e.shape,"float32")},t.prototype.softplus=function(e){Wu(e,"softplus");for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),r=this.readSync(e.dataId),a=0;a<r.length;++a){var i,o=r[a]>-t,s=r[a]<t,l=Math.exp(r[a]);i=s?l:o?r[a]:Math.log(1+l),n[a]=i}return this.makeOutput(n,e.shape,"float32")},t.prototype.sin=function(e){Wu(e,"sin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cos=function(e){Wu(e,"cos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tan=function(e){Wu(e,"tan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.tan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asin=function(e){Wu(e,"asin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acos=function(e){Wu(e,"acos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan=function(e){Wu(e,"atan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan2=function(e,t){return Wu([e,t],"atan2"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.atan2(e,t)})},t.prototype.sinh=function(e){Wu(e,"sinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cosh=function(e){Wu(e,"cosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tanh=function(e){Wu(e,"tanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=_(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asinh=function(e){Wu(e,"asinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acosh=function(e){Wu(e,"acosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atanh=function(e){Wu(e,"atanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atanh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.erf=function(e){Wu(e,"erf");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var a=Math.sign(n[r]),i=Math.abs(n[r]),o=1/(1+.3275911*i);t[r]=a*(1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-i*i))}return this.makeOutput(t,e.shape,"float32")},t.prototype.step=function(e,t){void 0===t&&(t=0),Wu(e,"step");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),a=0;a<r.length;++a){var i=r[a];isNaN(i)?n[a]=NaN:n[a]=i>0?1:t}return this.makeOutput(n,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights,s=this.conv2d(t,n,r);return a&&(s=this.add(s,a)),i&&(s=qu(this,s,i,o)),s},t.prototype.conv2d=function(e,t,n){Wu([e,t],"conv2d");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,l=n.padInfo.top,c="channelsLast"===n.dataFormat,u=Mn(n.outShape,e.dtype),d=e.strides[0],h=c?e.strides[1]:e.strides[2],f=c?e.strides[2]:1,p=c?1:e.strides[1],m=u.strides[0],g=c?u.strides[1]:u.strides[2],v=c?u.strides[2]:1,y=c?1:u.strides[1],b=this.readSync(e.dataId),x=this.readSync(t.dataId),w=u.values,N=0;N<n.batchSize;++N)for(var S=N*d,E=N*m,C=0;C<n.outHeight;++C)for(var k=E+C*g,A=C*n.strideHeight-l,_=0;_<r;_++){var j=A+_*i;if(!(j<0||j>=n.inHeight))for(var I=_*t.strides[0],T=S+j*h,O=0;O<n.outWidth;++O)for(var P=k+O*v,D=O*n.strideWidth-s,R=0;R<a;R++){var M=D+R*o;if(!(M<0||M>=n.inWidth))for(var F=T+M*f,L=I+R*t.strides[1],B=0;B<n.inChannels;++B){for(var U=b[F+B*p],z=0;z<n.outChannels;++z)w[P+z*y]+=U*x[L+z];L+=n.outChannels}}}return u.toTensor()},t.prototype.conv3d=function(e,t,n){for(var r=n.filterDepth,a=n.filterHeight,i=n.filterWidth,o=n.dilationDepth,s=n.dilationHeight,l=n.dilationWidth,c=n.padInfo.front,u=n.padInfo.left,d=n.padInfo.top,h=Mn(n.outShape,e.dtype),f=this.readSync(e.dataId),p=this.readSync(t.dataId),m=h.values,g=0;g<n.batchSize;++g)for(var v=g*e.strides[0],y=g*h.strides[0],b=0;b<n.outDepth;++b)for(var x=y+b*h.strides[1],w=b*n.strideDepth-c,N=0;N<r;N++){var S=w+N*o;if(!(S<0||S>=n.inDepth))for(var E=N*t.strides[0],C=v+S*e.strides[1],k=0;k<n.outHeight;++k)for(var A=x+k*h.strides[2],_=k*n.strideHeight-d,j=0;j<a;j++){var I=_+j*s;if(!(I<0||I>=n.inHeight))for(var T=E+j*t.strides[1],O=C+I*e.strides[2],P=0;P<n.outWidth;++P)for(var D=A+P*n.outChannels,R=P*n.strideWidth-u,M=0;M<i;M++){var F=R+M*l;if(!(F<0||F>=n.inWidth))for(var L=T+M*t.strides[2],B=O+F*n.inChannels,U=L,z=0;z<n.inChannels;++z){for(var V=f[B+z],W=0;W<n.outChannels;++W)m[D+W]+=V*p[U+W];U+=n.outChannels}}}}return h.toTensor()},t.prototype.conv2dDerInput=function(e,t,n){Wu([e,t],"conv2dDerInput");for(var r=Mn(n.inShape,"float32"),a=r.values,i=this.readSync(e.dataId),o=this.readSync(t.dataId),s=t.strides,l=s[0],c=s[1],u=s[2],d=n.batchSize,h=n.filterHeight,f=n.filterWidth,p=n.inChannels,m=n.inHeight,g=n.inWidth,v=n.outChannels,y=n.outHeight,b=n.outWidth,x=n.strideHeight,w=n.strideWidth,N=n.dataFormat,S=h-1-n.padInfo.top,E=f-1-n.padInfo.left,C="channelsLast"===N,k=r.strides[0],A=C?r.strides[1]:r.strides[2],_=C?r.strides[2]:1,j=C?1:r.strides[1],I=e.strides[0],T=C?e.strides[1]:e.strides[2],O=C?e.strides[2]:1,P=C?1:e.strides[1],D=0;D<d;++D)for(var R=0;R<p;++R)for(var M=0;M<m;++M)for(var F=M-S,L=Math.max(0,Math.ceil(F/x)),B=Math.min(y,(h+F)/x),U=0;U<g;++U){for(var z=U-E,V=Math.max(0,Math.ceil(z/w)),W=Math.min(b,(f+z)/w),q=0,H=L;H<B;++H)for(var G=H*x-F,K=V;K<W;++K)for(var X=I*D+T*H+O*K,Y=l*(h-1-G)+c*(f-1-(K*w-z))+u*R,Q=0;Q<v;++Q)q+=i[X+P*Q]*o[Y+Q];a[k*D+A*M+_*U+j*R]=q}return r.toTensor()},t.prototype.conv3dDerInput=function(e,t,n){for(var r=Mn(n.inShape,"float32"),a=r.values,i=r.strides,o=i[0],s=i[1],l=i[2],c=i[3],u=this.readSync(e.dataId),d=e.strides,h=d[0],f=d[1],p=d[2],m=d[3],g=this.readSync(t.dataId),v=t.strides,y=v[0],b=v[1],x=v[2],w=v[3],N=n.batchSize,S=n.filterDepth,E=n.filterHeight,C=n.filterWidth,k=n.inChannels,A=n.inDepth,_=n.inHeight,j=n.inWidth,I=n.outChannels,T=n.outDepth,O=n.outHeight,P=n.outWidth,D=n.strideDepth,R=n.strideHeight,M=n.strideWidth,F=S-1-n.padInfo.front,L=E-1-n.padInfo.top,B=C-1-n.padInfo.left,U=0;U<N;++U)for(var z=0;z<k;++z)for(var V=0;V<A;++V)for(var W=V-F,q=Math.max(0,Math.ceil(W/D)),H=Math.min(T,(S+W)/D),G=0;G<_;++G)for(var K=G-L,X=Math.max(0,Math.ceil(K/R)),Y=Math.min(O,(E+K)/R),Q=0;Q<j;++Q){for(var $=Q-B,J=Math.max(0,Math.ceil($/M)),Z=Math.min(P,(C+$)/M),ee=0,te=q;te<H;++te)for(var ne=te*D-W,re=X;re<Y;++re)for(var ae=re*R-K,ie=J;ie<Z;++ie)for(var oe=h*U+f*te+p*re+m*ie,se=y*(S-1-ne)+b*(E-1-ae)+x*(C-1-(ie*M-$))+w*z,le=0;le<I;++le)ee+=u[oe+le]*g[se+le];a[o*U+s*V+l*G+c*Q+z]=ee}return r.toTensor()},t.prototype.conv2dDerFilter=function(e,t,n){Wu([e,t],"conv2dDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s="channelsLast"===n.dataFormat,l=Mn(n.filterShape,"float32"),c=n.padInfo.left,u=n.padInfo.top,d=this.bufferSync(e),h=this.bufferSync(t),f=0;f<i;++f)for(var p=Math.max(0,Math.ceil((u-f)/r)),m=Math.min(n.outHeight,(n.inHeight+u-f)/r),g=0;g<o;++g)for(var v=Math.max(0,Math.ceil((c-g)/a)),y=Math.min(n.outWidth,(n.inWidth+c-g)/a),b=0;b<n.inChannels;++b)for(var x=0;x<n.outChannels;++x){for(var w=0,N=0;N<n.batchSize;++N)for(var S=p;S<m;++S)for(var E=f+S*r-u,C=v;C<y;++C){var k=g+C*a-c;w+=s?d.get(N,E,k,b)*h.get(N,S,C,x):d.get(N,b,E,k)*h.get(N,x,S,C)}l.set(w,f,g,b,x)}return l.toTensor()},t.prototype.conv3dDerFilter=function(e,t,n){for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,l=n.filterWidth,c=Mn(n.filterShape,"float32"),u=c.values,d=c.strides,h=d[0],f=d[1],p=d[2],m=d[3],g=this.readSync(t.dataId),v=t.strides,y=v[0],b=v[1],x=v[2],w=v[3],N=this.readSync(e.dataId),S=e.strides,E=S[0],C=S[1],k=S[2],A=S[3],_=n.padInfo.front,j=n.padInfo.left,I=n.padInfo.top,T=0;T<o;++T)for(var O=Math.max(0,Math.ceil((_-T)/r)),P=Math.min(n.outDepth,(n.inDepth+_-T)/r),D=T*h,R=0;R<s;++R)for(var M=Math.max(0,Math.ceil((I-R)/a)),F=Math.min(n.outHeight,(n.inHeight+I-R)/a),L=R*f+D,B=0;B<l;++B)for(var U=Math.max(0,Math.ceil((j-B)/i)),z=Math.min(n.outWidth,(n.inWidth+j-B)/i),V=B*p+L,W=0;W<n.inChannels;++W)for(var q=W*m+V,H=0;H<n.outChannels;++H){for(var G=0,K=0;K<n.batchSize;++K)for(var X=K*E,Y=K*y,Q=O;Q<P;++Q)for(var $=(T+Q*r-_)*C+X,J=Q*b+Y,Z=M;Z<F;++Z)for(var ee=(R+Z*a-I)*k+$,te=Z*x+J,ne=U;ne<z;++ne){var re=ne*w+te;G+=N[(B+ne*i-j)*A+ee+W]*g[re+H]}u[q+H]=G}return c.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights,s=this.depthwiseConv2D(t,n,r);return a&&(s=this.add(s,a)),i&&(s=qu(this,s,i,o)),s},t.prototype.depthwiseConv2D=function(e,t,n){Wu([e,t],"depthwiseConv2D");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,l=n.padInfo.top,c=n.outChannels/n.inChannels,u=Mn(n.outShape,e.dtype),d=this.readSync(e.dataId),h=this.readSync(t.dataId),f=u.values,p=0;p<n.batchSize;++p)for(var m=p*e.strides[0],g=p*u.strides[0],v=0;v<n.outHeight;++v)for(var y=g+v*u.strides[1],b=v*n.strideHeight-s,x=0;x<r;++x){var w=b+x*i;if(!(w<0||w>=n.inHeight))for(var N=x*t.strides[0],S=m+w*e.strides[1],E=0;E<n.outWidth;++E)for(var C=y+E*u.strides[2],k=E*n.strideWidth-l,A=0;A<a;++A){var _=k+A*o;if(!(_<0||_>=n.inWidth))for(var j=N+A*t.strides[1],I=S+_*n.inChannels,T=C,O=j,P=0;P<n.inChannels;++P){for(var D=d[I+P],R=0;R<c;++R)f[T+R]+=D*h[O+R];T+=c,O+=c}}}return u.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,t,n){Wu([e,t],"depthwiseConv2DDerInput");for(var r=Mn(n.inShape,"float32"),a=r.values,i=r.strides,o=i[0],s=i[1],l=i[2],c=this.readSync(e.dataId),u=e.strides,d=u[0],h=u[1],f=u[2],p=this.readSync(t.dataId),m=t.strides,g=m[0],v=m[1],y=m[2],b=n.batchSize,x=n.filterHeight,w=n.filterWidth,N=n.inChannels,S=n.inHeight,E=n.inWidth,C=n.outChannels,k=n.outHeight,A=n.outWidth,_=n.strideHeight,j=n.strideWidth,I=x-1-n.padInfo.top,T=w-1-n.padInfo.left,O=C/N,P=0;P<b;++P)for(var D=0;D<N;++D)for(var R=0;R<S;++R)for(var M=R-I,F=Math.max(0,Math.ceil(M/_)),L=Math.min(k,(x+M)/_),B=0;B<E;++B){for(var U=B-T,z=Math.max(0,Math.ceil(U/j)),V=Math.min(A,(w+U)/j),W=0,q=F;q<L;++q)for(var H=q*_-M,G=z;G<V;++G)for(var K=d*P+h*q+f*G,X=g*(x-1-H)+v*(w-1-(G*j-U))+y*D,Y=0;Y<O;++Y)W+=c[K+(D*O+Y)]*p[X+Y];a[o*P+s*R+l*B+D]=W}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){Wu([e,t],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=Mn(n.filterShape,"float32"),l=n.padInfo.left,c=n.padInfo.top,u=n.outChannels/n.inChannels,d=this.bufferSync(e),h=this.bufferSync(t),f=0;f<i;++f)for(var p=Math.max(0,Math.ceil((c-f)/r)),m=Math.min(n.outHeight,(n.inHeight+c-f)/r),g=0;g<o;++g)for(var v=Math.max(0,Math.ceil((l-g)/a)),y=Math.min(n.outWidth,(n.inWidth+l-g)/a),b=0;b<n.outChannels;++b){for(var x=Math.trunc(b/u),w=b%u,N=0,S=0;S<n.batchSize;++S)for(var E=p;E<m;++E)for(var C=f+E*r-c,k=v;k<y;++k){var A=g+k*a-l;N+=d.get(S,C,A,x)*h.get(S,E,k,b)}s.set(N,f,g,x,w)}return s.toTensor()},t.prototype.tile=function(e,t){return Wu(e,"tile"),ca(this.bufferSync(e),t)},t.prototype.pad=function(e,t,n){Wu(e,"pad");var r=t.map(function(t,n){return t[0]+e.shape[n]+t[1]}),a=t.map(function(e){return e[0]}),i=this.bufferSync(e),o=Mn(r,e.dtype);0!==n&&o.values.fill(n);for(var s=0;s<e.size;s++){var l=i.indexToLoc(s),c=l.map(function(e,t){return e+a[t]});o.set.apply(o,[i.get.apply(i,l)].concat(c))}return o.toTensor()},t.prototype.transpose=function(e,t){Wu(e,"transpose");for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[t[r]];var a=this.readSync(e.dataId),i=Mn(n,e.dtype),o=this.bufferSync(e);for(r=0;r<e.size;++r){for(var s=o.indexToLoc(r),l=new Array(s.length),c=0;c<l.length;c++)l[c]=s[t[c]];var u=i.locToIndex(l);i.values[u]=a[r]}return i.toTensor()},t.prototype.gather=function(e,t,n){Wu([e,t],"gather");var r=e.shape.slice(),a=this.readSync(t.dataId);r[n]=a.length;for(var i=Mn(r,e.dtype),o=this.bufferSync(e),s=0;s<i.size;++s){var l=i.indexToLoc(s),c=l.slice();c[n]=a[l[n]];var u=o.locToIndex(c);i.values[s]=o.values[u]}return i.toTensor()},t.prototype.batchToSpaceND=function(e,t,n){Wu([e],"batchToSpaceND");var r=t.reduce(function(e,t){return e*t}),a=cr(e.shape,t,r),i=ur(a.length,t.length),o=dr(e.shape,t,r),s=hr(n,t.length),l=fr(o,n,t.length);return e.reshape(a).transpose(i).reshape(o).slice(s,l)},t.prototype.spaceToBatchND=function(e,t,n){Wu([e],"spaceToBatchND");var r=t.reduce(function(e,t){return e*t}),a=[[0,0]];a.push.apply(a,n);for(var i=1+t.length;i<e.shape.length;++i)a.push([0,0]);var o=e.pad(a),s=cr(o.shape,t,r,!1),l=ur(s.length,t.length,!1),c=dr(o.shape,t,r,!1);return o.reshape(s).transpose(l).reshape(c)},t.prototype.pool=function(e,t,n){Wu(e,"pool");for(var r=t.strideHeight,a=t.strideWidth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=t.padInfo.top,u=t.padInfo.left,d="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,h=this.readSync(e.dataId),f=Mn(t.outShape,e.dtype),p=f.values,m=t.outShape[1]*t.outShape[2]*t.outShape[3],g=t.outShape[2]*t.outShape[3],v=t.outShape[3],y=0;y<t.batchSize;++y)for(var b=y*m,x=y*e.strides[0],w=0;w<t.inChannels;++w)for(var N=0;N<t.outHeight;++N)for(var S=N*r-c,E=Math.max(0,S),C=Math.min(t.inHeight,s+S),k=b+N*g,A=0;A<t.outWidth;++A){for(var _=A*a-u,j=Math.max(0,_),I=Math.min(t.inWidth,l+_),T=d,O=0,P=0,D=E;D<C;D+=i){for(var R=x+D*e.strides[1],M=j;M<I;M+=o){var F=h[R+M*e.strides[2]+w];"max"===n&&F>T?T=F:"avg"===n&&(O+=F,P++)}if(isNaN(T))break}p[k+A*v+w]="avg"===n?O/P:T}return f.toTensor()},t.prototype.maxPool=function(e,t){return this.pool(e,t,"max")},t.prototype.maxPoolPositions=function(e,t){for(var n=Mn(t.outShape,"int32"),r=t.strideHeight,a=t.strideWidth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=t.padInfo.top,u=t.padInfo.left,d=this.bufferSync(e),h=0;h<t.batchSize;++h)for(var f=0;f<t.inChannels;++f)for(var p=0;p<t.outHeight;++p){for(var m=p*r-c,g=m;g<0;)g+=i;for(var v=Math.min(t.inHeight,s+m),y=0;y<t.outWidth;++y){for(var b=y*a-u,x=b;x<0;)x+=o;for(var w=Math.min(t.inWidth,l+b),N=Number.NEGATIVE_INFINITY,S=-1,E=g;E<v;E+=i)for(var C=E-m,k=x;k<w;k+=o){var A=k-b,_=d.get(h,E,k,f);_>N&&(N=_,S=C*l+A)}n.set(S,h,p,y,f)}}return n.toTensor()},t.prototype.maxPoolBackprop=function(e,t,n,r){Wu([t,n],"maxPoolBackprop");for(var a=this.maxPoolPositions(t,r),i=r.strideHeight,o=r.strideWidth,s=r.dilationHeight,l=r.dilationWidth,c=r.effectiveFilterHeight,u=r.effectiveFilterWidth,d=u-1-r.padInfo.left,h=c-1-r.padInfo.top,f=Mn(t.shape,"float32"),p=this.bufferSync(a),m=this.bufferSync(e),g=0;g<r.batchSize;++g)for(var v=0;v<r.inChannels;++v)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var x=y-h,w=b-d,N=0,S=0;S<c;S+=s){var E=(x+S)/i;if(!(E<0||E>=r.outHeight||Math.floor(E)!==E))for(var C=0;C<u;C+=l){var k=(w+C)/o;if(!(k<0||k>=r.outWidth||Math.floor(k)!==k)){var A=c*u-1-p.get(g,E,k,v)===S*u+C?1:0;0!==A&&(N+=m.get(g,E,k,v)*A)}}}f.set(N,g,y,b,v)}return f.toTensor()},t.prototype.avgPoolBackprop=function(e,t,n){Wu([e,t],"avgPoolBackprop");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=n.dilationHeight,l=n.dilationWidth,c=n.effectiveFilterHeight,u=n.effectiveFilterWidth,d=u-1-n.padInfo.left,h=c-1-n.padInfo.top,f=Mn(t.shape,"float32"),p=1/(i*o),m=this.bufferSync(e),g=0;g<n.batchSize;++g)for(var v=0;v<n.inChannels;++v)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var x=y-h,w=b-d,N=0,S=0;S<c;S+=s){var E=(x+S)/r;if(!(E<0||E>=n.outHeight||Math.floor(E)!==E))for(var C=0;C<u;C+=l){var k=(w+C)/a;k<0||k>=n.outWidth||Math.floor(k)!==k||(N+=m.get(g,E,k,v))}}f.set(N*p,g,y,b,v)}return f.toTensor()},t.prototype.pool3d=function(e,t,n){Wu(e,"pool3d");for(var r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.front,f=t.padInfo.top,p=t.padInfo.left,m="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(e.dataId),v=Mn(t.outShape,e.dtype),y=v.values,b=t.outShape[1]*t.outShape[2]*t.outShape[3]*t.outShape[4],x=t.outShape[2]*t.outShape[3]*t.outShape[4],w=t.outShape[3]*t.outShape[4],N=t.outShape[4],S=0;S<t.batchSize;++S)for(var E=S*b,C=S*e.strides[0],k=0;k<t.inChannels;++k)for(var A=0;A<t.outDepth;++A){for(var _=A*r-h,j=_;j<0;)j+=o;for(var I=Math.min(t.inDepth,c+_),T=E+A*x,O=0;O<t.outHeight;++O){for(var P=O*a-f,D=P;D<0;)D+=s;for(var R=Math.min(t.inHeight,u+P),M=T+O*w,F=0;F<t.outWidth;++F){for(var L=F*i-p,B=L;B<0;)B+=l;for(var U=Math.min(t.inWidth,d+L),z=M+F*N,V=m,W=0,q=0,H=j;H<I;H+=o){for(var G=C+H*e.strides[1],K=D;K<R;K+=s){for(var X=G+K*e.strides[2],Y=B;Y<U;Y+=l){var Q=g[X+Y*e.strides[3]+k];if("max"===n&&Q>V?V=Q:"avg"===n&&(W+=Q,q++),isNaN(V))break}if(isNaN(V))break}if(isNaN(V))break}y[z+k]="avg"===n?W/q:V}}}return v.toTensor()},t.prototype.avgPool3d=function(e,t){return Wu(e,"avgPool3d"),this.pool3d(e,t,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,t,n){Wu([e,t],"avgPool3dBackprop");for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,l=n.filterWidth,c=n.dilationDepth,u=n.dilationHeight,d=n.dilationWidth,h=n.effectiveFilterDepth,f=n.effectiveFilterHeight,p=n.effectiveFilterWidth,m=h-1-n.padInfo.front,g=p-1-n.padInfo.left,v=f-1-n.padInfo.top,y=Mn(t.shape,"float32"),b=1/(o*s*l),x=this.bufferSync(e),w=0;w<n.batchSize;++w)for(var N=0;N<n.inChannels;++N)for(var S=0;S<n.inDepth;++S)for(var E=0;E<n.inHeight;++E)for(var C=0;C<n.inWidth;++C){for(var k=S-m,A=E-v,_=C-g,j=0,I=0;I<h;I+=c){var T=(k+I)/r;if(!(T<0||T>=n.outDepth||Math.floor(T)!==T))for(var O=0;O<f;O+=u){var P=(A+O)/a;if(!(P<0||P>=n.outHeight||Math.floor(P)!==P))for(var D=0;D<p;D+=d){var R=(_+D)/i;R<0||R>=n.outWidth||Math.floor(R)!==R||(j+=x.get(w,T,P,R,N))}}}y.set(j*b,w,S,E,C,N)}return y.toTensor()},t.prototype.maxPool3d=function(e,t){return Wu(e,"maxPool3d"),this.pool3d(e,t,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,t){for(var n=Mn(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.front,f=t.padInfo.top,p=t.padInfo.left,m=this.bufferSync(e),g=0;g<t.batchSize;++g)for(var v=0;v<t.inChannels;++v)for(var y=0;y<t.outDepth;++y){for(var b=y*r-h,x=b;x<0;)x+=o;for(var w=Math.min(t.inDepth,c+b),N=0;N<t.outHeight;++N){for(var S=N*a-f,E=S;E<0;)E+=s;for(var C=Math.min(t.inHeight,u+S),k=0;k<t.outWidth;++k){for(var A=k*i-p,_=A;_<0;)_+=l;for(var j=Math.min(t.inWidth,d+A),I=Number.NEGATIVE_INFINITY,T=-1,O=x;O<w;O+=o)for(var P=O-b,D=E;D<C;D+=s)for(var R=D-S,M=_;M<j;M+=l){var F=M-A,L=m.get(g,O,D,M,v);L>=I&&(I=L,T=P*u*d+R*u+F)}n.set(T,g,y,N,k,v)}}}return n.toTensor()},t.prototype.maxPool3dBackprop=function(e,t,n,r){Wu([t,n],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(t,r),i=r.strideDepth,o=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,c=r.dilationHeight,u=r.dilationWidth,d=r.effectiveFilterDepth,h=r.effectiveFilterHeight,f=r.effectiveFilterWidth,p=d-1-r.padInfo.front,m=f-1-r.padInfo.left,g=h-1-r.padInfo.top,v=Mn(t.shape,"float32"),y=this.bufferSync(a),b=this.bufferSync(e),x=0;x<r.batchSize;++x)for(var w=0;w<r.inChannels;++w)for(var N=0;N<r.inDepth;++N)for(var S=0;S<r.inHeight;++S)for(var E=0;E<r.inWidth;++E){for(var C=N-p,k=S-g,A=E-m,_=0,j=0;j<d;j+=l){var I=(C+j)/i;if(!(I<0||I>=r.outDepth||Math.floor(I)!==I))for(var T=0;T<h;T+=c){var O=(k+T)/o;if(!(O<0||O>=r.outHeight||Math.floor(O)!==O))for(var P=0;P<f;P+=u){var D=(A+P)/s;if(!(D<0||D>=r.outWidth||Math.floor(D)!==D)){var R=d*h*f-1-y.get(x,I,O,D,w)===j*h*f+T*f+P?1:0;0!==R&&(_+=b.get(x,I,O,D,w)*R)}}}}v.set(_,x,N,S,E,w)}return v.toTensor()},t.prototype.cast=function(e,t){return Kr(e,t,this)},t.prototype.reshape=function(e,t){return Xr(e,t)},t.prototype.avgPool=function(e,t){return Wu(e,"avgPool"),this.pool(e,t,"avg").toFloat()},t.prototype.resizeBilinear=function(e,t,n,r){Wu(e,"resizeBilinear");for(var a=e.shape,i=a[0],o=a[1],s=a[2],l=a[3],c=this.readSync(e.dataId),u=new Float32Array(C([i,t,n,l])),d=[r&&t>1?o-1:o,r&&n>1?s-1:s],h=[r&&t>1?t-1:t,r&&n>1?n-1:n],f=0,p=d[0]/h[0],m=d[1]/h[1],g=0;g<i;g++)for(var v=0;v<t;v++)for(var y=p*v,b=Math.floor(y),x=y-b,w=Math.min(o-1,Math.ceil(y)),N=g*e.strides[0]+b*e.strides[1],S=g*e.strides[0]+w*e.strides[1],E=0;E<n;E++)for(var k=m*E,A=Math.floor(k),_=k-A,j=Math.min(s-1,Math.ceil(k)),I=N+A*e.strides[2],T=S+A*e.strides[2],O=N+j*e.strides[2],P=S+j*e.strides[2],D=0;D<l;D++){var R=c[I+D],M=c[T+D],F=R+(c[O+D]-R)*_,L=F+(M+(c[P+D]-M)*_-F)*x;u[f++]=L}return an(u,[i,t,n,l])},t.prototype.resizeBilinearBackprop=function(e,t,n){Wu([e,t],"resizeBilinearBackprop");for(var r=t.shape,a=r[0],i=r[1],o=r[2],s=r[3],l=e.shape,c=l[1],u=l[2],d=new Float32Array(a*i*o*s),h=[n&&c>1?i-1:i,n&&u>1?o-1:o],f=[n&&c>1?c-1:c,n&&u>1?u-1:u],p=h[0]/f[0],m=h[1]/f[1],g=this.readSync(e.dataId),v=0,y=0;y<a;y++)for(var b=y*t.strides[0],x=0;x<c;x++)for(var w=x*p,N=Math.floor(w),S=Math.min(Math.ceil(w),i-1),E=b+N*t.strides[1],C=b+S*t.strides[1],k=w-N,A=1-k,_=0;_<u;_++)for(var j=_*m,I=Math.floor(j),T=Math.min(Math.ceil(j),o-1),O=j-I,P=1-O,D=E+I*t.strides[2],R=E+T*t.strides[2],M=C+I*t.strides[2],F=C+T*t.strides[2],L=A*P,B=A*O,U=k*P,z=k*O,V=0;V<s;V++){var W=g[v++];d[D+V]+=W*L,d[R+V]+=W*B,d[M+V]+=W*U,d[F+V]+=W*z}return dn(d,[a,o,i,s],t.dtype)},t.prototype.resizeNearestNeighbor=function(e,t,n,r){Wu(e,"resizeNearestNeighbor");for(var a=e.shape,i=a[0],o=a[1],s=a[2],l=a[3],c=this.readSync(e.dataId),u=new Float32Array(i*t*n*l),d=[r&&t>1?o-1:o,r&&n>1?s-1:s],h=[r&&t>1?t-1:t,r&&n>1?n-1:n],f=d[0]/h[0],p=d[1]/h[1],m=0,g=0;g<i;g++)for(var v=g*e.strides[0],y=0;y<t;y++)for(var b=f*y,x=v+Math.min(o-1,r?Math.round(b):Math.floor(b))*e.strides[1],w=0;w<n;w++)for(var N=p*w,S=x+Math.min(s-1,r?Math.round(N):Math.floor(N))*e.strides[2],E=0;E<l;E++){var C=c[S+E];u[m++]=C}return an(u,[i,t,n,l],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){Wu([e,t],"resizeNearestNeighborBackprop");for(var r=t.shape,a=r[0],i=r[1],o=r[2],s=r[3],l=e.shape,c=l[1],u=l[2],d=new Float32Array(a*i*o*s),h=this.readSync(e.dataId),f=[n&&c>1?i-1:i,n&&u>1?o-1:o],p=[n&&c>1?c-1:c,n&&u>1?u-1:u],m=f[0]/p[0],g=f[1]/p[1],v=1/m,y=1/g,b=2*Math.ceil(v)+2,x=2*Math.ceil(y)+2,w=0;w<a;w++)for(var N=w*t.strides[0],S=0;S<i;S++)for(var E=N+S*t.strides[1],C=Math.floor(S*v),k=Math.floor(C-b/2),A=0;A<o;A++)for(var _=E+A*t.strides[2],j=Math.floor(A*y),I=Math.floor(j-x/2),T=0;T<s;T++){for(var O=0,P=0;P<b;P++){var D=P+k;if(!(D<0||D>=c)){var R=N+D*e.strides[1],M=D*m;if(S===Math.min(i-1,n?Math.round(M):Math.floor(M)))for(var F=0;F<x;F++){var L=F+I;if(!(L<0||L>=u)){var B=R+L*e.strides[2],U=L*g;A===Math.min(o-1,n?Math.round(U):Math.floor(U))&&(O+=h[B+T])}}}}d[_+T]=O}return dn(d,t.shape,t.dtype)},t.prototype.batchNormalization=function(e,t,n,r,a,i){Wu([e,t,n,a,i],"batchNorm");for(var o=this.readSync(e.dataId),s=this.readSync(t.dataId),l=this.readSync(n.dataId),c=a?this.readSync(a.dataId):new Float32Array([1]),u=i?this.readSync(i.dataId):new Float32Array([0]),d=new Float32Array(o.length),h=u.length,f=c.length,p=l.length,m=s.length,g=0,v=0,y=0,b=0,x=0;x<o.length;++x)d[x]=u[g++]+(o[x]-s[v++])*c[y++]/Math.sqrt(l[b++]+r),g>=h&&(g=0),v>=m&&(v=0),y>=f&&(y=0),b>=p&&(b=0);return dn(d,e.shape)},t.prototype.localResponseNormalization4D=function(e,t,n,r,a){Wu(e,"localResponseNormalization4D");var i=e.shape[3],o=i-1,s=this.readSync(e.dataId),l=e.size,c=new Float32Array(l);function u(e){for(var n=e%i,r=e-n+Math.max(0,n-t),a=e-n+Math.min(n+t,o),l=0;r<=a;r++){var c=s[r];l+=c*c}return l}for(var d=0;d<l;d++){var h=u(d),f=s[d]*Math.pow(n+r*h,-a);c[d]=f}return dn(c,e.shape)},t.prototype.LRNGrad=function(e,t,n,r,a,i,o){Wu(e,"LRNGrad");for(var s=e.shape[3],l=this.readSync(e.dataId),c=this.readSync(t.dataId),u=this.readSync(n.dataId),d=new Float32Array(e.size),h=e.size,f=0;f<h;f++){for(var p=f%s,m=f-p+Math.max(0,p-r),g=f-p+Math.min(s,p+r+1),v=0,y=m;y<g;y++)v+=Math.pow(c[y],2);for(v=i*v+a,y=m;y<g;y++){var b=-2*i*o*c[y]*u[f]/v;f===y&&(b+=Math.pow(v,-o)),b*=l[f],d[y]+=b}}return dn(d,e.shape)},t.prototype.multinomial=function(e,t,n,r){Wu(e,"multinomial");for(var a=t?e:Ar(e),i=a.shape[0],o=a.shape[1],s=fn([i,n],"int32"),l=this.readSync(s.dataId),c=this.readSync(a.dataId),u=0;u<i;++u){var d=u*o,h=new Float32Array(o-1);h[0]=c[d];for(var f=1;f<h.length;++f)h[f]=h[f-1]+c[d+f];for(var p=On(r.toString()),m=u*n,g=0;g<n;++g){var v=p();l[m+g]=h.length;for(var y=0;y<h.length;y++)if(v<h[y]){l[m+g]=y;break}}}return s},t.prototype.oneHot=function(e,t,n,r){Wu(e,"oneHot");var a=new Float32Array(e.size*t);a.fill(r);for(var i=this.readSync(e.dataId),o=0;o<e.size;++o)i[o]>=0&&i[o]<t&&(a[o*t+i[o]]=n);return cn(a,[e.size,t],"int32")},t.prototype.nonMaxSuppression=function(e,t,n,r,a){return Wu(e,"nonMaxSuppression"),na(this.readSync(e.dataId),this.readSync(t.dataId),n,r,a)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,t){for(var n=e.shape[0],r=e.shape[1],a=Mn(e.shape,"float32"),i=Mn(e.shape,"float32"),o=nn(e).as2D(n,r),s=rn(e).as2D(n,r),l=0;l<n;l++)for(var c=o.slice([l,0],[1,r]),u=s.slice([l,0],[1,r]),d=tn(c,u),h=this.readSync(this.fftImpl(d,t).dataId),f=0;f<r;f++){var p=$r(h,f);a.values[l*r+f]=p.real,i.values[l*r+f]=p.imag}return tn(a.toTensor(),i.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(e,t){var n=e.as1D(),r=n.size;if(this.isExponentOf2(r)){var a=this.fftRadix2(n,r,t).as2D(e.shape[0],e.shape[1]);return t&&(a=tn(nn(a).div(sn(r)),rn(a).div(sn(r)))),a}var i=this.readSync(e.dataId),o=function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(this.fourierTransformByMatmul(i,r,t));return tn(o.real,o.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return 0==(e&e-1)},t.prototype.fftRadix2=function(e,t,n){if(1===t)return e;var r=this.readSync(e.dataId),a=t/2,i=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(r),o=tn(i.real,i.imag).as1D(),s=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(r),l=tn(s.real,s.imag).as1D();o=this.fftRadix2(o,a,n),l=this.fftRadix2(l,a,n);var c=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}(t,n),u=tn(c.real,c.imag).mul(l),d=o.add(u),h=o.sub(u),f=nn(d).concat(nn(h)),p=rn(d).concat(rn(h));return tn(f,p).as1D()},t.prototype.fourierTransformByMatmul=function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,s=0;s<t;s++){var l=Zr(a*s,t,n),c=$r(e,s);i+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}n&&(i/=t,o/=t),Jr(r,i,o,a)}return r},t.prototype.depthToSpace=function(e,t,n){w("NHWC"===n,function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n}),w(t>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+t});for(var r=e.shape[0],a=e.shape[1],i=e.shape[2],o=e.shape[3],s=a*t,l=i*t,c=o/(t*t),u=this.readSync(e.dataId),d=new Float32Array(r*s*l*c),h=0,f=0;f<r;++f)for(var p=0;p<s;++p)for(var m=Math.floor(p/t),g=p%t,v=0;v<l;++v)for(var y=Math.floor(v/t),b=(g*t+v%t)*c,x=0;x<c;++x){var N=x+b+o*(y+i*(m+a*f));d[h++]=u[N]}return dn(d,[r,s,l,c])},t.prototype.broadcastedBinaryOp=function(e,t,n,r){var a=Dr(e.shape,t.shape),i=Mn(a,n),o=this.readSync(e.dataId),s=this.readSync(t.dataId),l=Or(e.shape,a),c=Or(t.shape,a),u=i.values;if(l.length+c.length===0)for(var d=0;d<u.length;++d)u[d]=r(o[d%o.length],s[d%s.length]);else{var h=this.bufferSync(e),f=this.bufferSync(t),p=function(n){var a=i.indexToLoc(n),d=a.slice(-e.rank);l.forEach(function(e){return d[e]=0});var p=h.locToIndex(d),m=a.slice(-t.rank);c.forEach(function(e){return m[e]=0});var g=f.locToIndex(m);u[n]=r(o[p],s[g])};for(d=0;d<u.length;++d)p(d)}return i.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,t,n){var r=Dr(e.shape,t.shape),a=Mn(r,"float32"),i=Mn(r,"float32"),o=this.readSync(e.dataId),s=this.readSync(t.dataId),l=Or(e.shape,r),c=Or(t.shape,r),u=a.values,d=i.values;if(l.length+c.length===0)for(var h=0;h<u.length;h++){var f=h%o.length,p=h%s.length,m=n(o[2*f],o[2*f+1],s[2*p],s[2*p+1]);u[h]=m.real,d[h]=m.imag}else{var g=this.bufferSync(this.data.get(e.dataId).complexTensors.real),v=this.bufferSync(this.data.get(t.dataId).complexTensors.real),y=function(r){var i=a.indexToLoc(r),h=i.slice(-e.rank);l.forEach(function(e){return h[e]=0});var f=g.locToIndex(h),p=i.slice(-t.rank);c.forEach(function(e){return p[e]=0});var m=v.locToIndex(p),y=n(o[2*f],o[2*f+1],s[2*m],s[2*m+1]);u[r]=y.real,d[r]=y.imag};for(h=0;h<u.length;h++)y(h)}return this.complex(a.toTensor(),i.toTensor())},t.prototype.split=function(e,t,n){return la(e,t,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,t,n,r,a,i){for(var o=e.shape,s=o[0],l=o[1],c=o[2],u=o[3],d=t.shape[0],h=r[0],f=r[1],p=Mn([d,h,f,u],"float32"),m=this.readSync(t.dataId),g=this.readSync(n.dataId),v=this.readSync(e.dataId),y=e.strides,b=p.strides,x=0;x<d;x++){var w=4*x,N=m[w],S=m[w+1],E=m[w+2],C=m[w+3],k=g[x];if(!(k>=s))for(var A=h>1?(E-N)*(l-1)/(h-1):0,_=f>1?(C-S)*(c-1)/(f-1):0,j=0;j<h;j++){var I=h>1?N*(l-1)+j*A:.5*(N+E)*(l-1);if(I<0||I>l-1)for(var T=0;T<f;T++)for(var O=0;O<u;O++){var P=O+T*b[2]+j*b[1]+x*b[0];p.values[P]=i}else if("bilinear"===a){var D=Math.floor(I),R=Math.ceil(I),M=I-D;for(T=0;T<f;T++)if((H=f>1?S*(c-1)+T*_:.5*(S+C)*(c-1))<0||H>c-1)for(O=0;O<u;O++)P=O+T*b[2]+j*b[1]+x*b[0],p.values[P]=i;else{var F=Math.floor(H),L=Math.ceil(H),B=H-F;for(O=0;O<u;O++){var U=v[P=O+F*y[2]+D*y[1]+k*y[0]],z=v[P=O+L*y[2]+D*y[1]+k*y[0]],V=v[P=O+F*y[2]+R*y[1]+k*y[0]],W=U+(z-U)*B,q=V+(v[P=O+L*y[2]+R*y[1]+k*y[0]]-V)*B;P=O+T*b[2]+j*b[1]+x*b[0],p.values[P]=W+(q-W)*M}}}else for(T=0;T<f;++T){var H;if((H=f>1?S*(c-1)+T*_:.5*(S+C)*(c-1))<0||H>c-1)for(O=0;O<u;O++)P=O+T*b[2]+j*b[1]+x*b[0],p.values[P]=i;else{var G=Math.round(H),K=Math.round(I);for(O=0;O<u;O++){var X=O+G*y[2]+K*y[1]+k*y[0],Y=O+T*b[2]+j*b[1]+x*b[0];p.values[Y]=v[X]}}}}}return p.toTensor()},t.prototype.sparseToDense=function(e,t,n,r){var a=yr(0,e,n),i=a.sliceRank,o=a.numUpdates,s=a.sliceSize,l=a.strides,c=a.outputSize;return this.scatter(e,t,n,c,s,o,i,l,r,!1)},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],a=pr(e,t),i=a[0],o=a[1],s=a[2],l=a[3];if(0===o)return an([],i,e.dtype);for(var c=new de([o,s],e.dtype),u=this.readSync(t.dataId),d=this.readSync(e.dataId),h=0;h<o;h++){for(var f=[],p=0,m=0;m<r;m++){var g=u[h*r+m];p+=g*l[m],f.push(g)}if(p<0||p>=e.size/s)throw new Error("Invalid indices: "+f+" does not index into "+e.shape);for(var v=0;v<s;v++)c.values[h*s+v]=d[p*s+v]}return c.toTensor().reshape(i)},t.prototype.scatterND=function(e,t,n){var r=yr(0,e,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,l=r.outputSize,c=sn(0);return this.scatter(e,t,n,l,o,i,a,s,c,!0)},t.prototype.fill=function(e,t,n){var r=M(n=n||G(t),C(e));return r.fill(t),Te.makeTensor(r,e,n,this)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var t=M(e.dtype,C(e.shape));return this.makeOutput(t,e.shape,e.dtype)},t.prototype.linspace=function(e,t,n){return Yr(e,t,n)},t.prototype.scatter=function(e,t,n,r,a,i,o,s,l,c){var u=[r/a,a],d=this.readSync(e.dataId),h=this.readSync(t.dataId);if(0===r)return an([],n,t.dtype);var f=new de(u,t.dtype);f.values.fill(this.readSync(l.dataId)[0]);for(var p=0;p<i;p++){for(var m=[],g=0,v=0;v<o;v++){var y=d[p*o+v];m.push(y),g+=y*s[v]}if(g<0||g>=r/a)throw new Error("Invalid indices: "+m+" does not index into "+n);for(var b=0;b<a;b++)c?f.values[g*a+b]+=h[p*a+b]:f.values[g*a+b]=0===t.rank?h[0]:h[p*a+b]}return f.toTensor().reshape(n)},t}(Ir);Te.registerBackend("cpu",function(){return new Hu},1);for(var Gu=0,Ku=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t,i=a.boxes,o=a.scores,s=r,l=s.maxOutputSize,c=s.iouThreshold,u=s.scoreThreshold,d=s.softNmsSigma,h=n;Wu(i,"NonMaxSuppressionWithScore");var f=ra(h.data.get(i.dataId).values,h.data.get(o.dataId).values,l,c,u,d);return[f.selectedIndices,f.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;Wu(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var l=i[s];o[s]=l*l}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:as,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=r.a,i=r.b,o=n;Wu([a,i],as);var s=o.data.get(a.dataId).values,l=o.data.get(i.dataId).values,c=function(e,t,n,r,a,i){var o=Dr(e,t),s=o.length,l=Y(o),c=R(a,C(o)),u=e.length,d=t.length,h=Y(e),f=Y(t),p=Or(e,o),m=Or(t,o);if(p.length+m.length===0)for(var g=0;g<c.length;++g)c[g]=i(n[g%n.length],r[g%r.length]);else{var v=function(e){var t=ie(e,s,l),a=t.slice(-u);p.forEach(function(e){return a[e]=0});var o=ae(a,u,h),g=t.slice(-d);m.forEach(function(e){return g[e]=0});var v=ae(g,d,f);c[e]=i(n[o],r[v])};for(g=0;g<c.length;++g)v(g)}return[c,o]}(a.shape,i.shape,s,l,a.dtype,function(e,t){var n=e-t;return n*n}),u=c[0],d=c[1];return{dataId:o.write(u,d,a.dtype),shape:d,dtype:a.dtype}}}];Gu<Ku.length;Gu++)p(Ku[Gu]);for(var Xu,Yu=function(e){this.variableNames=["A"];var t=va(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+t.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},Qu=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=va(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+n+".0);\n            vec4 values = "+t.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+t.output+" = result;\n      }\n    "},$u=0,Ju=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement,c=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],u=c[0],d=c[1],h=[d,u],f=[d,u,i];(s||o)&&(null==Xu&&(Xu=document.createElement("canvas").getContext("2d")),Xu.canvas.width=u,Xu.canvas.height=d,Xu.drawImage(a,0,0,u,d),a=Xu.canvas);var p=n.makeTensorInfo(h,"int32");n.texData.get(p.dataId).usage=Re.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);var m=l().getBool("WEBGL_PACK")?new Qu(f):new Yu(f),g=n.runWebGLProgram(m,[p],"int32");return n.disposeData(p.dataId),g}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;Bt("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t,i=a.boxes,o=a.scores,s=r,l=s.maxOutputSize,c=s.iouThreshold,u=s.scoreThreshold,d=s.softNmsSigma,h=n,f=ra(h.readSync(i.dataId),h.readSync(o.dataId),l,c,u,d);return[f.selectedIndices,f.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n,i=new _o(r.shape,"return x * x;");return a.runWebGLProgram(i,[r],r.dtype)}},{kernelName:as,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=r.a,i=r.b,o=n,s=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ha("return (a - b) * (a - b);",a.shape,i.shape):new Wa("return (a - b) * (a - b);",a.shape,i.shape);return o.compileAndRun(s,[a,i])}}];$u<Ju.length;$u++)p(Ju[$u]);for(var Zu=0,ed=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:as,gradFunc:function(e,t){var n=t[0],r=t[1],a=sn(2);return{a:function(){return xl(e,xl(a,Cl(n,r)))},b:function(){return xl(e,xl(a,Cl(r,n)))}}}}];Zu<ed.length;Zu++)m(ed[Zu]);var td=function(){function e(){}return e.prototype.fetch=function(e,t){return fetch(e,t)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got "+t);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},e}();l().get("IS_BROWSER")&&l().setPlatform("browser",new td);var nd,rd=function(){function e(){this.util=n(745),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(e,t){return null!=l().global.fetch?l().global.fetch(e,t):(null==nd&&(nd=n(7318)),nd(e,t))},e.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)},e}();l().get("IS_NODE")&&l().setPlatform("node",new rd);var ad={float32:4,int32:4,uint16:2,uint8:1,bool:1};function id(e,t){for(var n={},r=0,a=function(t){var a=t.name,i=t.dtype,o=t.shape,s=C(o),l=void 0;if("quantization"in t){var c=t.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+t.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var u=ad[c.dtype],d=e.slice(r,r+s*u),h="uint8"===c.dtype?new Uint8Array(d):new Uint16Array(d);if("float32"===i)l=Float32Array.from(h,function(e){return e*c.scale+c.min});else{if("int32"!==i)throw new Error("Unsupported dtype in weight '"+a+"': "+i);l=Int32Array.from(h,function(e){return Math.round(e*c.scale+c.min)})}r+=s*u}else if("string"===i){var f=C(t.shape);l=[];for(var p=0;p<f;p++){var m=new Uint32Array(e.slice(r,r+4))[0];r+=4;var g=new Uint8Array(e.slice(r,r+m));l.push(g),r+=m}}else{var v=ad[i];if(d=e.slice(r,r+s*v),"float32"===i)l=new Float32Array(d);else if("int32"===i)l=new Int32Array(d);else{if("bool"!==i)throw new Error("Unsupported dtype in weight '"+a+"': "+i);l=new Uint8Array(d)}r+=s*v}n[a]=an(l,o,i)},i=0,o=t;i<o.length;i++)a(o[i]);return n}function od(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+e.constructor.name)});var r=new Uint8Array(t),a=0;return n.forEach(function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength}),r.buffer}var sd="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function ld(e){return sd?Buffer.byteLength(e):new Blob([e]).size}function cd(e){var t=0;e.forEach(function(e){t+=e.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(e){n.set(new Uint8Array(e),r),r+=e.byteLength}),n.buffer}function ud(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function dd(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:ld(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:ld(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}var hd=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(e){var n=e(t,r);null!==n&&a.push(n)}),a},e}(),fd="://",pd=function(){function e(){this.managers={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerManager=function(t,n){w(null!=t,function(){return"scheme must not be undefined or null."}),t.endsWith(fd)&&(t=t.slice(0,t.indexOf(fd))),w(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();w(null==r.managers[t],function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function md(e){if(-1===e.indexOf(fd))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+pd.getSchemes().join(","));return{scheme:e.split(fd)[0],path:e.split(fd)[1]}}function gd(e,t,n){return void 0===n&&(n=!1),i(this,void 0,void 0,function(){var r,a,i,s,l,c,u,d,h;return o(this,function(o){switch(o.label){case 0:return w(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),w((r=hd.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),w(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),a=r[0],w((i=hd.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),w(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),s=i[0],l=md(e).scheme,c=md(e).path,u=l===md(e).scheme,[4,a.load()];case 1:return d=o.sent(),n&&u?[4,pd.getManager(l).removeModel(c)]:[3,3];case 2:o.sent(),o.label=3;case 3:return[4,s.save(d)];case 4:return h=o.sent(),!n||u?[3,6]:[4,pd.getManager(l).removeModel(c)];case 5:o.sent(),o.label=6;case 6:return[2,h.modelArtifactsInfo]}})})}var vd="models_store",yd="model_info_store";function bd(){if(!l().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function xd(e){var t=e.result;t.createObjectStore(vd,{keyPath:"modelPath"}),t.createObjectStore(yd,{keyPath:"modelPath"})}var wd=function(){function e(e){if(this.indexedDB=bd(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return e.prototype.save=function(e){return i(this,void 0,void 0,function(){return o(this,function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]})})},e.prototype.load=function(){return i(this,void 0,void 0,function(){return o(this,function(e){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(e,t){var n=this;return new Promise(function(e,r){var a=n.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return xd(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(vd,"readonly"),s=o.objectStore(vd).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var l,c=dd(t),u=i.transaction(yd,"readwrite"),d=u.objectStore(yd),h=d.put({modelPath:n.modelPath,modelArtifactsInfo:c});h.onsuccess=function(){var a=(l=i.transaction(vd,"readwrite")).objectStore(vd).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});a.onsuccess=function(){return e({modelArtifactsInfo:c})},a.onerror=function(e){var t=(d=u.objectStore(yd)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},h.onerror=function(e){return i.close(),r(h.error)},u.oncomplete=function(){null==l?i.close():l.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}})},e.URL_SCHEME="indexeddb://",e}(),Nd=function(e){return l().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(wd.URL_SCHEME)?(t=e.slice(wd.URL_SCHEME.length),new wd(t)):null;var t};hd.registerSaveRouter(Nd),hd.registerLoadRouter(Nd);var Sd=function(){function e(){this.indexedDB=bd()}return e.prototype.listModels=function(){return i(this,void 0,void 0,function(){var e=this;return o(this,function(t){return[2,new Promise(function(t,n){var r=e.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return xd(r)},r.onsuccess=function(){var e=r.result,a=e.transaction(yd,"readonly"),i=a.objectStore(yd).getAll();i.onsuccess=function(){for(var e={},n=0,r=i.result;n<r.length;n++){var a=r[n];e[a.modelPath]=a.modelArtifactsInfo}t(e)},i.onerror=function(t){return e.close(),n(i.error)},a.oncomplete=function(){return e.close()}},r.onerror=function(e){return n(r.error)}})]})})},e.prototype.removeModel=function(e){return i(this,void 0,void 0,function(){var t=this;return o(this,function(n){var r;return e=(r=e).startsWith(wd.URL_SCHEME)?r.slice(wd.URL_SCHEME.length):r,[2,new Promise(function(n,r){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return xd(a)},a.onsuccess=function(){var t,i=a.result,o=i.transaction(yd,"readwrite"),s=o.objectStore(yd),l=s.get(e);l.onsuccess=function(){if(null==l.result)return i.close(),r(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var a=s.delete(e),o=function(){var a=(t=i.transaction(vd,"readwrite")).objectStore(vd).delete(e);a.onsuccess=function(){return n(l.result.modelArtifactsInfo)},a.onerror=function(e){return r(l.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(l.error)}},l.onerror=function(e){return i.close(),r(l.error)},o.oncomplete=function(){null==t?i.close():t.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})]})})},e}();if(l().getBool("IS_BROWSER"))try{pd.registerManager(wd.URL_SCHEME,new Sd)}catch(r){}var Ed="/",Cd="tensorflowjs_models",kd="info",Ad="model_topology",_d="weight_specs",jd="weight_data",Id="model_metadata";function Td(e){return{info:[Cd,e,kd].join(Ed),topology:[Cd,e,Ad].join(Ed),weightSpecs:[Cd,e,_d].join(Ed),weightData:[Cd,e,jd].join(Ed),modelMetadata:[Cd,e,Id].join(Ed)}}function Od(e){var t=e.split(Ed);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(Ed)}var Pd=function(){function e(e){if(!l().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Td(this.modelPath)}return e.prototype.save=function(e){return i(this,void 0,void 0,function(){var t,n,r;return o(this,function(a){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=dd(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){if(sd)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch(e){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}})})},e.prototype.load=function(){return i(this,void 0,void 0,function(){var e,t,n,r,a,i,s;return o(this,function(o){if(null==(e=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=r,null!=(a=this.LS.getItem(this.keys.modelMetadata))&&(i=JSON.parse(a),t.format=i.format,t.generatedBy=i.generatedBy,t.convertedBy=i.convertedBy,t.userDefinedMetadata=i.userDefinedMetadata),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(e){if(sd){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}(s),[2,t]})})},e.URL_SCHEME="localstorage://",e}(),Dd=function(e){return l().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Pd.URL_SCHEME)?(t=e.slice(Pd.URL_SCHEME.length),new Pd(t)):null;var t};hd.registerSaveRouter(Dd),hd.registerLoadRouter(Dd);var Rd=function(){function e(){w(l().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),w("undefined"==typeof window||void 0!==window.localStorage,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return i(this,void 0,void 0,function(){var e,t,n,r,a,i;return o(this,function(o){for(e={},t=Cd+Ed,n=Ed+kd,r=0;r<this.LS.length;++r)(a=this.LS.key(r)).startsWith(t)&&a.endsWith(n)&&(i=Od(a),e[i]=JSON.parse(this.LS.getItem(a)));return[2,e]})})},e.prototype.removeModel=function(e){return i(this,void 0,void 0,function(){var t,n;return o(this,function(r){var a;if(e=(a=e).startsWith(Pd.URL_SCHEME)?a.slice(Pd.URL_SCHEME.length):a,t=Td(e),null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,n]})})},e}();if(l().getBool("IS_BROWSER"))try{pd.registerManager(Pd.URL_SCHEME,new Rd)}catch(r){}function Md(e){return new Promise(function(e){return setTimeout(e)}).then(e)}var Fd=function(){function e(t){if(!l().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return e.prototype.save=function(e){return i(this,void 0,void 0,function(){var t,n,r,a,i,s;return o(this,function(o){switch(o.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:n},a=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(i=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=a,[4,Md(function(){return i.dispatchEvent(new MouseEvent("click"))})];case 2:return o.sent(),null==e.weightData?[3,4]:((s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=t,[4,Md(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:o.sent(),o.label=4;case 4:return[2,{modelArtifactsInfo:dd(e)}]}})})},e.URL_SCHEME="downloads://",e}(),Ld=function(){function e(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return e.prototype.load=function(){return i(this,void 0,void 0,function(){var e,t,n=this;return o(this,function(r){return e=this.files[0],t=this.files.slice(1),[2,new Promise(function(r,a){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),s=o.modelTopology;if(null!=s){0===t.length&&r({modelTopology:s});var l=o.weightsManifest;if(null!=l){var c;try{c=n.checkManifestAndWeightFiles(l,t)}catch(e){return void a(e)}var u=[],d=[],h=[];l.forEach(function(e){e.paths.forEach(function(e){d.push(e),h.push(null)}),u.push.apply(u,e.weights)}),l.forEach(function(e){e.paths.forEach(function(e){var t=new FileReader;t.onload=function(t){var n=t.target.result,a=d.indexOf(e);h[a]=n,-1===h.indexOf(null)&&r({modelTopology:s,weightSpecs:u,weightData:cd(h),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy,userDefinedMetadata:o.userDefinedMetadata})},t.onerror=function(t){return a("Failed to weights data from file of path '"+e+"'.")},t.readAsArrayBuffer(c[e])})})}else a(new Error("weightManifest field is missing from file "+e.name))}else a(new Error("modelTopology field is missing from file "+e.name))},i.onerror=function(t){return a("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},i.readAsText(e)})]})})},e.prototype.checkManifestAndWeightFiles=function(e,t){for(var n=[],r=t.map(function(e){return ud(e.name)}),a={},i=0,o=e;i<o.length;i++)o[i].paths.forEach(function(e){var i=ud(e);if(-1!==n.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: '"+i+"'");if(n.push(i),-1===r.indexOf(i))throw new Error("Weight file with basename '"+i+"' is not provided.");a[e]=t[r.indexOf(i)]});if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+t.length+").");return a},e}();function Bd(e,t,n,r){!function(e){w(null!=e&&Array.isArray(e)&&e.length>0,function(){return"promises must be a none empty array"})}(e),function(e,t){w(e>=0&&e<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+e}),w(t>=0&&t<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+t}),w(t>=e,function(){return"startFraction must be no more than endFraction, but got startFraction "+e+" and endFraction "+t})}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map(function(i){return i.then(function(i){var o=n+ ++a/e.length*(r-n);return t(o),i}),i}))}function Ud(e,t){return i(this,void 0,void 0,function(){var n,r,a,i,s,c,u,d,h;return o(this,function(o){switch(o.label){case 0:return null==t&&(t={}),n=null==t.fetchFunc?l().platform.fetch:t.fetchFunc,r=e.map(function(e){return n(e,t.requestInit,{isBinary:!0})}),a=0,i=.5,null!=t.onProgress?[3,2]:[4,Promise.all(r)];case 1:return s=o.sent(),[3,4];case 2:return[4,Bd(r,t.onProgress,a,i)];case 3:s=o.sent(),o.label=4;case 4:return c=s.map(function(e){return e.arrayBuffer()}),u=.5,d=1,null!=t.onProgress?[3,6]:[4,Promise.all(c)];case 5:return h=o.sent(),[3,8];case 6:return[4,Bd(c,t.onProgress,u,d)];case 7:h=o.sent(),o.label=8;case 8:return[2,h]}})})}function zd(e){var t=this;return function(n,r,a){return void 0===r&&(r=""),i(t,void 0,void 0,function(){var t,i,s,l,c,u,d,h,f,p;return o(this,function(o){switch(o.label){case 0:if(t=n.map(function(){return!1}),i={},s=null!=a?a.map(function(){return!1}):[],l=[],n.forEach(function(e,n){var r=0;e.weights.forEach(function(e){var o="quantization"in e?e.quantization.dtype:e.dtype,c=ad[o]*C(e.shape),u=function(){t[n]=!0,null==i[n]&&(i[n]=[]),i[n].push({manifestEntry:e,groupOffset:r,sizeBytes:c})};null!=a?a.forEach(function(t,n){t===e.name&&(u(),s[n]=!0)}):u(),l.push(e.name),r+=c})}),!s.every(function(e){return e}))throw c=a.filter(function(e,t){return!s[t]}),new Error("Could not find weights in manifest with names: "+c.join(", ")+". \nManifest JSON has weights with names: "+l.join(", ")+".");return u=t.reduce(function(e,t,n){return t&&e.push(n),e},[]),d=[],u.forEach(function(e){n[e].paths.forEach(function(e){var t=r+(r.endsWith("/")?"":"/")+e;d.push(t)})}),[4,e(d)];case 1:return h=o.sent(),f={},p=0,u.forEach(function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=h[p+a].byteLength;for(var o=new ArrayBuffer(r),s=new Uint8Array(o),l=0,c=0;c<t;c++){var u=new Uint8Array(h[p+c]);s.set(u,l),l+=u.byteLength}i[e].forEach(function(e){var t=id(o.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)f[n]=t[n]}),p+=t}),[2,f]}})})}}hd.registerSaveRouter(function(e){return l().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Fd.URL_SCHEME)?function(e){return void 0===e&&(e="model"),new Fd(e)}(e.slice(Fd.URL_SCHEME.length)):null});var Vd=function(){function e(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,null!=t.fetchFunc?(w("function"==typeof t.fetchFunc,function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=t.fetchFunc):this.fetch=l().platform.fetch,w(null!=e&&e.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(e)&&w(2===e.length,function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."}),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return e.prototype.save=function(e){return i(this,void 0,void 0,function(){var t,n,r,a;return o(this,function(i){switch(i.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:n},t.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((a=i.sent()).ok)return[2,{modelArtifactsInfo:dd(e),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}})})},e.prototype.load=function(){return i(this,void 0,void 0,function(){var e,t,n,r,a,i,s,l,c,u,d,h;return o(this,function(o){switch(o.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=o.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");o.label=2;case 2:return o.trys.push([2,4,,5]),[4,e.json()];case 3:return t=o.sent(),[3,5];case 4:throw o.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=t.modelTopology,a=t.weightsManifest,i=t.generatedBy,s=t.convertedBy,l=t.format,c=t.userDefinedMetadata,null==r&&null==a)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==a?[3,7]:[4,this.loadWeights(a)];case 6:h=o.sent(),u=h[0],d=h[1],o.label=7;case 7:return[2,{modelTopology:r,weightSpecs:u,weightData:d,userDefinedMetadata:c,generatedBy:i,convertedBy:s,format:l}]}})})},e.prototype.loadWeights=function(e){return i(this,void 0,void 0,function(){var t,n,r,a,i,s,l,c,u,d,h;return o(this,function(o){switch(o.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,n=function(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}(t),r=n[0],a=n[1],i=this.weightPathPrefix||r,s=[],l=0,c=e;l<c.length;l++)u=c[l],s.push.apply(s,u.weights);return d=[],e.forEach(function(e){e.paths.forEach(function(e){d.push(i+e+a)})}),[4,Ud(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return h=o.sent(),[2,[s,cd(h)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function Wd(e){return null!=e.match(Vd.URL_SCHEME_REGEX)}var qd=function(e,t){return"undefined"==typeof fetch?null:(Array.isArray(e)?e.every(function(e){return Wd(e)}):Wd(e))?Hd(e,{onProgress:t}):null};function Hd(e,t){return new Vd(e,t)}hd.registerSaveRouter(qd),hd.registerLoadRouter(qd);var Gd,Kd=function(){function e(e){this.modelArtifacts=e}return e.prototype.load=function(){return i(this,void 0,void 0,function(){return o(this,function(e){return[2,this.modelArtifacts]})})},e}(),Xd=function(){function e(e){this.saveHandler=e}return e.prototype.save=function(e){return i(this,void 0,void 0,function(){return o(this,function(t){return[2,this.saveHandler(e)]})})},e}(),Yd=Object.freeze({browserFiles:function(e){return new Ld(e)},browserHTTPRequest:function(e,t){return Hd(e,t)},concatenateArrayBuffers:cd,decodeWeights:id,encodeWeights:function(e,t){return i(this,void 0,void 0,function(){var n,r,a,s,l,c=this;return o(this,function(u){switch(u.label){case 0:for(n=[],r=[],a=Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e),s=function(s){var l=a[s],u=Array.isArray(e)?e[s].tensor:e[l];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype)throw new Error("Unsupported dtype in weight '"+l+"': "+u.dtype);var d={name:l,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){var h=new Promise(function(e){return i(c,void 0,void 0,function(){var t,n,r,a,i,s,l;return o(this,function(o){switch(o.label){case 0:return[4,u.bytes()];case 1:for(t=o.sent(),n=t.reduce(function(e,t){return e+t.length},0)+4*t.length,r=new Uint8Array(n),a=0,i=0;i<t.length;i++)s=t[i],l=new Uint8Array(new Uint32Array([s.length]).buffer),r.set(l,a),a+=4,r.set(s,a),a+=s.length;return e(r),[2]}})})});r.push(h)}else r.push(u.data());null!=t&&(d.group=t),n.push(d)},l=0;l<a.length;++l)s(l);return[4,Promise.all(r)];case 1:return[2,{data:od(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new Kd(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Kd({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Kd({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return hd.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:dd,getSaveHandlers:function(e){return hd.getSaveHandlers(e)},http:Hd,isHTTPScheme:Wd,loadWeights:function(e,t,n,r){return void 0===t&&(t=""),i(this,void 0,void 0,function(){return o(this,function(a){return[2,zd(function(e){return Ud(e,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return hd.registerLoadRouter(e)},registerSaveRouter:function(e){return hd.registerSaveRouter(e)},weightsLoaderFactory:zd,withSaveHandler:function(e){return new Xd(e)},copyModel:function(e,t){return i(this,void 0,void 0,function(){return o(this,function(n){return[2,gd(e,t,!1)]})})},listModels:function(){return i(this,void 0,void 0,function(){var e,t,n,r,a,i,s;return o(this,function(o){switch(o.label){case 0:e=pd.getSchemes(),t={},n=0,r=e,o.label=1;case 1:return n<r.length?(a=r[n],[4,pd.getManager(a).listModels()]):[3,4];case 2:for(s in i=o.sent())t[a+fd+s]=i[s];o.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return i(this,void 0,void 0,function(){return o(this,function(n){return[2,gd(e,t,!0)]})})},removeModel:function(e){return i(this,void 0,void 0,function(){var t;return o(this,function(n){return t=md(e),[2,pd.getManager(t.scheme).removeModel(t.path)]})})}}),Qd=en({confusionMatrix_:function(e,t,n){var r=Vt(e,"labels","confusionMatrix"),a=Vt(t,"predictions","confusionMatrix");w(null==n||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),w(1===r.rank,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),w(1===a.rank,function(){return"Expected the rank of predictions to be 1, but got "+a.rank}),w(r.shape[0]===a.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."}),w(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=Gn(r.asType("int32"),n),o=Gn(a.asType("int32"),n);return i.transpose().matMul(o).asType("int32")}}),$d=(Object.freeze({confusionMatrix:Qd}),en({fromPixels_:function(e,t){if(void 0===t&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else{if(null==e.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);o=!0}if(a&&a&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=h("FromPixels",Te.backendName))return Te.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,l,c=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],u=c[0],d=c[1];if(o?s=e.getContext("2d").getImageData(0,0,u,d).data:r||n?s=e.data:(i||a)&&(null==Gd&&(Gd=document.createElement("canvas").getContext("2d")),Gd.canvas.width=u,Gd.canvas.height=d,Gd.drawImage(e,0,0,u,d),s=Gd.getImageData(0,0,u,d).data),4===t)l=new Int32Array(s);else{var f=u*d;l=new Int32Array(f*t);for(var p=0;p<f;p++)for(var m=0;m<t;++m)l[p*t+m]=s[4*p+m]}return un(l,[d,u,t],"int32")}})),Jd=Object.freeze({toPixels:function(e,t){return i(this,void 0,void 0,function(){var n,r,a,i,s,l,c,u,d,h,f,p,m,g,v,y,b,x,w,N,S,E,C;return o(this,function(o){switch(o.label){case 0:if(n=Vt(e,"img","toPixels"),e instanceof me||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),a=r[0],i=r[1],(s=2===n.rank?1:n.shape[2])>4||2===s)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,n.data()];case 1:return l=o.sent(),c=n.min(),u=n.max(),[4,Promise.all([c.data(),u.data()])];case 2:if(d=o.sent(),h=d[0],f=d[1],p=h[0],m=f[0],c.dispose(),u.dispose(),"float32"===n.dtype){if(p<0||m>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+p+" - "+m+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(p<0||m>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+p+" - "+m+"].")}for(g="float32"===n.dtype?255:1,v=new Uint8ClampedArray(i*a*4),y=0;y<a*i;++y)b=void 0,x=void 0,w=void 0,N=void 0,1===s?(b=l[y]*g,x=l[y]*g,w=l[y]*g,N=255):3===s?(b=l[3*y]*g,x=l[3*y+1]*g,w=l[3*y+2]*g,N=255):4===s&&(b=l[4*y]*g,x=l[4*y+1]*g,w=l[4*y+2]*g,N=l[4*y+3]*g),v[0+(S=4*y)]=Math.round(b),v[S+1]=Math.round(x),v[S+2]=Math.round(w),v[S+3]=Math.round(N);return null!=t&&(t.width=i,t.height=a,E=t.getContext("2d"),C=new ImageData(v,i,a),E.putImageData(C,0,0)),n!==e&&n.dispose(),[2,v]}})})},fromPixels:$d}),Zd=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(e,t){return new e(t)},e}(),eh=function(){function e(){this.classNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function th(e){w(null!=e.className,function(){return"Class being registered does not have the static className property defined."}),w("string"==typeof e.className,function(){return"className is required to be a string, but got type "+typeof e.className}),w(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),eh.register(e)}Object.freeze({Serializable:Zd,SerializationMap:eh,registerClass:th});function nh(){return 32===Te.backend.floatPrecision()?.001:.1}function rh(e,t,n){var r=!0;if((U(e)||U(t))&&(r=!1),U(e)&&U(t)&&(r=!0),r){var a=e.constructor.name,i=t.constructor.name;if(a!==i)throw new Error("Arrays are of different type. Actual: "+a+". Expected: "+i)}if(Array.isArray(e)&&Array.isArray(t)){var o=Ut(e),s=Ut(t);if(!k(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var l=U(e)?e:E(e),c=U(t)?t:E(t);if(l.length!==c.length)throw new Error("Arrays have different lengths actual: "+l.length+" vs expected: "+c.length+".\nActual:   "+l+".\nExpected: "+c+".");for(var u=0;u<c.length;++u){var d=l[u],h=c[u];if(!n(d,h))throw new Error("Arrays differ: actual["+u+"] = "+d+", expected["+u+"] = "+h+".\nActual:   "+l+".\nExpected: "+c+".")}}function ah(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(e,t,n){return null==n&&(n=nh()),rh(e,t,function(e,t){return ah(e,t,n)})},testEpsilon:nh,expectPromiseToFail:function(e,t){e().then(function(){return t.fail()},function(){return t()})},expectArraysEqual:function(e,t){var n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return W(e)||W(e[0])||W(t)||W(t[0])?rh(e,n,function(e,t){return e==t}):rh(e,t,function(e,t){return ah(e,t,0)})},expectNumbersClose:function(e,t,n){if(null==n&&(n=nh()),!ah(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),Object.freeze({gpgpu_util:Ui,webgl_util:Dt,forceHalfFloat:function(){l().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:ns,setWebGLContext:Be,GPGPUContext:zi});var ih=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.minimize=function(e,t,n){void 0===t&&(t=!1);var r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map(function(e){return{name:e.name,tensor:i[e.name]}});this.applyGradients(o)}else this.applyGradients(i);return Lt(i),t?a:(a.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,t){return function(e,t){w(K(e),function(){return"The f passed in variableGrads(f) must be a function"}),w(null==t||Array.isArray(t)&&t.every(function(e){return e instanceof we}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=null!=t;if(!n)for(var r in t=[],Te.registeredVariables)t.push(Te.registeredVariables[r]);var a=n?t.filter(function(e){return!e.trainable}):null,i=t.length;w((t=t.filter(function(e){return e.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var o=Te.gradients(e,t,null,!0),s=o.value,l=o.grads;w(l.some(function(e){return null!=e}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),w(0===s.rank,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var c={};return t.forEach(function(e,t){null!=l[t]&&(c[e.name]=l[t])}),null!=a&&a.forEach(function(e){return c[e.name]=null}),{value:s,grads:c}}(e,t)},t.prototype.dispose=function(){null!=this.iterations_&&Lt(this.iterations_)},t.prototype.saveIterations=function(){return i(this,void 0,void 0,function(){return o(this,function(e){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:sn(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return i(this,void 0,void 0,function(){return o(this,function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(e){return i(this,void 0,void 0,function(){return o(this,function(e){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(e){return i(this,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:return t=this,[4,e[0].tensor.data()];case 1:return t.iterations_=n.sent()[0],[2,e.slice(1)]}})})},t}(Zd);Object.defineProperty(ih,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var oh=function(e){function t(t,n,r){void 0===r&&(r=null);var a=e.call(this)||this;return a.learningRate=t,a.rho=n,a.epsilon=r,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==r&&(a.epsilon=Te.backend.epsilon()),a}return a(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var a=Te.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:Ft(function(){return vn(a).variable(!1)})}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:Ft(function(){return vn(a).variable(!1)})});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;Ft(function(){var e=o.mul(t.rho).add(i.square().mul(1-t.rho)),n=s.add(t.epsilon).sqrt().div(o.add(t.epsilon).sqrt()).mul(i),r=s.mul(t.rho).add(n.square().mul(1-t.rho));o.assign(e),s.assign(r);var l=n.mul(-t.learningRate).add(a);a.assign(l)})}}),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedUpdates&&(Lt(this.accumulatedGrads.map(function(e){return e.variable})),Lt(this.accumulatedUpdates.map(function(e){return e.variable})))},t.prototype.getWeights=function(){return i(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return i(this,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=e.length/2,this.accumulatedGrads=e.slice(0,t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),this.accumulatedUpdates=e.slice(t,2*t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.rho,t.epsilon)},t.className="Adadelta",t}(ih);th(oh);var sh=function(e){function t(t,n){void 0===n&&(n=.1);var r=e.call(this)||this;return r.learningRate=t,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return a(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var a=Te.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accumulator",variable:Ft(function(){return pn(a.shape,t.initialAccumulatorValue).variable(!1)})});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;Ft(function(){var e=o.add(i.square());o.assign(e);var n=i.div(e.add(Te.backend.epsilon()).sqrt()).mul(-t.learningRate).add(a);a.assign(n)})}}),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedGrads&&Lt(this.accumulatedGrads.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulatedGrads=e.map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)},t.className="Adagrad",t}(ih);th(sh);var lh=function(e){function t(t,n,r,a){void 0===a&&(a=null);var i=e.call(this)||this;return i.learningRate=t,i.beta1=n,i.beta2=r,i.epsilon=a,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],Ft(function(){i.accBeta1=sn(n).variable(),i.accBeta2=sn(r).variable()}),null==a&&(i.epsilon=Te.backend.epsilon()),i}return a(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e);Ft(function(){var r=Cl(1,t.accBeta1),a=Cl(1,t.accBeta2);n.forEach(function(n,i){var o=Te.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:Ft(function(){return vn(o).variable(!1)})}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:n+"/v",variable:Ft(function(){return vn(o).variable(!1)})});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var l=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,u=l.mul(t.beta1).add(s.mul(1-t.beta1)),d=c.mul(t.beta2).add(s.square().mul(1-t.beta2)),h=u.div(r),f=d.div(a);l.assign(u),c.assign(d);var p=h.div(f.sqrt().add(t.epsilon)).mul(-t.learningRate).add(o);o.assign(p)}}),t.accBeta1.assign(t.accBeta1.mul(t.beta1)),t.accBeta2.assign(t.accBeta2.mul(t.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Lt(this.accumulatedFirstMoment.map(function(e){return e.variable})),null!=this.accumulatedSecondMoment&&Lt(this.accumulatedSecondMoment.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return i(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return i(this,void 0,void 0,function(){var t,n=this;return o(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),Ft(function(){n.accBeta1.assign(Nl(n.beta1,n.iterations_+1)),n.accBeta2.assign(Nl(n.beta2,n.iterations_+1))}),t=e.length/2,this.accumulatedFirstMoment=e.slice(0,t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),this.accumulatedSecondMoment=e.slice(t,2*t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)},t.className="Adam",t}(ih);th(lh);var ch=function(e){function t(t,n,r,a,i){void 0===a&&(a=null),void 0===i&&(i=0);var o=e.call(this)||this;return o.learningRate=t,o.beta1=n,o.beta2=r,o.epsilon=a,o.decay=i,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],Ft(function(){o.iteration=sn(0).variable(),o.accBeta1=sn(n).variable()}),null==a&&(o.epsilon=Te.backend.epsilon()),o}return a(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e);Ft(function(){var r=Cl(1,t.accBeta1),a=ul(-t.learningRate,t.iteration.mul(t.decay).add(1));n.forEach(function(n,i){var o=Te.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:vn(o).variable(!1)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:n+"/v",variable:vn(o).variable(!1)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var l=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,u=l.mul(t.beta1).add(s.mul(1-t.beta1)),d=c.mul(t.beta2),h=s.abs(),f=d.maximum(h);l.assign(u),c.assign(f);var p=a.div(r).mul(u.div(f.add(t.epsilon))).add(o);o.assign(p)}}),t.iteration.assign(t.iteration.add(1)),t.accBeta1.assign(t.accBeta1.mul(t.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Lt(this.accumulatedFirstMoment.map(function(e){return e.variable})),null!=this.accumulatedWeightedInfNorm&&Lt(this.accumulatedWeightedInfNorm.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return i(this,void 0,void 0,function(){return o(this,function(e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(e){return i(this,void 0,void 0,function(){return o(this,function(e){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)},t.className="Adamax",t}(ih);th(ch);var uh=function(e){function t(t){var n=e.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return a(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=Te.registeredVariables[n];Ft(function(){var e=t.c.mul(a).add(i);i.assign(e)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=function(e){return Te.keep(e)}(sn(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}})})},t.prototype.setWeights=function(e){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:if(0!==(e=t.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,t){return new e(t.learningRate)},t.className="SGD",t}(ih);th(uh);var dh=function(e){function t(t,n,r){void 0===r&&(r=!1);var a=e.call(this,t)||this;return a.learningRate=t,a.momentum=n,a.useNesterov=r,a.accumulations=[],a.m=sn(a.momentum),a}return a(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var a=Te.registeredVariables[n];null==t.accumulations[r]&&(t.accumulations[r]={originalName:n+"/momentum",variable:Ft(function(){return vn(a).variable(!1)})});var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&Ft(function(){var e,n=t.m.mul(i).add(o);e=t.useNesterov?t.c.mul(o.add(n.mul(t.m))).add(a):t.c.mul(n).add(a),i.assign(n),a.assign(e)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&Lt(this.accumulations.map(function(e){return e.variable}))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulations=e.map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)},t.className="Momentum",t}(uh);th(dh);var hh=function(e){function t(t,n,r,a,i){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===a&&(a=null),void 0===i&&(i=!1);var o=e.call(this)||this;if(o.learningRate=t,o.decay=n,o.momentum=r,o.epsilon=a,o.accumulatedMeanSquares=[],o.accumulatedMoments=[],o.accumulatedMeanGrads=[],o.centered=i,null==a&&(o.epsilon=Te.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.");return o}return a(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var a=Te.registeredVariables[n];null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:Ft(function(){return vn(a).variable(!1)})}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:n+"/momentum",variable:Ft(function(){return vn(a).variable(!1)})}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:Ft(function(){return vn(a).variable(!1)})});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedMeanSquares[r].variable,s=t.accumulatedMoments[r].variable;Ft(function(){var e=o.mul(t.decay).add(i.square().mul(1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,l=n.mul(t.decay).add(i.mul(1-t.decay)),c=s.mul(t.momentum).add(i.mul(t.learningRate).div(e.sub(l.square().add(t.epsilon)).sqrt()));o.assign(e),n.assign(l),s.assign(c);var u=a.sub(c);a.assign(u)}else{var d=o.mul(t.decay).add(i.square().mul(1-t.decay));c=s.mul(t.momentum).add(i.mul(t.learningRate).div(d.add(t.epsilon).sqrt())),o.assign(d),s.assign(c),u=a.sub(c),a.assign(u)}})}}),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&Lt(this.accumulatedMeanSquares.map(function(e){return e.variable})),null!=this.accumulatedMeanGrads&&this.centered&&Lt(this.accumulatedMeanGrads.map(function(e){return e.variable})),null!=this.accumulatedMoments&&Lt(this.accumulatedMoments.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return i(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return i(this,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),this.accumulatedMoments=e.slice(t,2*t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)},t.className="RMSProp",t}(ih);th(hh);var fh=function(){function e(){}return e.sgd=function(e){return new uh(e)},e.momentum=function(e,t,n){return void 0===n&&(n=!1),new dh(e,t,n)},e.rmsprop=function(e,t,n,r,a){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===a&&(a=!1),new hh(e,t,n,r,a)},e.adam=function(e,t,n,r){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new lh(e,t,n,r)},e.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=null),new oh(e,t,n)},e.adamax=function(e,t,n,r,a){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===a&&(a=0),new ch(e,t,n,r,a)},e.adagrad=function(e,t){return void 0===t&&(t=.1),new sh(e,t)},e}();fh.sgd,fh.momentum,fh.adadelta,fh.adagrad,fh.rmsprop,fh.adamax,fh.adam,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate&&setImmediate;me.prototype.squaredDifference=function(e){return is(this,e)},fe=Vu;var ph=function(e,t){return ph=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},ph(e,t)};function mh(e,t){function n(){this.constructor=e}ph(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var gh=function(){return gh=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},gh.apply(this,arguments)};function vh(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(a){o(a)}}function l(e){try{c(r.throw(e))}catch(a){o(a)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,l)}c((r=r.apply(e,t||[])).next())})}function yh(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}function bh(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)r[a]=i[o];return r}var xh=function(){function e(e,t){if(!_h(e)||!_h(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:t}));this._width=e,this._height=t}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function wh(e,t){return e instanceof me&&e.shape.length===t}function Nh(e){return wh(e,3)}function Sh(e){return wh(e,4)}function Eh(e){return e%2===0}function Ch(e){return e&&e.width&&e.height}function kh(e){return e.reduce(function(e,t){return e.add(t)},new Ih(0,0)).div(new Ih(e.length,e.length))}function Ah(e,t,n){return Array(e).fill(0).map(function(e,r){return t+r*n})}function _h(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||0===e}function jh(e){return _h(e)&&0<=e&&e<=1}var Ih=function(){function e(e,t){this._x=e,this._y=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),Th=function(){function e(t,n){void 0===n&&(n=!0);var r=t||{},a=[r.left,r.top,r.right,r.bottom].every(_h),i=[r.x,r.y,r.width,r.height].every(_h);if(!i&&!a)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var o=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=o[0],l=o[1],c=o[2],u=o[3];e.assertIsValidBox({x:s,y:l,width:c,height:u},"Box.constructor",n),this._x=s,this._y=l,this._width=c,this._height=u}return e.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(_h)},e.assertIsValidBox=function(t,n,r){if(void 0===r&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new Ih(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new Ih(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new Ih(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new Ih(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(e){return Math.round(e)});return new e({x:t[0],y:t[1],width:t[2],height:t[3]})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(e){return Math.floor(e)});return new e({x:t[0],y:t[1],width:t[2],height:t[3]})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,a=t.width,i=t.height,o=Math.abs(a-i);return a<i&&(n-=o/2,a+=o),i<a&&(r-=o/2,i+=o),new e({x:n,y:r,width:a,height:i})},e.prototype.rescale=function(t){var n=Ch(t)?t.width:t,r=Ch(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n];return new e({x:r[0],y:r[1],width:r[2],height:r[3]})},e.prototype.clipAtImageBorders=function(t,n){var r=this,a=r.x,i=r.y,o=r.right,s=r.bottom,l=Math.max(a,0),c=Math.max(i,0),u=o-l,d=s-c;return new e({x:l,y:c,width:Math.min(u,t-l),height:Math.min(d,n-c)}).floor()},e.prototype.shift=function(t,n){var r=this.width,a=this.height;return new e({x:this.x+t,y:this.y+n,width:r,height:a})},e.prototype.padAtBorders=function(e,t){var n=this.width+1,r=this.height+1,a=n,i=r,o=this.left,s=this.top,l=this.right,c=this.bottom;return l>t&&(a=-l+t+n,l=t),c>e&&(i=-c+e+r,c=e),o<1&&(i=2-o,o=1),s<1&&(i=2-s,s=1),{dy:1,edy:i,dx:1,edx:a,y:s,ey:c,x:o,ex:l,w:n,h:r}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),Oh=function(e){function t(t,n,r,a,i){return void 0===i&&(i=!1),e.call(this,{left:t,top:n,right:r,bottom:a},i)||this}return mh(t,e),t}(Th),Ph=function(){function e(e,t,n,r,a){this._imageDims=new xh(a.width,a.height),this._score=e,this._classScore=t,this._className=n,this._box=new Th(r).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new Th(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),Dh=function(e){function t(t,n,r){return e.call(this,t,t,"",n,r)||this}return mh(t,e),t.prototype.forSize=function(n,r){var a=e.prototype.forSize.call(this,n,r);return new t(a.score,a.relativeBox,a.imageDims)},t}(Ph);function Rh(e,t,n){void 0===n&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left))*Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return n?r/(e.area+t.area-r):r/Math.min(e.area,t.area)}function Mh(e,t,n,r){void 0===r&&(r=!0);for(var a=t.map(function(e,t){return{score:e,boxIndex:t}}).sort(function(e,t){return e.score-t.score}).map(function(e){return e.boxIndex}),i=[],o=function(){var t=a.pop();i.push(t);for(var o=a,s=[],l=0;l<o.length;l++){var c=o[l],u=e[t],d=e[c];s.push(Rh(u,d,r))}a=a.filter(function(e,t){return s[t]<=n})};a.length>0;)o();return i}function Fh(e,t){return Ft(function(){var n=t[0],r=t[1],a=t[2],i=pn(bh(e.shape.slice(0,3),[1]),n),o=pn(bh(e.shape.slice(0,3),[1]),r),s=pn(bh(e.shape.slice(0,3),[1]),a),l=yn([i,o,s],3);return Cl(e,l)})}function Lh(e){return 1/(1+Math.exp(-e))}var Bh,Uh=function(e){function t(t,n,r,a,i){return void 0===i&&(i=!1),e.call(this,{x:t,y:n,width:r,height:a},i)||this}return mh(t,e),t}(Th),zh=function(){function e(e,t,n){void 0===n&&(n=new Ih(0,0));var r=t.width,a=t.height;this._imgDims=new xh(r,a),this._shift=n,this._positions=e.map(function(e){return e.mul(new Ih(r,a)).add(n)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new Ih(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map(function(t){return t.sub(e._shift).div(new Ih(e.imageWidth,e.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})},e.prototype.shiftBy=function(e,t){return new this.constructor(this.relativePositions,this._imgDims,new Ih(e,t))},e.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},e.prototype.align=function(e,t){if(void 0===t&&(t={}),e){var n=e instanceof Dh?e.box.floor():new Th(e);return this.shiftBy(n.x,n.y).align(null,t)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},t),a=r.useDlibAlignment,i=r.minBoxPadding;return a?this.alignDlib():this.alignMinBbox(i)},e.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),t=e[0],n=e[1],r=e[2],a=function(e){return r.sub(e).magnitude()},i=(a(t)+a(n))/2,o=Math.floor(i/.45),s=kh(e),l=Math.floor(Math.max(0,s.x-.5*o)),c=Math.floor(Math.max(0,s.y-.43*o));return new Uh(l,c,Math.min(o,this.imageWidth+l),Math.min(o,this.imageHeight+c))},e.prototype.alignMinBbox=function(e){var t=function(e){var t=e.map(function(e){return e.x}),n=e.map(function(e){return e.y}),r=t.reduce(function(e,t){return t<e?t:e},1/0),a=n.reduce(function(e,t){return t<e?t:e},1/0),i=t.reduce(function(e,t){return e<t?t:e},0),o=n.reduce(function(e,t){return e<t?t:e},0);return new Oh(r,a,i,o)}(this.positions);return t.pad(t.width*e,t.height*e)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),Vh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],kh([e[3],e[4]])]},t}(zh),Wh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(kh)},t}(zh),qh=function(){function e(e,t){this._label=e,this._distance=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(e){return void 0===e&&(e=!0),this.label+(e?" ("+function(e,t){void 0===t&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}(this.distance)+")":"")},e}(),Hh=function(e){function t(t,n){var r=e.call(this,t)||this;return r._label=n,r}return mh(t,e),t.assertIsValidLabeledBox=function(e,t){if(Th.assertIsValidBox(e,t),!_h(e.label))throw new Error(t+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(Th),Gh=function(){function e(e,t){if("string"!==typeof e)throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some(function(e){return!(e instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(e){return Array.from(e)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(e){return new Float32Array(e)});return new e(t.label,n)},e}();!function(e){function t(t,n,r,a){var i=e.call(this,t,n)||this;return i._score=r,i._classScore=a,i}mh(t,e),t.assertIsValidPredictedBox=function(e,t){if(Hh.assertIsValidLabeledBox(e,t),!jh(e.score)||!jh(e.classScore))throw new Error(t+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0})}(Hh);function Kh(e,t){var n={detection:t};return Object.assign({},e,n)}function Xh(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:function(){throw new Error("readFile - filesystem not available for browser environment")}}}function Yh(e){var t="";if(!e)try{e=n(Object(function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}()))}catch(r){t=r.toString()}return{readFile:e?function(t){return new Promise(function(n,r){e.readFile(t,function(e,t){return e?r(e):n(t)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)}}}function Qh(){var e=n.g.Canvas||n.g.HTMLCanvasElement,t=n.g.Image||n.g.HTMLImageElement,r=n.g.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},a=Yh();return gh({Canvas:e||function(){},CanvasRenderingContext2D:n.g.CanvasRenderingContext2D||function(){},Image:t||function(){},ImageData:n.g.ImageData||function(){},Video:n.g.HTMLVideoElement||function(){},createCanvasElement:function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},fetch:r},a)}function $h(){return"object"===typeof window&&"undefined"!==typeof document&&"undefined"!==typeof HTMLImageElement&&"undefined"!==typeof HTMLCanvasElement&&"undefined"!==typeof HTMLVideoElement&&"undefined"!==typeof ImageData&&"undefined"!==typeof CanvasRenderingContext2D}function Jh(){return"object"===typeof n.g&&"undefined"!==typeof process&&!!process.version}function Zh(e){Bh=e}function ef(){$h()&&Zh(Xh()),Jh()&&Zh(Qh())}var tf,nf={getEnv:function(){if(!Bh)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Bh},setEnv:Zh,initialize:ef,createBrowserEnv:Xh,createFileSystem:Yh,createNodejsEnv:Qh,monkeyPatch:function(e){if(Bh||ef(),!Bh)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=void 0===t?Bh.Canvas:t,r=e.Image,a=void 0===r?Bh.Image:r;Bh.Canvas=n,Bh.Image=a,Bh.createCanvasElement=e.createCanvasElement||function(){return new n},Bh.createImageElement=e.createImageElement||function(){return new a},Bh.ImageData=e.ImageData||Bh.ImageData,Bh.Video=e.Video||Bh.Video,Bh.fetch=e.fetch||Bh.fetch,Bh.readFile=e.readFile||Bh.readFile},isBrowser:$h,isNodejs:Jh};function rf(e){return nf.isNodejs()||"string"!==typeof e?e:document.getElementById(e)}function af(e){var t=nf.getEnv(),n=t.Canvas;if(e instanceof t.CanvasRenderingContext2D)return e;var r=rf(e);if(!(r instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var a=r.getContext("2d");if(!a)throw new Error("resolveContext2d - canvas 2d context is null");return a}ef(),function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"}(tf||(tf={}));var of=function(e){void 0===e&&(e={});var t=e.anchorPosition,n=e.backgroundColor,r=e.fontColor,a=e.fontSize,i=e.fontStyle,o=e.padding;this.anchorPosition=t||tf.TOP_LEFT,this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=a||14,this.fontStyle=i||"Georgia",this.padding=o||4},sf=function(){function e(t,n,r){void 0===r&&(r={}),this.text="string"===typeof t?[t]:t instanceof e?t.text:t,this.anchor=n,this.options=new of(r)}return e.prototype.measureWidth=function(e){var t=this.options.padding;return this.text.map(function(t){return e.measureText(t).width}).reduce(function(e,t){return e<t?t:e},0)+2*t},e.prototype.measureHeight=function(){var e=this.options,t=e.fontSize,n=e.padding;return this.text.length*t+2*n},e.prototype.getUpperLeft=function(e,t){var n=this.options.anchorPosition,r=n===tf.BOTTOM_RIGHT||n===tf.TOP_RIGHT,a=n===tf.BOTTOM_LEFT||n===tf.BOTTOM_RIGHT,i=this.measureWidth(e),o=this.measureHeight(),s=r?this.anchor.x-i:this.anchor.x,l=a?this.anchor.y-o:this.anchor.y;if(t){var c=t.width,u=t.height;return{x:Math.max(Math.min(s,c-i),0),y:Math.max(Math.min(l,u-o),0)}}return{x:s,y:l}},e.prototype.draw=function(e){var t=rf(e),n=af(t),r=this.options,a=r.backgroundColor,i=r.fontColor,o=r.fontSize,s=r.fontStyle,l=r.padding;n.font=o+"px "+s;var c=this.measureWidth(n),u=this.measureHeight();n.fillStyle=a;var d=this.getUpperLeft(n,t);n.fillRect(d.x,d.y,c,u),n.fillStyle=i,this.text.forEach(function(e,t){var r=l+d.x,a=l+d.y+(t+1)*o;n.fillText(e,r,a)})},e}(),lf=function(e){void 0===e&&(e={});var t=e.boxColor,n=e.lineWidth,r=e.label,a=e.drawLabelOptions;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;var i={anchorPosition:tf.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new of(Object.assign({},i,a))};!function(){function e(e,t){void 0===t&&(t={}),this.box=new Th(e),this.options=new lf(t)}e.prototype.draw=function(e){var t=af(e),n=this.options,r=n.boxColor,a=n.lineWidth,i=this.box,o=i.x,s=i.y,l=i.width,c=i.height;t.strokeStyle=r,t.lineWidth=a,t.strokeRect(o,s,l,c);var u=this.options.label;u&&new sf([u],{x:o-a/2,y:s},this.options.drawLabelOptions).draw(e)}}();function cf(e){var t=nf.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function uf(e){var t=nf.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new xh(e.naturalWidth,e.naturalHeight):e instanceof r?new xh(e.videoWidth,e.videoHeight):new xh(e.width,e.height)}function df(e){var t=e.width,n=e.height,r=(0,nf.getEnv().createCanvasElement)();return r.width=t,r.height=n,r}function hf(e,t){var n=nf.getEnv().ImageData;if(!(e instanceof n)&&!cf(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=t||uf(e),a=r.width,i=r.height,o=df({width:a,height:i});return e instanceof n?af(o).putImageData(e,0,0):af(o).drawImage(e,0,0,a,i),o}function ff(e,t){return vh(this,void 0,void 0,function(){var n,r,a,i,o,s;return yh(this,function(l){switch(l.label){case 0:return n=t||nf.getEnv().createCanvasElement(),r=e.shape.slice(Sh(e)?1:0),a=r[0],i=r[1],o=r[2],s=Ft(function(){return e.as3D(a,i,o).toInt()}),[4,Jd.toPixels(s,n)];case 1:return l.sent(),s.dispose(),[2,n]}})})}function pf(e){var t=nf.getEnv(),n=t.Image,r=t.Canvas,a=t.Video;return e instanceof n||e instanceof r||e instanceof a}var mf=function(){function e(e,t){var n=this;if(void 0===t&&(t=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach(function(e,t){if(Nh(e))return n._imageTensors[t]=e,void(n._inputDimensions[t]=e.shape);if(Sh(e)){var r=e.shape[0];if(1!==r)throw new Error("NetInput - tf.Tensor4D with batchSize "+r+" passed, but not supported in input array");return n._imageTensors[t]=e,void(n._inputDimensions[t]=e.shape.slice(1))}var a=e instanceof nf.getEnv().Canvas?e:hf(e);n._canvases[t]=a,n._inputDimensions[t]=[a.height,a.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var e=this;return Ah(this.batchSize,0,1).map(function(t,n){return e.getReshapedInputDimensions(n)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},e.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},e.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},e.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},e.prototype.getReshapedInputDimensions=function(e){if("number"!==typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return function(e,t){var n=e.width,r=e.height,a=t/Math.max(r,n);return new xh(Math.round(n*a),Math.round(r*a))}({width:this.getInputWidth(e),height:this.getInputHeight(e)},this.inputSize)},e.prototype.toBatchTensor=function(e,t){var n=this;return void 0===t&&(t=!0),this._inputSize=e,Ft(function(){var r=Ah(n.batchSize,0,1).map(function(r){var a=n.getInput(r);if(a instanceof me){var i=Sh(a)?a:a.expandDims();return i=function(e,t){return void 0===t&&(t=!1),Ft(function(){var n=e.shape.slice(1),r=n[0],a=n[1];if(r===a)return e;var i=Math.abs(r-a),o=Math.round(i*(t?.5:1)),s=r>a?2:1,l=function(t){var n=e.shape.slice();return n[s]=t,pn(n,0)},c=l(o),u=i-c.shape[s],d=[t&&u?l(u):null,e,c].filter(function(e){return!!e}).map(function(e){return e.toFloat()});return yn(d,s)})}(i,t),i.shape[1]===e&&i.shape[2]===e||(i=Pu.resizeBilinear(i,[e,e])),i.as3D(e,e,3)}if(a instanceof nf.getEnv().Canvas)return Jd.fromPixels(function(e,t,n){void 0===n&&(n=!1);var r=nf.getEnv(),a=r.Image,i=r.Canvas;if(!(e instanceof a||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var o=uf(e),s=t/Math.max(o.height,o.width),l=s*o.width,c=s*o.height,u=df({width:t,height:t}),d=e instanceof i?e:hf(e),h=Math.abs(l-c)/2,f=n&&l<c?h:0,p=n&&c<l?h:0;return af(u).drawImage(d,f,p,l,c),u}(a,e,t));throw new Error("toBatchTensor - at batchIdx "+r+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+a)}),a=ir(r.map(function(e){return e.toFloat()})).as4D(n.batchSize,e,e,3);return a})},e}();function gf(e){return vh(this,void 0,void 0,function(){var t,n,r;return yh(this,function(a){switch(a.label){case 0:if(e instanceof mf)return[2,e];if(!(t=Array.isArray(e)?e:[e]).length)throw new Error("toNetInput - empty array passed as input");return n=function(t){return Array.isArray(e)?" at input index "+t+":":""},(r=t.map(rf)).forEach(function(e,r){if(!pf(e)&&!Nh(e)&&!Sh(e)){if("string"===typeof t[r])throw new Error("toNetInput -"+n(r)+" string passed, but could not resolve HTMLElement for element id "+t[r]);throw new Error("toNetInput -"+n(r)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id")}if(Sh(e)){var a=e.shape[0];if(1!==a)throw new Error("toNetInput -"+n(r)+" tf.Tensor4D with batchSize "+a+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(e){return pf(e)&&(t=e,new Promise(function(e,n){if(t instanceof nf.getEnv().Canvas||cf(t))return e();function r(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",a),e(t))}function a(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",a),n(e))}t.addEventListener("load",r),t.addEventListener("error",a)}));var t}))];case 1:return a.sent(),[2,new mf(r,Array.isArray(e))]}})})}function vf(e,t){return vh(this,void 0,void 0,function(){var n,r,a,i,o,s;return yh(this,function(l){switch(l.label){case 0:return n=nf.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,gf(e)];case 1:if((a=l.sent()).batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return(i=a.getInput(0))instanceof n?(o=i,[3,4]):[3,2];case 2:return[4,ff(i)];case 3:o=l.sent(),l.label=4;case 4:r=o,l.label=5;case 5:return s=af(r),[2,t.map(function(e){return e instanceof Dh?e.forSize(r.width,r.height).box.floor():e}).map(function(e){return e.clipAtImageBorders(r.width,r.height)}).map(function(e){var t=e.x,n=e.y,r=e.width,a=e.height,i=df({width:r,height:a});return af(i).putImageData(s.getImageData(t,n,r,a),0,0),i})]}})})}function yf(e,t){return vh(this,void 0,void 0,function(){return yh(this,function(n){if(!Nh(e)&&!Sh(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Sh(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,Ft(function(){var n=e.shape.slice(Sh(e)?1:0),r=n[0],a=n[1],i=n[2],o=t.map(function(e){return e instanceof Dh?e.forSize(a,r).box:e}).map(function(e){return e.clipAtImageBorders(a,r)}).map(function(t){var n=t.x,o=t.y,s=t.width,l=t.height;return wc(e.as3D(r,a,i),[o,n,0],[l,s,i])});return o})]})})}function bf(e,t){return vh(this,void 0,void 0,function(){var n;return yh(this,function(r){switch(r.label){case 0:return[4,(0,nf.getEnv().fetch)(e,t)];case 1:if(!((n=r.sent()).status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}})})}function xf(e){return vh(this,void 0,void 0,function(){return yh(this,function(t){switch(t.label){case 0:return[4,bf(e)];case 1:return[2,t.sent().json()]}})})}function wf(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if("/"===e)return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"",a=(e=e.replace(r,"")).split("/").filter(function(e){return e}),i=e.endsWith(".json")?a[a.length-1]:n,o=r+(e.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return{modelBaseUri:o=e.startsWith("/")?"/"+o:o,manifestUri:"/"===o?"/"+i:o+"/"+i}}function Nf(e,t){return vh(this,void 0,void 0,function(){var n,r,a,i;return yh(this,function(o){switch(o.label){case 0:return n=wf(e,t),r=n.manifestUri,a=n.modelBaseUri,[4,xf(r)];case 1:return i=o.sent(),[2,Yd.loadWeights(i,a)]}})})}var Sf=function(){function e(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(e){var t=this.traversePropertyPath(e);return t.obj[t.objProp]},e.prototype.reassignParamFromPath=function(e,t){var n=this.traversePropertyPath(e),r=n.obj,a=n.objProp;r[a].dispose(),r[a]=t},e.prototype.getParamList=function(){var e=this;return this._paramMappings.map(function(t){var n=t.paramPath;return{path:n,tensor:e.getParamFromPath(n)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(e){return e.tensor instanceof we})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(e){return!(e.tensor instanceof we)})},e.prototype.variable=function(){var e=this;this.getFrozenParams().forEach(function(t){var n=t.path,r=t.tensor;e.reassignParamFromPath(n,r.variable())})},e.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach(function(t){var n=t.path,r=t.tensor,a=an(r.dataSync());r.dispose(),e.reassignParamFromPath(n,a)})},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.getParamList().forEach(function(t){if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+t.path);t.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(e){var t=e.tensor;return Array.from(t.dataSync())}).reduce(function(e,t){return e.concat(t)}))},e.prototype.load=function(e){return vh(this,void 0,void 0,function(){return yh(this,function(t){switch(t.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return t.sent(),[2]}})})},e.prototype.loadFromUri=function(e){return vh(this,void 0,void 0,function(){var t;return yh(this,function(n){switch(n.label){case 0:if(e&&"string"!==typeof e)throw new Error(this._name+".loadFromUri - expected model uri");return[4,Nf(e,this.getDefaultModelName())];case 1:return t=n.sent(),this.loadFromWeightMap(t),[2]}})})},e.prototype.loadFromDisk=function(e){return vh(this,void 0,void 0,function(){var t,n,r,a,i,o,s,l,c,u;return yh(this,function(d){switch(d.label){case 0:if(e&&"string"!==typeof e)throw new Error(this._name+".loadFromDisk - expected model file path");return t=nf.getEnv().readFile,n=wf(e,this.getDefaultModelName()),r=n.manifestUri,a=n.modelBaseUri,i=function(e){return Promise.all(e.map(function(e){return t(e).then(function(e){return e.buffer})}))},o=Yd.weightsLoaderFactory(i),c=(l=JSON).parse,[4,t(r)];case 1:return s=c.apply(l,[d.sent().toString()]),[4,o(s,a)];case 2:return u=d.sent(),this.loadFromWeightMap(u),[2]}})})},e.prototype.loadFromWeightMap=function(e){var t=this.extractParamsFromWeigthMap(e),n=t.paramMappings,r=t.params;this._paramMappings=n,this._params=r},e.prototype.extractWeights=function(e){var t=this.extractParams(e),n=t.paramMappings,r=t.params;this._paramMappings=n,this._params=r},e.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var t=e.split("/").reduce(function(t,n){if(!t.nextObj.hasOwnProperty(n))throw new Error("traversePropertyPath - object does not have property "+n+", for path "+e);return{obj:t.nextObj,objProp:n,nextObj:t.nextObj[n]}},{nextObj:this.params}),n=t.obj,r=t.objProp;if(!n||!r||!(n[r]instanceof me))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:n,objProp:r}},e}();function Ef(e,t,n){return Ft(function(){var r=ec(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=ol(r,t.bias)})}function Cf(e,t,n){return void 0===n&&(n=!1),Ft(function(){var r=Lc(n?ol(Kl(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Ef(e,t.conv0,[2,2])),a=Ef(r,t.conv1,[1,1]),i=Ef(Lc(ol(r,a)),t.conv2,[1,1]);return Lc(ol(r,ol(a,i)))})}function kf(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),Ft(function(){var a=Lc(n?ol(Kl(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Ef(e,t.conv0,r?[2,2]:[1,1])),i=Ef(a,t.conv1,[1,1]),o=Ef(Lc(ol(a,i)),t.conv2,[1,1]),s=Ef(Lc(ol(a,ol(i,o))),t.conv3,[1,1]);return Lc(ol(a,ol(i,ol(o,s))))})}function Af(e,t,n,r){return void 0===n&&(n="same"),void 0===r&&(r=!1),Ft(function(){var a=ol(Kl(e,t.filters,[1,1],n),t.bias);return r?Lc(a):a})}function _f(e,t){Object.keys(e).forEach(function(n){t.some(function(e){return e.originalPath===n})||e[n].dispose()})}function jf(e,t){return function(n,r,a,i){var o=dn(e(n*r*a*a),[a,a,n,r]),s=ln(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:o,bias:s}}}function If(e,t){return function(n,r,a){var i=cn(e(n*r),[n,r]),o=ln(e(r));return t.push({paramPath:a+"/weights"},{paramPath:a+"/bias"}),{weights:i,bias:o}}}var Tf=function(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n};function Of(e,t){return function(n,r,a){var i=dn(e(9*n),[3,3,n,1]),o=dn(e(n*r),[1,1,n,r]),s=ln(e(r));return t.push({paramPath:a+"/depthwise_filter"},{paramPath:a+"/pointwise_filter"},{paramPath:a+"/bias"}),new Tf(i,o,s)}}function Pf(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),a=e(t+"/bias",1);return new Tf(n,r,a)}}function Df(e,t){return function(n,r,a){var i=e[n];if(!wh(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:n,paramPath:a||n}),i}}function Rf(e){var t=e;return{extractWeights:function(e){var n=t.slice(0,e);return t=t.slice(e),n},getRemainingWeights:function(){return t}}}function Mf(e,t){var n=jf(e,t),r=Of(e,t);function a(e,t,a,i){return void 0===i&&(i=!1),{conv0:i?n(e,t,3,a+"/conv0"):r(e,t,a+"/conv0"),conv1:r(t,t,a+"/conv1"),conv2:r(t,t,a+"/conv2")}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:function(e,t,n,i){void 0===i&&(i=!1);var o=a(e,t,n,i);return{conv0:o.conv0,conv1:o.conv1,conv2:o.conv2,conv3:r(t,t,n+"/conv3")}}}}function Ff(e){return function(t){return{filters:e(t+"/filters",4),bias:e(t+"/bias",1)}}}function Lf(e,t){var n=Df(e,t),r=Ff(n),a=Pf(n);return{extractDenseBlock3Params:function(e,t){return void 0===t&&(t=!1),{conv0:t?r(e+"/conv0"):a(e+"/conv0"),conv1:a(e+"/conv1"),conv2:a(e+"/conv2")}},extractDenseBlock4Params:function(e,t){return void 0===t&&(t=!1),{conv0:t?r(e+"/conv0"):a(e+"/conv0"),conv1:a(e+"/conv1"),conv2:a(e+"/conv2"),conv3:a(e+"/conv3")}}}}var Bf=function(e){function t(){return e.call(this,"FaceFeatureExtractor")||this}return mh(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return Ft(function(){var n=kf(Fh(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(sn(255)),t.dense0,!0);return n=kf(n,t.dense1),n=kf(n,t.dense2),n=kf(n,t.dense3),n=pc(n,[7,7],[2,2],"valid")})},t.prototype.forward=function(e){return vh(this,void 0,void 0,function(){var t;return yh(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,gf(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function(e){var t=[],n=Lf(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return _f(e,t),{params:r,paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=Rf(e),r=n.extractWeights,a=n.getRemainingWeights,i=Mf(r,t).extractDenseBlock4Params,o=i(3,32,"dense0",!0),s=i(32,64,"dense1"),l=i(64,128,"dense2"),c=i(128,256,"dense3");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:o,dense1:s,dense2:l,dense3:c}}}(e)},t}(Sf);function Uf(e,t){return Ft(function(){return ol(rc(e,t.weights),t.bias)})}function zf(e){var t={},n={};return Object.keys(e).forEach(function(r){(r.startsWith("fc")?n:t)[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var Vf=function(e){function t(t,n){var r=e.call(this,t)||this;return r._faceFeatureExtractor=n,r}return mh(t,e),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return Ft(function(){var r=e instanceof mf?t.faceFeatureExtractor.forwardInput(e):e;return Uf(r.as2D(r.shape[0],-1),n.fc)})},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},t.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),n=t.params,r=t.paramMappings;this._params=n,this._paramMappings=r},t.prototype.extractClassifierParams=function(e){return function(e,t,n){var r=[],a=Rf(e),i=a.extractWeights,o=a.getRemainingWeights,s=If(i,r)(t,n,"fc");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:r,params:{fc:s}}}(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var t=zf(e),n=t.featureExtractorMap,r=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(e){var t,n=[],r=Df(e,n),a={fc:(t="fc",{weights:r(t+"/weights",2),bias:r(t+"/bias",1)})};return _f(e,n),{params:a,paramMappings:n}}(r)},t.prototype.extractParams=function(e){var t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*t+n,a=e.slice(0,e.length-r),i=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(i)},t}(Sf),Wf=["neutral","happy","sad","angry","fearful","disgusted","surprised"],qf=function(){function e(e){var t=this;if(7!==e.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);Wf.forEach(function(n,r){t[n]=e[r]})}return e.prototype.asSortedArray=function(){var e=this;return Wf.map(function(t){return{expression:t,probability:e[t]}}).sort(function(e,t){return t.probability-e.probability})},e}(),Hf=function(e){function t(t){return void 0===t&&(t=new Bf),e.call(this,"FaceExpressionNet",t)||this}return mh(t,e),t.prototype.forwardInput=function(e){var t=this;return Ft(function(){return Ar(t.runNet(e))})},t.prototype.forward=function(e){return vh(this,void 0,void 0,function(){var t;return yh(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,gf(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.predictExpressions=function(e){return vh(this,void 0,void 0,function(){var t,n,r,a,i=this;return yh(this,function(o){switch(o.label){case 0:return[4,gf(e)];case 1:return t=o.sent(),[4,this.forwardInput(t)];case 2:return n=o.sent(),[4,Promise.all(lr(n).map(function(e){return vh(i,void 0,void 0,function(){var t;return yh(this,function(n){switch(n.label){case 0:return[4,e.data()];case 1:return t=n.sent(),e.dispose(),[2,t]}})})}))];case 3:return r=o.sent(),n.dispose(),a=r.map(function(e){return new qf(e)}),[2,t.isBatchInput?a:a[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(Vf);function Gf(e,t){var n={expressions:t};return Object.assign({},e,n)}function Kf(e){return function(e){return e.detection instanceof Dh}(e)&&e.landmarks instanceof zh&&e.unshiftedLandmarks instanceof zh&&e.alignedRect instanceof Dh}function Xf(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),a=r.align(),i=e.detection.imageDims,o={landmarks:r,unshiftedLandmarks:t,alignedRect:new Dh(e.detection.score,a.rescale(i.reverse()),i)};return Object.assign({},e,o)}function Yf(e,t,n){if(void 0===n&&(n=!1),e.beginPath(),t.slice(1).forEach(function(n,r){var a=n.x,i=n.y,o=t[r];e.moveTo(o.x,o.y),e.lineTo(a,i)}),n){var r=t[t.length-1],a=t[0];if(!r||!a)return;e.moveTo(r.x,r.y),e.lineTo(a.x,a.y)}e.stroke()}var Qf=function(e){void 0===e&&(e={});var t=e.drawLines,n=void 0===t||t,r=e.drawPoints,a=void 0===r||r,i=e.lineWidth,o=e.lineColor,s=e.pointSize,l=e.pointColor;this.drawLines=n,this.drawPoints=a,this.lineWidth=i||1,this.pointSize=s||2,this.lineColor=o||"rgba(0, 255, 255, 1)",this.pointColor=l||"rgba(255, 0, 255, 1)"};!function(){function e(e,t){void 0===t&&(t={}),this.faceLandmarks=e,this.options=new Qf(t)}e.prototype.draw=function(e){var t=af(e),n=this.options,r=n.drawLines,a=n.drawPoints,i=n.lineWidth,o=n.lineColor,s=n.pointSize,l=n.pointColor;if(r&&this.faceLandmarks instanceof Wh&&(t.strokeStyle=o,t.lineWidth=i,Yf(t,this.faceLandmarks.getJawOutline()),Yf(t,this.faceLandmarks.getLeftEyeBrow()),Yf(t,this.faceLandmarks.getRightEyeBrow()),Yf(t,this.faceLandmarks.getNose()),Yf(t,this.faceLandmarks.getLeftEye(),!0),Yf(t,this.faceLandmarks.getRightEye(),!0),Yf(t,this.faceLandmarks.getMouth(),!0)),a){t.strokeStyle=l,t.fillStyle=l;this.faceLandmarks.positions.forEach(function(e){t.beginPath(),t.arc(e.x,e.y,s,0,2*Math.PI),t.fill()})}}}();function $f(e,t){var n=[],r=Rf(e),a=r.extractWeights,i=r.getRemainingWeights,o=function(e,t){var n=jf(e,t),r=Of(e,t);return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:function(e,t,a){return{separable_conv0:r(e,t,a+"/separable_conv0"),separable_conv1:r(t,t,a+"/separable_conv1"),expansion_conv:n(e,t,1,a+"/expansion_conv")}},extractMainBlockParams:function(e,t){return{separable_conv0:r(e,e,t+"/separable_conv0"),separable_conv1:r(e,e,t+"/separable_conv1"),separable_conv2:r(e,e,t+"/separable_conv2")}}}}(a,n),s=o.extractConvParams,l=o.extractSeparableConvParams,c=o.extractReductionBlockParams,u=o.extractMainBlockParams,d={conv_in:s(3,32,3,"entry_flow/conv_in"),reduction_block_0:c(32,64,"entry_flow/reduction_block_0"),reduction_block_1:c(64,128,"entry_flow/reduction_block_1")},h={};Ah(t,0,1).forEach(function(e){h["main_block_"+e]=u(128,"middle_flow/main_block_"+e)});var f={reduction_block:c(128,256,"exit_flow/reduction_block"),separable_conv:l(256,512,"exit_flow/separable_conv")};if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:d,middle_flow:h,exit_flow:f}}}function Jf(e,t){var n=[],r=function(e,t){var n=Df(e,t),r=Ff(n),a=Pf(n);return{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:function(e){return{separable_conv0:a(e+"/separable_conv0"),separable_conv1:a(e+"/separable_conv1"),expansion_conv:r(e+"/expansion_conv")}},extractMainBlockParams:function(e){return{separable_conv0:a(e+"/separable_conv0"),separable_conv1:a(e+"/separable_conv1"),separable_conv2:a(e+"/separable_conv2")}}}}(e,n),a=r.extractConvParams,i=r.extractSeparableConvParams,o=r.extractReductionBlockParams,s=r.extractMainBlockParams,l={conv_in:a("entry_flow/conv_in"),reduction_block_0:o("entry_flow/reduction_block_0"),reduction_block_1:o("entry_flow/reduction_block_1")},c={};Ah(t,0,1).forEach(function(e){c["main_block_"+e]=s("middle_flow/main_block_"+e)});var u={reduction_block:o("exit_flow/reduction_block"),separable_conv:i("exit_flow/separable_conv")};return _f(e,n),{params:{entry_flow:l,middle_flow:c,exit_flow:u},paramMappings:n}}function Zf(e,t,n){return ol(Kl(e,t.filters,n,"same"),t.bias)}function ep(e,t,n){void 0===n&&(n=!0);var r=n?Lc(e):e;return r=Ef(r,t.separable_conv0,[1,1]),r=Ef(Lc(r),t.separable_conv1,[1,1]),r=fc(r,[3,3],[2,2],"same"),r=ol(r,Zf(e,t.expansion_conv,[2,2]))}var tp,np=function(e){function t(t){var n=e.call(this,"TinyXception")||this;return n._numMainBlocks=t,n}return mh(t,e),t.prototype.forwardInput=function(e){var t=this,n=this.params;if(!n)throw new Error("TinyXception - load model before inference");return Ft(function(){var r=Fh(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(sn(256)),a=Lc(Zf(r,n.entry_flow.conv_in,[2,2]));return a=ep(a,n.entry_flow.reduction_block_0,!1),a=ep(a,n.entry_flow.reduction_block_1),Ah(t._numMainBlocks,0,1).forEach(function(e){a=function(e,t){var n=Ef(Lc(e),t.separable_conv0,[1,1]);return n=Ef(Lc(n),t.separable_conv1,[1,1]),n=Ef(Lc(n),t.separable_conv2,[1,1]),ol(n,e)}(a,n.middle_flow["main_block_"+e])}),a=ep(a,n.exit_flow.reduction_block),a=Lc(Ef(a,n.exit_flow.separable_conv,[1,1]))})},t.prototype.forward=function(e){return vh(this,void 0,void 0,function(){var t;return yh(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,gf(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Jf(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return $f(e,this._numMainBlocks)},t}(Sf);!function(e){e.FEMALE="female",e.MALE="male"}(tp||(tp={}));var rp=function(e){function t(t){void 0===t&&(t=new np(2));var n=e.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=t,n}return mh(t,e),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return Ft(function(){var r=e instanceof mf?t.faceFeatureExtractor.forwardInput(e):e,a=pc(r,[7,7],[2,2],"valid").as2D(r.shape[0],-1);return{age:Uf(a,n.fc.age).as1D(),gender:Uf(a,n.fc.gender)}})},t.prototype.forwardInput=function(e){var t=this;return Ft(function(){var n=t.runNet(e),r=n.age,a=n.gender;return{age:r,gender:Ar(a)}})},t.prototype.forward=function(e){return vh(this,void 0,void 0,function(){var t;return yh(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,gf(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.predictAgeAndGender=function(e){return vh(this,void 0,void 0,function(){var t,n,r,a,i,o,s=this;return yh(this,function(l){switch(l.label){case 0:return[4,gf(e)];case 1:return t=l.sent(),[4,this.forwardInput(t)];case 2:return n=l.sent(),r=lr(n.age),a=lr(n.gender),i=r.map(function(e,t){return{ageTensor:e,genderTensor:a[t]}}),[4,Promise.all(i.map(function(e){var t=e.ageTensor,n=e.genderTensor;return vh(s,void 0,void 0,function(){var e,r,a,i,o;return yh(this,function(s){switch(s.label){case 0:return[4,t.data()];case 1:return e=s.sent()[0],[4,n.data()];case 2:return r=s.sent()[0],i=(a=r>.5)?tp.MALE:tp.FEMALE,o=a?r:1-r,t.dispose(),n.dispose(),[2,{age:e,gender:i,genderProbability:o}]}})})}))];case 3:return o=l.sent(),n.age.dispose(),n.gender.dispose(),[2,t.isBatchInput?o:o[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},t.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),n=t.params,r=t.paramMappings;this._params=n,this._paramMappings=r},t.prototype.extractClassifierParams=function(e){return function(e){var t=[],n=Rf(e),r=n.extractWeights,a=n.getRemainingWeights,i=If(r,t),o=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{fc:{age:o,gender:s}}}}(e)},t.prototype.extractParamsFromWeigthMap=function(e){var t=zf(e),n=t.featureExtractorMap,r=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(e){var t=[],n=Df(e,t);function r(e){return{weights:n(e+"/weights",2),bias:n(e+"/bias",1)}}var a={fc:{age:r("fc/age"),gender:r("fc/gender")}};return _f(e,t),{params:a,paramMappings:t}}(r)},t.prototype.extractParams=function(e){var t=e.slice(0,e.length-1539),n=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(n)},t}(Sf),ap=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.postProcess=function(e,t,n){var r=n.map(function(e){var n=e.width,r=e.height,a=t/Math.max(r,n);return{width:n*a,height:r*a}}),a=r.length;return Ft(function(){var n=function(e,t){return ir([pn([68],e),pn([68],t)],1).as2D(1,136).as1D()},i=function(e,t){var n=r[e],a=n.width,i=n.height;return t(a,i)?Math.abs(a-i)/2:0},o=e.mul(pn([a,136],t)).sub(ir(Array.from(Array(a),function(e,t){return n(function(e){return i(e,function(e,t){return e<t})}(t),function(e){return i(e,function(e,t){return t<e})}(t))}))).div(ir(Array.from(Array(a),function(e,t){return n(r[t].width,r[t].height)})));return o})},t.prototype.forwardInput=function(e){var t=this;return Ft(function(){var n=t.runNet(e);return t.postProcess(n,e.inputSize,e.inputDimensions.map(function(e){return{height:e[0],width:e[1]}}))})},t.prototype.forward=function(e){return vh(this,void 0,void 0,function(){var t;return yh(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,gf(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.detectLandmarks=function(e){return vh(this,void 0,void 0,function(){var t,n,r,a=this;return yh(this,function(i){switch(i.label){case 0:return[4,gf(e)];case 1:return t=i.sent(),n=Ft(function(){return lr(a.forwardInput(t))}),[4,Promise.all(n.map(function(e,n){return vh(a,void 0,void 0,function(){var r,a,i,o,s;return yh(this,function(l){switch(l.label){case 0:return i=(a=Array).from,[4,e.data()];case 1:return r=i.apply(a,[l.sent()]),o=r.filter(function(e,t){return Eh(t)}),s=r.filter(function(e,t){return!Eh(t)}),[2,new Wh(Array(68).fill(0).map(function(e,t){return new Ih(o[t],s[t])}),{height:t.getInputHeight(n),width:t.getInputWidth(n)})]}})})}))];case 2:return r=i.sent(),n.forEach(function(e){return e.dispose()}),[2,t.isBatchInput?r:r[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(Vf),ip=function(e){function t(t){return void 0===t&&(t=new Bf),e.call(this,"FaceLandmark68Net",t)||this}return mh(t,e),t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(ap);var op=function(e){function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return mh(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return Ft(function(){var n=Cf(Fh(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(sn(255)),t.dense0,!0);return n=Cf(n,t.dense1),n=Cf(n,t.dense2),n=pc(n,[14,14],[2,2],"valid")})},t.prototype.forward=function(e){return vh(this,void 0,void 0,function(){var t;return yh(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,gf(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function(e){var t=[],n=Lf(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return _f(e,t),{params:r,paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=Rf(e),r=n.extractWeights,a=n.getRemainingWeights,i=Mf(r,t).extractDenseBlock3Params,o=i(3,32,"dense0",!0),s=i(32,64,"dense1"),l=i(64,128,"dense2");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:o,dense1:s,dense2:l}}}(e)},t}(Sf),sp=function(e){function t(t){return void 0===t&&(t=new op),e.call(this,"FaceLandmark68TinyNet",t)||this}return mh(t,e),t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(ap);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}mh(t,e)}(ip);function lp(e,t,n,r,a){void 0===a&&(a="same");var i=t.conv,o=i.filters,s=i.bias,l=Kl(e,o,n,a);return l=function(e,t){return ol(xl(e,t.weights),t.biases)}(l=ol(l,s),t.scale),r?Lc(l):l}function cp(e,t){return lp(e,t,[1,1],!1)}function up(e,t){return lp(e,t,[2,2],!0,"valid")}function dp(e,t){function n(n,r,a,i){var o=function(t,n,r){var a=e(t),i=a.length/(n*r*r);if(i%1!==0)throw new Error("depth has to be an integer: "+i+", weights.length: "+a.length+", numFilters: "+n+", filterSize: "+r);return Ft(function(){return zc(dn(a,[n,i,r,r]),[2,3,1,0])})}(n,r,a),s=ln(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:o,bias:s}}function r(r,a,i,o){var s=n(r,a,i,o+"/conv"),l=function(n,r){var a=ln(e(n)),i=ln(e(n));return t.push({paramPath:r+"/weights"},{paramPath:r+"/biases"}),{weights:a,biases:i}}(a,o+"/scale");return{conv:s,scale:l}}return{extractConvLayerParams:r,extractResidualLayerParams:function(e,t,n,a,i){return void 0===i&&(i=!1),{conv1:r((i?.5:1)*e,t,n,a+"/conv1"),conv2:r(e,t,n,a+"/conv2")}}}}function hp(e,t){var n=Df(e,t);function r(e){var t=n(e+"/conv/filters",4),r=n(e+"/conv/bias",1),a=function(e){return{weights:n(e+"/scale/weights",1),biases:n(e+"/scale/biases",1)}}(e);return{conv:{filters:t,bias:r},scale:a}}return{extractConvLayerParams:r,extractResidualLayerParams:function(e){return{conv1:r(e+"/conv1"),conv2:r(e+"/conv2")}}}}function fp(e){var t=[],n=hp(e,t),r=n.extractConvLayerParams,a=n.extractResidualLayerParams,i=r("conv32_down"),o=a("conv32_1"),s=a("conv32_2"),l=a("conv32_3"),c=a("conv64_down"),u=a("conv64_1"),d=a("conv64_2"),h=a("conv64_3"),f=a("conv128_down"),p=a("conv128_1"),m=a("conv128_2"),g=a("conv256_down"),v=a("conv256_1"),y=a("conv256_2"),b=a("conv256_down_out"),x=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!wh(x,2))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+x);var w={conv32_down:i,conv32_1:o,conv32_2:s,conv32_3:l,conv64_down:c,conv64_1:u,conv64_2:d,conv64_3:h,conv128_down:f,conv128_1:p,conv128_2:m,conv256_down:g,conv256_1:v,conv256_2:y,conv256_down_out:b,fc:x};return _f(e,t),{params:w,paramMappings:t}}function pp(e,t){var n=function(e,t){return lp(e,t,[1,1],!0)}(e,t.conv1);return n=cp(n,t.conv2),n=ol(n,e),n=Lc(n)}function mp(e,t){var n=up(e,t.conv1);n=cp(n,t.conv2);var r=pc(e,2,2,"valid"),a=fn(r.shape),i=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){var o=bh(n.shape);o[1]=1;var s=fn(o),l=bh((n=yn([n,s],1)).shape);l[2]=1;var c=fn(l);n=yn([n,c],2)}return r=i?yn([r,a],3):r,n=ol(r,n),n=Lc(n)}var gp=function(e){function t(){return e.call(this,"FaceRecognitionNet")||this}return mh(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return Ft(function(){var n=up(Fh(e.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(sn(256)),t.conv32_down);n=pp(n=fc(n,3,2,"valid"),t.conv32_1),n=pp(n,t.conv32_2),n=pp(n,t.conv32_3),n=pp(n=mp(n,t.conv64_down),t.conv64_1),n=pp(n,t.conv64_2),n=pp(n,t.conv64_3),n=pp(n=mp(n,t.conv128_down),t.conv128_1),n=pp(n,t.conv128_2),n=pp(n=mp(n,t.conv256_down),t.conv256_1);var r=(n=mp(n=pp(n,t.conv256_2),t.conv256_down_out)).mean([1,2]);return rc(r,t.fc)})},t.prototype.forward=function(e){return vh(this,void 0,void 0,function(){var t;return yh(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,gf(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.computeFaceDescriptor=function(e){return vh(this,void 0,void 0,function(){var t,n,r,a=this;return yh(this,function(i){switch(i.label){case 0:return[4,gf(e)];case 1:return t=i.sent(),n=Ft(function(){return lr(a.forwardInput(t))}),[4,Promise.all(n.map(function(e){return e.data()}))];case 2:return r=i.sent(),n.forEach(function(e){return e.dispose()}),[2,t.isBatchInput?r:r[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return fp(e)},t.prototype.extractParams=function(e){return function(e){var t=Rf(e),n=t.extractWeights,r=t.getRemainingWeights,a=[],i=dp(n,a),o=i.extractConvLayerParams,s=i.extractResidualLayerParams,l=o(4704,32,7,"conv32_down"),c=s(9216,32,3,"conv32_1"),u=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),h=s(36864,64,3,"conv64_down",!0),f=s(36864,64,3,"conv64_1"),p=s(36864,64,3,"conv64_2"),m=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),v=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),b=s(589824,256,3,"conv256_down",!0),x=s(589824,256,3,"conv256_1"),w=s(589824,256,3,"conv256_2"),N=s(589824,256,3,"conv256_down_out"),S=Ft(function(){return zc(cn(n(32768),[128,256]),[1,0])});if(a.push({paramPath:"fc"}),0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{conv32_down:l,conv32_1:c,conv32_2:u,conv32_3:d,conv64_down:h,conv64_1:f,conv64_2:p,conv64_3:m,conv128_down:g,conv128_1:v,conv128_2:y,conv256_down:b,conv256_1:x,conv256_2:w,conv256_down_out:N,fc:S},paramMappings:a}}(e)},t}(Sf);function vp(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var yp=function(){function e(e){var t=void 0===e?{}:e,n=t.minFaceSize,r=t.scaleFactor,a=t.maxNumScales,i=t.scoreThresholds,o=t.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=r||.709,this._maxNumScales=a||10,this._scoreThresholds=i||[.6,.7,.7],this._scaleSteps=o,"number"!==typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!==typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!==typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some(function(e){return"number"!==typeof e}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(e){return"number"!==typeof e})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function bp(e,t){function n(n,r,a,i,o){var s=dn(e(n*r*a*a),[a,a,n,r]),l=ln(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/"+(o?"batch_norm_offset":"bias")}),{filters:s,bias:l}}function r(e,t,r,a){var i=n(e,t,r,a,!0);return{filters:i.filters,batch_norm_offset:i.bias}}function a(n,a,i){var o=function(n,r){var a=dn(e(9*n),[3,3,n,1]),i=ln(e(n)),o=ln(e(n)),s=ln(e(n)),l=ln(e(n));return t.push({paramPath:r+"/filters"},{paramPath:r+"/batch_norm_scale"},{paramPath:r+"/batch_norm_offset"},{paramPath:r+"/batch_norm_mean"},{paramPath:r+"/batch_norm_variance"}),{filters:a,batch_norm_scale:i,batch_norm_offset:o,batch_norm_mean:s,batch_norm_variance:l}}(n,i+"/depthwise_conv");return{depthwise_conv:o,pointwise_conv:r(n,a,1,i+"/pointwise_conv")}}return{extractMobilenetV1Params:function(){return{conv_0:r(3,32,3,"mobilenetv1/conv_0"),conv_1:a(32,64,"mobilenetv1/conv_1"),conv_2:a(64,128,"mobilenetv1/conv_2"),conv_3:a(128,128,"mobilenetv1/conv_3"),conv_4:a(128,256,"mobilenetv1/conv_4"),conv_5:a(256,256,"mobilenetv1/conv_5"),conv_6:a(256,512,"mobilenetv1/conv_6"),conv_7:a(512,512,"mobilenetv1/conv_7"),conv_8:a(512,512,"mobilenetv1/conv_8"),conv_9:a(512,512,"mobilenetv1/conv_9"),conv_10:a(512,512,"mobilenetv1/conv_10"),conv_11:a(512,512,"mobilenetv1/conv_11"),conv_12:a(512,1024,"mobilenetv1/conv_12"),conv_13:a(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:r(1024,256,1,"prediction_layer/conv_0"),conv_1:r(256,512,3,"prediction_layer/conv_1"),conv_2:r(512,128,1,"prediction_layer/conv_2"),conv_3:r(128,256,3,"prediction_layer/conv_3"),conv_4:r(256,128,1,"prediction_layer/conv_4"),conv_5:r(128,256,3,"prediction_layer/conv_5"),conv_6:r(256,64,1,"prediction_layer/conv_6"),conv_7:r(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}function xp(e){var t=[],n=function(e,t){var n=Df(e,t);function r(e,t,r){return{filters:n(e+"/Conv2d_"+t+"_pointwise/weights",4,r+"/filters"),batch_norm_offset:n(e+"/Conv2d_"+t+"_pointwise/convolution_bn_offset",1,r+"/batch_norm_offset")}}function a(e){var t="mobilenetv1/conv_"+e,a="MobilenetV1/Conv2d_"+e+"_depthwise",i=t+"/depthwise_conv",o=t+"/pointwise_conv";return{depthwise_conv:{filters:n(a+"/depthwise_weights",4,i+"/filters"),batch_norm_scale:n(a+"/BatchNorm/gamma",1,i+"/batch_norm_scale"),batch_norm_offset:n(a+"/BatchNorm/beta",1,i+"/batch_norm_offset"),batch_norm_mean:n(a+"/BatchNorm/moving_mean",1,i+"/batch_norm_mean"),batch_norm_variance:n(a+"/BatchNorm/moving_variance",1,i+"/batch_norm_variance")},pointwise_conv:r("MobilenetV1",e,o)}}function i(e,t){return{filters:n(e+"/weights",4,t+"/filters"),bias:n(e+"/biases",1,t+"/bias")}}function o(e){return{box_encoding_predictor:i("Prediction/BoxPredictor_"+e+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+e+"/box_encoding_predictor"),class_predictor:i("Prediction/BoxPredictor_"+e+"/ClassPredictor","prediction_layer/box_predictor_"+e+"/class_predictor")}}return{extractMobilenetV1Params:function(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}},extractPredictionLayerParams:function(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:o(0),box_predictor_1:o(1),box_predictor_2:o(2),box_predictor_3:o(3),box_predictor_4:o(4),box_predictor_5:o(5)}}}}(e,t),r=n.extractMobilenetV1Params,a=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Nh(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var o={mobilenetv1:r(),prediction_layer:a(),output_layer:{extra_dim:i}};return _f(e,t),{params:o,paramMappings:t}}function wp(e,t,n){return Ft(function(){var r=Kl(e,t.filters,n,"same");return r=ol(r,t.batch_norm_offset),ps(r,0,6)})}function Np(e,t){return Ft(function(){var n=null,r=wp(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach(function(e,t){var a=t+1,i=function(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}(a);r=function(e,t,n){return Ft(function(){var r=$l(e,t.filters,n,"same");return r=Qs(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,.0010000000474974513),ps(r,0,6)})}(r,e.depthwise_conv,i),r=wp(r,e.pointwise_conv,[1,1]),11===a&&(n=r)}),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function Sp(e,t,n){var r=e.arraySync(),a=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),o=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),l=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),u=Math.max(r[n][0],r[n][2]),d=Math.max(r[n][1],r[n][3]),h=(o-a)*(s-i),f=(u-l)*(d-c);if(h<=0||f<=0)return 0;var p=Math.max(a,l),m=Math.max(i,c),g=Math.min(o,u),v=Math.min(s,d),y=Math.max(g-p,0)*Math.max(v-m,0);return y/(h+f-y)}function Ep(e,t){var n=function(e){var t=lr(zc(e,[1,0])),n=[Cl(t[2],t[0]),Cl(t[3],t[1])];return{sizes:n,centers:[ol(t[0],ul(n[0],sn(2))),ol(t[1],ul(n[1],sn(2)))]}}(e),r=n.sizes,a=n.centers,i=lr(zc(t,[1,0])),o=ul(xl(ys(ul(i[2],sn(5))),r[0]),sn(2)),s=ol(xl(ul(i[0],sn(10)),r[0]),a[0]),l=ul(xl(ys(ul(i[3],sn(5))),r[1]),sn(2)),c=ol(xl(ul(i[1],sn(10)),r[1]),a[1]);return zc(ir([Cl(s,o),Cl(c,l),ol(s,o),ol(c,l)]),[1,0])}function Cp(e,t){return Ft(function(){var n=e.shape[0];return{boxPredictionEncoding:nr(Af(e,t.box_encoding_predictor),[n,-1,1,4]),classPrediction:nr(Af(e,t.class_predictor),[n,-1,3])}})}var kp=function(){function e(e){var t=void 0===e?{}:e,n=t.minConfidence,r=t.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=r||100,"number"!==typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!==typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),Ap=function(e){function t(){return e.call(this,"SsdMobilenetv1")||this}return mh(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return Ft(function(){var n=e.toBatchTensor(512,!1).toFloat(),r=Np(Cl(xl(n,sn(.007843137718737125)),sn(1)),t.mobilenetv1),a=function(e,t,n){return Ft(function(){var r=wp(e,n.conv_0,[1,1]),a=wp(r,n.conv_1,[2,2]),i=wp(a,n.conv_2,[1,1]),o=wp(i,n.conv_3,[2,2]),s=wp(o,n.conv_4,[1,1]),l=wp(s,n.conv_5,[2,2]),c=wp(l,n.conv_6,[1,1]),u=wp(c,n.conv_7,[2,2]),d=Cp(t,n.box_predictor_0),h=Cp(e,n.box_predictor_1),f=Cp(a,n.box_predictor_2),p=Cp(o,n.box_predictor_3),m=Cp(l,n.box_predictor_4),g=Cp(u,n.box_predictor_5);return{boxPredictions:yn([d.boxPredictionEncoding,h.boxPredictionEncoding,f.boxPredictionEncoding,p.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),classPredictions:yn([d.classPrediction,h.classPrediction,f.classPrediction,p.classPrediction,m.classPrediction,g.classPrediction],1)}})}(r.out,r.conv11,t.prediction_layer);return function(e,t,n){return Ft(function(){var r=e.shape[0],a=Ep(nr(or(n.extra_dim,[r,1,1]),[-1,4]),nr(e,[-1,4]));a=nr(a,[r,a.shape[0]/r,4]);var i=_s(yc(t,[0,0,1],[-1,-1,-1])),o=yc(i,[0,0,0],[-1,-1,1]);return o=nr(o,[r,o.shape[1]]),{boxes:lr(a),scores:lr(o)}})}(a.boxPredictions,a.classPredictions,t.output_layer)})},t.prototype.forward=function(e){return vh(this,void 0,void 0,function(){var t;return yh(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,gf(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.locateFaces=function(e,t){return void 0===t&&(t={}),vh(this,void 0,void 0,function(){var n,r,a,i,o,s,l,c,u,d,h,f,p,m,g,v,y,b,x,w;return yh(this,function(N){switch(N.label){case 0:return n=new kp(t),r=n.maxResults,a=n.minConfidence,[4,gf(e)];case 1:for(i=N.sent(),o=this.forwardInput(i),s=o.boxes,l=o.scores,c=s[0],u=l[0],d=1;d<s.length;d++)s[d].dispose(),l[d].dispose();return p=(f=Array).from,[4,u.data()];case 2:return h=p.apply(f,[N.sent()]),m=function(e,t,n,r,a){var i=e.shape[0],o=Math.min(n,i),s=t.map(function(e,t){return{score:e,boxIndex:t}}).filter(function(e){return e.score>a}).sort(function(e,t){return t.score-e.score}),l=function(e){return e<=r?1:0},c=[];return s.forEach(function(t){if(!(c.length>=o)){for(var n=t.score,r=c.length-1;r>=0;--r){var i=Sp(e,t.boxIndex,c[r]);if(0!==i&&(t.score*=l(i),t.score<=a))break}n===t.score&&c.push(t.boxIndex)}}),c}(c,h,r,.5,a),g=i.getReshapedInputDimensions(0),v=i.inputSize,y=v/g.width,b=v/g.height,x=c.arraySync(),w=m.map(function(e){var t=[Math.max(0,x[e][0]),Math.min(1,x[e][2])].map(function(e){return e*b}),n=t[0],r=t[1],a=[Math.max(0,x[e][1]),Math.min(1,x[e][3])].map(function(e){return e*y}),o=a[0],s=a[1];return new Dh(h[e],new Uh(o,n,s-o,r-n),{height:i.getInputHeight(0),width:i.getInputWidth(0)})}),c.dispose(),u.dispose(),[2,w]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return xp(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=Rf(e),r=n.extractWeights,a=n.getRemainingWeights,i=bp(r,t),o=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,l=o(),c=s(),u={extra_dim:un(r(20472),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{params:{mobilenetv1:l,prediction_layer:c,output_layer:u},paramMappings:t}}(e)},t}(Sf);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}mh(t,e)}(Ap);var _p,jp=[new Ih(.738768,.874946),new Ih(2.42204,2.65704),new Ih(4.30971,7.04493),new Ih(10.246,4.59428),new Ih(12.6868,11.8741)],Ip=[new Ih(1.603231,2.094468),new Ih(6.041143,7.080126),new Ih(2.882459,3.518061),new Ih(4.266906,5.178857),new Ih(9.041765,10.66308)],Tp=[117.001,114.697,97.404],Op=function(e){return"number"===typeof e};function Pp(e){return Ft(function(){var t=xl(e,sn(.10000000149011612));return ol(Lc(Cl(e,t)),t)})}function Dp(e,t){return Ft(function(){var n=Kn(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Kl(n,t.conv.filters,[1,1],"valid"),n=Cl(n,t.bn.sub),n=xl(n,t.bn.truediv),Pp(n=ol(n,t.conv.bias))})}function Rp(e,t){return Ft(function(){var n=Kn(e,[[0,0],[1,1],[1,1],[0,0]]);return n=ec(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),Pp(n=ol(n,t.bias))})}function Mp(e,t){var n=jf(e,t);var r=Of(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:function(r,a,i){var o=n(r,a,3,i+"/conv"),s=function(n,r){var a=ln(e(n)),i=ln(e(n));return t.push({paramPath:r+"/sub"},{paramPath:r+"/truediv"}),{sub:a,truediv:i}}(a,i+"/bn");return{conv:o,bn:s}},extractSeparableConvParams:r}}function Fp(e,t){var n=Df(e,t);function r(e){return{filters:n(e+"/filters",4),bias:n(e+"/bias",1)}}return{extractConvParams:r,extractConvWithBatchNormParams:function(e){var t=r(e+"/conv"),a=function(e){return{sub:n(e+"/sub",1),truediv:n(e+"/truediv",1)}}(e+"/bn");return{conv:t,bn:a}},extractSeparableConvParams:Pf(n)}}!function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"}(_p||(_p={}));var Lp=function(){function e(e){var t=void 0===e?{}:e,n=t.inputSize,r=t.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=r||.5,"number"!==typeof this._inputSize||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!==typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),Bp=function(e){function t(t){var n=e.call(this,"TinyYolov2")||this;return function(e){if(!e)throw new Error("invalid config: "+e);if("boolean"!==typeof e.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!Op(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(e){return"string"===typeof e}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(e){return e||{}}).every(function(e){return Op(e.x)&&Op(e.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||3!==e.meanRgb.length||!e.meanRgb.every(Op)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}(t),n._config=t,n}return mh(t,e),Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,t){var n=Dp(e,t.conv0);return n=Dp(n=fc(n,[2,2],[2,2],"same"),t.conv1),n=Dp(n=fc(n,[2,2],[2,2],"same"),t.conv2),n=Dp(n=fc(n,[2,2],[2,2],"same"),t.conv3),n=Dp(n=fc(n,[2,2],[2,2],"same"),t.conv4),n=Dp(n=fc(n,[2,2],[2,2],"same"),t.conv5),n=Dp(n=fc(n,[2,2],[1,1],"same"),t.conv6),Af(n=Dp(n,t.conv7),t.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,t){var n=this.config.isFirstLayerConv2d?Pp(Af(e,t.conv0,"valid",!1)):Rp(e,t.conv0);return n=Rp(n=fc(n,[2,2],[2,2],"same"),t.conv1),n=Rp(n=fc(n,[2,2],[2,2],"same"),t.conv2),n=Rp(n=fc(n,[2,2],[2,2],"same"),t.conv3),n=Rp(n=fc(n,[2,2],[2,2],"same"),t.conv4),n=Rp(n=fc(n,[2,2],[2,2],"same"),t.conv5),n=fc(n,[2,2],[1,1],"same"),n=t.conv6?Rp(n,t.conv6):n,Af(n=t.conv7?Rp(n,t.conv7):n,t.conv8,"valid",!1)},t.prototype.forwardInput=function(e,t){var n=this,r=this.params;if(!r)throw new Error("TinyYolov2 - load model before inference");return Ft(function(){var a=e.toBatchTensor(t,!1).toFloat();return a=(a=n.config.meanRgb?Fh(a,n.config.meanRgb):a).div(sn(256)),n.config.withSeparableConvs?n.runMobilenet(a,r):n.runTinyYolov2(a,r)})},t.prototype.forward=function(e,t){return vh(this,void 0,void 0,function(){var n;return yh(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,gf(e)];case 1:return[4,n.apply(this,[r.sent(),t])];case 2:return[2,r.sent()]}})})},t.prototype.detect=function(e,t){return void 0===t&&(t={}),vh(this,void 0,void 0,function(){var n,r,a,i,o,s,l,c,u,d,h,f,p,m=this;return yh(this,function(g){switch(g.label){case 0:return n=new Lp(t),r=n.inputSize,a=n.scoreThreshold,[4,gf(e)];case 1:return i=g.sent(),[4,this.forwardInput(i,r)];case 2:return o=g.sent(),s=Ft(function(){return lr(o)[0].expandDims()}),l={width:i.getInputWidth(0),height:i.getInputHeight(0)},[4,this.extractBoxes(s,i.getReshapedInputDimensions(0),a)];case 3:return c=g.sent(),o.dispose(),s.dispose(),u=c.map(function(e){return e.box}),d=c.map(function(e){return e.score}),h=c.map(function(e){return e.classScore}),f=c.map(function(e){return m.config.classes[e.label]}),p=Mh(u.map(function(e){return e.rescale(r)}),d,this.config.iouThreshold,!0),[2,p.map(function(e){return new Ph(d[e],h[e],f[e],u[e],l)})]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return function(e,t){var n,r=[],a=Fp(e,r),i=a.extractConvParams,o=a.extractConvWithBatchNormParams,s=a.extractSeparableConvParams;if(t.withSeparableConvs){var l=t.filterSizes&&t.filterSizes.length||9;n={conv0:t.isFirstLayerConv2d?i("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:l>7?s("conv6"):void 0,conv7:l>8?s("conv7"):void 0,conv8:i("conv8")}}else n={conv0:o("conv0"),conv1:o("conv1"),conv2:o("conv2"),conv3:o("conv3"),conv4:o("conv4"),conv5:o("conv5"),conv6:o("conv6"),conv7:o("conv7"),conv8:i("conv8")};return _f(e,r),{params:n,paramMappings:r}}(e,this.config)},t.prototype.extractParams=function(e){var n=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(7!==r&&8!==r&&9!==r)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return function(e,t,n,r){var a,i=Rf(e),o=i.extractWeights,s=i.getRemainingWeights,l=[],c=Mp(o,l),u=c.extractConvParams,d=c.extractConvWithBatchNormParams,h=c.extractSeparableConvParams;if(t.withSeparableConvs){var f=r[0],p=r[1],m=r[2],g=r[3],v=r[4],y=r[5],b=r[6],x=r[7],w=r[8];a={conv0:t.isFirstLayerConv2d?u(f,p,3,"conv0"):h(f,p,"conv0"),conv1:h(p,m,"conv1"),conv2:h(m,g,"conv2"),conv3:h(g,v,"conv3"),conv4:h(v,y,"conv4"),conv5:h(y,b,"conv5"),conv6:x?h(b,x,"conv6"):void 0,conv7:w?h(x,w,"conv7"):void 0,conv8:u(w||x||b,5*n,1,"conv8")}}else f=r[0],p=r[1],m=r[2],g=r[3],v=r[4],y=r[5],b=r[6],x=r[7],w=r[8],a={conv0:d(f,p,"conv0"),conv1:d(p,m,"conv1"),conv2:d(m,g,"conv2"),conv3:d(g,v,"conv3"),conv4:d(v,y,"conv4"),conv5:d(y,b,"conv5"),conv6:d(b,x,"conv6"),conv7:d(x,w,"conv7"),conv8:u(w,5*n,1,"conv8")};if(0!==s().length)throw new Error("weights remaing after extract: "+s().length);return{params:a,paramMappings:l}}(e,this.config,this.boxEncodingSize,n)},t.prototype.extractBoxes=function(e,t,n){return vh(this,void 0,void 0,function(){var r,a,i,o,s,l,c,u,d,h,f,p,m,g,v,y,b,x,w,N,S,E,C,k,A,_,j,I,T,O=this;return yh(this,function(P){switch(P.label){case 0:return r=t.width,a=t.height,i=Math.max(r,a),o=i/r,s=i/a,l=e.shape[1],c=this.config.anchors.length,u=Ft(function(){var t=e.reshape([l,l,c,O.boxEncodingSize]);return[t.slice([0,0,0,0],[l,l,c,4]),t.slice([0,0,0,4],[l,l,c,1]),O.withClassScores?Ar(t.slice([0,0,0,5],[l,l,c,O.config.classes.length]),3):sn(0)]}),d=u[0],h=u[1],f=u[2],p=[],[4,h.array()];case 1:return m=P.sent(),[4,d.array()];case 2:g=P.sent(),v=0,P.label=3;case 3:if(!(v<l))return[3,12];y=0,P.label=4;case 4:if(!(y<l))return[3,11];b=0,P.label=5;case 5:return b<c?(x=Lh(m[v][y][b][0]),!n||x>n?(w=(y+Lh(g[v][y][b][0]))/l*o,N=(v+Lh(g[v][y][b][1]))/l*s,S=Math.exp(g[v][y][b][2])*this.config.anchors[b].x/l*o,E=Math.exp(g[v][y][b][3])*this.config.anchors[b].y/l*s,C=w-S/2,k=N-E/2,A={row:v,col:y,anchor:b},this.withClassScores?[4,this.extractPredictedClass(f,A)]:[3,7]):[3,9]):[3,10];case 6:return T=P.sent(),[3,8];case 7:T={classScore:1,label:0},P.label=8;case 8:j=(_=T).classScore,I=_.label,p.push(gh({box:new Oh(C,k,C+S,k+E),score:x,classScore:x*j,label:I},A)),P.label=9;case 9:return b++,[3,5];case 10:return y++,[3,4];case 11:return v++,[3,3];case 12:return d.dispose(),h.dispose(),f.dispose(),[2,p]}})})},t.prototype.extractPredictedClass=function(e,t){return vh(this,void 0,void 0,function(){var n,r,a,i;return yh(this,function(o){switch(o.label){case 0:return n=t.row,r=t.col,a=t.anchor,[4,e.array()];case 1:return i=o.sent(),[2,Array(this.config.classes.length).fill(0).map(function(e,t){return i[n][r][a][t]}).map(function(e,t){return{classScore:e,label:t}}).reduce(function(e,t){return e.classScore>t.classScore?e:t})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Sf),Up=function(e){function t(t){void 0===t&&(t=!0);var n=Object.assign({},{withSeparableConvs:t,iouThreshold:.4,classes:["face"]},t?{anchors:Ip,meanRgb:Tp}:{anchors:jp,withClassScores:!0});return e.call(this,n)||this}return mh(t,e),Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,t){return vh(this,void 0,void 0,function(){return yh(this,function(n){switch(n.label){case 0:return[4,this.detect(e,t)];case 1:return[2,n.sent().map(function(e){return new Dh(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},t.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},t}(Bp);var zp=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name="TinyFaceDetectorOptions",t}return mh(t,e),t}(Lp),Vp=function(){function e(){}return e.prototype.then=function(e){return vh(this,void 0,void 0,function(){var t;return yh(this,function(n){switch(n.label){case 0:return t=e,[4,this.run()];case 1:return[2,t.apply(void 0,[n.sent()])]}})})},e.prototype.run=function(){return vh(this,void 0,void 0,function(){return yh(this,function(e){throw new Error("ComposableTask - run is not implemented")})})},e}();function Wp(e,t){var n={descriptor:t};return Object.assign({},e,n)}function qp(e,t,n,r,a){return void 0===a&&(a=function(e){return e.alignedRect}),vh(this,void 0,void 0,function(){var i,o,s,l,c;return yh(this,function(u){switch(u.label){case 0:return i=e.map(function(e){return Kf(e)?a(e):e.detection}),(s=r)?[3,5]:t instanceof me?[4,yf(t,i)]:[3,2];case 1:return l=u.sent(),[3,4];case 2:return[4,vf(t,i)];case 3:l=u.sent(),u.label=4;case 4:s=l,u.label=5;case 5:return[4,n(o=s)];case 6:return c=u.sent(),o.forEach(function(e){return e instanceof me&&e.dispose()}),[2,c]}})})}function Hp(e,t,n,r,a){return vh(this,void 0,void 0,function(){var i=this;return yh(this,function(o){return[2,qp([e],t,function(e){return vh(i,void 0,void 0,function(){return yh(this,function(t){return[2,n(e[0])]})})},r,a)]})})}function Gp(e){var t=Rf(e),n=t.extractWeights,r=t.getRemainingWeights,a=[],i=function(e,t){var n=jf(e,t),r=If(e,t);function a(n,r){var a=ln(e(n));return t.push({paramPath:r}),a}function i(e,t,r){return void 0===r&&(r=!1),{conv1:n(e[0],e[1],3,t+"/conv1"),prelu1_alpha:a(e[1],t+"/prelu1_alpha"),conv2:n(e[1],e[2],3,t+"/conv2"),prelu2_alpha:a(e[2],t+"/prelu2_alpha"),conv3:n(e[2],e[3],r?2:3,t+"/conv3"),prelu3_alpha:a(e[3],t+"/prelu3_alpha")}}return{extractPNetParams:function(){var e=i([3,10,16,32],"pnet"),t=n(32,2,1,"pnet/conv4_1"),r=n(32,4,1,"pnet/conv4_2");return gh(gh({},e),{conv4_1:t,conv4_2:r})},extractRNetParams:function(){var e=i([3,28,48,64],"rnet",!0),t=r(576,128,"rnet/fc1"),n=a(128,"rnet/prelu4_alpha"),o=r(128,2,"rnet/fc2_1"),s=r(128,4,"rnet/fc2_2");return gh(gh({},e),{fc1:t,prelu4_alpha:n,fc2_1:o,fc2_2:s})},extractONetParams:function(){var e=i([3,32,64,64],"onet"),t=n(64,128,2,"onet/conv4"),o=a(128,"onet/prelu4_alpha"),s=r(1152,256,"onet/fc1"),l=a(256,"onet/prelu5_alpha"),c=r(256,2,"onet/fc2_1"),u=r(256,4,"onet/fc2_2"),d=r(256,10,"onet/fc2_3");return gh(gh({},e),{conv4:t,prelu4_alpha:o,fc1:s,prelu5_alpha:l,fc2_1:c,fc2_2:u,fc2_3:d})}}}(n,a),o=i.extractPNetParams,s=i.extractRNetParams,l=i.extractONetParams,c=o(),u=s(),d=l();if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:c,rnet:u,onet:d},paramMappings:a}}function Kp(e){var t=[],n=function(e,t){var n=Df(e,t);function r(e){return{filters:n(e+"/weights",4,e+"/filters"),bias:n(e+"/bias",1)}}function a(e){return{weights:n(e+"/weights",2),bias:n(e+"/bias",1)}}function i(e){return n(e,1)}function o(e){return{conv1:r(e+"/conv1"),prelu1_alpha:i(e+"/prelu1_alpha"),conv2:r(e+"/conv2"),prelu2_alpha:i(e+"/prelu2_alpha"),conv3:r(e+"/conv3"),prelu3_alpha:i(e+"/prelu3_alpha")}}return{extractPNetParams:function(){var e=o("pnet"),t=r("pnet/conv4_1"),n=r("pnet/conv4_2");return gh(gh({},e),{conv4_1:t,conv4_2:n})},extractRNetParams:function(){var e=o("rnet"),t=a("rnet/fc1"),n=i("rnet/prelu4_alpha"),r=a("rnet/fc2_1"),s=a("rnet/fc2_2");return gh(gh({},e),{fc1:t,prelu4_alpha:n,fc2_1:r,fc2_2:s})},extractONetParams:function(){var e=o("onet"),t=r("onet/conv4"),n=i("onet/prelu4_alpha"),s=a("onet/fc1"),l=i("onet/prelu5_alpha"),c=a("onet/fc2_1"),u=a("onet/fc2_2"),d=a("onet/fc2_3");return gh(gh({},e),{conv4:t,prelu4_alpha:n,fc1:s,prelu5_alpha:l,fc2_1:c,fc2_2:u,fc2_3:d})}}}(e,t),r=n.extractPNetParams,a=n.extractRNetParams,i=n.extractONetParams,o=r(),s=a(),l=i();return _f(e,t),{params:{pnet:o,rnet:s,onet:l},paramMappings:t}}function Xp(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}var Yp=function(e){function t(t,n,r,a){return e.call(this,{left:t,top:n,right:r,bottom:a},!0)||this}return mh(t,e),t}(Th);function Qp(e){return Ft(function(){return xl(Cl(e,sn(127.5)),sn(.0078125))})}function $p(e,t){return Ft(function(){return ol(Lc(e),xl(t,Es(Lc(Es(e)))))})}function Jp(e,t,n){return void 0===n&&(n=!1),Ft(function(){var r=Af(e,t.conv1,"valid");return r=$p(r,t.prelu1_alpha),r=$p(r=Af(r=fc(r,n?[2,2]:[3,3],[2,2],"same"),t.conv2,"valid"),t.prelu2_alpha),r=$p(r=Af(r=n?r:fc(r,[3,3],[2,2],"valid"),t.conv3,"valid"),t.prelu3_alpha)})}function Zp(e,t,n,r,a){a.stage1=[];var i=t.map(function(t){return Ft(function(){var n={scale:t},a=function(e,t){return Ft(function(){var n=Xp(t,e.shape.slice(1)),r=n.height,a=n.width,i=Qp(Pu.resizeBilinear(e,[r,a]));return zc(i,[0,2,1,3])})}(e,t),i=Date.now(),o=function(e,t){return Ft(function(){var n=Jp(e,t,!0),r=Af(n,t.conv4_1,"valid"),a=Wn(jc(r,3),3);return{prob:Ar(Cl(r,a),3),regions:Af(n,t.conv4_2,"valid")}})}(a,r),s=o.prob,l=o.regions;return n.pnet=Date.now()-i,{scoresTensor:lr(lr(s,3)[1])[0],regionsTensor:lr(l)[0],scale:t,statsForScale:n}})}),o=i.map(function(e){var t=e.scoresTensor,r=e.regionsTensor,i=e.scale,o=e.statsForScale,s=function(e,t,n,r){for(var a=[],i=e.arraySync(),o=0;o<e.shape[0];o++)for(var s=0;s<e.shape[1];s++)i[o][s]>=r&&a.push(new Ih(s,o));return a.map(function(e){var r=new Oh(Math.round((2*e.y+1)/n),Math.round((2*e.x+1)/n),Math.round((2*e.y+12)/n),Math.round((2*e.x+12)/n)),a=i[e.y][e.x],o=t.arraySync();return{cell:r,score:a,region:new Yp(o[e.y][e.x][0],o[e.y][e.x][1],o[e.y][e.x][2],o[e.y][e.x][3])}})}(t,r,i,n);if(t.dispose(),r.dispose(),!s.length)return a.stage1.push(o),[];var l=Date.now(),c=Mh(s.map(function(e){return e.cell}),s.map(function(e){return e.score}),.5);return o.nms=Date.now()-l,o.numBoxes=c.length,a.stage1.push(o),c.map(function(e){return s[e]})}),s=o.reduce(function(e,t){return e.concat(t)},[]),l=[],c=[];if(s.length>0){var u=Date.now(),d=Mh(s.map(function(e){return e.cell}),s.map(function(e){return e.score}),.7);a.stage1_nms=Date.now()-u,c=d.map(function(e){return s[e].score}),l=d.map(function(e){return s[e]}).map(function(e){var t=e.cell,n=e.region;return new Oh(t.left+n.left*t.width,t.top+n.top*t.height,t.right+n.right*t.width,t.bottom+n.bottom*t.height).toSquare().round()})}return{boxes:l,scores:c}}function em(e,t,n){var r=n.width,a=n.height;return vh(this,void 0,void 0,function(){var n,i,o,s=this;return yh(this,function(l){switch(l.label){case 0:return n=af(e),[4,Promise.all(t.map(function(t){return vh(s,void 0,void 0,function(){var r,a,i,o,s,l,c,u;return yh(this,function(d){return r=t.padAtBorders(e.height,e.width),a=r.y,i=r.ey,o=r.x,s=r.ex,l=o-1,c=a-1,u=n.getImageData(l,c,s-l,i-c),[2,nf.isNodejs()?hf(u):createImageBitmap(u)]})})}))];case 1:return i=l.sent(),o=[],i.forEach(function(e){var t=af(df({width:r,height:a}));t.drawImage(e,0,0,r,a);for(var n=t.getImageData(0,0,r,a).data,i=[],s=0;s<n.length;s+=4)i.push(n[s+2]),i.push(n[s+1]),i.push(n[s]);o.push(i)}),[2,o.map(function(e){return Ft(function(){return Qp(zc(dn(e,[1,r,a,3]),[0,2,1,3]).toFloat())})})]}})})}function tm(e,t,n,r,a){return vh(this,void 0,void 0,function(){var i,o,s,l,c,u,d,h,f,p,m,g,v,y;return yh(this,function(b){switch(b.label){case 0:return i=Date.now(),[4,em(e,t,{width:24,height:24})];case 1:return o=b.sent(),a.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=o.map(function(e){var t=function(e,t){return Ft(function(){var n=Jp(e,t),r=$p(Uf(nr(n,[n.shape[0],t.fc1.weights.shape[0]]),t.fc1),t.prelu4_alpha),a=Uf(r,t.fc2_1),i=Wn(jc(a,1),1),o=Ar(Cl(a,i),1),s=Uf(r,t.fc2_2);return{scores:lr(o,1)[1],regions:s}})}(e,r);return e.dispose(),t}),a.stage2_rnet=Date.now()-i,l=s.length>1?yn(s.map(function(e){return e.scores})):s[0].scores,d=(u=Array).from,[4,l.data()];case 2:return c=d.apply(u,[b.sent()]),l.dispose(),h=c.map(function(e,t){return{score:e,idx:t}}).filter(function(e){return e.score>n}).map(function(e){return e.idx}),f=h.map(function(e){return t[e]}),p=h.map(function(e){return c[e]}),m=[],g=[],f.length>0&&(i=Date.now(),v=Mh(f,p,.7),a.stage2_nms=Date.now()-i,y=v.map(function(e){var t=s[h[e]].regions.arraySync();return new Yp(t[0][0],t[0][1],t[0][2],t[0][3])}),g=v.map(function(e){return p[e]}),m=v.map(function(e,t){return f[e].calibrate(y[t])})),s.forEach(function(e){e.regions.dispose(),e.scores.dispose()}),[2,{boxes:m,scores:g}]}})})}function nm(e,t,n,r,a){return vh(this,void 0,void 0,function(){var i,o,s,l,c,u,d,h,f,p,m,g,v,y,b;return yh(this,function(x){switch(x.label){case 0:return i=Date.now(),[4,em(e,t,{width:48,height:48})];case 1:return o=x.sent(),a.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=o.map(function(e){var t=function(e,t){return Ft(function(){var n=Jp(e,t);n=$p(n=Af(n=fc(n,[2,2],[2,2],"same"),t.conv4,"valid"),t.prelu4_alpha);var r=$p(Uf(nr(n,[n.shape[0],t.fc1.weights.shape[0]]),t.fc1),t.prelu5_alpha),a=Uf(r,t.fc2_1),i=Wn(jc(a,1),1),o=Ar(Cl(a,i),1),s=Uf(r,t.fc2_2),l=Uf(r,t.fc2_3);return{scores:lr(o,1)[1],regions:s,points:l}})}(e,r);return e.dispose(),t}),a.stage3_onet=Date.now()-i,l=s.length>1?yn(s.map(function(e){return e.scores})):s[0].scores,d=(u=Array).from,[4,l.data()];case 2:return c=d.apply(u,[x.sent()]),l.dispose(),h=c.map(function(e,t){return{score:e,idx:t}}).filter(function(e){return e.score>n}).map(function(e){return e.idx}),f=h.map(function(e){var t=s[e].regions.arraySync();return new Yp(t[0][0],t[0][1],t[0][2],t[0][3])}),p=h.map(function(e,n){return t[e].calibrate(f[n])}),m=h.map(function(e){return c[e]}),g=[],v=[],y=[],p.length>0&&(i=Date.now(),b=Mh(p,m,.7,!1),a.stage3_nms=Date.now()-i,g=b.map(function(e){return p[e]}),v=b.map(function(e){return m[e]}),y=b.map(function(e,t){return Array(5).fill(0).map(function(n,r){var a=s[e].points.arraySync();return new Ih(a[0][r]*(g[t].width+1)+g[t].left,a[0][r+5]*(g[t].height+1)+g[t].top)})})),s.forEach(function(e){e.regions.dispose(),e.scores.dispose(),e.points.dispose()}),[2,{boxes:g,scores:v,points:y}]}})})}var rm=function(e){function t(){return e.call(this,"Mtcnn")||this}return mh(t,e),t.prototype.load=function(t){return vh(this,void 0,void 0,function(){return yh(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,t)]})})},t.prototype.loadFromDisk=function(t){return vh(this,void 0,void 0,function(){return yh(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,t)]})})},t.prototype.forwardInput=function(e,t){return void 0===t&&(t={}),vh(this,void 0,void 0,function(){var n,r,a,i,o,s,l,c,u,d,h,f,p,m,g,v,y,b,x,w,N;return yh(this,function(S){switch(S.label){case 0:if(!(n=this.params))throw new Error("Mtcnn - load model before inference");if(!(r=e.canvases[0]))throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},i=Date.now(),o=Ft(function(){return e=Wn(Jd.fromPixels(r)).toFloat(),Ft(function(){return ir(lr(e,3).reverse(),3)});var e}),s=function(e){return o.dispose(),a.total=Date.now()-i,e},l=o.shape.slice(1),c=l[0],u=l[1],d=new yp(t),h=d.minFaceSize,f=d.scaleFactor,p=d.maxNumScales,m=d.scoreThresholds,g=d.scaleSteps,v=(g||function(e,t,n){for(var r=n[0],a=n[1],i=12/e,o=[],s=Math.min(r,a)*i,l=0;s>=12;)o.push(i*Math.pow(t,l)),s*=t,l+=1;return o}(h,f,[c,u])).filter(function(e){var t=Xp(e,[c,u]);return Math.min(t.width,t.height)>12}).slice(0,p),a.scales=v,a.pyramid=v.map(function(e){return Xp(e,[c,u])}),y=Date.now(),[4,Zp(o,v,m[0],n.pnet,a)];case 1:return b=S.sent(),a.total_stage1=Date.now()-y,b.boxes.length?(a.stage2_numInputBoxes=b.boxes.length,y=Date.now(),[4,tm(r,b.boxes,m[1],n.rnet,a)]):[2,s({results:[],stats:a})];case 2:return x=S.sent(),a.total_stage2=Date.now()-y,x.boxes.length?(a.stage3_numInputBoxes=x.boxes.length,y=Date.now(),[4,nm(r,x.boxes,m[2],n.onet,a)]):[2,s({results:[],stats:a})];case 3:return w=S.sent(),a.total_stage3=Date.now()-y,N=w.boxes.map(function(e,t){return Xf(Kh({},new Dh(w.scores[t],new Uh(e.left/u,e.top/c,e.width/u,e.height/c),{height:c,width:u})),new Vh(w.points[t].map(function(t){return t.sub(new Ih(e.left,e.top)).div(new Ih(e.width,e.height))}),{width:e.width,height:e.height}))}),[2,s({results:N,stats:a})]}})})},t.prototype.forward=function(e,t){return void 0===t&&(t={}),vh(this,void 0,void 0,function(){var n;return yh(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,gf(e)];case 1:return[4,n.apply(this,[r.sent(),t])];case 2:return[2,r.sent().results]}})})},t.prototype.forwardWithStats=function(e,t){return void 0===t&&(t={}),vh(this,void 0,void 0,function(){var n;return yh(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,gf(e)];case 1:return[2,n.apply(this,[r.sent(),t])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Kp(e)},t.prototype.extractParams=function(e){return Gp(e)},t}(Sf),am=[new Ih(1.603231,2.094468),new Ih(6.041143,7.080126),new Ih(2.882459,3.518061),new Ih(4.266906,5.178857),new Ih(9.041765,10.66308)],im=[117.001,114.697,97.404],om=function(e){function t(){var t={withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:am,meanRgb:im,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return e.call(this,t)||this}return mh(t,e),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,t){return vh(this,void 0,void 0,function(){return yh(this,function(n){switch(n.label){case 0:return[4,this.detect(e,t)];case 1:return[2,n.sent().map(function(e){return new Dh(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},t}(Bp),sm={ssdMobilenetv1:new Ap,tinyFaceDetector:new om,tinyYolov2:new Up,mtcnn:new rm,faceLandmark68Net:new ip,faceLandmark68TinyNet:new sp,faceRecognitionNet:new gp,faceExpressionNet:new Hf,ageGenderNet:new rp};function lm(e,t){var n={age:t};return Object.assign({},e,n)}var cm=function(e){function t(t,n,r){var a=e.call(this)||this;return a.parentTask=t,a.input=n,a.extractedFaces=r,a}return mh(t,e),t}(Vp),um=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.run=function(){return vh(this,void 0,void 0,function(){var e,t,n=this;return yh(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,qp(e=r.sent(),this.input,function(e){return vh(n,void 0,void 0,function(){return yh(this,function(t){switch(t.label){case 0:return[4,Promise.all(e.map(function(e){return sm.faceExpressionNet.predictExpressions(e)}))];case 1:return[2,t.sent()]}})})},this.extractedFaces)];case 2:return t=r.sent(),[2,e.map(function(e,n){return Gf(e,t[n])})]}})})},t.prototype.withAgeAndGender=function(){return new mm(this,this.input)},t}(cm),dm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.run=function(){return vh(this,void 0,void 0,function(){var e,t;return yh(this,function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(e=n.sent())?[4,Hp(e,this.input,function(e){return sm.faceExpressionNet.predictExpressions(e)},this.extractedFaces)]:[2];case 2:return t=n.sent(),[2,Gf(e,t)]}})})},t.prototype.withAgeAndGender=function(){return new gm(this,this.input)},t}(cm),hm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.withAgeAndGender=function(){return new vm(this,this.input)},t.prototype.withFaceDescriptors=function(){return new xm(this,this.input)},t}(um),fm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.withAgeAndGender=function(){return new ym(this,this.input)},t.prototype.withFaceDescriptor=function(){return new wm(this,this.input)},t}(dm),pm=function(e){function t(t,n,r){var a=e.call(this)||this;return a.parentTask=t,a.input=n,a.extractedFaces=r,a}return mh(t,e),t}(Vp),mm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.run=function(){return vh(this,void 0,void 0,function(){var e,t,n=this;return yh(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,qp(e=r.sent(),this.input,function(e){return vh(n,void 0,void 0,function(){return yh(this,function(t){switch(t.label){case 0:return[4,Promise.all(e.map(function(e){return sm.ageGenderNet.predictAgeAndGender(e)}))];case 1:return[2,t.sent()]}})})},this.extractedFaces)];case 2:return t=r.sent(),[2,e.map(function(e,n){var r=t[n],a=r.age;return lm(vp(e,r.gender,r.genderProbability),a)})]}})})},t.prototype.withFaceExpressions=function(){return new um(this,this.input)},t}(pm),gm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.run=function(){return vh(this,void 0,void 0,function(){var e,t,n,r,a;return yh(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return(e=i.sent())?[4,Hp(e,this.input,function(e){return sm.ageGenderNet.predictAgeAndGender(e)},this.extractedFaces)]:[2];case 2:return t=i.sent(),n=t.age,r=t.gender,a=t.genderProbability,[2,lm(vp(e,r,a),n)]}})})},t.prototype.withFaceExpressions=function(){return new dm(this,this.input)},t}(pm),vm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.withFaceExpressions=function(){return new hm(this,this.input)},t.prototype.withFaceDescriptors=function(){return new xm(this,this.input)},t}(mm),ym=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.withFaceExpressions=function(){return new fm(this,this.input)},t.prototype.withFaceDescriptor=function(){return new wm(this,this.input)},t}(gm),bm=function(e){function t(t,n){var r=e.call(this)||this;return r.parentTask=t,r.input=n,r}return mh(t,e),t}(Vp),xm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.run=function(){return vh(this,void 0,void 0,function(){var e;return yh(this,function(t){switch(t.label){case 0:return[4,this.parentTask];case 1:return[4,qp(e=t.sent(),this.input,function(e){return Promise.all(e.map(function(e){return sm.faceRecognitionNet.computeFaceDescriptor(e)}))},null,function(e){return e.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return[2,t.sent().map(function(t,n){return Wp(e[n],t)})]}})})},t.prototype.withFaceExpressions=function(){return new hm(this,this.input)},t.prototype.withAgeAndGender=function(){return new vm(this,this.input)},t}(bm),wm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.run=function(){return vh(this,void 0,void 0,function(){var e,t;return yh(this,function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(e=n.sent())?[4,Hp(e,this.input,function(e){return sm.faceRecognitionNet.computeFaceDescriptor(e)},null,function(e){return e.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return t=n.sent(),[2,Wp(e,t)]}})})},t.prototype.withFaceExpressions=function(){return new fm(this,this.input)},t.prototype.withAgeAndGender=function(){return new ym(this,this.input)},t}(bm),Nm=function(e){function t(t,n,r){var a=e.call(this)||this;return a.parentTask=t,a.input=n,a.useTinyLandmarkNet=r,a}return mh(t,e),Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?sm.faceLandmark68TinyNet:sm.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Vp),Sm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.run=function(){return vh(this,void 0,void 0,function(){var e,t,n,r,a,i=this;return yh(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return e=o.sent(),t=e.map(function(e){return e.detection}),this.input instanceof me?[4,yf(this.input,t)]:[3,3];case 2:return r=o.sent(),[3,5];case 3:return[4,vf(this.input,t)];case 4:r=o.sent(),o.label=5;case 5:return n=r,[4,Promise.all(n.map(function(e){return i.landmarkNet.detectLandmarks(e)}))];case 6:return a=o.sent(),n.forEach(function(e){return e instanceof me&&e.dispose()}),[2,e.map(function(e,t){return Xf(e,a[t])})]}})})},t.prototype.withFaceExpressions=function(){return new hm(this,this.input)},t.prototype.withAgeAndGender=function(){return new vm(this,this.input)},t.prototype.withFaceDescriptors=function(){return new xm(this,this.input)},t}(Nm),Em=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.run=function(){return vh(this,void 0,void 0,function(){var e,t,n,r,a;return yh(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return(e=i.sent())?(t=e.detection,this.input instanceof me?[4,yf(this.input,[t])]:[3,3]):[2];case 2:return r=i.sent(),[3,5];case 3:return[4,vf(this.input,[t])];case 4:r=i.sent(),i.label=5;case 5:return n=r,[4,this.landmarkNet.detectLandmarks(n[0])];case 6:return a=i.sent(),n.forEach(function(e){return e instanceof me&&e.dispose()}),[2,Xf(e,a)]}})})},t.prototype.withFaceExpressions=function(){return new fm(this,this.input)},t.prototype.withAgeAndGender=function(){return new ym(this,this.input)},t.prototype.withFaceDescriptor=function(){return new wm(this,this.input)},t}(Nm),Cm=function(e){function t(t,n){void 0===n&&(n=new kp);var r=e.call(this)||this;return r.input=t,r.options=n,r}return mh(t,e),t}(Vp),km=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mh(t,e),t.prototype.run=function(){return vh(this,void 0,void 0,function(){var e,t,n,r;return yh(this,function(a){switch(a.label){case 0:return t=(e=this).input,(n=e.options)instanceof yp?[4,sm.mtcnn.forward(t,n)]:[3,2];case 1:return[2,a.sent().map(function(e){return e.detection})];case 2:if(r=n instanceof zp?function(e){return sm.tinyFaceDetector.locateFaces(e,n)}:n instanceof kp?function(e){return sm.ssdMobilenetv1.locateFaces(e,n)}:n instanceof Lp?function(e){return sm.tinyYolov2.locateFaces(e,n)}:null,!r)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,r(t)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise(function(t){return vh(e,void 0,void 0,function(){var e;return yh(this,function(n){switch(n.label){case 0:return[4,this.run()];case 1:return e=n.sent(),[2,t(e.map(function(e){return Kh({},e)}))]}})})})},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new Sm(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new um(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new mm(this.runAndExtendWithFaceDetections(),this.input)},t}(Cm);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}mh(t,e),t.prototype.run=function(){return vh(this,void 0,void 0,function(){var e,t;return yh(this,function(n){switch(n.label){case 0:return[4,new km(this.input,this.options)];case 1:return e=n.sent(),t=e[0],e.forEach(function(e){e.score>t.score&&(t=e)}),[2,t]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise(function(t){return vh(e,void 0,void 0,function(){var e;return yh(this,function(n){switch(n.label){case 0:return[4,this.run()];case 1:return e=n.sent(),[2,t(e?Kh({},e):void 0)]}})})})},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new Em(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new dm(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new gm(this.runAndExtendWithFaceDetection(),this.input)}}(Cm);function Am(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(function(e,t){return e-r[t]}).reduce(function(e,t){return e+Math.pow(t,2)},0))}!function(){function e(e,t){void 0===t&&(t=.6),this._distanceThreshold=t;var n=Array.isArray(e)?e:[e];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var r=1,a=function(){return"person "+r++};this._labeledDescriptors=n.map(function(e){if(e instanceof Gh)return e;if(e instanceof Float32Array)return new Gh(a(),[e]);if(e.descriptor&&e.descriptor instanceof Float32Array)return new Gh(a(),[e.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(e,t){return t.map(function(t){return Am(t,e)}).reduce(function(e,t){return e+t},0)/(t.length||1)},e.prototype.matchDescriptor=function(e){var t=this;return this.labeledDescriptors.map(function(n){var r=n.descriptors,a=n.label;return new qh(a,t.computeMeanDistance(e,r))}).reduce(function(e,t){return e.distance<t.distance?e:t})},e.prototype.findBestMatch=function(e){var t=this.matchDescriptor(e);return t.distance<this.distanceThreshold?t:new qh("unknown",t.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(e){return e.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(e){return Gh.fromJSON(e)});return new e(n,t.distanceThreshold)}}();const _m=new class{constructor(){this.isInitialized=!1,this.modelsLoaded=!1}async initialize(){if(!this.isInitialized)try{console.log("\ud83d\ude80 Initializing face recognition service...");const e="/models";await Promise.all([sm.tinyFaceDetector.loadFromUri(e),sm.faceLandmark68Net.loadFromUri(e),sm.faceRecognitionNet.loadFromUri(e)]),this.modelsLoaded=!0,this.isInitialized=!0,console.log("\u2705 Face recognition models loaded successfully")}catch(e){throw console.error("\u274c Error initializing face recognition:",e),new Error("Failed to initialize face recognition service")}}async detectFaces(e){this.isInitialized||await this.initialize();try{return await(t=e,n=new zp,void 0===n&&(n=new kp),new km(t,n)).withFaceLandmarks().withFaceDescriptors()}catch(r){return console.error("\u274c Error detecting faces:",r),[]}var t,n}async getFaceDescriptor(e){const t=await this.detectFaces(e);if(0===t.length)throw new Error("No face detected in the image");if(t.length>1)throw new Error("Multiple faces detected. Please ensure only one face is visible");return t[0].descriptor}compareFaces(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.45;if(!e||!t)return{match:!1,distance:1,confidence:0};const r=Am(e,t),a=r<n,i=Math.max(0,Math.min(100,100*(1-r)));return{match:a,distance:r,confidence:Math.round(i)}}async verifyFace(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.45;try{const r=await this.getFaceDescriptor(e),a=this.compareFaces(r,t,n);return{success:a.match,confidence:a.confidence,distance:a.distance,message:a.match?"Face verified with ".concat(a.confidence,"% confidence"):"Face verification failed (".concat(a.confidence,"% confidence)")}}catch(r){return{success:!1,confidence:0,error:r.message}}}async registerFace(e){try{const t=await this.getFaceDescriptor(e);return{success:!0,descriptor:Array.from(t),message:"Face registered successfully"}}catch(t){return{success:!1,error:t.message}}}findBestMatch(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.45,a=null,i=1/0;return t.forEach((t,o)=>{const s=Am(e,new Float32Array(t));s<i&&s<r&&(i=s,a={label:n[o],distance:s,confidence:Math.round(100*(1-s))})}),a}async identifyFace(e,t){try{const n=await this.getFaceDescriptor(e),r=t.map(e=>e.descriptor),a=t.map(e=>e.label||e.studentId),i=this.findBestMatch(n,r,a);return i?{success:!0,match:i,message:"Identified as ".concat(i.label," with ").concat(i.confidence,"% confidence")}:{success:!1,message:"No matching face found in database"}}catch(n){return{success:!1,error:n.message}}}async validateImageQuality(e){const t=await this.detectFaces(e);if(0===t.length)return{valid:!1,message:"No face detected"};if(t.length>1)return{valid:!1,message:"Multiple faces detected"};const n=t[0].detection.box;if(n.width<80||n.height<80)return{valid:!1,message:"Face too small - please move closer"};const r=e.width||e.videoWidth,a=e.height||e.videoHeight;return n.x<10||n.y<10||n.x+n.width>r-10||n.y+n.height>a-10?{valid:!1,message:"Please center your face in the frame"}:{valid:!0,message:"Face quality is good"}}async detectEyeLandmarks(e){try{const t=await this.detectFaces(e);if(0===t.length)return{success:!1,message:"No face detected"};if(t.length>1)return{success:!1,message:"Multiple faces detected"};const n=t[0].landmarks,r=n.positions.slice(36,42);return{success:!0,leftEye:r,rightEye:n.positions.slice(42,48),landmarks:n.positions}}catch(t){return console.error("Error detecting eye landmarks:",t),{success:!1,message:"Failed to detect eye landmarks"}}}calculateEAR(e){if(6!==e.length)return 0;const t=e[1],n=e[5],r=e[2],a=e[4],i=e[0],o=e[3];return(Math.sqrt(Math.pow(n.x-o.x,2)+Math.pow(n.y-o.y,2))+Math.sqrt(Math.pow(r.x-a.x,2)+Math.pow(r.y-a.y,2)))/(2*Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)))}async detectBlink(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25;try{const n=await this.detectEyeLandmarks(e);if(!n.success)return{success:!1,message:n.message};const r=this.calculateEAR(n.leftEye),a=this.calculateEAR(n.rightEye),i=(r+a)/2;return{success:!0,isBlinking:i<t,leftEAR:r,rightEAR:a,avgEAR:i,threshold:t}}catch(n){return console.error("Error detecting blink:",n),{success:!1,message:"Failed to detect blink"}}}async verifyFaceMultiFrame(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.45;try{const i=[],o=document.createElement("canvas"),s=o.getContext("2d");o.width=e.videoWidth||640,o.height=e.videoHeight||480;for(let f=0;f<n;f++){s.drawImage(e,0,0,o.width,o.height);const l=o.toDataURL("image/jpeg",.8),c=new Image;await new Promise((e,t)=>{c.onload=()=>e(),c.onerror=()=>t(new Error("Failed to load frame")),c.src=l});try{const e=await this.getFaceDescriptor(c),n=this.compareFaces(e,t,r);i.push({frameIndex:f,match:n.match,distance:n.distance,confidence:n.confidence})}catch(a){console.warn("Frame ".concat(f," failed:"),a.message),i.push({frameIndex:f,match:!1,distance:1,confidence:0,error:a.message})}f<n-1&&await new Promise(e=>setTimeout(e,500))}const l=i.filter(e=>!e.error),c=l.filter(e=>e.match),u=l.length>0?c.length/l.length:0,d=l.length>0?l.reduce((e,t)=>e+t.confidence,0)/l.length:0,h=u>=.67;return{success:h,results:i,successRate:Math.round(100*u),avgConfidence:Math.round(d),validFrames:l.length,matchingFrames:c.length,message:h?"Face verified across ".concat(c.length,"/").concat(l.length," frames"):"Verification failed - only ".concat(c.length,"/").concat(l.length," frames matched")}}catch(a){return console.error("Multi-frame verification error:",a),{success:!1,error:a.message,message:"Multi-frame verification failed"}}}async checkEncodingQuality(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;try{if(!e||0===e.length)return{isGoodQuality:!1,quality:0,message:"No face descriptor available"};const n=e.reduce((e,t)=>e+t,0)/e.length,r=e.reduce((e,t)=>e+Math.pow(t-n,2),0)/e.length,a=Math.min(r,1),i=a>t;return{isGoodQuality:i,quality:Math.round(100*a),variance:r,message:i?"Face encoding quality is good":"Face encoding quality is poor - consider re-registering"}}catch(n){return console.error("Error checking encoding quality:",n),{isGoodQuality:!1,quality:0,message:"Failed to check encoding quality"}}}computeFaceDistance(e,t){if(!e||!t)return 1;try{return Am(e,t)}catch(n){return console.error("Error computing face distance:",n),1}}},jm=_m},4208:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.uniqBy=function(e,t){const n=new Map;for(let r=0;r<e.length;r++){const a=e[r],i=t(a);n.has(i)||n.set(i,a)}return Array.from(n.values())}},4288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,m(x,v.prototype),x.isPureReactComponent=!0;var w=Array.isArray,N={H:null,A:null,T:null,S:null,V:null},S=Object.prototype.hasOwnProperty;function E(e,t,r,a,i,o){return r=o.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:o}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function _(){}function j(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(s){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case h:return j((u=e._init)(e._payload),t,a,i,o)}}if(u)return o=o(e),u=""===i?"."+A(e,0):i,w(o)?(a="",null!=u&&(a=u.replace(k,"$&/")+"/"),j(o,t,a,"",function(e){return e})):null!=o&&(C(o)&&(l=o,c=a+(null==o.key||e&&e.key===o.key?"":(""+o.key).replace(k,"$&/")+"/")+u,o=E(l.type,c,void 0,0,0,l.props)),t.push(o)),1;u=0;var d,p=""===i?".":i+":";if(w(e))for(var m=0;m<e.length;m++)u+=j(i=e[m],t,a,s=p+A(i,m),o);else if("function"===typeof(m=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=f&&d[f]||d["@@iterator"])?d:null))for(e=m.call(e),m=0;!(i=e.next()).done;)u+=j(i=i.value,t,a,s=p+A(i,m++),o);else if("object"===s){if("function"===typeof e.then)return j(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(_,_):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,a,i,o);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function I(e,t,n){if(null==e)return e;var r=[],a=0;return j(e,r,"","",function(e){return t.call(n,e,a++)}),r}function T(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function P(){}t.Children={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return N.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=m({},e.props),a=e.key;if(null!=t)for(i in void 0!==t.ref&&void 0,void 0!==t.key&&(a=""+t.key),t)!S.call(t,i)||"key"===i||"__self"===i||"__source"===i||"ref"===i&&void 0===t.ref||(r[i]=t[i]);var i=arguments.length-2;if(1===i)r.children=n;else if(1<i){for(var o=Array(i),s=0;s<i;s++)o[s]=arguments[s+2];r.children=o}return E(e.type,a,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:s,_context:e},e},t.createElement=function(e,t,n){var r,a={},i=null;if(null!=t)for(r in void 0!==t.key&&(i=""+t.key),t)S.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(a[r]=t[r]);var o=arguments.length-2;if(1===o)a.children=n;else if(1<o){for(var s=Array(o),l=0;l<o;l++)s[l]=arguments[l+2];a.children=s}if(e&&e.defaultProps)for(r in o=e.defaultProps)void 0===a[r]&&(a[r]=o[r]);return E(e,i,void 0,0,0,a)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=N.T,n={};N.T=n;try{var r=e(),a=N.S;null!==a&&a(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(P,O)}catch(i){O(i)}finally{N.T=t}},t.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},t.use=function(e){return N.H.use(e)},t.useActionState=function(e,t,n){return N.H.useActionState(e,t,n)},t.useCallback=function(e,t){return N.H.useCallback(e,t)},t.useContext=function(e){return N.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return N.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var r=N.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,t)},t.useId=function(){return N.H.useId()},t.useImperativeHandle=function(e,t,n){return N.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return N.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return N.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return N.H.useMemo(e,t)},t.useOptimistic=function(e,t){return N.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return N.H.useReducer(e,t,n)},t.useRef=function(e){return N.H.useRef(e)},t.useState=function(e){return N.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return N.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return N.H.useTransition()},t.version="19.1.1"},4332:(e,t,n)=>{e.exports=n(5053).uniqBy},4391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(7004)},4459:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},4537:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},4566:e=>{function t(){this.buffer=[],this.length=0}t.prototype={get:function(e){const t=Math.floor(e/8);return 1===(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(let n=0;n<t;n++)this.putBit(1===(e>>>t-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},e.exports=t},4596:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},4651:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},4661:e=>{function t(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}t.prototype.set=function(e,t,n,r){const a=e*this.size+t;this.data[a]=n,r&&(this.reservedBit[a]=!0)},t.prototype.get=function(e,t){return this.data[e*this.size+t]},t.prototype.xor=function(e,t,n){this.data[e*this.size+t]^=n},t.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},e.exports=t},4704:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=/^(?:0|[1-9]\d*)$/;t.isIndex=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_SAFE_INTEGER;switch(typeof e){case"number":return Number.isInteger(e)&&e>=0&&e<t;case"symbol":return!1;case"string":return n.test(e)}}},4705:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function i(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{A:()=>i})},4772:(e,t,n)=>{const r=n(7969),a=n(6272),i=n(4566),o=n(4661),s=n(9382),l=n(9021),c=n(4833),u=n(1805),d=n(8177),h=n(4980),f=n(350),p=n(7421),m=n(4004);function g(e,t,n){const r=e.size,a=f.getEncodedBits(t,n);let i,o;for(i=0;i<15;i++)o=1===(a>>i&1),i<6?e.set(i,8,o,!0):i<8?e.set(i+1,8,o,!0):e.set(r-15+i,8,o,!0),i<8?e.set(8,r-i-1,o,!0):i<9?e.set(8,15-i-1+1,o,!0):e.set(8,15-i-1,o,!0);e.set(r-8,8,1,!0)}function v(e,t,n){const a=new i;n.forEach(function(t){a.put(t.mode.bit,4),a.put(t.getLength(),p.getCharCountIndicator(t.mode,e)),t.write(a)});const o=8*(r.getSymbolTotalCodewords(e)-u.getTotalCodewordsCount(e,t));for(a.getLengthInBits()+4<=o&&a.put(0,4);a.getLengthInBits()%8!==0;)a.putBit(0);const s=(o-a.getLengthInBits())/8;for(let r=0;r<s;r++)a.put(r%2?17:236,8);return function(e,t,n){const a=r.getSymbolTotalCodewords(t),i=u.getTotalCodewordsCount(t,n),o=a-i,s=u.getBlocksCount(t,n),l=a%s,c=s-l,h=Math.floor(a/s),f=Math.floor(o/s),p=f+1,m=h-f,g=new d(m);let v=0;const y=new Array(s),b=new Array(s);let x=0;const w=new Uint8Array(e.buffer);for(let r=0;r<s;r++){const e=r<c?f:p;y[r]=w.slice(v,v+e),b[r]=g.encode(y[r]),v+=e,x=Math.max(x,e)}const N=new Uint8Array(a);let S,E,C=0;for(S=0;S<x;S++)for(E=0;E<s;E++)S<y[E].length&&(N[C++]=y[E][S]);for(S=0;S<m;S++)for(E=0;E<s;E++)N[C++]=b[E][S];return N}(a,e,t)}function y(e,t,n,a){let i;if(Array.isArray(e))i=m.fromArray(e);else{if("string"!==typeof e)throw new Error("Invalid data");{let r=t;if(!r){const t=m.rawSplit(e);r=h.getBestVersionForData(t,n)}i=m.fromString(e,r||40)}}const u=h.getBestVersionForData(i,n);if(!u)throw new Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<u)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+u+".\n")}else t=u;const d=v(t,n,i),f=r.getSymbolSize(t),p=new o(f);return function(e,t){const n=e.size,r=l.getPositions(t);for(let a=0;a<r.length;a++){const t=r[a][0],i=r[a][1];for(let r=-1;r<=7;r++)if(!(t+r<=-1||n<=t+r))for(let a=-1;a<=7;a++)i+a<=-1||n<=i+a||(r>=0&&r<=6&&(0===a||6===a)||a>=0&&a<=6&&(0===r||6===r)||r>=2&&r<=4&&a>=2&&a<=4?e.set(t+r,i+a,!0,!0):e.set(t+r,i+a,!1,!0))}}(p,t),function(e){const t=e.size;for(let n=8;n<t-8;n++){const t=n%2===0;e.set(n,6,t,!0),e.set(6,n,t,!0)}}(p),function(e,t){const n=s.getPositions(t);for(let r=0;r<n.length;r++){const t=n[r][0],a=n[r][1];for(let n=-2;n<=2;n++)for(let r=-2;r<=2;r++)-2===n||2===n||-2===r||2===r||0===n&&0===r?e.set(t+n,a+r,!0,!0):e.set(t+n,a+r,!1,!0)}}(p,t),g(p,n,0),t>=7&&function(e,t){const n=e.size,r=h.getEncodedBits(t);let a,i,o;for(let s=0;s<18;s++)a=Math.floor(s/3),i=s%3+n-8-3,o=1===(r>>s&1),e.set(a,i,o,!0),e.set(i,a,o,!0)}(p,t),function(e,t){const n=e.size;let r=-1,a=n-1,i=7,o=0;for(let s=n-1;s>0;s-=2)for(6===s&&s--;;){for(let n=0;n<2;n++)if(!e.isReserved(a,s-n)){let r=!1;o<t.length&&(r=1===(t[o]>>>i&1)),e.set(a,s-n,r),i--,-1===i&&(o++,i=7)}if(a+=r,a<0||n<=a){a-=r,r=-r;break}}}(p,d),isNaN(a)&&(a=c.getBestMask(p,g.bind(null,p,n))),c.applyMask(a,p),g(p,n,a),{modules:p,version:t,errorCorrectionLevel:n,maskPattern:a,segments:i}}t.create=function(e,t){if("undefined"===typeof e||""===e)throw new Error("No input text");let n,i,o=a.M;return"undefined"!==typeof t&&(o=a.from(t.errorCorrectionLevel,a.M),n=h.from(t.version),i=c.from(t.maskPattern),t.toSJISFunc&&r.setToSJISFunction(t.toSJISFunc)),y(e,n,o,i)}},4803:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isPrimitive=function(e){return null==e||"object"!==typeof e&&"function"!==typeof e}},4830:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.debounce=function(e,t){let n,{signal:r,edges:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=null;const o=null!=a&&a.includes("leading"),s=null==a||a.includes("trailing"),l=()=>{null!==i&&(e.apply(n,i),n=void 0,i=null)};let c=null;const u=()=>{null!=c&&clearTimeout(c),c=setTimeout(()=>{c=null,s&&l(),d()},t)},d=()=>{null!==c&&(clearTimeout(c),c=null),n=void 0,i=null},h=function(){if(null!==r&&void 0!==r&&r.aborted)return;n=this;for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];i=t;const s=null==c;u(),o&&s&&l()};return h.schedule=u,h.cancel=d,h.flush=()=>{l()},null===r||void 0===r||r.addEventListener("abort",d,{once:!0}),h}},4833:(e,t)=>{t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const n=3,r=3,a=40,i=10;function o(e,n,r){switch(e){case t.Patterns.PATTERN000:return(n+r)%2===0;case t.Patterns.PATTERN001:return n%2===0;case t.Patterns.PATTERN010:return r%3===0;case t.Patterns.PATTERN011:return(n+r)%3===0;case t.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(r/3))%2===0;case t.Patterns.PATTERN101:return n*r%2+n*r%3===0;case t.Patterns.PATTERN110:return(n*r%2+n*r%3)%2===0;case t.Patterns.PATTERN111:return(n*r%3+(n+r)%2)%2===0;default:throw new Error("bad maskPattern:"+e)}}t.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},t.from=function(e){return t.isValid(e)?parseInt(e,10):void 0},t.getPenaltyN1=function(e){const t=e.size;let r=0,a=0,i=0,o=null,s=null;for(let l=0;l<t;l++){a=i=0,o=s=null;for(let c=0;c<t;c++){let t=e.get(l,c);t===o?a++:(a>=5&&(r+=n+(a-5)),o=t,a=1),t=e.get(c,l),t===s?i++:(i>=5&&(r+=n+(i-5)),s=t,i=1)}a>=5&&(r+=n+(a-5)),i>=5&&(r+=n+(i-5))}return r},t.getPenaltyN2=function(e){const t=e.size;let n=0;for(let r=0;r<t-1;r++)for(let a=0;a<t-1;a++){const t=e.get(r,a)+e.get(r,a+1)+e.get(r+1,a)+e.get(r+1,a+1);4!==t&&0!==t||n++}return n*r},t.getPenaltyN3=function(e){const t=e.size;let n=0,r=0,i=0;for(let a=0;a<t;a++){r=i=0;for(let o=0;o<t;o++)r=r<<1&2047|e.get(a,o),o>=10&&(1488===r||93===r)&&n++,i=i<<1&2047|e.get(o,a),o>=10&&(1488===i||93===i)&&n++}return n*a},t.getPenaltyN4=function(e){let t=0;const n=e.data.length;for(let r=0;r<n;r++)t+=e.data[r];return Math.abs(Math.ceil(100*t/n/5)-10)*i},t.applyMask=function(e,t){const n=t.size;for(let r=0;r<n;r++)for(let a=0;a<n;a++)t.isReserved(a,r)||t.xor(a,r,o(e,a,r))},t.getBestMask=function(e,n){const r=Object.keys(t.Patterns).length;let a=0,i=1/0;for(let o=0;o<r;o++){n(o),t.applyMask(o,e);const r=t.getPenaltyN1(e)+t.getPenaltyN2(e)+t.getPenaltyN3(e)+t.getPenaltyN4(e);t.applyMask(o,e),r<i&&(i=r,a=o)}return a}},4879:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6770);t.toFinite=function(e){if(!e)return 0===e?e:0;if((e=r.toNumber(e))===1/0||e===-1/0){return(e<0?-1:1)*Number.MAX_VALUE}return e===e?e:0}},4919:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},4980:(e,t,n)=>{const r=n(7969),a=n(1805),i=n(6272),o=n(7421),s=n(3257),l=r.getBCHDigit(7973);function c(e,t){return o.getCharCountIndicator(e,t)+4}function u(e,t){let n=0;return e.forEach(function(e){const r=c(e.mode,t);n+=r+e.getBitsLength()}),n}t.from=function(e,t){return s.isValid(e)?parseInt(e,10):t},t.getCapacity=function(e,t,n){if(!s.isValid(e))throw new Error("Invalid QR Code version");"undefined"===typeof n&&(n=o.BYTE);const i=8*(r.getSymbolTotalCodewords(e)-a.getTotalCodewordsCount(e,t));if(n===o.MIXED)return i;const l=i-c(n,e);switch(n){case o.NUMERIC:return Math.floor(l/10*3);case o.ALPHANUMERIC:return Math.floor(l/11*2);case o.KANJI:return Math.floor(l/13);case o.BYTE:default:return Math.floor(l/8)}},t.getBestVersionForData=function(e,n){let r;const a=i.from(n,i.M);if(Array.isArray(e)){if(e.length>1)return function(e,n){for(let r=1;r<=40;r++)if(u(e,r)<=t.getCapacity(r,n,o.MIXED))return r}(e,a);if(0===e.length)return 1;r=e[0]}else r=e;return function(e,n,r){for(let a=1;a<=40;a++)if(n<=t.getCapacity(a,r,e))return a}(r.mode,r.getLength(),a)},t.getEncodedBits=function(e){if(!s.isValid(e)||e<7)throw new Error("Invalid QR Code version");let t=e<<12;for(;r.getBCHDigit(t)-l>=0;)t^=7973<<r.getBCHDigit(t)-l;return e<<12|t}},5016:(e,t,n)=>{"use strict";n.d(t,{A:()=>u,O:()=>d});var r=n(9379),a=n(5043),i=n(823),o=n(1121),s=n(9308),l=n(579);const c=(0,a.createContext)(),u=()=>(0,a.useContext)(c),d=e=>{let{children:t}=e;const[n,u]=(0,a.useState)(null),[d,h]=(0,a.useState)(null),[f,p]=(0,a.useState)(!0);(0,a.useEffect)(()=>(0,i.hg)(o.auth,async e=>{if(e){const t=await(0,s.LU)(e.uid);t.success&&(u(e),h((0,r.A)((0,r.A)({},t.userData),{},{uid:e.uid})))}else u(null),h(null);p(!1)}),[]);const m={currentUser:n,userData:d,loading:f};return(0,l.jsx)(c.Provider,{value:m,children:!f&&t})}},5043:(e,t,n)=>{"use strict";e.exports=n(4288)},5053:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(4208),a=n(9599),i=n(2104),o=n(2715);t.uniqBy=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.identity;return i.isArrayLikeObject(e)?r.uniqBy(Array.from(e),o.iteratee(t)):[]}},5082:(e,t)=>{"use strict";var n=60103,r=60106,a=60107,i=60108,o=60114,s=60109,l=60110,c=60112,u=60113,d=60120,h=60115,f=60116,p=60121,m=60122,g=60117,v=60129,y=60131;if("function"===typeof Symbol&&Symbol.for){var b=Symbol.for;n=b("react.element"),r=b("react.portal"),a=b("react.fragment"),i=b("react.strict_mode"),o=b("react.profiler"),s=b("react.provider"),l=b("react.context"),c=b("react.forward_ref"),u=b("react.suspense"),d=b("react.suspense_list"),h=b("react.memo"),f=b("react.lazy"),p=b("react.block"),m=b("react.server.block"),g=b("react.fundamental"),v=b("react.debug_trace_mode"),y=b("react.legacy_hidden")}function x(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case a:case o:case i:case u:case d:return e;default:switch(e=e&&e.$$typeof){case l:case c:case f:case h:case s:return e;default:return t}}case r:return t}}}t.isFragment=function(e){return x(e)===a}},5087:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},5088:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},5180:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function a(e,t,r){var a=null;if(void 0!==r&&(a=""+r),void 0!==t.key&&(a=""+t.key),"key"in t)for(var i in r={},t)"key"!==i&&(r[i]=t[i]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:a,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=a,t.jsxs=a},5200:(e,t,n)=>{const r=n(7421),a=n(7969);function i(e){this.mode=r.KANJI,this.data=e}i.getBitsLength=function(e){return 13*e},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let n=a.toSJIS(this.data[t]);if(n>=33088&&n<=40956)n-=33088;else{if(!(n>=57408&&n<=60351))throw new Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");n-=49472}n=192*(n>>>8&255)+(255&n),e.put(n,13)}},e.exports=i},5261:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6433);t.cloneDeep=function(e){return r.cloneDeepWithImpl(e,void 0,e,new Map,void 0)}},5303:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2489),a=n(4704),i=n(6321),o=n(1444);t.has=function(e,t){let n;if(n=Array.isArray(t)?t:"string"===typeof t&&r.isDeepKey(t)&&null==(null===e||void 0===e?void 0:e[t])?o.toPath(t):[t],0===n.length)return!1;let s=e;for(let r=0;r<n.length;r++){const e=n[r];if(null==s||!Object.hasOwn(s,e)){if(!((Array.isArray(s)||i.isArguments(s))&&a.isIndex(e)&&e<s.length))return!1}s=s[e]}return!0}},5316:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9709),a=n(7043),i=n(1444);t.orderBy=function(e,t,n,o){if(null==e)return[];n=o?void 0:n,Array.isArray(e)||(e=Object.values(e)),Array.isArray(t)||(t=null==t?[null]:[t]),0===t.length&&(t=[null]),Array.isArray(n)||(n=null==n?[]:[n]),n=n.map(e=>String(e));const s=(e,t)=>{let n=e;for(let r=0;r<t.length&&null!=n;++r)n=n[t[r]];return n},l=t.map(e=>(Array.isArray(e)&&1===e.length&&(e=e[0]),null==e||"function"===typeof e||Array.isArray(e)||a.isKey(e)?e:{key:e,path:i.toPath(e)}));return e.map(e=>({original:e,criteria:l.map(t=>((e,t)=>null==t||null==e?t:"object"===typeof e&&"key"in e?Object.hasOwn(t,e.key)?t[e.key]:s(t,e.path):"function"===typeof e?e(t):Array.isArray(e)?s(t,e):"object"===typeof t?t[e]:t)(t,e))})).slice().sort((e,t)=>{for(let a=0;a<l.length;a++){const i=r.compareValues(e.criteria[a],t.criteria[a],n[a]);if(0!==i)return i}return 0}).map(e=>e.original)}},5327:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},5352:(e,t,n)=>{"use strict";n.d(t,{BV:()=>Oe,C5:()=>je,Kd:()=>dt,Zp:()=>de,g:()=>he,qh:()=>Ie});var r=n(3986),a=n(9379),i=n(5043);const o=["sri"],s=["page"],l=["page","matches"],c=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],u=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],d=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var h="popstate";function f(){return x(function(e,t){let{pathname:n,search:r,hash:a}=e.location;return v("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:y(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function p(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function m(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function g(e,t){return{usr:e.state,key:e.key,idx:t}}function v(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return(0,a.A)((0,a.A)({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?b(t):t),{},{state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function y(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function b(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function x(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:i=document.defaultView,v5Compat:o=!1}=r,s=i.history,l="POP",c=null,u=d();function d(){return(s.state||{idx:null}).idx}function f(){l="POP";let e=d(),t=null==e?null:e-u;u=e,c&&c({action:l,location:m.location,delta:t})}function p(e){return w(e)}null==u&&(u=0,s.replaceState((0,a.A)((0,a.A)({},s.state),{},{idx:u}),""));let m={get action(){return l},get location(){return e(i,s)},listen(e){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(h,f),c=e,()=>{i.removeEventListener(h,f),c=null}},createHref:e=>t(i,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l="PUSH";let r=v(m.location,e,t);n&&n(r,e),u=d()+1;let a=g(r,u),h=m.createHref(r);try{s.pushState(a,"",h)}catch(f){if(f instanceof DOMException&&"DataCloneError"===f.name)throw f;i.location.assign(h)}o&&c&&c({action:l,location:m.location,delta:1})},replace:function(e,t){l="REPLACE";let r=v(m.location,e,t);n&&n(r,e),u=d();let a=g(r,u),i=m.createHref(r);s.replaceState(a,"",i),o&&c&&c({action:l,location:m.location,delta:0})},go:e=>s.go(e)};return m}function w(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),p(n,"No window.location.(origin|href) available to create URL");let r="string"===typeof e?e:y(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}new WeakMap;function N(e,t){return S(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function S(e,t,n,r){let a=L(("string"===typeof t?b(t):t).pathname||"/",n);if(null==a)return null;let i=E(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let o=null;for(let s=0;null==o&&s<i.length;++s){let e=F(a);o=D(i[s],e,r)}return o}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=function(e,i){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a,s=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(r)&&o)return;p(l.relativePath.startsWith(r),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(r.length)}let c=W([r,l.relativePath]),u=n.concat(l);e.children&&e.children.length>0&&(p(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),E(e.children,t,u,c,o)),(null!=e.path||e.index)&&t.push({path:c,score:P(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let r of C(e.path))i(e,t,!0,r);else i(e,t)}),t}function C(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return a?[i,""]:[i];let o=C(r.join("/")),s=[];return s.push(...o.map(e=>""===e?i:[i,e].join("/"))),a&&s.push(...o),s.map(t=>e.startsWith("/")&&""===t?"/":t)}var k=/^:[\w-]+$/,A=3,_=2,j=1,I=10,T=-2,O=e=>"*"===e;function P(e,t){let n=e.split("/"),r=n.length;return n.some(O)&&(r+=T),t&&(r+=_),n.filter(e=>!O(e)).reduce((e,t)=>e+(k.test(t)?A:""===t?j:I),r)}function D(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,a={},i="/",o=[];for(let s=0;s<r.length;++s){let e=r[s],l=s===r.length-1,c="/"===i?t:t.slice(i.length)||"/",u=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),o.push({params:a,pathname:W([i,u.pathname]),pathnameBase:q(W([i,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(i=W([i,u.pathnameBase]))}return o}function R(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=M(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=s[n]||"";o=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:i,pathnameBase:o,pattern:e}}function M(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];m("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function F(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return m(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function L(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function B(e,t,n,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function U(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function z(e){let t=U(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function V(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=b(e):(r=(0,a.A)({},e),p(!r.pathname||!r.pathname.includes("?"),B("?","pathname","search",r)),p(!r.pathname||!r.pathname.includes("#"),B("#","pathname","hash",r)),p(!r.search||!r.search.includes("#"),B("#","search","hash",r)));let o,s=""===e||""===r.pathname,l=s?"/":r.pathname;if(null==l)o=n;else{let e=t.length-1;if(!i&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}o=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:r="",hash:a=""}="string"===typeof e?b(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:H(r),hash:G(a)}}(r,o),u=l&&"/"!==l&&l.endsWith("/"),d=(s||"."===l)&&n.endsWith("/");return c.pathname.endsWith("/")||!u&&!d||(c.pathname+="/"),c}var W=e=>e.join("/").replace(/\/\/+/g,"/"),q=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),H=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",G=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function K(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var X=["POST","PUT","PATCH","DELETE"],Y=(new Set(X),["GET",...X]);new Set(Y),Symbol("ResetLoaderData");var Q=i.createContext(null);Q.displayName="DataRouter";var $=i.createContext(null);$.displayName="DataRouterState";var J=i.createContext(!1);var Z=i.createContext({isTransitioning:!1});Z.displayName="ViewTransition";var ee=i.createContext(new Map);ee.displayName="Fetchers";var te=i.createContext(null);te.displayName="Await";var ne=i.createContext(null);ne.displayName="Navigation";var re=i.createContext(null);re.displayName="Location";var ae=i.createContext({outlet:null,matches:[],isDataRoute:!1});ae.displayName="Route";var ie=i.createContext(null);ie.displayName="RouteError";var oe=!0;function se(){return null!=i.useContext(re)}function le(){return p(se(),"useLocation() may be used only in the context of a <Router> component."),i.useContext(re).location}var ce="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ue(e){i.useContext(ne).static||i.useLayoutEffect(e)}function de(){let{isDataRoute:e}=i.useContext(ae);return e?function(){let{router:e}=we("useNavigate"),t=Se("useNavigate"),n=i.useRef(!1);ue(()=>{n.current=!0});let r=i.useCallback(async function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};m(n.current,ce),n.current&&("number"===typeof r?e.navigate(r):await e.navigate(r,(0,a.A)({fromRouteId:t},i)))},[e,t]);return r}():function(){p(se(),"useNavigate() may be used only in the context of a <Router> component.");let e=i.useContext(Q),{basename:t,navigator:n}=i.useContext(ne),{matches:r}=i.useContext(ae),{pathname:a}=le(),o=JSON.stringify(z(r)),s=i.useRef(!1);ue(()=>{s.current=!0});let l=i.useCallback(function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(m(s.current,ce),!s.current)return;if("number"===typeof r)return void n.go(r);let l=V(r,JSON.parse(o),a,"path"===i.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:W([t,l.pathname])),(i.replace?n.replace:n.push)(l,i.state,i)},[t,n,o,a,e]);return l}()}i.createContext(null);function he(){let{matches:e}=i.useContext(ae),t=e[e.length-1];return t?t.params:{}}function fe(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=i.useContext(ae),{pathname:r}=le(),a=JSON.stringify(z(n));return i.useMemo(()=>V(e,JSON.parse(a),r,"path"===t),[e,a,r,t])}function pe(e,t,n,r,o){p(se(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=i.useContext(ne),{matches:l}=i.useContext(ae),c=l[l.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",f=c&&c.route;if(oe){let e=f&&f.path||"";ke(d,!f||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(d,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let g,v=le();if(t){var y;let e="string"===typeof t?b(t):t;p("/"===h||(null===(y=e.pathname)||void 0===y?void 0:y.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),g=e}else g=v;let x=g.pathname||"/",w=x;if("/"!==h){let e=h.replace(/^\//,"").split("/");w="/"+x.replace(/^\//,"").split("/").slice(e.length).join("/")}let S=N(e,{pathname:w});oe&&(m(f||null!=S,'No routes matched location "'.concat(g.pathname).concat(g.search).concat(g.hash,'" ')),m(null==S||void 0!==S[S.length-1].route.element||void 0!==S[S.length-1].route.Component||void 0!==S[S.length-1].route.lazy,'Matched leaf route at location "'.concat(g.pathname).concat(g.search).concat(g.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.')));let E=be(S&&S.map(e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:W([h,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:W([h,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),l,n,r,o);return t&&E?i.createElement(re.Provider,{value:{location:(0,a.A)({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:"POP"}},E):E}function me(){let e=Ee(),t=K(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},s=null;return oe&&(console.error("Error handled by React Router default ErrorBoundary:",e),s=i.createElement(i.Fragment,null,i.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),i.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",i.createElement("code",{style:o},"ErrorBoundary")," or"," ",i.createElement("code",{style:o},"errorElement")," prop on your route."))),i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},t),n?i.createElement("pre",{style:a},n):null,s)}var ge=i.createElement(me,null),ve=class extends i.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?i.createElement(ae.Provider,{value:this.props.routeContext},i.createElement(ie.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ye(e){let{routeContext:t,match:n,children:r}=e,a=i.useContext(Q);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(ae.Provider,{value:t},r)}function be(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let a=e,o=null===n||void 0===n?void 0:n.errors;if(null!=o){let e=a.findIndex(e=>e.route.id&&void 0!==(null===o||void 0===o?void 0:o[e.route.id]));p(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(o).join(","))),a=a.slice(0,Math.min(a.length,e+1))}let s=!1,l=-1;if(n)for(let i=0;i<a.length;i++){let e=a[i];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=i),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){s=!0,a=l>=0?a.slice(0,l+1):[a[0]];break}}}return a.reduceRight((e,c,u)=>{let d,h=!1,f=null,p=null;n&&(d=o&&c.route.id?o[c.route.id]:void 0,f=c.route.errorElement||ge,s&&(l<0&&0===u?(ke("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,p=null):l===u&&(h=!0,p=c.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,u+1)),g=()=>{let t;return t=d?f:h?p:c.route.Component?i.createElement(c.route.Component,null):c.route.element?c.route.element:e,i.createElement(ye,{match:c,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(c.route.ErrorBoundary||c.route.errorElement||0===u)?i.createElement(ve,{location:n.location,revalidation:n.revalidation,component:f,error:d,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0},unstable_onError:r}):g()},null)}function xe(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function we(e){let t=i.useContext(Q);return p(t,xe(e)),t}function Ne(e){let t=i.useContext($);return p(t,xe(e)),t}function Se(e){let t=function(e){let t=i.useContext(ae);return p(t,xe(e)),t}(e),n=t.matches[t.matches.length-1];return p(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function Ee(){var e;let t=i.useContext(ie),n=Ne("useRouteError"),r=Se("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[r]}var Ce={};function ke(e,t,n){t||Ce[e]||(Ce[e]=!0,m(!1,n))}var Ae={};function _e(e,t){e||Ae[t]||(Ae[t]=!0,console.warn(t))}i.memo(function(e){let{routes:t,future:n,state:r,unstable_onError:a}=e;return pe(t,void 0,r,a,n)});function je(e){let{to:t,replace:n,state:r,relative:a}=e;p(se(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=i.useContext(ne);m(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=i.useContext(ae),{pathname:l}=le(),c=de(),u=V(t,z(s),l,"path"===a),d=JSON.stringify(u);return i.useEffect(()=>{c(JSON.parse(d),{replace:n,state:r,relative:a})},[c,d,a,n,r]),null}function Ie(e){p(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Te(e){let{basename:t="/",children:n=null,location:r,navigationType:a="POP",navigator:o,static:s=!1}=e;p(!se(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=i.useMemo(()=>({basename:l,navigator:o,static:s,future:{}}),[l,o,s]);"string"===typeof r&&(r=b(r));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:g="default"}=r,v=i.useMemo(()=>{let e=L(u,l);return null==e?null:{location:{pathname:e,search:d,hash:h,state:f,key:g},navigationType:a}},[l,u,d,h,f,g,a]);return m(null!=v,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(u).concat(d).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==v?null:i.createElement(ne.Provider,{value:c},i.createElement(re.Provider,{children:n,value:v}))}function Oe(e){let{children:t,location:n}=e;return pe(Pe(t),n)}i.Component;function Pe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return i.Children.forEach(e,(e,r)=>{if(!i.isValidElement(e))return;let a=[...t,r];if(e.type===i.Fragment)return void n.push.apply(n,Pe(e.props.children,a));p(e.type===Ie,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),p(!e.props.index||!e.props.children,"An index route cannot have child routes.");let o={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=Pe(e.props.children,a)),n.push(o)}),n}var De="get",Re="application/x-www-form-urlencoded";function Me(e){return null!=e&&"string"===typeof e.tagName}var Fe=null;var Le=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Be(e){return null==e||Le.has(e)?e:(m(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Re,'"')),null)}function Ue(e,t){let n,r,a,i,o;if(Me(s=e)&&"form"===s.tagName.toLowerCase()){let o=e.getAttribute("action");r=o?L(o,t):null,n=e.getAttribute("method")||De,a=Be(e.getAttribute("enctype"))||Re,i=new FormData(e)}else if(function(e){return Me(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Me(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let o=e.form;if(null==o)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||o.getAttribute("action");if(r=s?L(s,t):null,n=e.getAttribute("formmethod")||o.getAttribute("method")||De,a=Be(e.getAttribute("formenctype"))||Be(o.getAttribute("enctype"))||Re,i=new FormData(o,e),!function(){if(null===Fe)try{new FormData(document.createElement("form"),0),Fe=!1}catch(e){Fe=!0}return Fe}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?"".concat(t,"."):"";i.append("".concat(e,"x"),"0"),i.append("".concat(e,"y"),"0")}else t&&i.append(t,r)}}else{if(Me(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=De,r=null,a=Re,o=e}var s;return i&&"text/plain"===a&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function ze(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function Ve(e,t,n){let r="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.".concat(n):t&&"/"===L(r.pathname,t)?r.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):r.pathname="".concat(r.pathname.replace(/\/$/,""),".").concat(n),r}async function We(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function qe(e){return null!=e&&"string"===typeof e.page}function He(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ge(e,t,n,r,a,i){let o=(e,t)=>!n[t]||e.route.id!==n[t].route.id,s=(e,t)=>{var r;return n[t].pathname!==e.pathname||(null===(r=n[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===i?t.filter((e,t)=>o(e,t)||s(e,t)):"data"===i?t.filter((t,i)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(o(t,i)||s(t,i))return!0;if(t.route.shouldRevalidate){var c;let r=t.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0}):[]}function Ke(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1),[...new Set(r)];var r}function Xe(e,t){let n=new Set,r=new Set(t);return e.reduce((e,a)=>{if(t&&!qe(a)&&"script"===a.as&&a.href&&r.has(a.href))return e;let i=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(a));return n.has(i)||(n.add(i),e.push({key:i,link:a})),e},[])}function Ye(e,t){return"lazy"===e.mode&&!0===t}function Qe(){let e=i.useContext(Q);return ze(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function $e(){let e=i.useContext($);return ze(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Je=i.createContext(void 0);function Ze(){let e=i.useContext(Je);return ze(e,"You must render this element inside a <HydratedRouter> element"),e}function et(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function tt(e,t,n){if(n&&!it)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}Je.displayName="FrameworkContext";function nt(e){let{page:t}=e,n=(0,r.A)(e,s),{router:o}=Qe(),l=i.useMemo(()=>N(o.routes,t,o.basename),[o.routes,t,o.basename]);return l?i.createElement(at,(0,a.A)({page:t,matches:l},n)):null}function rt(e){let{manifest:t,routeModules:n}=Ze(),[r,o]=i.useState([]);return i.useEffect(()=>{let r=!1;return async function(e,t,n){return Xe((await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await We(r,n);return e.links?e.links():[]}return[]}))).flat(1).filter(He).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?(0,a.A)((0,a.A)({},e),{},{rel:"prefetch",as:"style"}):(0,a.A)((0,a.A)({},e),{},{rel:"prefetch"})))}(e,t,n).then(e=>{r||o(e)}),()=>{r=!0}},[e,t,n]),r}function at(e){let{page:t,matches:n}=e,o=(0,r.A)(e,l),s=le(),{manifest:c,routeModules:u}=Ze(),{basename:d}=Qe(),{loaderData:h,matches:f}=$e(),p=i.useMemo(()=>Ge(t,n,f,c,s,"data"),[t,n,f,c,s]),m=i.useMemo(()=>Ge(t,n,f,c,s,"assets"),[t,n,f,c,s]),g=i.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let e=new Set,r=!1;if(n.forEach(t=>{var n;let a=c.routes[t.route.id];a&&a.hasLoader&&(!p.some(e=>e.route.id===t.route.id)&&t.route.id in h&&null!==(n=u[t.route.id])&&void 0!==n&&n.shouldRevalidate||a.hasClientLoader?r=!0:e.add(t.route.id))}),0===e.size)return[];let a=Ve(t,d,"data");return r&&e.size>0&&a.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[a.pathname+a.search]},[d,h,s,c,p,n,t,u]),v=i.useMemo(()=>Ke(m,c),[m,c]),y=rt(m);return i.createElement(i.Fragment,null,g.map(e=>i.createElement("link",(0,a.A)({key:e,rel:"prefetch",as:"fetch",href:e},o))),v.map(e=>i.createElement("link",(0,a.A)({key:e,rel:"modulepreload",href:e},o))),y.map(e=>{let{key:t,link:n}=e;return i.createElement("link",(0,a.A)({key:t,nonce:o.nonce},n))}))}var it=!1;function ot(e){let{manifest:t,serverHandoffString:n,isSpaMode:s,renderMeta:l,routeDiscovery:c,ssr:u}=Ze(),{router:d,static:h,staticContext:f}=Qe(),{matches:p}=$e(),m=i.useContext(J),g=Ye(c,u);l&&(l.didRenderScripts=!0);let v=tt(p,null,s);i.useEffect(()=>{it=!0},[]);let y=i.useMemo(()=>{var s;if(m)return null;let l=f?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",c=h?"".concat(null!==(s=t.hmr)&&void 0!==s&&s.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(v.map((e,n)=>{let r="route".concat(n),a=t.routes[e.route.id];ze(a,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:i,clientLoaderModule:o,clientMiddlewareModule:s,hydrateFallbackModule:l,module:c}=a,u=[...i?[{module:i,varName:"".concat(r,"_clientAction")}]:[],...o?[{module:o,varName:"".concat(r,"_clientLoader")}]:[],...s?[{module:s,varName:"".concat(r,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(r,"_HydrateFallback")}]:[],{module:c,varName:"".concat(r,"_main")}];return 1===u.length?"import * as ".concat(r," from ").concat(JSON.stringify(c),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(r," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,i=(0,r.A)(e,o),s=new Set(t.state.matches.map(e=>e.route.id)),l=t.state.location.pathname.split("/").filter(Boolean),c=["/"];for(l.pop();l.length>0;)c.push("/".concat(l.join("/"))),l.pop();c.forEach(e=>{let n=N(t.routes,e,t.basename);n&&n.forEach(e=>s.add(e.route.id))});let u=[...s].reduce((e,t)=>Object.assign(e,{[t]:i.routes[t]}),{});return(0,a.A)((0,a.A)({},i),{},{routes:u,sri:!!n||void 0})}(t,d),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(v.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return i.createElement(i.Fragment,null,i.createElement("script",(0,a.A)((0,a.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:l},type:void 0})),i.createElement("script",(0,a.A)((0,a.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:c},type:"module",async:!0})))},[]),b=it||m?[]:(x=t.entry.imports.concat(Ke(v,t,{includeHydrateFallback:!0})),[...new Set(x)]);var x;let w="object"===typeof t.sri?t.sri:{};return _e(!m,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),it||m?null:i.createElement(i.Fragment,null,"object"===typeof t.sri?i.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:w})}}):null,g?null:i.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:w[t.url],suppressHydrationWarning:!0}),i.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:w[t.entry.module],suppressHydrationWarning:!0}),b.map(t=>i.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:w[t],suppressHydrationWarning:!0})),y)}function st(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}i.Component;function lt(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let r,a=i.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(K(t))return i.createElement(ct,{title:"Unhandled Thrown Response!"},i.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),oe?a:null);if(t instanceof Error)r=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);r=new Error(e)}return i.createElement(ct,{title:"Application Error!",isOutsideRemixApp:n},i.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),i.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),a)}function ct(e){var t;let{title:n,renderScripts:r,isOutsideRemixApp:a,children:o}=e,{routeModules:s}=Ze();return null!==(t=s.root)&&void 0!==t&&t.Layout&&!a?o:i.createElement("html",{lang:"en"},i.createElement("head",null,i.createElement("meta",{charSet:"utf-8"}),i.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),i.createElement("title",null,n)),i.createElement("body",null,i.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},o,r?i.createElement(ot,null):null)))}var ut="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{ut&&(window.__reactRouterVersion="7.9.1")}catch(xt){}function dt(e){let{basename:t,children:n,window:r}=e,a=i.useRef();null==a.current&&(a.current=f({window:r,v5Compat:!0}));let o=a.current,[s,l]=i.useState({action:o.action,location:o.location}),c=i.useCallback(e=>{i.startTransition(()=>l(e))},[l]);return i.useLayoutEffect(()=>o.listen(c),[o,c]),i.createElement(Te,{basename:t,children:n,location:s.location,navigationType:s.action,navigator:o})}var ht=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ft=i.forwardRef(function(e,t){let n,{onClick:o,discover:s="render",prefetch:l="none",relative:u,reloadDocument:d,replace:h,state:f,target:g,to:v,preventScrollReset:b,viewTransition:x}=e,w=(0,r.A)(e,c),{basename:N}=i.useContext(ne),S="string"===typeof v&&ht.test(v),E=!1;if("string"===typeof v&&S&&(n=v,ut))try{let e=new URL(window.location.href),t=v.startsWith("//")?new URL(e.protocol+v):new URL(v),n=L(t.pathname,N);t.origin===e.origin&&null!=n?v=n+t.search+t.hash:E=!0}catch(xt){m(!1,'<Link to="'.concat(v,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let C=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p(se(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=i.useContext(ne),{hash:a,pathname:o,search:s}=fe(e,{relative:t}),l=o;return"/"!==n&&(l="/"===o?n:W([n,o])),r.createHref({pathname:l,search:s,hash:a})}(v,{relative:u}),[k,A,_]=function(e,t){let n=i.useContext(Je),[r,a]=i.useState(!1),[o,s]=i.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,f=i.useRef(null);i.useEffect(()=>{if("render"===e&&s(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{s(e.isIntersecting)})},{threshold:.5});return f.current&&e.observe(f.current),()=>{e.disconnect()}}},[e]),i.useEffect(()=>{if(r){let e=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(e)}}},[r]);let p=()=>{a(!0)},m=()=>{a(!1),s(!1)};return n?"intent"!==e?[o,f,{}]:[o,f,{onFocus:et(l,p),onBlur:et(c,m),onMouseEnter:et(u,p),onMouseLeave:et(d,m),onTouchStart:et(h,p)}]:[!1,f,{}]}(l,w),j=function(e){let{target:t,replace:n,state:r,preventScrollReset:a,relative:o,viewTransition:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=de(),c=le(),u=fe(e,{relative:o});return i.useCallback(i=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(i,t)){i.preventDefault();let t=void 0!==n?n:y(c)===y(u);l(e,{replace:t,state:r,preventScrollReset:a,relative:o,viewTransition:s})}},[c,l,u,n,r,t,e,a,o,s])}(v,{replace:h,state:f,target:g,preventScrollReset:b,relative:u,viewTransition:x});let I=i.createElement("a",(0,a.A)((0,a.A)((0,a.A)({},w),_),{},{href:n||C,onClick:E||d?o:function(e){o&&o(e),e.defaultPrevented||j(e)},ref:st(t,A),target:g,"data-discover":S||"render"!==s?void 0:"true"}));return k&&!S?i.createElement(i.Fragment,null,I,i.createElement(nt,{page:C})):I});ft.displayName="Link",i.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:o=!1,className:s="",end:l=!1,style:c,to:d,viewTransition:h,children:f}=e,m=(0,r.A)(e,u),g=fe(d,{relative:m.relative}),v=le(),y=i.useContext($),{navigator:b,basename:x}=i.useContext(ne),w=null!=y&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.useContext(Z);p(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=gt("useViewTransitionState"),a=fe(e,{relative:t});if(!n.isTransitioning)return!1;let o=L(n.currentLocation.pathname,r)||n.currentLocation.pathname,s=L(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=R(a.pathname,s)||null!=R(a.pathname,o)}(g)&&!0===h,N=b.encodeLocation?b.encodeLocation(g).pathname:g.pathname,S=v.pathname,E=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;o||(S=S.toLowerCase(),E=E?E.toLowerCase():null,N=N.toLowerCase()),E&&x&&(E=L(E,x)||E);const C="/"!==N&&N.endsWith("/")?N.length-1:N.length;let k,A=S===N||!l&&S.startsWith(N)&&"/"===S.charAt(C),_=null!=E&&(E===N||!l&&E.startsWith(N)&&"/"===E.charAt(N.length)),j={isActive:A,isPending:_,isTransitioning:w},I=A?n:void 0;k="function"===typeof s?s(j):[s,A?"active":null,_?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let T="function"===typeof c?c(j):c;return i.createElement(ft,(0,a.A)((0,a.A)({},m),{},{"aria-current":I,className:k,ref:t,style:T,to:d,viewTransition:h}),"function"===typeof f?f(j):f)}).displayName="NavLink";var pt=i.forwardRef((e,t)=>{let{discover:n="render",fetcherKey:o,navigate:s,reloadDocument:l,replace:c,state:u,method:h=De,action:f,onSubmit:m,relative:g,preventScrollReset:v,viewTransition:b}=e,x=(0,r.A)(e,d),w=bt(),N=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=i.useContext(ne),r=i.useContext(ae);p(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),s=(0,a.A)({},fe(e||".",{relative:t})),l=le();if(null==e){s.search=l.search;let e=new URLSearchParams(s.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();s.search=n?"?".concat(n):""}}e&&"."!==e||!o.route.index||(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(s.pathname="/"===s.pathname?n:W([n,s.pathname]));return y(s)}(f,{relative:g}),S="get"===h.toLowerCase()?"get":"post",E="string"===typeof f&&ht.test(f);return i.createElement("form",(0,a.A)((0,a.A)({ref:t,method:S,action:N,onSubmit:l?m:e=>{if(m&&m(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||h;w(t||e.currentTarget,{fetcherKey:o,method:n,navigate:s,replace:c,state:u,relative:g,preventScrollReset:v,viewTransition:b})}},x),{},{"data-discover":E||"render"!==n?void 0:"true"}))});function mt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function gt(e){let t=i.useContext(Q);return p(t,mt(e)),t}pt.displayName="Form";var vt=0,yt=()=>"__".concat(String(++vt),"__");function bt(){let{router:e}=gt("useSubmit"),{basename:t}=i.useContext(ne),n=Se("useRouteId");return i.useCallback(async function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:i,method:o,encType:s,formData:l,body:c}=Ue(r,t);if(!1===a.navigate){let t=a.fetcherKey||yt();await e.fetch(t,n,a.action||i,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||o,formEncType:a.encType||s,flushSync:a.flushSync})}else await e.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||o,formEncType:a.encType||s,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,n])}},5400:(e,t,n)=>{"use strict";n.d(t,{Q4:()=>c,Y2:()=>o,hi:()=>l,vf:()=>s});var r=n(9379),a=n(6667),i=n(1121);const o=async function(e,t,n,r,o){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";try{console.log("\ud83d\udcdd Creating child request:",{parentId:e,studentId:r,studentName:o});const l=(0,a.P)((0,a.rJ)(i.db,"childRequests"),(0,a._M)("parentId","==",e),(0,a._M)("studentId","==",r),(0,a._M)("status","==","pending"));if(!(await(0,a.GG)(l)).empty)return{success:!1,error:"A request for this child is already pending"};const c=await(0,a.getDoc)((0,a.doc)(i.db,"users",e));if(c.exists()){const e=c.data();if(e.children&&e.children.includes(r))return{success:!1,error:"This child is already linked to your account"}}const u={parentId:e,parentName:t,parentEmail:n,studentId:r,studentName:o||"",reason:s||"Parent requesting to link child",status:"pending",createdAt:(new Date).toISOString(),requestType:"child_addition"},d=await(0,a.gS)((0,a.rJ)(i.db,"childRequests"),u);return console.log("\u2705 Child request created:",d.id),{success:!0,requestId:d.id,message:"Request submitted successfully. Please wait for admin approval."}}catch(l){return console.error("\u274c Error creating child request:",l),{success:!1,error:l.message}}},s=async(e,t,n)=>{try{console.log("\u2705 Approving child request:",e);const o=await(0,a.getDoc)((0,a.doc)(i.db,"childRequests",e));if(!o.exists())return{success:!1,error:"Request not found"};const s=o.data(),{parentId:l,studentId:c,parentName:u,studentName:d}=s,h=(0,a.doc)(i.db,"users",l);await(0,a.mZ)(h,{children:(0,a.hq)(c)});try{const e=(0,a.P)((0,a.rJ)(i.db,"users"),(0,a._M)("role","==","student"),(0,a._M)("studentId","==",c)),t=await(0,a.GG)(e);if(!t.empty){const e=t.docs[0];await(0,a.mZ)(e.ref,{parentId:l,parentName:u})}}catch(r){console.warn("\u26a0\ufe0f Could not update student parent info:",r)}return await(0,a.mZ)((0,a.doc)(i.db,"childRequests",e),{status:"approved",approvedBy:t,approvedByName:n,approvedAt:(new Date).toISOString()}),console.log("\u2705 Child request approved successfully"),{success:!0,message:"Successfully linked ".concat(d," to ").concat(u)}}catch(r){return console.error("\u274c Error approving child request:",r),{success:!1,error:r.message}}},l=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";try{return console.log("\u274c Rejecting child request:",e),await(0,a.mZ)((0,a.doc)(i.db,"childRequests",e),{status:"rejected",rejectedBy:t,rejectedByName:n,rejectedAt:(new Date).toISOString(),rejectionReason:r}),console.log("\u2705 Child request rejected"),{success:!0,message:"Request rejected successfully"}}catch(o){return console.error("\u274c Error rejecting child request:",o),{success:!1,error:o.message}}},c=async()=>{try{console.log("\ud83d\udccb Getting all child requests");const e=(0,a.P)((0,a.rJ)(i.db,"childRequests"),(0,a.My)("createdAt","desc")),t=await(0,a.GG)(e),n=[];return t.forEach(e=>{n.push((0,r.A)({id:e.id},e.data()))}),{success:!0,requests:n}}catch(e){return console.error("\u274c Error getting all requests:",e),{success:!1,error:e.message,requests:[]}}}},5414:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(1293);t.throttle=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{leading:a=!0,trailing:i=!0}=n;return r.debounce(e,t,{leading:a,maxWait:t,trailing:i})}},5469:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5487:(e,t,n)=>{const r=n(8293);function a(e,t){const n=e.a/255,r=t+'="'+e.hex+'"';return n<1?r+" "+t+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function i(e,t,n){let r=e+t;return"undefined"!==typeof n&&(r+=" "+n),r}t.render=function(e,t,n){const o=r.getOptions(t),s=e.modules.size,l=e.modules.data,c=s+2*o.margin,u=o.color.light.a?"<path "+a(o.color.light,"fill")+' d="M0 0h'+c+"v"+c+'H0z"/>':"",d="<path "+a(o.color.dark,"stroke")+' d="'+function(e,t,n){let r="",a=0,o=!1,s=0;for(let l=0;l<e.length;l++){const c=Math.floor(l%t),u=Math.floor(l/t);c||o||(o=!0),e[l]?(s++,l>0&&c>0&&e[l-1]||(r+=o?i("M",c+n,.5+u+n):i("m",a,0),a=0,o=!1),c+1<t&&e[l+1]||(r+=i("h",s),s=0)):a++}return r}(l,s,o.margin)+'"/>',h='viewBox="0 0 '+c+" "+c+'"',f='<svg xmlns="http://www.w3.org/2000/svg" '+(o.width?'width="'+o.width+'" height="'+o.width+'" ':"")+h+' shape-rendering="crispEdges">'+u+d+"</svg>\n";return"function"===typeof n&&n(null,f),f}},5508:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6433),a=n(7599);t.cloneDeepWith=function(e,t){return r.cloneDeepWith(e,(n,i,o,s)=>{const l=null===t||void 0===t?void 0:t(n,i,o,s);if(void 0!==l)return l;if("object"===typeof e)switch(Object.prototype.toString.call(e)){case a.numberTag:case a.stringTag:case a.booleanTag:{const t=new e.constructor(null===e||void 0===e?void 0:e.valueOf());return r.copyProperties(t,e),t}case a.argumentsTag:{const t={};return r.copyProperties(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}})}},5686:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},5896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>i(l,n))c<a&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<a&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function N(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,E||(E=!0,S());else{var t=r(u);null!==t&&O(N,t.startTime-e)}}var S,E=!1,C=-1,k=5,A=-1;function _(){return!!v||!(t.unstable_now()-A<k)}function j(){if(v=!1,E){var e=t.unstable_now();A=e;var n=!0;try{e:{m=!1,g&&(g=!1,b(C),C=-1),p=!0;var i=f;try{t:{for(w(e),h=r(c);null!==h&&!(h.expirationTime>e&&_());){var o=h.callback;if("function"===typeof o){h.callback=null,f=h.priorityLevel;var s=o(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof s){h.callback=s,w(e),n=!0;break t}h===r(c)&&a(c),w(e)}else a(c);h=r(c)}if(null!==h)n=!0;else{var l=r(u);null!==l&&O(N,l.startTime-e),n=!1}}break e}finally{h=null,f=i,p=!1}n=void 0}}finally{n?S():E=!1}}}if("function"===typeof x)S=function(){x(j)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,T=I.port2;I.port1.onmessage=j,S=function(){T.postMessage(null)}}else S=function(){y(j,0)};function O(e,n){C=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,n(u,e),null===r(c)&&e===r(u)&&(g?(b(C),C=-1):g=!0,O(N,i-o))):(e.sortIndex=s,n(c,e),m||p||(m=!0,E||(E=!0,S()))),e},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},5990:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.getTag=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}},6116:e=>{e.exports=function(){return"function"===typeof Promise&&Promise.prototype&&Promise.prototype.then}},6210:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},6272:(e,t)=>{t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2},t.isValid=function(e){return e&&"undefined"!==typeof e.bit&&e.bit>=0&&e.bit<4},t.from=function(e,n){if(t.isValid(e))return e;try{return function(e){if("string"!==typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}(e)}catch(r){return n}}},6321:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(5990);t.isArguments=function(e){return null!==e&&"object"===typeof e&&"[object Arguments]"===r.getTag(e)}},6392:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.last=function(e){return e[e.length-1]}},6433:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6443),a=n(5990),i=n(7599),o=n(4803),s=n(3757);function l(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;const d=null===u||void 0===u?void 0:u(e,t,n,r);if(void 0!==d)return d;if(o.isPrimitive(e))return e;if(r.has(e))return r.get(e);if(Array.isArray(e)){const t=new Array(e.length);r.set(e,t);for(let a=0;a<e.length;a++)t[a]=l(e[a],a,n,r,u);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){const t=new Map;r.set(e,t);for(const[a,i]of e)t.set(a,l(i,a,n,r,u));return t}if(e instanceof Set){const t=new Set;r.set(e,t);for(const a of e)t.add(l(a,void 0,n,r,u));return t}if("undefined"!==typeof Buffer&&Buffer.isBuffer(e))return e.subarray();if(s.isTypedArray(e)){const t=new(Object.getPrototypeOf(e).constructor)(e.length);r.set(e,t);for(let a=0;a<e.length;a++)t[a]=l(e[a],a,n,r,u);return t}if(e instanceof ArrayBuffer||"undefined"!==typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return r.set(e,t),c(t,e,n,r,u),t}if("undefined"!==typeof File&&e instanceof File){const t=new File([e],e.name,{type:e.type});return r.set(e,t),c(t,e,n,r,u),t}if(e instanceof Blob){const t=new Blob([e],{type:e.type});return r.set(e,t),c(t,e,n,r,u),t}if(e instanceof Error){const t=new e.constructor;return r.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,c(t,e,n,r,u),t}if("object"===typeof e&&function(e){switch(a.getTag(e)){case i.argumentsTag:case i.arrayTag:case i.arrayBufferTag:case i.dataViewTag:case i.booleanTag:case i.dateTag:case i.float32ArrayTag:case i.float64ArrayTag:case i.int8ArrayTag:case i.int16ArrayTag:case i.int32ArrayTag:case i.mapTag:case i.numberTag:case i.objectTag:case i.regexpTag:case i.setTag:case i.stringTag:case i.symbolTag:case i.uint8ArrayTag:case i.uint8ClampedArrayTag:case i.uint16ArrayTag:case i.uint32ArrayTag:return!0;default:return!1}}(e)){const t=Object.create(Object.getPrototypeOf(e));return r.set(e,t),c(t,e,n,r,u),t}return e}function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;const o=[...Object.keys(t),...r.getSymbols(t)];for(let r=0;r<o.length;r++){const s=o[r],c=Object.getOwnPropertyDescriptor(e,s);(null==c||c.writable)&&(e[s]=l(t[s],s,n,a,i))}}t.cloneDeepWith=function(e,t){return l(e,void 0,e,new Map,t)},t.cloneDeepWithImpl=l,t.copyProperties=c},6443:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.getSymbols=function(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}},6471:(e,t,n)=>{"use strict";n.d(t,{E$:()=>s,ph:()=>l});var r=n(5043),a=n(8717),i=n(579);const o=(0,r.createContext)(),s=()=>{const e=(0,r.useContext)(o);if(!e)throw new Error("useNotifications must be used within a NotificationProvider");return e},l=e=>{let{children:t}=e;const{notifications:n,success:s,error:l,info:c,warning:u,removeNotification:d}=(0,a.hN)(),{confirmState:h,confirm:f,close:p}=(0,a.SC)(),[m,g]=r.useState(!1),[v,y]=r.useState("Processing..."),b={showSuccess:function(e){return s(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3)},showError:function(e){return l(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3)},showInfo:function(e){return c(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3)},showWarning:function(e){return u(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3)},showLoading:function(){y(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Processing..."),g(!0)},hideLoading:()=>{g(!1)},confirm:f,confirmDialog:f,confirmDelete:(e,t)=>f({title:"Delete Confirmation",message:'Are you sure you want to delete "'.concat(e,'"? This action cannot be undone.'),confirmText:"Delete",cancelText:"Cancel",type:"danger",onConfirm:t}),confirmAction:function(e,t,n){return f({title:e,message:t,confirmText:"Confirm",cancelText:"Cancel",type:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"info",onConfirm:n})},confirmApproval:(e,t)=>f({title:"Approve Student Request",message:"Are you sure you want to approve ".concat(e,"'s request to join this classroom?"),confirmText:"Approve",cancelText:"Cancel",type:"success",onConfirm:t}),confirmRejection:(e,t)=>f({title:"Reject Student Request",message:"Are you sure you want to reject ".concat(e,"'s request to join this classroom?"),confirmText:"Reject",cancelText:"Cancel",type:"danger",onConfirm:t}),notifications:n,removeNotification:d};return(0,i.jsxs)(o.Provider,{value:b,children:[t,(0,i.jsx)(a.bL,{notifications:n,onRemove:d}),(0,i.jsx)(a.TM,{confirmState:h,onClose:p}),(0,i.jsx)(a.p8,{isVisible:m,message:v})]})}},6667:(e,t,n)=>{"use strict";n.d(t,{Dc:()=>ye,gS:()=>Cc,hq:()=>Ic,rJ:()=>sl,doc:()=>ll,d_:()=>_c,getDoc:()=>xc,GG:()=>Nc,aU:()=>fl,AB:()=>oc,My:()=>ac,P:()=>Zl,O5:()=>jc,setDoc:()=>Sc,HM:()=>lc,mZ:()=>Ec,_M:()=>tc});var r,a,i=n(9379),o=n(1150),s=n(9606),l=n(2965),c=n(1776),u="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},d={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var a=0;16>a;++a)r[a]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(a=0;16>a;++a)r[a]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],a=e.g[2];var i=e.g[3],o=t+(i^n&(a^i))+r[0]+3614090360&4294967295;o=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=n+(o<<7&4294967295|o>>>25))+((o=i+(a^t&(n^a))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^a&(i^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(a^i))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=i+(a^t&(n^a))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^a&(i^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(a^i))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=i+(a^t&(n^a))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^a&(i^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(a^i))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=i+(a^t&(n^a))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^a&(i^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^i&(n^a))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=a+(t^n&(i^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(a^i))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(a^i&(n^a))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=a+(t^n&(i^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(a^i))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(a^i&(n^a))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=a+(t^n&(i^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(a^i))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(a^i&(n^a))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=a+(t^n&(i^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(a^i))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^a^i)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^a)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^a^i)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^a)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^a^i)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^a)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^a^i)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^a)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(a^(n|~i))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~a))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=a+(t^(i|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(a|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(a^(n|~i))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~a))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=a+(t^(i|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(a|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(a^(n|~i))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~a))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=a+(t^(i|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(a|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((i=(t=n+((o=t+(a^(n|~i))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~a))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((a=i+((o=a+(t^(i|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(a+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+a&4294967295,e.g[3]=e.g[3]+i&4294967295}function i(e,t){this.h=t;for(var n=[],r=!0,a=e.length-1;0<=a;a--){var i=0|e[a];r&&i==t||(n[a]=i,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,a=this.B,i=this.h,o=0;o<t;){if(0==i)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(a[i++]=e.charCodeAt(o++),i==this.blockSize){n(this,a),i=0;break}}else for(;o<t;)if(a[i++]=e[o++],i==this.blockSize){n(this,a),i=0;break}}this.h=i,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var o={};function s(e){return-128<=e&&128>e?function(e,t){var n=o;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new i([0|e],0>e?-1:0)}):new i([0|e],0>e?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return c;if(0>e)return m(l(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new i(t,0)}var c=s(0),u=s(1),h=s(16777216);function f(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function p(e){return-1==e.h}function m(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new i(n,~e.h).add(u)}function g(e,t){return e.add(m(t))}function v(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function y(e,t){this.g=e,this.h=t}function b(e,t){if(f(t))throw Error("division by zero");if(f(e))return new y(c,c);if(p(e))return t=b(m(e),t),new y(m(t.g),m(t.h));if(p(t))return t=b(e,m(t)),new y(m(t.g),t.h);if(30<e.g.length){if(p(e)||p(t))throw Error("slowDivide_ only works with positive integers.");for(var n=u,r=t;0>=r.l(e);)n=x(n),r=x(r);var a=w(n,1),i=w(r,1);for(r=w(r,2),n=w(n,2);!f(r);){var o=i.add(r);0>=o.l(e)&&(a=a.add(n),i=o),r=w(r,1),n=w(n,1)}return t=g(e,a.j(t)),new y(a,t)}for(a=c;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(i=l(n)).j(t);p(o)||0<o.l(e);)o=(i=l(n-=r)).j(t);f(i)&&(i=u),a=a.add(i),e=g(e,o)}return new y(a,e)}function x(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new i(n,e.h)}function w(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,a=[],o=0;o<r;o++)a[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new i(a,e.h)}(e=i.prototype).m=function(){if(p(this))return-m(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(f(this))return"0";if(p(this))return"-"+m(this).toString(e);for(var t=l(Math.pow(e,6)),n=this,r="";;){var a=b(n,t).g,i=((0<(n=g(n,a.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(f(n=a))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return p(e=g(this,e))?-1:f(e)?0:1},e.abs=function(){return p(this)?m(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,a=0;a<=t;a++){var o=r+(65535&this.i(a))+(65535&e.i(a)),s=(o>>>16)+(this.i(a)>>>16)+(e.i(a)>>>16);r=s>>>16,o&=65535,s&=65535,n[a]=s<<16|o}return new i(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(f(this)||f(e))return c;if(p(this))return p(e)?m(this).j(m(e)):m(m(this).j(e));if(p(e))return m(this.j(m(e)));if(0>this.l(h)&&0>e.l(h))return l(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var a=0;a<e.g.length;a++){var o=this.i(r)>>>16,s=65535&this.i(r),u=e.i(a)>>>16,d=65535&e.i(a);n[2*r+2*a]+=s*d,v(n,2*r+2*a),n[2*r+2*a+1]+=o*d,v(n,2*r+2*a+1),n[2*r+2*a+1]+=s*u,v(n,2*r+2*a+1),n[2*r+2*a+2]+=o*u,v(n,2*r+2*a+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new i(n,0)},e.A=function(e){return b(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new i(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new i(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new i(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,a=d.Md5=t,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=l,i.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return m(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=l(Math.pow(n,8)),a=c,i=0;i<t.length;i+=8){var o=Math.min(8,t.length-i),s=parseInt(t.substring(i,i+o),n);8>o?(o=l(Math.pow(n,o)),a=a.j(o).add(l(s))):a=(a=a.j(r)).add(l(s))}return a},r=d.Integer=i}).apply("undefined"!==typeof u?u:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var h,f,p,m,g,v,y,b,x="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},w={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof x&&x];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var a=n;e=e.split(".");for(var i=0;i<e.length-1;i++){var o=e[i];if(!(o in a))break e;a=a[o]}(r=r(i=a[e=e[e.length-1]]))!=i&&null!=r&&t(a,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,a={next:function(){if(!r&&n<e.length){var a=n++;return{value:t(a,e[a]),done:!1}}return r=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}(this,function(e,t){return t})}});var r=r||{},a=this||self;function i(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function s(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?s:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}function N(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function S(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(i(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let a=0;a<r;a++)e[n+a]=t[a]}else e.push(t)}}function E(e){return/^[\s\xa0]*$/.test(e)}function C(){var e=a.navigator;return e&&(e=e.userAgent)?e:""}function k(e){return k[" "](e),e}k[" "]=function(){};var A=-1!=C().indexOf("Gecko")&&!(-1!=C().toLowerCase().indexOf("webkit")&&-1==C().indexOf("Edge"))&&!(-1!=C().indexOf("Trident")||-1!=C().indexOf("MSIE"))&&-1==C().indexOf("Edge");function _(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function j(e){const t={};for(const n in e)t[n]=e[n];return t}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(e,t){let n,r;for(let a=1;a<arguments.length;a++){for(n in r=arguments[a],r)e[n]=r[n];for(let t=0;t<I.length;t++)n=I[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function O(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function P(e){a.setTimeout(()=>{throw e},0)}function D(){var e=B;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var R=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new M,e=>e.reset());class M{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let F,L=!1,B=new class{constructor(){this.h=this.g=null}add(e,t){const n=R.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},U=()=>{const e=a.Promise.resolve(void 0);F=()=>{e.then(z)}};var z=()=>{for(var e;e=D();){try{e.h.call(e.g)}catch(n){P(n)}var t=R;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}L=!1};function V(){this.s=this.s,this.C=this.C}function W(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}V.prototype.s=!1,V.prototype.ma=function(){this.s||(this.s=!0,this.N())},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},W.prototype.h=function(){this.defaultPrevented=!0};var q=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(n){}return e}();function H(e,t){if(W.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(A){e:{try{k(t.nodeName);var a=!0;break e}catch(i){}a=!1}a||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:G[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&H.aa.h.call(this)}}d(H,W);var G={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var K="closure_listenable_"+(1e6*Math.random()|0),X=0;function Y(e,t,n,r,a){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=a,this.key=++X,this.da=this.fa=!1}function Q(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function $(e){this.src=e,this.g={},this.h=0}function J(e,t){var n=t.type;if(n in e.g){var r,a=e.g[n],i=Array.prototype.indexOf.call(a,t,void 0);(r=0<=i)&&Array.prototype.splice.call(a,i,1),r&&(Q(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Z(e,t,n,r){for(var a=0;a<e.length;++a){var i=e[a];if(!i.da&&i.listener==t&&i.capture==!!n&&i.ha==r)return a}return-1}$.prototype.add=function(e,t,n,r,a){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var o=Z(e,t,r,a);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new Y(t,this.src,i,!!r,a)).fa=n,e.push(t)),t};var ee="closure_lm_"+(1e6*Math.random()|0),te={};function ne(e,t,n,r,a){if(r&&r.once)return ae(e,t,n,r,a);if(Array.isArray(t)){for(var i=0;i<t.length;i++)ne(e,t[i],n,r,a);return null}return n=de(n),e&&e[K]?e.K(t,n,o(r)?!!r.capture:!!r,a):re(e,t,n,!1,r,a)}function re(e,t,n,r,a,i){if(!t)throw Error("Invalid event type");var s=o(a)?!!a.capture:!!a,l=ce(e);if(l||(e[ee]=l=new $(e)),(n=l.add(t,n,r,s,i)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=le;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)q||(a=s),void 0===a&&(a=!1),e.addEventListener(t.toString(),r,a);else if(e.attachEvent)e.attachEvent(se(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ae(e,t,n,r,a){if(Array.isArray(t)){for(var i=0;i<t.length;i++)ae(e,t[i],n,r,a);return null}return n=de(n),e&&e[K]?e.L(t,n,o(r)?!!r.capture:!!r,a):re(e,t,n,!0,r,a)}function ie(e,t,n,r,a){if(Array.isArray(t))for(var i=0;i<t.length;i++)ie(e,t[i],n,r,a);else r=o(r)?!!r.capture:!!r,n=de(n),e&&e[K]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Z(i=e.g[t],n,r,a))&&(Q(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=ce(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Z(t,n,r,a)),(n=-1<e?t[e]:null)&&oe(n))}function oe(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[K])J(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(se(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ce(t))?(J(n,e),0==n.h&&(n.src=null,t[ee]=null)):Q(e)}}}function se(e){return e in te?te[e]:te[e]="on"+e}function le(e,t){if(e.da)e=!0;else{t=new H(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&oe(e),e=n.call(r,t)}return e}function ce(e){return(e=e[ee])instanceof $?e:null}var ue="__closure_events_fn_"+(1e9*Math.random()>>>0);function de(e){return"function"===typeof e?e:(e[ue]||(e[ue]=function(t){return e.handleEvent(t)}),e[ue])}function he(){V.call(this),this.i=new $(this),this.M=this,this.F=null}function fe(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new W(t,e);else if(t instanceof W)t.target=t.target||e;else{var a=t;T(t=new W(r,e),a)}if(a=!0,n)for(var i=n.length-1;0<=i;i--){var o=t.g=n[i];a=pe(o,r,!0,t)&&a}if(a=pe(o=t.g=e,r,!0,t)&&a,a=pe(o,r,!1,t)&&a,n)for(i=0;i<n.length;i++)a=pe(o=t.g=n[i],r,!1,t)&&a}function pe(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var a=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.da&&o.capture==n){var s=o.listener,l=o.ha||o.src;o.fa&&J(e.i,o),a=!1!==s.call(l,r)&&a}}return a&&!r.defaultPrevented}function me(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function ge(e){e.g=me(()=>{e.g=null,e.i&&(e.i=!1,ge(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(he,V),he.prototype[K]=!0,he.prototype.removeEventListener=function(e,t,n,r){ie(this,e,t,n,r)},he.prototype.N=function(){if(he.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Q(n[r]);delete t.g[e],t.h--}}this.F=null},he.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},he.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class ve extends V{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ge(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ye(e){V.call(this),this.h=e,this.g={}}d(ye,V);var be=[];function xe(e){_(e.g,function(e,t){this.g.hasOwnProperty(t)&&oe(e)},e),e.g={}}ye.prototype.N=function(){ye.aa.N.call(this),xe(this)},ye.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var we=a.JSON.stringify,Ne=a.JSON.parse,Se=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function Ee(){}function Ce(e){return e.h||(e.h=e.i())}function ke(){}Ee.prototype.h=null;var Ae={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function _e(){W.call(this,"d")}function je(){W.call(this,"c")}d(_e,W),d(je,W);var Ie={},Te=null;function Oe(){return Te=Te||new he}function Pe(e){W.call(this,Ie.La,e)}function De(e){const t=Oe();fe(t,new Pe(t))}function Re(e,t){W.call(this,Ie.STAT_EVENT,e),this.stat=t}function Me(e){const t=Oe();fe(t,new Re(t,e))}function Fe(e,t){W.call(this,Ie.Ma,e),this.size=t}function Le(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){e()},t)}function Be(){this.g=!0}function Ue(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var a=r[1];if(Array.isArray(a)&&!(1>a.length)){var i=a[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<a.length;o++)a[o]=""}}}return we(n)}catch(s){return t}}(e,n)+(r?" "+r:"")})}Ie.La="serverreachability",d(Pe,W),Ie.STAT_EVENT="statevent",d(Re,W),Ie.Ma="timingevent",d(Fe,W),Be.prototype.xa=function(){this.g=!1},Be.prototype.info=function(){};var ze,Ve={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},We={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function qe(){}function He(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new ye(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ge}function Ge(){this.i=null,this.g="",this.h=!1}d(qe,Ee),qe.prototype.g=function(){return new XMLHttpRequest},qe.prototype.i=function(){return{}},ze=new qe;var Ke={},Xe={};function Ye(e,t,n){e.L=1,e.v=wt(gt(t)),e.m=n,e.P=!0,Qe(e,null)}function Qe(e,t){e.F=Date.now(),Ze(e),e.A=gt(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Rt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Ge,e.g=Sn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ve(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var a="readystatechange";Array.isArray(a)||(a&&(be[0]=a.toString()),a=be);for(var i=0;i<a.length;i++){var o=ne(n,a[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?j(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),De(),function(e,t,n,r,a,i){e.info(function(){if(e.g)if(i)for(var o="",s=i.split("&"),l=0;l<s.length;l++){var c=s[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");o=2<=d.length&&"type"==d[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+a+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.u,e.A,e.l,e.R,e.m)}function $e(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Je(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Xe:(n=Number(t.substring(n,r)),isNaN(n)?Ke:(r+=1)+n>t.length?Xe:(t=t.slice(r,r+n),e.C=r+n,t))}function Ze(e){e.S=Date.now()+e.I,et(e,e.I)}function et(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Le(c(e.ba,e),t)}function tt(e){e.B&&(a.clearTimeout(e.B),e.B=null)}function nt(e){0==e.j.G||e.J||yn(e.j,e)}function rt(e){tt(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,xe(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function at(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||ct(n.h,e)))if(!e.K&&ct(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var a=r;if(0==a[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;vn(n),sn(n)}pn(n),Me(18)}}else n.za=a[1],0<n.za-n.T&&37500>a[2]&&n.F&&0==n.v&&!n.C&&(n.C=Le(c(n.Za,n),6e3));if(1>=lt(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else xn(n,11)}else if((e.K||n.g==e)&&vn(n),!E(t))for(a=n.Da.g.parse(t),t=0;t<a.length;t++){let c=a[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const a=c[4];null!=a&&(n.Aa=a,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=r.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(ut(i,i.h),i.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,xt(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((r=n).qa=Nn(r,r.J?r.ia:null,r.W),o.K){dt(r.h,o);var s=o,l=r.L;l&&(s.I=l),s.B&&(tt(s),Ze(s)),r.g=o}else fn(r);0<n.i.length&&cn(n)}else"stop"!=c[0]&&"close"!=c[0]||xn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?xn(n,7):on(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}De()}catch(u){}}He.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==tn(e)?t.j():this.Y(e)},He.prototype.Y=function(e){try{if(e==this.g)e:{const h=tn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||nn(this.g)))){this.J||4!=h||7==t||De(),tt(this);var n=this.g.Z();this.X=n;t:if($e(this)){var r=nn(this.g);e="";var i=r.length,o=4==tn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){rt(this),nt(this);var s="";break t}this.h.i=new a.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(o&&t==i-1)});r.length=0,this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.oa();if(this.o=200==n,function(e,t,n,r,a,i,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+a+"]: "+t+"\n"+n+"\n"+i+" "+o})}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Me(12),rt(this),nt(this);break e}Ue(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,at(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<s.length;){if(e=Je(this,s),e==Xe){4==h&&(this.s=4,Me(14),n=!1),Ue(this.i,this.l,null,"[Incomplete Response]");break}if(e==Ke){this.s=4,Me(15),Ue(this.i,this.l,s,"[Invalid Chunk]"),n=!1;break}Ue(this.i,this.l,e,null),at(this,e)}if($e(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=s.length||this.h.h||(this.s=1,Me(16),n=!1),this.o=this.o&&n,n){if(0<s.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+s.length),mn(d),d.M=!0,Me(11))}}else Ue(this.i,this.l,s,"[Invalid Chunked Response]"),rt(this),nt(this)}else Ue(this.i,this.l,s,null),at(this,s);4==h&&rt(this),this.o&&!this.J&&(4==h?yn(this.j,this):(this.o=!1,Ze(this)))}else(function(e){const t={};e=(e.g&&2<=tn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(E(e[r]))continue;var n=O(e[r]);const a=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const i=t[a]||[];t[a]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<s.indexOf("Unknown SID")?(this.s=3,Me(12)):(this.s=0,Me(13)),rt(this),nt(this)}}}catch(h){}},He.prototype.cancel=function(){this.J=!0,rt(this)},He.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(De(),Me(17)),rt(this),this.s=2,nt(this)):et(this,this.S-e)};var it=class{constructor(e,t){this.g=e,this.map=t}};function ot(e){this.l=e||10,a.PerformanceNavigationTiming?e=0<(e=a.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function st(e){return!!e.h||!!e.g&&e.g.size>=e.j}function lt(e){return e.h?1:e.g?e.g.size:0}function ct(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ut(e,t){e.g?e.g.add(t):e.h=t}function dt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function ht(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return N(e.i)}function ft(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(i(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(i(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(i(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),a=r.length,o=0;o<a;o++)t.call(void 0,r[o],n&&n[o],e)}ot.prototype.cancel=function(){if(this.i=ht(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var pt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function mt(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof mt){this.h=e.h,vt(this,e.j),this.o=e.o,this.g=e.g,yt(this,e.s),this.l=e.l;var t=e.i,n=new Tt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),bt(this,n),this.m=e.m}else e&&(t=String(e).match(pt))?(this.h=!1,vt(this,t[1]||"",!0),this.o=Nt(t[2]||""),this.g=Nt(t[3]||"",!0),yt(this,t[4]),this.l=Nt(t[5]||"",!0),bt(this,t[6]||"",!0),this.m=Nt(t[7]||"")):(this.h=!1,this.i=new Tt(null,this.h))}function gt(e){return new mt(e)}function vt(e,t,n){e.j=n?Nt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function yt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function bt(e,t,n){t instanceof Tt?(e.i=t,function(e,t){t&&!e.j&&(Ot(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Pt(this,t),Rt(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=St(t,jt)),e.i=new Tt(t,e.h))}function xt(e,t,n){e.i.set(t,n)}function wt(e){return xt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Nt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function St(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Et),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Et(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}mt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(St(t,kt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(St(t,kt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(St(n,"/"==n.charAt(0)?_t:At,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",St(n,It)),e.join("")};var Ct,kt=/[#\/\?@]/g,At=/[#\?:]/g,_t=/[#\?]/g,jt=/[#\?@]/g,It=/#/g;function Tt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Ot(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),a=null;if(0<=r){var i=e[n].substring(0,r);a=e[n].substring(r+1)}else i=e[n];t(i,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Pt(e,t){Ot(e),t=Mt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Dt(e,t){return Ot(e),t=Mt(e,t),e.g.has(t)}function Rt(e,t,n){Pt(e,t),0<n.length&&(e.i=null,e.g.set(Mt(e,t),N(n)),e.h+=n.length)}function Mt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ft(e,t,n,r,a){try{a&&(a.onload=null,a.onerror=null,a.onabort=null,a.ontimeout=null),r(n)}catch(i){}}function Lt(){this.g=new Se}function Bt(e,t,n){const r=n||"";try{ft(e,function(e,n){let a=e;o(e)&&(a=we(e)),t.push(r+n+"="+encodeURIComponent(a))})}catch(a){throw t.push(r+"type="+encodeURIComponent("_badmap")),a}}function Ut(e){this.l=e.Ub||null,this.j=e.eb||!1}function zt(e,t){he.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Vt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Wt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,qt(e)}function qt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Ht(e){let t="";return _(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Gt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Ht(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):xt(e,t,n))}function Kt(e){he.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Tt.prototype).add=function(e,t){Ot(this),this.i=null,e=Mt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Ot(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){Ot(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const a=e[r];for(let e=0;e<a.length;e++)n.push(t[r])}return n},e.V=function(e){Ot(this);let t=[];if("string"===typeof e)Dt(this,e)&&(t=t.concat(this.g.get(Mt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Ot(this),this.i=null,Dt(this,e=Mt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const i=encodeURIComponent(String(r)),o=this.V(r);for(r=0;r<o.length;r++){var a=i;""!==o[r]&&(a+="="+encodeURIComponent(String(o[r]))),e.push(a)}}return this.i=e.join("&")},d(Ut,Ee),Ut.prototype.g=function(){return new zt(this.l,this.j)},Ut.prototype.i=(Ct={},function(){return Ct}),d(zt,he),(e=zt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,qt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||a).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Wt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,qt(this)),this.g&&(this.readyState=3,qt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Wt(this):qt(this),3==this.readyState&&Vt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Wt(this))},e.Qa=function(e){this.g&&(this.response=e,Wt(this))},e.ga=function(){this.g&&Wt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(zt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Kt,he);var Xt=/^https?$/i,Yt=["POST","PUT"];function Qt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,$t(e),Zt(e)}function $t(e){e.A||(e.A=!0,fe(e,"complete"),fe(e,"error"))}function Jt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=tn(e)||2!=e.Z()))if(e.u&&4==tn(e))me(e.Ea,0,e);else if(fe(e,"readystatechange"),4==tn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===r){var o=String(e.D).match(pt)[1]||null;!o&&a.self&&a.self.location&&(o=a.self.location.protocol.slice(0,-1)),i=!Xt.test(o?o.toLowerCase():"")}n=i}if(n)fe(e,"complete"),fe(e,"success");else{e.m=6;try{var s=2<tn(e)?e.g.statusText:""}catch(l){s=""}e.l=s+" ["+e.Z()+"]",$t(e)}}finally{Zt(e)}}}function Zt(e,t){if(e.g){en(e);const r=e.g,a=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||fe(e,"ready");try{r.onreadystatechange=a}catch(n){}}}function en(e){e.I&&(a.clearTimeout(e.I),e.I=null)}function tn(e){return e.g?e.g.readyState:0}function nn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function rn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function an(e){this.Aa=0,this.i=[],this.j=new Be,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=rn("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=rn("baseRetryDelayMs",5e3,e),this.cb=rn("retryDelaySeedMs",1e4,e),this.Wa=rn("forwardChannelMaxRetries",2,e),this.wa=rn("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new ot(e&&e.concurrentRequestLimit),this.Da=new Lt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function on(e){if(ln(e),3==e.G){var t=e.U++,n=gt(e.I);if(xt(n,"SID",e.K),xt(n,"RID",t),xt(n,"TYPE","terminate"),dn(e,n),(t=new He(e,e.j,t)).L=2,t.v=wt(gt(n)),n=!1,a.navigator&&a.navigator.sendBeacon)try{n=a.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&a.Image&&((new Image).src=t.v,n=!0),n||(t.g=Sn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Ze(t)}wn(e)}function sn(e){e.g&&(mn(e),e.g.cancel(),e.g=null)}function ln(e){sn(e),e.u&&(a.clearTimeout(e.u),e.u=null),vn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&a.clearTimeout(e.s),e.s=null)}function cn(e){if(!st(e.h)&&!e.s){e.s=!0;var t=e.Ga;F||U(),L||(F(),L=!0),B.add(t,e),e.B=0}}function un(e,t){var n;n=t?t.l:e.U++;const r=gt(e.I);xt(r,"SID",e.K),xt(r,"RID",n),xt(r,"AID",e.T),dn(e,r),e.m&&e.o&&Gt(r,e.m,e.o),n=new He(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=hn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),ut(e.h,n),Ye(n,r,t)}function dn(e,t){e.H&&_(e.H,function(e,n){xt(t,n,e)}),e.l&&ft({},function(e,n){xt(t,n,e)})}function hn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var a=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=a[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let s=0;s<n;s++){let n=a[s].g;const l=a[s].map;if(n-=t,0>n)t=Math.max(0,a[s].g-100),o=!1;else try{Bt(l,e,"req"+n+"_")}catch(i){r&&r(l)}}if(o){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function fn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;F||U(),L||(F(),L=!0),B.add(t,e),e.v=0}}function pn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Le(c(e.Fa,e),bn(e,e.v)),e.v++,!0)}function mn(e){null!=e.A&&(a.clearTimeout(e.A),e.A=null)}function gn(e){e.g=new He(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=gt(e.qa);xt(t,"RID","rpc"),xt(t,"SID",e.K),xt(t,"AID",e.T),xt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&xt(t,"TO",e.ja),xt(t,"TYPE","xmlhttp"),dn(e,t),e.m&&e.o&&Gt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=wt(gt(t)),n.m=null,n.P=!0,Qe(n,e)}function vn(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function yn(e,t){var n=null;if(e.g==t){vn(e),mn(e),e.g=null;var r=2}else{if(!ct(e.h,t))return;n=t.D,dt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var a=e.B;fe(r=Oe(),new Fe(r,n)),cn(e)}else fn(e);else if(3==(a=t.s)||0==a&&0<t.X||!(1==r&&function(e,t){return!(lt(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Le(c(e.Ga,e,t),bn(e,e.B)),e.B++,!0))}(e,t)||2==r&&pn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),a){case 1:xn(e,5);break;case 4:xn(e,10);break;case 3:xn(e,6);break;default:xn(e,2)}}function bn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function xn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new mt(r||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||vt(r,"https"),wt(r),t?function(e,t){const n=new Be;if(a.Image){const r=new Image;r.onload=u(Ft,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Ft,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Ft,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Ft,n,"TestLoadImage: timeout",!1,t,r),a.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Be;const n=new AbortController,r=setTimeout(()=>{n.abort(),Ft(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Ft(0,0,!0,t):Ft(0,0,!1,t)}).catch(()=>{clearTimeout(r),Ft(0,0,!1,t)})}(r.toString(),n)}else Me(2);e.G=0,e.l&&e.l.sa(t),wn(e),ln(e)}function wn(e){if(e.G=0,e.ka=[],e.l){const t=ht(e.h);0==t.length&&0==e.i.length||(S(e.ka,t),S(e.ka,e.i),e.h.i.length=0,N(e.i),e.i.length=0),e.l.ra()}}function Nn(e,t,n){var r=n instanceof mt?gt(n):new mt(n);if(""!=r.g)t&&(r.g=t+"."+r.g),yt(r,r.s);else{var i=a.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var o=new mt(null);r&&vt(o,r),t&&(o.g=t),i&&yt(o,i),n&&(o.l=n),r=o}return n=e.D,t=e.ya,n&&t&&xt(r,n,t),xt(r,"VER",e.la),dn(e,r),r}function Sn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Kt(new Ut({eb:n})):new Kt(e.pa)).Ha(e.J),t}function En(){}function Cn(){}function kn(e,t){he.call(this),this.g=new an(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!E(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!E(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new jn(this)}function An(e){_e.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function _n(){je.call(this),this.status=1}function jn(e){this.g=e}(e=Kt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ze.g(),this.v=this.o?Ce(this.o):Ce(ze),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void Qt(this,o)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=a.FormData&&e instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Yt,t,void 0))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,s]of n)this.g.setRequestHeader(a,s);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{en(this),this.u=!0,this.g.send(e),this.u=!1}catch(o){Qt(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,fe(this,"complete"),fe(this,"abort"),Zt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zt(this,!0)),Kt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Jt(this):this.bb())},e.bb=function(){Jt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<tn(this)?this.g.status:-1}catch(Ct){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(Ct){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Ne(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=an.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Me(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=Nn(this,null,this.W),cn(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const a=new He(this,this.j,e);let i=this.o;if(this.S&&(i?(i=j(i),T(i,this.S)):i=this.S),null!==this.m||this.O||(a.H=i,i=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=hn(this,a,t),xt(n=gt(this.I),"RID",e),xt(n,"CVER",22),this.D&&xt(n,"X-HTTP-Session-Id",this.D),dn(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(Ht(i)))+"&"+t:this.m&&Gt(n,this.m,i)),ut(this.h,a),this.Ua&&xt(n,"TYPE","init"),this.P?(xt(n,"$req",t),xt(n,"SID","null"),a.T=!0,Ye(a,n,null)):Ye(a,n,t),this.G=2}}else 3==this.G&&(e?un(this,e):0==this.i.length||st(this.h)||un(this))},e.Fa=function(){if(this.u=null,gn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Le(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Me(10),sn(this),gn(this))},e.Za=function(){null!=this.C&&(this.C=null,sn(this),pn(this),Me(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Me(2)):(this.j.info("Failed to ping google.com"),Me(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=En.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},Cn.prototype.g=function(e,t){return new kn(e,t)},d(kn,he),kn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},kn.prototype.close=function(){on(this.g)},kn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=we(e),e=n);t.i.push(new it(t.Ya++,e)),3==t.G&&cn(t)},kn.prototype.N=function(){this.g.l=null,delete this.j,on(this.g),delete this.g,kn.aa.N.call(this)},d(An,_e),d(_n,je),d(jn,En),jn.prototype.ua=function(){fe(this.g,"a")},jn.prototype.ta=function(e){fe(this.g,new An(e))},jn.prototype.sa=function(e){fe(this.g,new _n)},jn.prototype.ra=function(){fe(this.g,"b")},Cn.prototype.createWebChannel=Cn.prototype.g,kn.prototype.send=kn.prototype.o,kn.prototype.open=kn.prototype.m,kn.prototype.close=kn.prototype.close,b=w.createWebChannelTransport=function(){return new Cn},y=w.getStatEventTarget=function(){return Oe()},v=w.Event=Ie,g=w.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ve.NO_ERROR=0,Ve.TIMEOUT=8,Ve.HTTP_ERROR=6,m=w.ErrorCode=Ve,We.COMPLETE="complete",p=w.EventType=We,ke.EventType=Ae,Ae.OPEN="a",Ae.CLOSE="b",Ae.ERROR="c",Ae.MESSAGE="d",he.prototype.listen=he.prototype.K,f=w.WebChannel=ke,w.FetchXmlHttpFactory=Ut,Kt.prototype.listenOnce=Kt.prototype.L,Kt.prototype.getLastError=Kt.prototype.Ka,Kt.prototype.getLastErrorCode=Kt.prototype.Ba,Kt.prototype.getStatus=Kt.prototype.Z,Kt.prototype.getResponseJson=Kt.prototype.Oa,Kt.prototype.getResponseText=Kt.prototype.oa,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Ha,h=w.XhrIo=Kt}).apply("undefined"!==typeof x?x:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const N="@firebase/firestore",S="4.9.1";class E{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}E.UNAUTHENTICATED=new E(null),E.GOOGLE_CREDENTIALS=new E("google-credentials-uid"),E.FIRST_PARTY=new E("first-party-uid"),E.MOCK_USER=new E("mock-user");let C="12.2.0";const k=new l.Vy("@firebase/firestore");function A(){return k.logLevel}function _(e){if(k.logLevel<=l.$b.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(T);k.debug("Firestore (".concat(C,"): ").concat(e),...a)}}function j(e){if(k.logLevel<=l.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(T);k.error("Firestore (".concat(C,"): ").concat(e),...a)}}function I(e){if(k.logLevel<=l.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(T);k.warn("Firestore (".concat(C,"): ").concat(e),...a)}}function T(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function O(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,P(e,r,n)}function P(e,t,n){let r="FIRESTORE (".concat(C,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw j(r),new Error(r)}function D(e,t,n,r){let a="Unexpected state";"string"==typeof n?a=n:r=n,e||P(t,a,r)}function R(e,t){return e}const M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class F extends c.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class L{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class B{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class U{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(E.UNAUTHENTICATED))}shutdown(){}}class z{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class V{constructor(e){this.t=e,this.currentUser=E.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){D(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let a=new L;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new L,e.enqueueRetryable(()=>r(this.currentUser))};const i=()=>{const t=a;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{_("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(_("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new L)}},0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(_("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(D("string"==typeof t.accessToken,31837,{l:t}),new B(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return D(null===e||"string"==typeof e,2055,{h:e}),new E(e)}}class W{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=E.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class q{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new W(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(E.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class H{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class G{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,o.xZ)(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){D(void 0===this.o,3512);const n=e=>{null!=e.error&&_("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.m;return this.m=e.token,_("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{_("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):_("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new H(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(D("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new H(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function K(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class X{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=K(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Y(e,t){return e<t?-1:e>t?1:0}function Q(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),a=t.charAt(r);if(n!==a)return Z(n)===Z(a)?Y(n,a):Z(n)?1:-1}return Y(e.length,t.length)}const $=55296,J=57343;function Z(e){const t=e.charCodeAt(0);return t>=$&&t<=J}function ee(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const te="__name__";class ne{constructor(e,t,n){void 0===t?t=0:t>e.length&&O(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&O(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===ne.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ne?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=ne.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Y(e.length,t.length)}static compareSegments(e,t){const n=ne.isNumericId(e),r=ne.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?ne.extractNumericId(e).compare(ne.extractNumericId(t)):Q(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return r.fromString(e.substring(4,e.length-2))}}class re extends ne{construct(e,t,n){return new re(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n){if(a.indexOf("//")>=0)throw new F(M.INVALID_ARGUMENT,"Invalid segment (".concat(a,"). Paths must not contain // in them."));e.push(...a.split("/").filter(e=>e.length>0))}return new re(e)}static emptyPath(){return new re([])}}const ae=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ie extends ne{construct(e,t,n){return new ie(e,t,n)}static isValidIdentifier(e){return ae.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ie.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===te}static keyField(){return new ie([te])}static fromServerFormat(e){const t=[];let n="",r=0;const a=()=>{if(0===n.length)throw new F(M.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new F(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new F(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(a(),r++)}if(a(),i)throw new F(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ie(t)}static emptyPath(){return new ie([])}}class oe{constructor(e){this.path=e}static fromPath(e){return new oe(re.fromString(e))}static fromName(e){return new oe(re.fromString(e).popFirst(5))}static empty(){return new oe(re.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===re.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return re.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new oe(new re(e.slice()))}}function se(e,t,n){if(!n)throw new F(M.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function le(e){if(!oe.isDocumentKey(e))throw new F(M.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function ce(e){if(oe.isDocumentKey(e))throw new F(M.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function ue(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function de(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":O(12329,{type:typeof e})}function he(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new F(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=de(e);throw new F(M.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function fe(e,t){if(t<=0)throw new F(M.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}function pe(e,t){const n={typeString:e};return t&&(n.value=t),n}function me(e,t){if(!ue(e))throw new F(M.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const a=t[r].typeString,i="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n="JSON missing required field: '".concat(r,"'");break}const o=e[r];if(a&&typeof o!==a){n="JSON field '".concat(r,"' must be a ").concat(a,".");break}if(void 0!==i&&o!==i.value){n="Expected '".concat(r,"' field to equal '").concat(i.value,"'");break}}if(n)throw new F(M.INVALID_ARGUMENT,n);return!0}const ge=-62135596800,ve=1e6;class ye{static now(){return ye.fromMillis(Date.now())}static fromDate(e){return ye.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*ve);return new ye(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new F(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new F(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ge)throw new F(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new F(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ve}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ye._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(me(e,ye._jsonSchema))return new ye(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ge;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ye._jsonSchemaVersion="firestore/timestamp/1.0",ye._jsonSchema={type:pe("string",ye._jsonSchemaVersion),seconds:pe("number"),nanoseconds:pe("number")};class be{static fromTimestamp(e){return new be(e)}static min(){return new be(new ye(0,0))}static max(){return new be(new ye(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const xe=-1;class we{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}we.UNKNOWN_ID=-1;function Ne(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,a=be.fromTimestamp(1e9===r?new ye(n+1,0):new ye(n,r));return new Ee(a,oe.empty(),t)}function Se(e){return new Ee(e.readTime,e.key,xe)}class Ee{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Ee(be.min(),oe.empty(),xe)}static max(){return new Ee(be.max(),oe.empty(),xe)}}function Ce(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=oe.comparator(e.documentKey,t.documentKey),0!==n?n:Y(e.largestBatchId,t.largestBatchId))}const ke="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ae{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function _e(e){if(e.code!==M.FAILED_PRECONDITION||e.message!==ke)throw e;_("LocalStore","Unexpectedly lost primary lease")}class je{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&O(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new je((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof je?t:je.resolve(t)}catch(e){return je.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):je.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):je.reject(t)}static resolve(e){return new je((t,n)=>{t(e)})}static reject(e){return new je((t,n)=>{n(e)})}static waitFor(e){return new je((t,n)=>{let r=0,a=0,i=!1;e.forEach(e=>{++r,e.next(()=>{++a,i&&a===r&&t()},e=>n(e))}),i=!0,a===r&&t()})}static or(e){let t=je.resolve(!1);for(const n of e)t=t.next(e=>e?je.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new je((n,r)=>{const a=e.length,i=new Array(a);let o=0;for(let s=0;s<a;s++){const l=s;t(e[l]).next(e=>{i[l]=e,++o,o===a&&n(i)},e=>r(e))}})}static doWhile(e,t){return new je((n,r)=>{const a=()=>{!0===e()?t().next(()=>{a()},r):n()};a()})}}function Ie(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Te(e){return"IndexedDbTransactionError"===e.name}class Oe{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Oe.ce=-1;const Pe=-1;function De(e){return null==e}function Re(e){return 0===e&&1/e==-1/0}function Me(e){return"number"==typeof e&&Number.isInteger(e)&&!Re(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const Fe="\x01";function Le(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Ue(t)),t=Be(e.get(n),t);return Ue(t)}function Be(e,t){let n=t;const r=e.length;for(let a=0;a<r;a++){const t=e.charAt(a);switch(t){case"\0":n+="\x01\x10";break;case Fe:n+="\x01\x11";break;default:n+=t}}return n}function Ue(e){return e+Fe+"\x01"}const ze="remoteDocuments",Ve="owner",We="mutationQueues",qe="mutations";const He="documentMutations",Ge="remoteDocumentsV14",Ke="remoteDocumentGlobal",Xe="targets",Ye="targetDocuments",Qe="targetGlobal",$e="collectionParents",Je="clientMetadata",Ze="bundles",et="namedQueries",tt="indexConfiguration",nt="indexState",rt="indexEntries",at="documentOverlays",it="globals",ot=[We,qe,He,ze,Xe,Ve,Qe,Ye,Je,Ke,$e,Ze,et],st=[We,qe,He,Ge,Xe,Ve,Qe,Ye,Je,Ke,$e,Ze,et,at],lt=st,ct=[...lt,tt,nt,rt];function ut(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function dt(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ht(e,t){const n=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(t(e[r],r,e));return n}function ft(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class pt{constructor(e,t){this.comparator=e,this.root=t||gt.EMPTY}insert(e,t){return new pt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,gt.BLACK,null,null))}remove(e){return new pt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new mt(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new mt(this.root,e,this.comparator,!1)}getReverseIterator(){return new mt(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new mt(this.root,e,this.comparator,!0)}}class mt{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&r&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class gt{constructor(e,t,n,r,a){this.key=e,this.value=t,this.color=null!=n?n:gt.RED,this.left=null!=r?r:gt.EMPTY,this.right=null!=a?a:gt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,a){return new gt(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const a=n(e,r.key);return r=a<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===a?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return gt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return gt.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw O(43730,{key:this.key,value:this.value});if(this.right.isRed())throw O(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw O(27949);return e+(this.isRed()?0:1)}}gt.EMPTY=null,gt.RED=!0,gt.BLACK=!1,gt.EMPTY=new class{constructor(){this.size=0}get key(){throw O(57766)}get value(){throw O(16141)}get color(){throw O(16727)}get left(){throw O(29726)}get right(){throw O(36894)}copy(e,t,n,r,a){return this}insert(e,t,n){return new gt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class vt{constructor(e){this.comparator=e,this.data=new pt(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new yt(this.data.getIterator())}getIteratorFrom(e){return new yt(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof vt))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new vt(this.comparator);return t.data=e,t}}class yt{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class bt{constructor(e){this.fields=e,e.sort(ie.comparator)}static empty(){return new bt([])}unionWith(e){let t=new vt(ie.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new bt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ee(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class xt extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class wt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new xt("Invalid base64 string: "+e):e}}(e);return new wt(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new wt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}wt.EMPTY_BYTE_STRING=new wt("");const Nt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function St(e){if(D(!!e,39018),"string"==typeof e){let t=0;const n=Nt.exec(e);if(D(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Et(e.seconds),nanos:Et(e.nanos)}}function Et(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Ct(e){return"string"==typeof e?wt.fromBase64String(e):wt.fromUint8Array(e)}const kt="server_timestamp",At="__type__",_t="__previous_value__",jt="__local_write_time__";function It(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[At])||void 0===t?void 0:t.stringValue)===kt}function Tt(e){const t=e.mapValue.fields[_t];return It(t)?Tt(t):t}function Ot(e){const t=St(e.mapValue.fields[jt].timestampValue);return new ye(t.seconds,t.nanos)}class Pt{constructor(e,t,n,r,a,i,o,s,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=s,this.useFetchStreams=l,this.isUsingEmulator=c}}const Dt="(default)";class Rt{constructor(e,t){this.projectId=e,this.database=t||Dt}static empty(){return new Rt("","")}get isDefaultDatabase(){return this.database===Dt}isEqual(e){return e instanceof Rt&&e.projectId===this.projectId&&e.database===this.database}}const Mt="__type__",Ft="__max__",Lt={mapValue:{fields:{__type__:{stringValue:Ft}}}},Bt="__vector__",Ut="value";function zt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?It(e)?4:an(e)?9007199254740991:nn(e)?10:11:O(28295,{value:e})}function Vt(e,t){if(e===t)return!0;const n=zt(e);if(n!==zt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ot(e).isEqual(Ot(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=St(e.timestampValue),r=St(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Ct(e.bytesValue).isEqual(Ct(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Et(e.geoPointValue.latitude)===Et(t.geoPointValue.latitude)&&Et(e.geoPointValue.longitude)===Et(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Et(e.integerValue)===Et(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Et(e.doubleValue),r=Et(t.doubleValue);return n===r?Re(n)===Re(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ee(e.arrayValue.values||[],t.arrayValue.values||[],Vt);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(ut(n)!==ut(r))return!1;for(const a in n)if(n.hasOwnProperty(a)&&(void 0===r[a]||!Vt(n[a],r[a])))return!1;return!0}(e,t);default:return O(52216,{left:e})}}function Wt(e,t){return void 0!==(e.values||[]).find(e=>Vt(e,t))}function qt(e,t){if(e===t)return 0;const n=zt(e),r=zt(t);if(n!==r)return Y(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Y(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Et(e.integerValue||e.doubleValue),r=Et(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Ht(e.timestampValue,t.timestampValue);case 4:return Ht(Ot(e),Ot(t));case 5:return Q(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Ct(e),r=Ct(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let a=0;a<n.length&&a<r.length;a++){const e=Y(n[a],r[a]);if(0!==e)return e}return Y(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Y(Et(e.latitude),Et(t.latitude));return 0!==n?n:Y(Et(e.longitude),Et(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Gt(e.arrayValue,t.arrayValue);case 10:return function(e,t,n,r,a,i){const o=e.fields||{},s=t.fields||{},l=null===(n=o[Ut])||void 0===n?void 0:n.arrayValue,c=null===(r=s[Ut])||void 0===r?void 0:r.arrayValue,u=Y((null===l||void 0===l||null===(a=l.values)||void 0===a?void 0:a.length)||0,(null===c||void 0===c||null===(i=c.values)||void 0===i?void 0:i.length)||0);return 0!==u?u:Gt(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Lt.mapValue&&t===Lt.mapValue)return 0;if(e===Lt.mapValue)return 1;if(t===Lt.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),a=t.fields||{},i=Object.keys(a);r.sort(),i.sort();for(let o=0;o<r.length&&o<i.length;++o){const e=Q(r[o],i[o]);if(0!==e)return e;const t=qt(n[r[o]],a[i[o]]);if(0!==t)return t}return Y(r.length,i.length)}(e.mapValue,t.mapValue);default:throw O(23264,{he:n})}}function Ht(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Y(e,t);const n=St(e),r=St(t),a=Y(n.seconds,r.seconds);return 0!==a?a:Y(n.nanos,r.nanos)}function Gt(e,t){const n=e.values||[],r=t.values||[];for(let a=0;a<n.length&&a<r.length;++a){const e=qt(n[a],r[a]);if(e)return e}return Y(n.length,r.length)}function Kt(e){return Xt(e)}function Xt(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=St(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Ct(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return oe.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Xt(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const a of t)r?r=!1:n+=",",n+="".concat(a,":").concat(Xt(e.fields[a]));return n+"}"}(e.mapValue):O(61005,{value:e})}function Yt(e){switch(zt(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Tt(e);return t?16+Yt(t):16;case 5:return 2*e.stringValue.length;case 6:return Ct(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+Yt(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return dt(e.fields,(e,n)=>{t+=e.length+Yt(n)}),t}(e.mapValue);default:throw O(13486,{value:e})}}function Qt(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function $t(e){return!!e&&"integerValue"in e}function Jt(e){return!!e&&"arrayValue"in e}function Zt(e){return!!e&&"nullValue"in e}function en(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function tn(e){return!!e&&"mapValue"in e}function nn(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[Mt])||void 0===t?void 0:t.stringValue)===Bt}function rn(e){if(e.geoPointValue)return{geoPointValue:(0,i.A)({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:(0,i.A)({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return dt(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=rn(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=rn(e.arrayValue.values[n]);return t}return(0,i.A)({},e)}function an(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Ft}class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!tn(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=rn(t)}setAll(e){let t=ie.emptyPath(),n={},r=[];e.forEach((e,a)=>{if(!t.isImmediateParentOf(a)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=a.popLast()}e?n[a.lastSegment()]=rn(e):r.push(a.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,n,r)}delete(e){const t=this.field(e.popLast());tn(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Vt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];tn(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){dt(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new on(rn(this.value))}}function sn(e){const t=[];return dt(e.fields,(e,n)=>{const r=new ie([e]);if(tn(n)){const e=sn(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new bt(t)}class ln{constructor(e,t,n,r,a,i,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=a,this.data=i,this.documentState=o}static newInvalidDocument(e){return new ln(e,0,be.min(),be.min(),be.min(),on.empty(),0)}static newFoundDocument(e,t,n,r){return new ln(e,1,t,be.min(),n,r,0)}static newNoDocument(e,t){return new ln(e,2,t,be.min(),be.min(),on.empty(),0)}static newUnknownDocument(e,t){return new ln(e,3,t,be.min(),be.min(),on.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(be.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=be.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ln&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ln(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class cn{constructor(e,t){this.position=e,this.inclusive=t}}function un(e,t,n){let r=0;for(let a=0;a<e.position.length;a++){const i=t[a],o=e.position[a];if(r=i.field.isKeyField()?oe.comparator(oe.fromName(o.referenceValue),n.key):qt(o,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function dn(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Vt(e.position[n],t.position[n]))return!1;return!0}class hn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function fn(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class pn{}class mn extends pn{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Sn(e,t,n):"array-contains"===t?new An(e,n):"in"===t?new _n(e,n):"not-in"===t?new jn(e,n):"array-contains-any"===t?new In(e,n):new mn(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new En(e,n):new Cn(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(qt(t,this.value)):null!==t&&zt(this.value)===zt(t)&&this.matchesComparison(qt(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return O(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gn extends pn{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new gn(e,t)}matches(e){return vn(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function vn(e){return"and"===e.op}function yn(e){return bn(e)&&vn(e)}function bn(e){for(const t of e.filters)if(t instanceof gn)return!1;return!0}function xn(e){if(e instanceof mn)return e.field.canonicalString()+e.op.toString()+Kt(e.value);if(yn(e))return e.filters.map(e=>xn(e)).join(",");{const t=e.filters.map(e=>xn(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function wn(e,t){return e instanceof mn?function(e,t){return t instanceof mn&&e.op===t.op&&e.field.isEqual(t.field)&&Vt(e.value,t.value)}(e,t):e instanceof gn?function(e,t){return t instanceof gn&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&wn(n,t.filters[r]),!0)}(e,t):void O(19439)}function Nn(e){return e instanceof mn?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Kt(e.value))}(e):e instanceof gn?function(e){return e.op.toString()+" {"+e.getFilters().map(Nn).join(" ,")+"}"}(e):"Filter"}class Sn extends mn{constructor(e,t,n){super(e,t,n),this.key=oe.fromName(n.referenceValue)}matches(e){const t=oe.comparator(e.key,this.key);return this.matchesComparison(t)}}class En extends mn{constructor(e,t){super(e,"in",t),this.keys=kn("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Cn extends mn{constructor(e,t){super(e,"not-in",t),this.keys=kn("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function kn(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>oe.fromName(e.referenceValue))}class An extends mn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Jt(t)&&Wt(t.arrayValue,this.value)}}class _n extends mn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Wt(this.value.arrayValue,t)}}class jn extends mn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Wt(this.value.arrayValue,t)}}class In extends mn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Jt(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Wt(this.value.arrayValue,e))}}class Tn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=a,this.startAt=i,this.endAt=o,this.Te=null}}function On(e){return new Tn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Pn(e){const t=R(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>xn(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),De(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Kt(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Kt(e)).join(",")),t.Te=e}return t.Te}function Dn(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!fn(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!wn(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!dn(e.startAt,t.startAt)&&dn(e.endAt,t.endAt)}function Rn(e){return oe.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Mn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=a,this.limitType=i,this.startAt=o,this.endAt=s,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Fn(e,t,n,r,a,i,o,s){return new Mn(e,t,n,r,a,i,o,s)}function Ln(e){return new Mn(e)}function Bn(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Un(e){return null!==e.collectionGroup}function zn(e){const t=R(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const a of t.explicitOrderBy)t.Ie.push(a),e.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new vt(ie.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new hn(r,n))}),e.has(ie.keyField().canonicalString())||t.Ie.push(new hn(ie.keyField(),n))}return t.Ie}function Vn(e){const t=R(e);return t.Ee||(t.Ee=qn(t,zn(e))),t.Ee}function Wn(e){const t=R(e);return t.de||(t.de=qn(t,e.explicitOrderBy)),t.de}function qn(e,t){if("F"===e.limitType)return On(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new hn(e.field,t)});const n=e.endAt?new cn(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new cn(e.startAt.position,e.startAt.inclusive):null;return On(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Hn(e,t){const n=e.filters.concat([t]);return new Mn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Gn(e,t,n){return new Mn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Kn(e,t){return Dn(Vn(e),Vn(t))&&e.limitType===t.limitType}function Xn(e){return"".concat(Pn(Vn(e)),"|lt:").concat(e.limitType)}function Yn(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>Nn(e)).join(", "),"]")),De(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Kt(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Kt(e)).join(",")),"Target(".concat(t,")")}(Vn(e)),"; limitType=").concat(e.limitType,")")}function Qn(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):oe.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of zn(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=un(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,zn(e),t))&&!(e.endAt&&!function(e,t,n){const r=un(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,zn(e),t))}(e,t)}function $n(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Jn(e){return(t,n)=>{let r=!1;for(const a of zn(e)){const e=Zn(a,t,n);if(0!==e)return e;r=r||a.field.isKeyField()}return 0}}function Zn(e,t,n){const r=e.field.isKeyField()?oe.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),a=n.data.field(e);return null!==r&&null!==a?qt(r,a):O(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return O(19790,{direction:e.dir})}}class er{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,a]of n)if(this.equalsFn(r,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){dt(this.inner,(t,n)=>{for(const[r,a]of n)e(r,a)})}isEmpty(){return ft(this.inner)}size(){return this.innerSize}}const tr=new pt(oe.comparator);function nr(){return tr}const rr=new pt(oe.comparator);function ar(){let e=rr;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.insert(a.key,a);return e}function ir(e){let t=rr;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function or(){return lr()}function sr(){return lr()}function lr(){return new er(e=>e.toString(),(e,t)=>e.isEqual(t))}const cr=new pt(oe.comparator),ur=new vt(oe.comparator);function dr(){let e=ur;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.add(a);return e}const hr=new vt(Y);function fr(){return hr}function pr(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Re(t)?"-0":t}}function mr(e){return{integerValue:""+e}}function gr(e,t){return Me(t)?mr(t):pr(e,t)}class vr{constructor(){this._=void 0}}function yr(e,t,n){return e instanceof wr?function(e,t){const n={fields:{[At]:{stringValue:kt},[jt]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&It(t)&&(t=Tt(t)),t&&(n.fields[_t]=t),{mapValue:n}}(n,t):e instanceof Nr?Sr(e,t):e instanceof Er?Cr(e,t):function(e,t){const n=xr(e,t),r=Ar(n)+Ar(e.Ae);return $t(n)&&$t(e.Ae)?mr(r):pr(e.serializer,r)}(e,t)}function br(e,t,n){return e instanceof Nr?Sr(e,t):e instanceof Er?Cr(e,t):n}function xr(e,t){return e instanceof kr?function(e){return $t(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class wr extends vr{}class Nr extends vr{constructor(e){super(),this.elements=e}}function Sr(e,t){const n=_r(t);for(const r of e.elements)n.some(e=>Vt(e,r))||n.push(r);return{arrayValue:{values:n}}}class Er extends vr{constructor(e){super(),this.elements=e}}function Cr(e,t){let n=_r(t);for(const r of e.elements)n=n.filter(e=>!Vt(e,r));return{arrayValue:{values:n}}}class kr extends vr{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Ar(e){return Et(e.integerValue||e.doubleValue)}function _r(e){return Jt(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class jr{constructor(e,t){this.field=e,this.transform=t}}class Ir{constructor(e,t){this.version=e,this.transformResults=t}}class Tr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Tr}static exists(e){return new Tr(void 0,e)}static updateTime(e){return new Tr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Or(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Pr{}function Dr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new qr(e.key,Tr.none()):new Br(e.key,e.data,Tr.none());{const n=e.data,r=on.empty();let a=new vt(ie.comparator);for(let e of t.fields)if(!a.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),a=a.add(e)}return new Ur(e.key,r,new bt(a.toArray()),Tr.none())}}function Rr(e,t,n){e instanceof Br?function(e,t,n){const r=e.value.clone(),a=Vr(e.fieldTransforms,t,n.transformResults);r.setAll(a),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Ur?function(e,t,n){if(!Or(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Vr(e.fieldTransforms,t,n.transformResults),a=t.data;a.setAll(zr(e)),a.setAll(r),t.convertToFoundDocument(n.version,a).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Mr(e,t,n,r){return e instanceof Br?function(e,t,n,r){if(!Or(e.precondition,t))return n;const a=e.value.clone(),i=Wr(e.fieldTransforms,r,t);return a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,n,r):e instanceof Ur?function(e,t,n,r){if(!Or(e.precondition,t))return n;const a=Wr(e.fieldTransforms,r,t),i=t.data;return i.setAll(zr(e)),i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return Or(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Fr(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),a=xr(r.transform,e||null);null!=a&&(null===n&&(n=on.empty()),n.set(r.field,a))}return n||null}function Lr(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ee(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Nr&&t instanceof Nr||e instanceof Er&&t instanceof Er?ee(e.elements,t.elements,Vt):e instanceof kr&&t instanceof kr?Vt(e.Ae,t.Ae):e instanceof wr&&t instanceof wr}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Br extends Pr{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ur extends Pr{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function zr(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Vr(e,t,n){const r=new Map;D(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let a=0;a<n.length;a++){const i=e[a],o=i.transform,s=t.data.field(i.field);r.set(i.field,br(o,s,n[a]))}return r}function Wr(e,t,n){const r=new Map;for(const a of e){const e=a.transform,i=n.data.field(a.field);r.set(a.field,yr(e,i,t))}return r}class qr extends Pr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Hr extends Pr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Gr{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Rr(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Mr(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Mr(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=sr();return this.mutations.forEach(r=>{const a=e.get(r.key),i=a.overlayedDocument;let o=this.applyToLocalView(i,a.mutatedFields);o=t.has(r.key)?null:o;const s=Dr(i,o);null!==s&&n.set(r.key,s),i.isValidDocument()||i.convertToNoDocument(be.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),dr())}isEqual(e){return this.batchId===e.batchId&&ee(this.mutations,e.mutations,(e,t)=>Lr(e,t))&&ee(this.baseMutations,e.baseMutations,(e,t)=>Lr(e,t))}}class Kr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){D(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=cr;const a=e.mutations;for(let i=0;i<a.length;i++)r=r.insert(a[i].key,n[i].version);return new Kr(e,t,n,r)}}class Xr{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Yr{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}class Qr{constructor(e,t){this.count=e,this.unchangedNames=t}}var $r,Jr;function Zr(e){switch(e){case M.OK:return O(64938);case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0;default:return O(15467,{code:e})}}function ea(e){if(void 0===e)return j("GRPC error has no .code"),M.UNKNOWN;switch(e){case $r.OK:return M.OK;case $r.CANCELLED:return M.CANCELLED;case $r.UNKNOWN:return M.UNKNOWN;case $r.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case $r.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case $r.INTERNAL:return M.INTERNAL;case $r.UNAVAILABLE:return M.UNAVAILABLE;case $r.UNAUTHENTICATED:return M.UNAUTHENTICATED;case $r.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case $r.NOT_FOUND:return M.NOT_FOUND;case $r.ALREADY_EXISTS:return M.ALREADY_EXISTS;case $r.PERMISSION_DENIED:return M.PERMISSION_DENIED;case $r.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case $r.ABORTED:return M.ABORTED;case $r.OUT_OF_RANGE:return M.OUT_OF_RANGE;case $r.UNIMPLEMENTED:return M.UNIMPLEMENTED;case $r.DATA_LOSS:return M.DATA_LOSS;default:return O(39323,{code:e})}}(Jr=$r||($r={}))[Jr.OK=0]="OK",Jr[Jr.CANCELLED=1]="CANCELLED",Jr[Jr.UNKNOWN=2]="UNKNOWN",Jr[Jr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Jr[Jr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Jr[Jr.NOT_FOUND=5]="NOT_FOUND",Jr[Jr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Jr[Jr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Jr[Jr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Jr[Jr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Jr[Jr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Jr[Jr.ABORTED=10]="ABORTED",Jr[Jr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Jr[Jr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Jr[Jr.INTERNAL=13]="INTERNAL",Jr[Jr.UNAVAILABLE=14]="UNAVAILABLE",Jr[Jr.DATA_LOSS=15]="DATA_LOSS";let ta=null;function na(){return new TextEncoder}const ra=new r([4294967295,4294967295],0);function aa(e){const t=na().encode(e),n=new a;return n.update(t),new Uint8Array(n.digest())}function ia(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),a=t.getUint32(4,!0),i=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new r([n,a],0),new r([i,o],0)]}class oa{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new sa("Invalid padding: ".concat(t));if(n<0)throw new sa("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new sa("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new sa("Invalid padding when bitmap length is 0: ".concat(t));this.ge=8*e.length-t,this.pe=r.fromNumber(this.ge)}ye(e,t,n){let a=e.add(t.multiply(r.fromNumber(n)));return 1===a.compare(ra)&&(a=new r([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=aa(e),[n,r]=ia(t);for(let a=0;a<this.hashCount;a++){const e=this.ye(n,r,a);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),i=new oa(a,r,t);return n.forEach(e=>i.insert(e)),i}insert(e){if(0===this.ge)return;const t=aa(e),[n,r]=ia(t);for(let a=0;a<this.hashCount;a++){const e=this.ye(n,r,a);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class sa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class la{constructor(e,t,n,r,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ca.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new la(be.min(),r,new pt(Y),nr(),dr())}}class ca{constructor(e,t,n,r,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ca(n,t,dr(),dr(),dr())}}class ua{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class da{constructor(e,t){this.targetId=e,this.Ce=t}}class ha{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wt.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class fa{constructor(){this.ve=0,this.Fe=ga(),this.Me=wt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=dr(),t=dr(),n=dr();return this.Fe.forEach((r,a)=>{switch(a){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:O(38017,{changeType:a})}}),new ca(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=ga()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,D(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class pa{constructor(e){this.Ge=e,this.ze=new Map,this.je=nr(),this.Je=ma(),this.He=ma(),this.Ye=new pt(Y)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:O(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(Rn(i))if(0===n){const e=new oe(i.path);this.et(t,e,ln.newNoDocument(e,be.min()))}else D(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){var a;const n=this.ut(e),i=n?this.ct(n,e,r):1;if(0!==i){this.it(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}null===(a=ta)||void 0===a||a.lt(function(e,t,n,r,a,i,o,s,l,c){const u={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(u.bloomFilter={applied:0===a,hashCount:null!==(i=null===d||void 0===d?void 0:d.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(o=null===d||void 0===d||null===(s=d.bits)||void 0===s||null===(s=s.bitmap)||void 0===s?void 0:s.length)&&void 0!==o?o:0,padding:null!==(l=null===d||void 0===d||null===(c=d.bits)||void 0===c?void 0:c.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null===r||void 0===r?void 0:r.mightContain(e))&&void 0!==t&&t}}),u}(r,e.Ce,this.Ge.ht(),n,i))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:a=0}=t;let i,o;try{i=Ct(n).toUint8Array()}catch(e){if(e instanceof xt)return I("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new oa(i,r,a)}catch(e){return I(e instanceof sa?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.ge?null:o}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const a=this.Ge.ht(),i="projects/".concat(a.projectId,"/databases/").concat(a.database,"/documents/").concat(n.path.canonicalString());e.mightContain(i)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const a=this.ot(r);if(a){if(n.current&&Rn(a.target)){const t=new oe(a.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,ln.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=dr();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new la(e,t,this.Ye,this.je,n);return this.je=nr(),this.Je=ma(),this.He=ma(),this.Ye=new pt(Y),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new fa,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new vt(Y),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new vt(Y),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||_("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new fa),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ma(){return new pt(oe.comparator)}function ga(){return new pt(oe.comparator)}const va={asc:"ASCENDING",desc:"DESCENDING"},ya={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ba={and:"AND",or:"OR"};class xa{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function wa(e,t){return e.useProto3Json||De(t)?t:{value:t}}function Na(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Sa(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ea(e,t){return Na(e,t.toTimestamp())}function Ca(e){return D(!!e,49232),be.fromTimestamp(function(e){const t=St(e);return new ye(t.seconds,t.nanos)}(e))}function ka(e,t){return Aa(e,t).canonicalString()}function Aa(e,t){const n=function(e){return new re(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function _a(e){const t=re.fromString(e);return D(Ya(t),10190,{key:t.toString()}),t}function ja(e,t){return ka(e.databaseId,t.path)}function Ia(e,t){const n=_a(t);if(n.get(1)!==e.databaseId.projectId)throw new F(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new F(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new oe(Da(n))}function Ta(e,t){return ka(e.databaseId,t)}function Oa(e){const t=_a(e);return 4===t.length?re.emptyPath():Da(t)}function Pa(e){return new re(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Da(e){return D(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function Ra(e,t,n){return{name:ja(e,t),fields:n.value.mapValue.fields}}function Ma(e,t){let n;if(t instanceof Br)n={update:Ra(e,t.key,t.value)};else if(t instanceof qr)n={delete:ja(e,t.key)};else if(t instanceof Ur)n={update:Ra(e,t.key,t.data),updateMask:Xa(t.fieldMask)};else{if(!(t instanceof Hr))return O(16599,{Vt:t.type});n={verify:ja(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof wr)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Nr)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Er)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof kr)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw O(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ea(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:O(27497)}(e,t.precondition)),n}function Fa(e,t){return{documents:[Ta(e,t.path)]}}function La(e,t){const n={structuredQuery:{}},r=t.path;let a;null!==t.collectionGroup?(a=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(a=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Ta(e,a);const i=function(e){if(0!==e.length)return Ka(gn.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const o=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:Ha(e.field),direction:Va(e.dir)}}(e))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const s=wa(e,t.limit);return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:a}}function Ba(e,t,n,r){const{ft:a,parent:i}=La(e,t),o={},s=[];let l=0;return n.forEach(e=>{const t=r?e.alias:"aggregate_"+l++;o[t]=e.alias,"count"===e.aggregateType?s.push({alias:t,count:{}}):"avg"===e.aggregateType?s.push({alias:t,avg:{field:Ha(e.fieldPath)}}):"sum"===e.aggregateType&&s.push({alias:t,sum:{field:Ha(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:s,structuredQuery:a.structuredQuery},parent:a.parent},gt:o,parent:i}}function Ua(e){let t=Oa(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){D(1===r,65062);const e=n.from[0];e.allDescendants?a=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=za(e);return t instanceof gn&&yn(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map(e=>function(e){return new hn(Ga(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let s=null;n.limit&&(s=function(e){let t;return t="object"==typeof e?e.value:e,De(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new cn(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new cn(n,t)}(n.endAt)),Fn(t,a,o,i,s,"F",l,c)}function za(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ga(e.unaryFilter.field);return mn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Ga(e.unaryFilter.field);return mn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ga(e.unaryFilter.field);return mn.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Ga(e.unaryFilter.field);return mn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return O(61313);default:return O(60726)}}(e):void 0!==e.fieldFilter?function(e){return mn.create(Ga(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return O(58110);default:return O(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return gn.create(e.compositeFilter.filters.map(e=>za(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return O(1026)}}(e.compositeFilter.op))}(e):O(30097,{filter:e})}function Va(e){return va[e]}function Wa(e){return ya[e]}function qa(e){return ba[e]}function Ha(e){return{fieldPath:e.canonicalString()}}function Ga(e){return ie.fromServerFormat(e.fieldPath)}function Ka(e){return e instanceof mn?function(e){if("=="===e.op){if(en(e.value))return{unaryFilter:{field:Ha(e.field),op:"IS_NAN"}};if(Zt(e.value))return{unaryFilter:{field:Ha(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(en(e.value))return{unaryFilter:{field:Ha(e.field),op:"IS_NOT_NAN"}};if(Zt(e.value))return{unaryFilter:{field:Ha(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ha(e.field),op:Wa(e.op),value:e.value}}}(e):e instanceof gn?function(e){const t=e.getFilters().map(e=>Ka(e));return 1===t.length?t[0]:{compositeFilter:{op:qa(e.op),filters:t}}}(e):O(54877,{filter:e})}function Xa(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Ya(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Qa{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:be.min(),i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:be.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:wt.EMPTY_BYTE_STRING,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=s}withSequenceNumber(e){return new Qa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Qa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class $a{constructor(e){this.yt=e}}function Ja(e){const t=Ua({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Gn(t,t.limit,"L"):t}class Za{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Et(e.integerValue));else if("doubleValue"in e){const n=Et(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),Re(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=St(n)),t.xt("".concat(n.seconds||"")),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ct(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?an(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):nn(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):O(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){var n;const r=e.fields||{};this.Ft(t,53);const a=Ut,i=(null===(n=r[a].arrayValue)||void 0===n||null===(n=n.values)||void 0===n?void 0:n.length)||0;this.Ft(t,15),t.Mt(Et(i)),this.Ot(a,t),this.Ct(r[a],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),oe.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Za.Kt=new Za;class ei{constructor(){this.Cn=new ti}addToCollectionParentIndex(e,t){return this.Cn.add(t),je.resolve()}getCollectionParents(e,t){return je.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return je.resolve()}deleteFieldIndex(e,t){return je.resolve()}deleteAllFieldIndexes(e){return je.resolve()}createTargetIndexes(e,t){return je.resolve()}getDocumentsMatchingTarget(e,t){return je.resolve(null)}getIndexType(e,t){return je.resolve(0)}getFieldIndexes(e,t){return je.resolve([])}getNextCollectionGroupToUpdate(e){return je.resolve(null)}getMinOffset(e,t){return je.resolve(Ee.min())}getMinOffsetFromCollectionGroup(e,t){return je.resolve(Ee.min())}updateCollectionGroup(e,t,n){return je.resolve()}updateIndexEntries(e,t){return je.resolve()}}class ti{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new vt(re.comparator),a=!r.has(n);return this.index[t]=r.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new vt(re.comparator)).toArray()}}new Uint8Array(0);const ni={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ri=41943040;class ai{static withCacheSize(e){return new ai(e,ai.DEFAULT_COLLECTION_PERCENTILE,ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}ai.DEFAULT_COLLECTION_PERCENTILE=10,ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ai.DEFAULT=new ai(ri,ai.DEFAULT_COLLECTION_PERCENTILE,ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ai.DISABLED=new ai(-1,0,0);class ii{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ii(0)}static cr(){return new ii(-1)}}const oi="LruGarbageCollector",si=1048576;function li(e,t){let[n,r]=e,[a,i]=t;const o=Y(n,a);return 0===o?Y(r,i):o}class ci{constructor(e){this.Ir=e,this.buffer=new vt(li),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();li(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ui{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){_(oi,"Garbage collection scheduled in ".concat(e,"ms")),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Te(e)?_(oi,"Ignoring IndexedDB error during garbage collection: ",e):await _e(e)}await this.Vr(3e5)})}}class di{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return je.resolve(Oe.ce);const n=new ci(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(_("LruGarbageCollector","Garbage collection skipped; disabled"),je.resolve(ni)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(_("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),ni):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,a,i,o,s,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(_("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,i=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,o=Date.now(),this.removeTargets(e,n,t))).next(t=>(a=t,s=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(c=Date.now(),A()<=l.$b.DEBUG&&_("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(i-u,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-i)+"ms\n"+"\tRemoved ".concat(a," targets in ")+(s-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(c-s)+"ms\n"+"Total Duration: ".concat(c-u,"ms")),je.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:a,documentsRemoved:e})))}}function hi(e,t){return new di(e,t)}class fi{constructor(){this.changes=new er(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ln.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?je.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class pi{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class mi{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Mr(n.mutation,e,bt.empty(),ye.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,dr()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:dr();const r=or();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=ar();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=or();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,dr()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let a=nr();const i=lr(),o=lr();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Ur)?a=a.insert(t.key,t):void 0!==o?(i.set(t.key,o.mutation.getFieldMask()),Mr(o.mutation,t,o.mutation.getFieldMask(),ye.now())):i.set(t.key,bt.empty())}),this.recalculateAndSaveOverlays(e,a).next(e=>(e.forEach((e,t)=>i.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new pi(t,null!==(n=i.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=lr();let r=new pt((e,t)=>e-t),a=dr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const a of e)a.keys().forEach(e=>{const i=t.get(e);if(null===i)return;let o=n.get(e)||bt.empty();o=a.applyToLocalView(i,o),n.set(e,o);const s=(r.get(a.batchId)||dr()).add(e);r=r.insert(a.batchId,s)})}).next(()=>{const i=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),s=r.key,l=r.value,c=sr();l.forEach(e=>{if(!a.has(e)){const r=Dr(t.get(e),n.get(e));null!==r&&c.set(e,r),a=a.add(e)}}),i.push(this.documentOverlayCache.saveOverlays(e,s,c))}return je.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return oe.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Un(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(a=>{const i=r-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):je.resolve(or());let o=xe,s=a;return i.next(t=>je.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),a.get(t)?je.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{s=s.insert(t,e)}))).next(()=>this.populateOverlays(e,t,a)).next(()=>this.computeViews(e,s,t,dr())).next(e=>({batchId:o,changes:ir(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new oe(t)).next(e=>{let t=ar();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const a=t.collectionGroup;let i=ar();return this.indexManager.getCollectionParents(e,a).next(o=>je.forEach(o,o=>{const s=function(e,t){return new Mn(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(a));return this.getDocumentsMatchingCollectionQuery(e,s,n,r).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n,r){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,r))).next(e=>{a.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,ln.newInvalidDocument(r)))});let n=ar();return e.forEach((e,r)=>{const i=a.get(e);void 0!==i&&Mr(i.mutation,r,bt.empty(),ye.now()),Qn(t,r)&&(n=n.insert(e,r))}),n})}}class gi{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return je.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Ca(e.createTime)}}(t)),je.resolve()}getNamedQuery(e,t){return je.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:Ja(e.bundledQuery),readTime:Ca(e.readTime)}}(t)),je.resolve()}}class vi{constructor(){this.overlays=new pt(oe.comparator),this.qr=new Map}getOverlay(e,t){return je.resolve(this.overlays.get(t))}getOverlays(e,t){const n=or();return je.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),je.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),je.resolve()}getOverlaysForCollection(e,t,n){const r=or(),a=t.length+1,i=new oe(t.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const e=o.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===a&&e.largestBatchId>n&&r.set(e.getKey(),e)}return je.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let a=new pt((e,t)=>e-t);const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=a.get(e.largestBatchId);null===t&&(t=or(),a=a.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=or(),s=a.getIterator();for(;s.hasNext()&&(s.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return je.resolve(o)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Xr(t,n));let a=this.qr.get(t);void 0===a&&(a=dr(),this.qr.set(t,a)),this.qr.set(t,a.add(n.key))}}class yi{constructor(){this.sessionToken=wt.EMPTY_BYTE_STRING}getSessionToken(e){return je.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,je.resolve()}}class bi{constructor(){this.Qr=new vt(xi.$r),this.Ur=new vt(xi.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new xi(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new xi(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new oe(new re([])),n=new xi(t,e),r=new xi(t,e+1),a=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),a.push(e.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new oe(new re([])),n=new xi(t,e),r=new xi(t,e+1);let a=dr();return this.Ur.forEachInRange([n,r],e=>{a=a.add(e.key)}),a}containsKey(e){const t=new xi(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class xi{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return oe.comparator(e.key,t.key)||Y(e.Yr,t.Yr)}static Kr(e,t){return Y(e.Yr,t.Yr)||oe.comparator(e.key,t.key)}}class wi{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new vt(xi.$r)}checkEmpty(e){return je.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new Gr(a,t,n,r);this.mutationQueue.push(i);for(const o of r)this.Zr=this.Zr.add(new xi(o.key,a)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return je.resolve(i)}lookupMutationBatch(e,t){return je.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),a=r<0?0:r;return je.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return je.resolve(0===this.mutationQueue.length?Pe:this.tr-1)}getAllMutationBatches(e){return je.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new xi(t,0),r=new xi(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);a.push(t)}),je.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new vt(Y);return t.forEach(e=>{const t=new xi(e,0),r=new xi(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),je.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let a=n;oe.isDocumentKey(a)||(a=a.child(""));const i=new xi(new oe(a),0);let o=new vt(Y);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Yr)),!0)},i),je.resolve(this.ti(o))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){D(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return je.forEach(t.mutations,r=>{const a=new xi(r.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new xi(t,0),r=this.Zr.firstAfterOrEqual(n);return je.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,je.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Ni{constructor(e){this.ri=e,this.docs=new pt(oe.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),a=r?r.size:0,i=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return je.resolve(n?n.document.mutableCopy():ln.newInvalidDocument(t))}getEntries(e,t){let n=nr();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():ln.newInvalidDocument(e))}),je.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let a=nr();const i=t.path,o=new oe(i.child("__id-9223372036854775808__")),s=this.docs.getIteratorFrom(o);for(;s.hasNext();){const{key:e,value:{document:o}}=s.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||Ce(Se(o),n)<=0||(r.has(o.key)||Qn(t,o))&&(a=a.insert(o.key,o.mutableCopy()))}return je.resolve(a)}getAllFromCollectionGroup(e,t,n,r){O(9500)}ii(e,t){return je.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Si(this)}getSize(e){return je.resolve(this.size)}}class Si extends fi{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),je.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Ei{constructor(e){this.persistence=e,this.si=new er(e=>Pn(e),Dn),this.lastRemoteSnapshotVersion=be.min(),this.highestTargetId=0,this.oi=0,this._i=new bi,this.targetCount=0,this.ai=ii.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),je.resolve()}getLastRemoteSnapshotVersion(e){return je.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return je.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),je.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),je.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new ii(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,je.resolve()}updateTargetData(e,t){return this.Pr(t),je.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,je.resolve()}removeTargets(e,t,n){let r=0;const a=[];return this.si.forEach((i,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.si.delete(i),a.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),je.waitFor(a).next(()=>r)}getTargetCount(e){return je.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return je.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),je.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,a=[];return r&&t.forEach(t=>{a.push(r.markPotentiallyOrphaned(e,t))}),je.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),je.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return je.resolve(n)}containsKey(e,t){return je.resolve(this._i.containsKey(t))}}class Ci{constructor(e,t){this.ui={},this.overlays={},this.ci=new Oe(0),this.li=!1,this.li=!0,this.hi=new yi,this.referenceDelegate=e(this),this.Pi=new Ei(this),this.indexManager=new ei,this.remoteDocumentCache=function(e){return new Ni(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new $a(t),this.Ii=new gi(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new vi,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new wi(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){_("MemoryPersistence","Starting transaction:",e);const r=new ki(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return je.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class ki extends Ae{constructor(e){super(),this.currentSequenceNumber=e}}class Ai{constructor(e){this.persistence=e,this.Ri=new bi,this.Vi=null}static mi(e){return new Ai(e)}get fi(){if(this.Vi)return this.Vi;throw O(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),je.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),je.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),je.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return je.forEach(this.fi,n=>{const r=oe.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,be.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return je.or([()=>je.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class _i{constructor(e,t){this.persistence=e,this.pi=new er(e=>Le(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=hi(this,t)}static mi(e,t){return new _i(e,t)}Ei(){}di(e){return je.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return je.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?je.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),a=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,a.removeEntry(r,be.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),je.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),je.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),je.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),je.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Yt(e.data.value)),t}br(e,t,n){return je.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return je.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ji{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=dr(),r=dr();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}return new ji(e,t.fromCache,n,r)}}class Ii{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Ti{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(0,c.nr)()?8:Ie((0,c.ZQ)())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const a={result:null};return this.ys(e,t).next(e=>{a.result=e}).next(()=>{if(!a.result)return this.ws(e,t,r,n).next(e=>{a.result=e})}).next(()=>{if(a.result)return;const n=new Ii;return this.Ss(e,t,n).next(r=>{if(a.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>a.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(A()<=l.$b.DEBUG&&_("QueryEngine","SDK will not create cache indexes for query:",Yn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),je.resolve()):(A()<=l.$b.DEBUG&&_("QueryEngine","Query:",Yn(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(A()<=l.$b.DEBUG&&_("QueryEngine","The SDK decides to create cache indexes for query:",Yn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vn(t))):je.resolve())}ys(e,t){if(Bn(t))return je.resolve(null);let n=Vn(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=Gn(t,null,"F"),n=Vn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const a=dr(...r);return this.ps.getDocuments(e,a).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const i=this.Ds(t,r);return this.Cs(t,i,a,n.readTime)?this.ys(e,Gn(t,null,"F")):this.vs(e,i,t,n)}))})))}ws(e,t,n,r){return Bn(t)||r.isEqual(be.min())?je.resolve(null):this.ps.getDocuments(e,n).next(a=>{const i=this.Ds(t,a);return this.Cs(t,i,n,r)?je.resolve(null):(A()<=l.$b.DEBUG&&_("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Yn(t)),this.vs(e,i,t,Ne(r,xe)).next(e=>e))})}Ds(e,t){let n=new vt(Jn(e));return t.forEach((t,r)=>{Qn(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}Ss(e,t,n){return A()<=l.$b.DEBUG&&_("QueryEngine","Using full collection scan to execute query:",Yn(t)),this.ps.getDocumentsMatchingQuery(e,t,Ee.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const Oi="LocalStore",Pi=3e8;class Di{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new pt(Y),this.xs=new er(e=>Pn(e),Dn),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new mi(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function Ri(e,t,n,r){return new Di(e,t,n,r)}async function Mi(e,t){const n=R(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(a=>(r=a,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const a=[],i=[];let o=dr();for(const e of r){a.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({Ls:e,removedBatchIds:a,addedBatchIds:i}))})})}function Fi(e){const t=R(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function Li(e,t,n){let r=dr(),a=dr();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=nr();return n.forEach((n,i)=>{const o=e.get(n);i.isFoundDocument()!==o.isFoundDocument()&&(a=a.add(n)),i.isNoDocument()&&i.version.isEqual(be.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!o.isValidDocument()||i.version.compareTo(o.version)>0||0===i.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):_(Oi,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",i.version)}),{ks:r,qs:a}})}function Bi(e,t){const n=R(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=Pe),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Ui(e,t){const n=R(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(a=>a?(r=a,je.resolve(r)):n.Pi.allocateTargetId(e).next(a=>(r=new Qa(t,a,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}async function zi(e,t,n){const r=R(e),a=r.Ms.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,e=>r.persistence.referenceDelegate.removeTarget(e,a))}catch(e){if(!Te(e))throw e;_(Oi,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.Ms=r.Ms.remove(t),r.xs.delete(a.target)}function Vi(e,t,n){const r=R(e);let a=be.min(),i=dr();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=R(e),a=r.xs.get(n);return void 0!==a?je.resolve(r.Ms.get(a)):r.Pi.getTargetData(t,n)}(r,e,Vn(t)).next(t=>{if(t)return a=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{i=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?a:be.min(),n?i:dr())).next(e=>(Wi(r,$n(t),e),{documents:e,Qs:i})))}function Wi(e,t,n){let r=e.Os.get(t)||be.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}class qi{constructor(){this.activeTargetIds=fr()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Hi{constructor(){this.Mo=new qi,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new qi,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Gi{Oo(e){}shutdown(){}}const Ki="ConnectivityMonitor";class Xi{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){_(Ki,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){_(Ki,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Yi=null;function Qi(){return null===Yi?Yi=268435456+Math.round(2147483648*Math.random()):Yi++,"0x"+Yi.toString(16)}const $i="RestConnection",Ji={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Zi{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko="projects/".concat(n,"/databases/").concat(r),this.Wo=this.databaseId.database===Dt?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Go(e,t,n,r,a){const i=Qi(),o=this.zo(e,t.toUriEncodedString());_($i,"Sending RPC '".concat(e,"' ").concat(i,":"),o,n);const s={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(s,r,a);const{host:l}=new URL(o),u=(0,c.zJ)(l);return this.Jo(e,o,s,n,u).then(t=>(_($i,"Received RPC '".concat(e,"' ").concat(i,": "),t),t),t=>{throw I($i,"RPC '".concat(e,"' ").concat(i," failed with error: "),t,"url: ",o,"request:",n),t})}Ho(e,t,n,r,a,i){return this.Go(e,t,n,r,a)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+C,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=Ji[e];return"".concat(this.Uo,"/v1/").concat(t,":").concat(n)}terminate(){}}class eo{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const to="WebChannelConnection";class no extends Zi{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,a){const i=Qi();return new Promise((a,o)=>{const s=new h;s.setWithCredentials(!0),s.listenOnce(p.COMPLETE,()=>{try{switch(s.getLastErrorCode()){case m.NO_ERROR:const n=s.getResponseJson();_(to,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(n)),a(n);break;case m.TIMEOUT:_(to,"RPC '".concat(e,"' ").concat(i," timed out")),o(new F(M.DEADLINE_EXCEEDED,"Request time out"));break;case m.HTTP_ERROR:const r=s.getStatus();if(_(to,"RPC '".concat(e,"' ").concat(i," failed with status:"),r,"response text:",s.getResponseText()),r>0){var t;let e=s.getResponseJson();Array.isArray(e)&&(e=e[0]);const n=null===(t=e)||void 0===t?void 0:t.error;if(n&&n.status&&n.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(t)>=0?t:M.UNKNOWN}(n.status);o(new F(e,n.message))}else o(new F(M.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new F(M.UNAVAILABLE,"Connection failed."));break;default:O(9055,{l_:e,streamId:i,h_:s.getLastErrorCode(),P_:s.getLastError()})}}finally{_(to,"RPC '".concat(e,"' ").concat(i," completed."))}});const l=JSON.stringify(r);_(to,"RPC '".concat(e,"' ").concat(i," sending request:"),r),s.send(t,"POST",l,n,15)})}T_(e,t,n){const r=Qi(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=b(),o=y(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(s.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(s.useFetchStreams=!0),this.jo(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;const c=a.join("");_(to,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),s);const u=i.createWebChannel(c,s);this.I_(u);let d=!1,h=!1;const p=new eo({Yo:t=>{h?_(to,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(d||(_(to,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),d=!0),_(to,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},Zo:()=>u.close()}),m=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return m(u,f.EventType.OPEN,()=>{h||(_(to,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),p.o_())}),m(u,f.EventType.CLOSE,()=>{h||(h=!0,_(to,"RPC '".concat(e,"' stream ").concat(r," transport closed")),p.a_(),this.E_(u))}),m(u,f.EventType.ERROR,t=>{h||(h=!0,I(to,"RPC '".concat(e,"' stream ").concat(r," transport errored. Name:"),t.name,"Message:",t.message),p.a_(new F(M.UNAVAILABLE,"The operation could not be completed")))}),m(u,f.EventType.MESSAGE,t=>{if(!h){var n;const a=t.data[0];D(!!a,16349);const i=a,o=(null===i||void 0===i?void 0:i.error)||(null===(n=i[0])||void 0===n?void 0:n.error);if(o){_(to,"RPC '".concat(e,"' stream ").concat(r," received error:"),o);const t=o.status;let n=function(e){const t=$r[e];if(void 0!==t)return ea(t)}(t),a=o.message;void 0===n&&(n=M.INTERNAL,a="Unknown error status: "+t+" with message "+o.message),h=!0,p.a_(new F(n,a)),u.close()}else _(to,"RPC '".concat(e,"' stream ").concat(r," received:"),a),p.u_(a)}}),m(o,v.STAT_EVENT,t=>{t.stat===g.PROXY?_(to,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===g.NOPROXY&&_(to,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{p.__()},0),p}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function ro(){return"undefined"!=typeof document?document:null}function ao(e){return new xa(e,!0)}class io{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&_("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.V_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const oo="PersistentStream";class so{constructor(e,t,n,r,a,i,o,s){this.Mi=e,this.S_=n,this.b_=r,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=s,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new io(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===M.RESOURCE_EXHAUSTED?(j(t.toString()),j("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===M.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.D_===t&&this.G_(n,r)},t=>{e(()=>{const e=new F(M.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return _(oo,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(_(oo,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class lo extends so{constructor(e,t,n,r,a,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,i),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:O(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],i=function(e,t){return e.useProto3Json?(D(void 0===t||"string"==typeof t,58123),wt.fromBase64String(t||"")):(D(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),wt.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&function(e){const t=void 0===e.code?M.UNKNOWN:ea(e.code);return new F(t,e.message||"")}(o);n=new ha(r,a,i,s||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const a=Ia(e,r.document.name),i=Ca(r.document.updateTime),o=r.document.createTime?Ca(r.document.createTime):be.min(),s=new on({mapValue:{fields:r.document.fields}}),l=ln.newFoundDocument(a,i,o,s),c=r.targetIds||[],u=r.removedTargetIds||[];n=new ua(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const a=Ia(e,r.document),i=r.readTime?Ca(r.readTime):be.min(),o=ln.newNoDocument(a,i),s=r.removedTargetIds||[];n=new ua([],s,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const a=Ia(e,r.document),i=r.removedTargetIds||[];n=new ua([],i,a,null)}else{if(!("filter"in t))return O(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:a}=e,i=new Qr(r,a),o=e.targetId;n=new da(o,i)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return be.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?be.min():t.readTime?Ca(t.readTime):be.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Pa(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Rn(r)?{documents:Fa(e,r)}:{query:La(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Sa(e,t.resumeToken);const r=wa(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(be.min())>0){n.readTime=Na(e,t.snapshotVersion.toTimestamp());const r=wa(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return O(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Pa(this.serializer),t.removeTarget=e,this.q_(t)}}class co extends so{constructor(e,t,n,r,a,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,i),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return D(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,D(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){D(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(D(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?Ca(e.updateTime):Ca(t);return n.isEqual(be.min())&&(n=Ca(t)),new Ir(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Ca(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Pa(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Ma(this.serializer,e))};this.q_(t)}}class uo{}class ho extends uo{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new F(M.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(a=>{let[i,o]=a;return this.connection.Go(e,Aa(t,n),r,i,o)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new F(M.UNKNOWN,e.toString())})}Ho(e,t,n,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[o,s]=i;return this.connection.Ho(e,Aa(t,n),r,o,s,a)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new F(M.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class fo{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.aa?(j(t),this.aa=!1):_("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const po="RemoteStore";class mo{constructor(e,t,n,r,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{Eo(this)&&(_(po,"Restarting streams for network reachability change."),await async function(e){const t=R(e);t.Ea.add(4),await vo(t),t.Ra.set("Unknown"),t.Ea.delete(4),await go(t)}(this))})}),this.Ra=new fo(n,r)}}async function go(e){if(Eo(e))for(const t of e.da)await t(!0)}async function vo(e){for(const t of e.da)await t(!1)}function yo(e,t){const n=R(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),So(n)?No(n):Wo(n).O_()&&xo(n,t))}function bo(e,t){const n=R(e),r=Wo(n);n.Ia.delete(t),r.O_()&&wo(n,t),0===n.Ia.size&&(r.O_()?r.L_():Eo(n)&&n.Ra.set("Unknown"))}function xo(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(be.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Wo(e).Y_(t)}function wo(e,t){e.Va.Ue(t),Wo(e).Z_(t)}function No(e){e.Va=new pa({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Wo(e).start(),e.Ra.ua()}function So(e){return Eo(e)&&!Wo(e).x_()&&e.Ia.size>0}function Eo(e){return 0===R(e).Ea.size}function Co(e){e.Va=void 0}async function ko(e){e.Ra.set("Online")}async function Ao(e){e.Ia.forEach((t,n)=>{xo(e,t)})}async function _o(e,t){Co(e),So(e)?(e.Ra.ha(t),No(e)):e.Ra.set("Unknown")}async function jo(e,t,n){if(e.Ra.set("Online"),t instanceof ha&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){_(po,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Io(e,n)}else if(t instanceof ua?e.Va.Ze(t):t instanceof da?e.Va.st(t):e.Va.tt(t),!n.isEqual(be.min()))try{const t=await Fi(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const a=e.Ia.get(r);a&&e.Ia.set(r,a.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(wt.EMPTY_BYTE_STRING,r.snapshotVersion)),wo(e,t);const a=new Qa(r.target,t,n,r.sequenceNumber);xo(e,a)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){_(po,"Failed to raise snapshot:",t),await Io(e,t)}}async function Io(e,t,n){if(!Te(t))throw t;e.Ea.add(1),await vo(e),e.Ra.set("Offline"),n||(n=()=>Fi(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{_(po,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await go(e)})}function To(e,t){return t().catch(n=>Io(e,n,t))}async function Oo(e){const t=R(e),n=qo(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Pe;for(;Po(t);)try{const e=await Bi(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,Do(t,e)}catch(e){await Io(t,e)}Ro(t)&&Mo(t)}function Po(e){return Eo(e)&&e.Ta.length<10}function Do(e,t){e.Ta.push(t);const n=qo(e);n.O_()&&n.X_&&n.ea(t.mutations)}function Ro(e){return Eo(e)&&!qo(e).x_()&&e.Ta.length>0}function Mo(e){qo(e).start()}async function Fo(e){qo(e).ra()}async function Lo(e){const t=qo(e);for(const n of e.Ta)t.ea(n.mutations)}async function Bo(e,t,n){const r=e.Ta.shift(),a=Kr.from(r,t,n);await To(e,()=>e.remoteSyncer.applySuccessfulWrite(a)),await Oo(e)}async function Uo(e,t){t&&qo(e).X_&&await async function(e,t){if(function(e){return Zr(e)&&e!==M.ABORTED}(t.code)){const n=e.Ta.shift();qo(e).B_(),await To(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Oo(e)}}(e,t),Ro(e)&&Mo(e)}async function zo(e,t){const n=R(e);n.asyncQueue.verifyOperationInProgress(),_(po,"RemoteStore received new credentials");const r=Eo(n);n.Ea.add(3),await vo(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await go(n)}async function Vo(e,t){const n=R(e);t?(n.Ea.delete(2),await go(n)):t||(n.Ea.add(2),await vo(n),n.Ra.set("Unknown"))}function Wo(e){return e.ma||(e.ma=function(e,t,n){const r=R(e);return r.sa(),new lo(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:ko.bind(null,e),t_:Ao.bind(null,e),r_:_o.bind(null,e),H_:jo.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),So(e)?No(e):e.Ra.set("Unknown")):(await e.ma.stop(),Co(e))})),e.ma}function qo(e){return e.fa||(e.fa=function(e,t,n){const r=R(e);return r.sa(),new co(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Fo.bind(null,e),r_:Uo.bind(null,e),ta:Lo.bind(null,e),na:Bo.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await Oo(e)):(await e.fa.stop(),e.Ta.length>0&&(_(po,"Stopping write stream with ".concat(e.Ta.length," pending writes")),e.Ta=[]))})),e.fa}class Ho{constructor(e,t,n,r,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=a,this.deferred=new L,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,a){const i=Date.now()+n,o=new Ho(e,t,i,r,a);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new F(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Go(e,t){if(j("AsyncQueue","".concat(t,": ").concat(e)),Te(e))return new F(M.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Ko{static emptySet(e){return new Ko(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||oe.comparator(t.key,n.key):(e,t)=>oe.comparator(e.key,t.key),this.keyedMap=ar(),this.sortedSet=new pt(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ko))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Ko;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Xo{constructor(){this.ga=new pt(oe.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):O(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class Yo{constructor(e,t,n,r,a,i,o,s,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=s,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,a){const i=[];return t.forEach(e=>{i.push({type:0,doc:e})}),new Yo(e,t,Ko.emptySet(t),i,n,r,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Qo{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class $o{constructor(){this.queries=Jo(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=R(e),r=n.queries;n.queries=Jo(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new F(M.ABORTED,"Firestore shutting down"))}}function Jo(){return new er(e=>Xn(e),Kn)}async function Zo(e,t){const n=R(e);let r=3;const a=t.query;let i=n.queries.get(a);i?!i.ba()&&t.Da()&&(r=2):(i=new Qo,r=t.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(a,!0);break;case 1:i.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(e){const n=Go(e,"Initialization of query '".concat(Yn(t.query),"' failed"));return void t.onError(n)}n.queries.set(a,i),i.Sa.push(t),t.va(n.onlineState),i.wa&&t.Fa(i.wa)&&rs(n)}async function es(e,t){const n=R(e),r=t.query;let a=3;const i=n.queries.get(r);if(i){const e=i.Sa.indexOf(t);e>=0&&(i.Sa.splice(e,1),0===i.Sa.length?a=t.Da()?0:1:!i.ba()&&t.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function ts(e,t){const n=R(e);let r=!1;for(const a of t){const e=a.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(a)&&(r=!0);t.wa=a}}r&&rs(n)}function ns(e,t,n){const r=R(e),a=r.queries.get(t);if(a)for(const i of a.Sa)i.onError(n);r.queries.delete(t)}function rs(e){e.Ca.forEach(e=>{e.next()})}var as,is;(is=as||(as={})).Ma="default",is.Cache="cache";class os{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Yo(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=Yo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==as.Cache}}class ss{constructor(e){this.key=e}}class ls{constructor(e){this.key=e}}class cs{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=dr(),this.mutatedKeys=dr(),this.eu=Jn(e),this.tu=new Ko(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Xo,r=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,i=r,o=!1;const s="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=Qn(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.su(c,u)||(n.track({type:2,doc:u}),f=!0,(s&&this.eu(u,s)>0||l&&this.eu(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(s||l)&&(o=!0)),f&&(u?(i=i.add(u),a=h?a.add(e):a.delete(e)):(i=i.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),a=a.delete(e.key),n.track({type:1,doc:e})}return{tu:i,iu:n,Cs:o,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const i=e.iu.ya();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return O(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=null!==r&&void 0!==r&&r;const o=t&&!r?this._u():[],s=0===this.Xa.size&&this.current&&!r?1:0,l=s!==this.Za;return this.Za=s,0!==i.length||l?{snapshot:new Yo(this.query,e.tu,a,i,e.mutatedKeys,0===s,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Xo,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=dr(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new ls(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new ss(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=dr();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Yo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const us="SyncEngine";class ds{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class hs{constructor(e){this.key=e,this.hu=!1}}class fs{constructor(e,t,n,r,a,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new er(e=>Xn(e),Kn),this.Iu=new Map,this.Eu=new Set,this.du=new pt(oe.comparator),this.Au=new Map,this.Ru=new bi,this.Vu={},this.mu=new Map,this.fu=ii.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function ps(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Rs(e);let a;const i=r.Tu.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.lu()):a=await gs(r,t,n,!0),a}async function ms(e,t){const n=Rs(e);await gs(n,t,!0,!1)}async function gs(e,t,n,r){const a=await Ui(e.localStore,Vn(t)),i=a.targetId,o=e.sharedClientState.addLocalQueryTarget(i,n);let s;return r&&(s=await vs(e,t,i,"current"===o,a.resumeToken)),e.isPrimaryClient&&n&&yo(e.remoteStore,a),s}async function vs(e,t,n,r,a){e.pu=(t,n,r)=>async function(e,t,n,r){let a=t.view.ru(n);a.Cs&&(a=await Vi(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ru(n,a)}));const i=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),s=t.view.applyChanges(a,e.isPrimaryClient,i,o);return js(e,t.targetId,s.au),s.snapshot}(e,t,n,r);const i=await Vi(e.localStore,t,!0),o=new cs(t,i.Qs),s=o.ru(i.documents),l=ca.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,a),c=o.applyChanges(s,e.isPrimaryClient,l);js(e,n,c.au);const u=new ds(t,n,o);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),c.snapshot}async function ys(e,t,n){const r=R(e),a=r.Tu.get(t),i=r.Iu.get(a.targetId);if(i.length>1)return r.Iu.set(a.targetId,i.filter(e=>!Kn(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await zi(r.localStore,a.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(a.targetId),n&&bo(r.remoteStore,a.targetId),As(r,a.targetId)}).catch(_e)):(As(r,a.targetId),await zi(r.localStore,a.targetId,!0))}async function bs(e,t){const n=R(e),r=n.Tu.get(t),a=n.Iu.get(r.targetId);n.isPrimaryClient&&1===a.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),bo(n.remoteStore,r.targetId))}async function xs(e,t){const n=R(e);try{const e=await function(e,t){const n=R(e),r=t.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const i=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const o=[];t.targetChanges.forEach((i,s)=>{const l=a.get(s);if(!l)return;o.push(n.Pi.removeMatchingKeys(e,i.removedDocuments,s).next(()=>n.Pi.addMatchingKeys(e,i.addedDocuments,s)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(s)?c=c.withResumeToken(wt.EMPTY_BYTE_STRING,be.min()).withLastLimboFreeSnapshotVersion(be.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,r)),a=a.insert(s,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=Pi||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,i)&&o.push(n.Pi.updateTargetData(e,c))});let s=nr(),l=dr();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(Li(e,i,t.documentUpdates).next(e=>{s=e.ks,l=e.qs})),!r.isEqual(be.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return je.waitFor(o).next(()=>i.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,s,l)).next(()=>s)}).then(e=>(n.Ms=a,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(D(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?D(r.hu,14607):e.removedDocuments.size>0&&(D(r.hu,42227),r.hu=!1))}),await Os(n,e,t)}catch(e){await _e(e)}}function ws(e,t,n){const r=R(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const a=r.view.va(t);a.snapshot&&e.push(a.snapshot)}),function(e,t){const n=R(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const a of n.Sa)a.va(t)&&(r=!0)}),r&&rs(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Ns(e,t,n){const r=R(e);r.sharedClientState.updateQueryState(t,"rejected",n);const a=r.Au.get(t),i=a&&a.key;if(i){let e=new pt(oe.comparator);e=e.insert(i,ln.newNoDocument(i,be.min()));const n=dr().add(i),a=new la(be.min(),new Map,new pt(Y),e,n);await xs(r,a),r.du=r.du.remove(i),r.Au.delete(t),Ts(r)}else await zi(r.localStore,t,!1).then(()=>As(r,t,n)).catch(_e)}async function Ss(e,t){const n=R(e),r=t.batch.batchId;try{const e=await function(e,t){const n=R(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),a=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const a=n.batch,i=a.keys();let o=je.resolve();return i.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const i=n.docVersions.get(e);D(null!==i,48541),t.version.compareTo(i)<0&&(a.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,a))}(n,e,t,a).next(()=>a.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=dr();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);ks(n,r,null),Cs(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Os(n,e)}catch(e){await _e(e)}}async function Es(e,t,n){const r=R(e);try{const e=await function(e,t){const n=R(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(D(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);ks(r,t,n),Cs(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Os(r,e)}catch(n){await _e(n)}}function Cs(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function ks(e,t,n){const r=R(e);let a=r.Vu[r.currentUser.toKey()];if(a){const e=a.get(t);e&&(n?e.reject(n):e.resolve(),a=a.remove(t)),r.Vu[r.currentUser.toKey()]=a}}function As(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||_s(e,t)})}function _s(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(bo(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),Ts(e))}function js(e,t,n){for(const r of n)r instanceof ss?(e.Ru.addReference(r.key,t),Is(e,r)):r instanceof ls?(_(us,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||_s(e,r.key)):O(19791,{wu:r})}function Is(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(_(us,"New document in limbo: "+n),e.Eu.add(r),Ts(e))}function Ts(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new oe(re.fromString(t)),r=e.fu.next();e.Au.set(r,new hs(n)),e.du=e.du.insert(n,r),yo(e.remoteStore,new Qa(Vn(Ln(n.path)),r,"TargetPurposeLimboResolution",Oe.ce))}}async function Os(e,t,n){const r=R(e),a=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((e,s)=>{o.push(r.pu(s,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){var t;const a=e?!e.fromCache:null===n||void 0===n||null===(t=n.targetChanges.get(s.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(s.targetId,a?"current":"not-current")}if(e){a.push(e);const t=ji.As(s.targetId,e);i.push(t)}}))}),await Promise.all(o),r.Pu.H_(a),await async function(e,t){const n=R(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>je.forEach(t,t=>je.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>je.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!Te(e))throw e;_(Oi,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,a=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,a)}}}(r.localStore,i))}async function Ps(e,t){const n=R(e);if(!n.currentUser.isEqual(t)){_(us,"User change. New user:",t.toKey());const e=await Mi(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new F(M.CANCELLED,t))})}),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Os(n,e.Ls)}}function Ds(e,t){const n=R(e),r=n.Au.get(t);if(r&&r.hu)return dr().add(r.key);{let e=dr();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function Rs(e){const t=R(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=xs.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ds.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Ns.bind(null,t),t.Pu.H_=ts.bind(null,t.eventManager),t.Pu.yu=ns.bind(null,t.eventManager),t}function Ms(e){const t=R(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Ss.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Es.bind(null,t),t}class Fs{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ao(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Ri(this.persistence,new Ti,e.initialUser,this.serializer)}Cu(e){return new Ci(Ai.mi,this.serializer)}Du(e){return new Hi}async terminate(){var e,t;null!==(e=this.gcScheduler)&&void 0!==e&&e.stop(),null!==(t=this.indexBackfillerScheduler)&&void 0!==t&&t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Fs.provider={build:()=>new Fs};class Ls extends Fs{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){D(this.persistence.referenceDelegate instanceof _i,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new ui(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?ai.withCacheSize(this.cacheSizeBytes):ai.DEFAULT;return new Ci(e=>_i.mi(e,t),this.serializer)}}class Bs{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>ws(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ps.bind(null,this.syncEngine),await Vo(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new $o}createDatastore(e){const t=ao(e.databaseInfo.databaseId),n=function(e){return new no(e)}(e.databaseInfo);return function(e,t,n,r){return new ho(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,a){return new mo(e,t,n,r,a)}(this.localStore,this.datastore,e.asyncQueue,e=>ws(this.syncEngine,e,0),Xi.v()?new Xi:new Gi)}createSyncEngine(e,t){return function(e,t,n,r,a,i,o){const s=new fs(e,t,n,r,a,i);return o&&(s.gu=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=R(e);_(po,"RemoteStore shutting down."),t.Ea.add(5),await vo(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),null!==(e=this.datastore)&&void 0!==e&&e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Bs.provider={build:()=>new Bs};class Us{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):j("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const zs="FirestoreClient";class Vs{constructor(e,t,n,r,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=E.UNAUTHENTICATED,this.clientId=X.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async e=>{_(zs,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(_(zs,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new L;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Go(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Ws(e,t){e.asyncQueue.verifyOperationInProgress(),_(zs,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Mi(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function qs(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Hs(e);_(zs,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>zo(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>zo(t.remoteStore,n)),e._onlineComponents=t}async function Hs(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){_(zs,"Using user provided OfflineComponentProvider");try{await Ws(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===M.FAILED_PRECONDITION||e.code===M.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;I("Error using user provided cache. Falling back to memory cache: "+n),await Ws(e,new Fs)}}else _(zs,"Using default OfflineComponentProvider"),await Ws(e,new Ls(void 0));return e._offlineComponents}async function Gs(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(_(zs,"Using user provided OnlineComponentProvider"),await qs(e,e._uninitializedComponentsProvider._online)):(_(zs,"Using default OnlineComponentProvider"),await qs(e,new Bs))),e._onlineComponents}function Ks(e){return Gs(e).then(e=>e.syncEngine)}function Xs(e){return Gs(e).then(e=>e.datastore)}async function Ys(e){const t=await Gs(e),n=t.eventManager;return n.onListen=ps.bind(null,t.syncEngine),n.onUnlisten=ys.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=ms.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=bs.bind(null,t.syncEngine),n}function Qs(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new L;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,a){const i=new Us({next:s=>{i.Nu(),t.enqueueAndForget(()=>es(e,o));const l=s.docs.has(n);!l&&s.fromCache?a.reject(new F(M.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&s.fromCache&&r&&"server"===r.source?a.reject(new F(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):a.resolve(s)},error:e=>a.reject(e)}),o=new os(Ln(n.path),i,{includeMetadataChanges:!0,qa:!0});return Zo(e,o)}(await Ys(e),e.asyncQueue,t,n,r)),r.promise}function $s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new L;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,a){const i=new Us({next:n=>{i.Nu(),t.enqueueAndForget(()=>es(e,o)),n.fromCache&&"server"===r.source?a.reject(new F(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(n)},error:e=>a.reject(e)}),o=new os(n,i,{includeMetadataChanges:!0,qa:!0});return Zo(e,o)}(await Ys(e),e.asyncQueue,t,n,r)),r.promise}function Js(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Zs=new Map,el="firestore.googleapis.com",tl=!0;class nl{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new F(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=el,this.ssl=tl}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:tl;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=ri;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<si)throw new F(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new F(M.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Js(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new F(M.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new F(M.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new F(M.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class rl{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new nl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new F(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new F(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new nl(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new U;switch(e.type){case"firstParty":return new q(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new F(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Zs.get(e);t&&(_("ComponentProvider","Removing Datastore"),Zs.delete(e),t.terminate())}(this),Promise.resolve()}}class al{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new al(this.firestore,e,this._query)}}class il{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ol(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new il(this.firestore,e,this._key)}toJSON(){return{type:il._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(me(t,il._jsonSchema))return new il(e,n||null,new oe(re.fromString(t.referencePath)))}}il._jsonSchemaVersion="firestore/documentReference/1.0",il._jsonSchema={type:pe("string",il._jsonSchemaVersion),referencePath:pe("string")};class ol extends al{constructor(e,t,n){super(e,t,Ln(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new il(this.firestore,null,new oe(e))}withConverter(e){return new ol(this.firestore,e,this._path)}}function sl(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=(0,c.Ku)(e),se("collection","path",t),e instanceof rl){const n=re.fromString(t,...r);return ce(n),new ol(e,null,n)}{if(!(e instanceof il||e instanceof ol))throw new F(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(re.fromString(t,...r));return ce(n),new ol(e.firestore,null,n)}}function ll(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=(0,c.Ku)(e),1===arguments.length&&(t=X.newId()),se("doc","path",t),e instanceof rl){const n=re.fromString(t,...r);return le(n),new il(e,null,new oe(n))}{if(!(e instanceof il||e instanceof ol))throw new F(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(re.fromString(t,...r));return le(n),new il(e.firestore,e instanceof ol?e.converter:null,new oe(n))}}const cl="AsyncQueue";class ul{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new io(this,"async_queue_retry"),this._c=()=>{const e=ro();e&&_(cl,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=ro();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ro();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new L;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Te(e))throw e;_(cl,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,j("INTERNAL UNHANDLED ERROR: ",dl(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Ho.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&O(47125,{Pc:dl(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function dl(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class hl extends rl{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new ul,this._persistenceKey=(null===r||void 0===r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ul(e),this._firestoreClient=void 0,await e}}}function fl(e,t){const n="object"==typeof e?e:(0,o.Sx)(),r="string"==typeof e?e:t||Dt,a=(0,o.j6)(n,"firestore").getImmediate({identifier:r});if(!a._initialized){const e=(0,c.yU)("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=he(e,rl);const a=(0,c.zJ)(t),o=e._getSettings(),s=(0,i.A)((0,i.A)({},o),{},{emulatorOptions:e._getEmulatorOptions()}),l="".concat(t,":").concat(n);a&&((0,c.gE)("https://".concat(l)),(0,c.P1)("Firestore",!0)),o.host!==el&&o.host!==l&&I("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=(0,i.A)((0,i.A)({},o),{},{host:l,ssl:a,emulatorOptions:r});if(!(0,c.bD)(u,s)&&(e._setSettings(u),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=E.MOCK_USER;else{var d;t=(0,c.Fy)(r.mockUserToken,null===(d=e._app)||void 0===d?void 0:d.options.projectId);const a=r.mockUserToken.sub||r.mockUserToken.user_id;if(!a)throw new F(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new E(a)}e._authCredentials=new z(new B(t,n))}}(a,...e)}return a}function pl(e){if(e._terminated)throw new F(M.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||ml(e),e._firestoreClient}function ml(e){var t,n,r;const a=e._freezeSettings(),i=function(e,t,n,r){return new Pt(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Js(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,a);e._componentsProvider||null!==(n=a.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=a.localCache)&&void 0!==r&&r._onlineComponentProvider&&(e._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),e._firestoreClient=new Vs(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&function(e){const t=null===e||void 0===e?void 0:e._online.build();return{_offline:null===e||void 0===e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class gl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"count",t=arguments.length>1?arguments[1]:void 0;this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class vl{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}class yl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yl(wt.fromBase64String(e))}catch(e){throw new F(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new yl(wt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:yl._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(me(e,yl._jsonSchema))return yl.fromBase64String(e.bytes)}}yl._jsonSchemaVersion="firestore/bytes/1.0",yl._jsonSchema={type:pe("string",yl._jsonSchemaVersion),bytes:pe("string")};class bl{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new F(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ie(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class xl{constructor(e){this._methodName=e}}class wl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new F(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:wl._jsonSchemaVersion}}static fromJSON(e){if(me(e,wl._jsonSchema))return new wl(e.latitude,e.longitude)}}wl._jsonSchemaVersion="firestore/geoPoint/1.0",wl._jsonSchema={type:pe("string",wl._jsonSchemaVersion),latitude:pe("number"),longitude:pe("number")};class Nl{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Nl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(me(e,Nl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new Nl(e.vectorValues);throw new F(M.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Nl._jsonSchemaVersion="firestore/vectorValue/1.0",Nl._jsonSchema={type:pe("string",Nl._jsonSchemaVersion),vectorValues:pe("object")};const Sl=/^__.*__$/;class El{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Ur(e,this.data,this.fieldMask,t,this.fieldTransforms):new Br(e,this.data,t,this.fieldTransforms)}}class Cl{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ur(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function kl(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw O(40011,{Ac:e})}}class Al{constructor(e,t,n,r,a,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===a&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Al((0,i.A)((0,i.A)({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Hl(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(kl(this.Ac)&&Sl.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class _l{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||ao(e)}Cc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Al({Ac:e,methodName:t,Dc:n,path:ie.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function jl(e){const t=e._freezeSettings(),n=ao(e._databaseId);return new _l(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Il(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Cc(i.merge||i.mergeFields?2:0,t,n,a);zl("Data must be an object, but it was:",o,r);const s=Bl(r,o);let l,c;if(i.merge)l=new bt(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const a=Vl(t,r,n);if(!o.contains(a))throw new F(M.INVALID_ARGUMENT,"Field '".concat(a,"' is specified in your field mask but missing from your input data."));Gl(e,a)||e.push(a)}l=new bt(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new El(new on(s),l,c)}class Tl extends xl{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Sc("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Tl}}function Ol(e,t,n){return new Al({Ac:3,Dc:t.settings.Dc,methodName:e._methodName,fc:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class Pl extends xl{_toFieldTransform(e){return new jr(e.path,new wr)}isEqual(e){return e instanceof Pl}}class Dl extends xl{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=Ol(this,e,!0),n=this.vc.map(e=>Ll(e,t)),r=new Nr(n);return new jr(e.path,r)}isEqual(e){return e instanceof Dl&&(0,c.bD)(this.vc,e.vc)}}function Rl(e,t,n,r){const a=e.Cc(1,t,n);zl("Data must be an object, but it was:",a,r);const i=[],o=on.empty();dt(r,(e,r)=>{const s=ql(t,e,n);r=(0,c.Ku)(r);const l=a.yc(s);if(r instanceof Tl)i.push(s);else{const e=Ll(r,l);null!=e&&(i.push(s),o.set(s,e))}});const s=new bt(i);return new Cl(o,s,a.fieldTransforms)}function Ml(e,t,n,r,a,i){const o=e.Cc(1,t,n),s=[Vl(t,r,n)],l=[a];if(i.length%2!=0)throw new F(M.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let c=0;c<i.length;c+=2)s.push(Vl(t,i[c])),l.push(i[c+1]);const u=[],d=on.empty();for(let f=s.length-1;f>=0;--f)if(!Gl(u,s[f])){const e=s[f];let t=l[f];t=(0,c.Ku)(t);const n=o.yc(e);if(t instanceof Tl)u.push(e);else{const r=Ll(t,n);null!=r&&(u.push(e),d.set(e,r))}}const h=new bt(u);return new Cl(d,h,o.fieldTransforms)}function Fl(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Ll(n,e.Cc(r?4:3,t))}function Ll(e,t){if(Ul(e=(0,c.Ku)(e)))return zl("Unsupported field value:",t,e),Bl(e,t);if(e instanceof xl)return function(e,t){if(!kl(t.Ac))throw t.Sc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Sc("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const a of e){let e=Ll(a,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,c.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return gr(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=ye.fromDate(e);return{timestampValue:Na(t.serializer,n)}}if(e instanceof ye){const n=new ye(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Na(t.serializer,n)}}if(e instanceof wl)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof yl)return{bytesValue:Sa(t.serializer,e._byteString)};if(e instanceof il){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:ka(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Nl)return function(e,t){return{mapValue:{fields:{[Mt]:{stringValue:Bt},[Ut]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return pr(t.serializer,e)})}}}}}}(e,t);throw t.Sc("Unsupported field value: ".concat(de(e)))}(e,t)}function Bl(e,t){const n={};return ft(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):dt(e,(e,r)=>{const a=Ll(r,t.mc(e));null!=a&&(n[e]=a)}),{mapValue:{fields:n}}}function Ul(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ye||e instanceof wl||e instanceof yl||e instanceof il||e instanceof xl||e instanceof Nl)}function zl(e,t,n){if(!Ul(n)||!ue(n)){const r=de(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function Vl(e,t,n){if((t=(0,c.Ku)(t))instanceof bl)return t._internalPath;if("string"==typeof t)return ql(e,t);throw Hl("Field path arguments must be of type string or ",e,!1,void 0,n)}const Wl=new RegExp("[~\\*/\\[\\]]");function ql(e,t,n){if(t.search(Wl)>=0)throw Hl("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new bl(...t.split("."))._internalPath}catch(r){throw Hl("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Hl(e,t,n,r,a){const i=r&&!r.isEmpty(),o=void 0!==a;let s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=" in field ".concat(r)),o&&(l+=" in document ".concat(a)),l+=")"),new F(M.INVALID_ARGUMENT,s+e+l)}function Gl(e,t){return e.some(e=>e.isEqual(t))}class Kl{constructor(e,t,n,r,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new il(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Xl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Yl("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Xl extends Kl{data(){return super.data()}}function Yl(e,t){return"string"==typeof t?ql(e,t):t instanceof bl?t._internalPath:t._delegate._internalPath}function Ql(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new F(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $l{}class Jl extends $l{}function Zl(e,t){let n=[];for(var r=arguments.length,a=new Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];t instanceof $l&&n.push(t),n=n.concat(a),function(e){const t=e.filter(e=>e instanceof nc).length,n=e.filter(e=>e instanceof ec).length;if(t>1||t>0&&n>0)throw new F(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class ec extends Jl{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new ec(e,t,n)}_apply(e){const t=this._parse(e);return hc(e._query,t),new al(e.firestore,e.converter,Hn(e._query,t))}_parse(e){const t=jl(e.firestore),n=function(e,t,n,r,a,i,o){let s;if(a.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new F(M.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(i,"' queries on documentId()."));if("in"===i||"not-in"===i){dc(o,i);const t=[];for(const n of o)t.push(uc(r,e,n));s={arrayValue:{values:t}}}else s=uc(r,e,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||dc(o,i),s=Fl(n,t,o,"in"===i||"not-in"===i);return mn.create(a,i,s)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function tc(e,t,n){const r=t,a=Yl("where",e);return ec._create(a,r,n)}class nc extends $l{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new nc(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:gn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const a of r)hc(n,a),n=Hn(n,a)}(e._query,t),new al(e.firestore,e.converter,Hn(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class rc extends Jl{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new rc(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new F(M.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new F(M.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new hn(t,n)}(e._query,this._field,this._direction);return new al(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Mn(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function ac(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Yl("orderBy",e);return rc._create(n,t)}class ic extends Jl{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new ic(e,t,n)}_apply(e){return new al(e.firestore,e.converter,Gn(e._query,this._limit,this._limitType))}}function oc(e){return fe("limit",e),ic._create("limit",e,"F")}class sc extends Jl{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new sc(e,t,n)}_apply(e){const t=cc(e,this.type,this._docOrFields,this._inclusive);return new al(e.firestore,e.converter,function(e,t){return new Mn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}function lc(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return sc._create("startAfter",t,!1)}function cc(e,t,n,r){if(n[0]=(0,c.Ku)(n[0]),n[0]instanceof Kl)return function(e,t,n,r,a){if(!r)throw new F(M.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));const i=[];for(const o of zn(e))if(o.field.isKeyField())i.push(Qt(t,r.key));else{const e=r.data.field(o.field);if(It(e))throw new F(M.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=o.field.canonicalString();throw new F(M.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(e,"' (used as the orderBy) does not exist."))}i.push(e)}return new cn(i,a)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const a=jl(e.firestore);return function(e,t,n,r,a,i){const o=e.explicitOrderBy;if(a.length>o.length)throw new F(M.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));const s=[];for(let l=0;l<a.length;l++){const i=a[l];if(o[l].field.isKeyField()){if("string"!=typeof i)throw new F(M.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof i));if(!Un(e)&&-1!==i.indexOf("/"))throw new F(M.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(i,"' contains a slash."));const n=e.path.child(re.fromString(i));if(!oe.isDocumentKey(n))throw new F(M.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(n,"' is not because it contains an odd number of segments."));const a=new oe(n);s.push(Qt(t,a))}else{const e=Fl(n,r,i);s.push(e)}}return new cn(s,i)}(e._query,e.firestore._databaseId,a,t,n,r)}}function uc(e,t,n){if("string"==typeof(n=(0,c.Ku)(n))){if(""===n)throw new F(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Un(t)&&-1!==n.indexOf("/"))throw new F(M.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(re.fromString(n));if(!oe.isDocumentKey(r))throw new F(M.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Qt(e,new oe(r))}if(n instanceof il)return Qt(e,n._key);throw new F(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(de(n),"."))}function dc(e,t){if(!Array.isArray(e)||0===e.length)throw new F(M.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function hc(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new F(M.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new F(M.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class fc{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(zt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ct(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw O(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return dt(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t;const n=null===(t=e.fields)||void 0===t||null===(t=t[Ut].arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(e=>Et(e.doubleValue));return new Nl(n)}convertGeoPoint(e){return new wl(Et(e.latitude),Et(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Tt(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Ot(e));default:return null}}convertTimestamp(e){const t=St(e);return new ye(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=re.fromString(e);D(Ya(n),9688,{name:e});const r=new Rt(n.get(1),n.get(3)),a=new oe(n.popFirst(5));return r.isEqual(t)||j("Document ".concat(a," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),a}}function pc(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class mc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class gc extends Kl{constructor(e,t,n,r,a,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new vc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Yl("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new F(M.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=gc._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}gc._jsonSchemaVersion="firestore/documentSnapshot/1.0",gc._jsonSchema={type:pe("string",gc._jsonSchemaVersion),bundleSource:pe("string","DocumentSnapshot"),bundleName:pe("string"),bundle:pe("string")};class vc extends gc{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class yc{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new mc(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new vc(this._firestore,this._userDataWriter,n.key,n,new mc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new F(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new vc(e._firestore,e._userDataWriter,n.doc.key,n.doc,new mc(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new vc(e._firestore,e._userDataWriter,t.doc.key,t.doc,new mc(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let a=-1,i=-1;return 0!==t.type&&(a=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:bc(t.type),doc:r,oldIndex:a,newIndex:i}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new F(M.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=yc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=X.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function bc(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return O(61501,{type:e})}}function xc(e){e=he(e,il);const t=he(e.firestore,hl);return Qs(pl(t),e._key).then(n=>Ac(t,e,n))}yc._jsonSchemaVersion="firestore/querySnapshot/1.0",yc._jsonSchema={type:pe("string",yc._jsonSchemaVersion),bundleSource:pe("string","QuerySnapshot"),bundleName:pe("string"),bundle:pe("string")};class wc extends fc{constructor(e){super(),this.firestore=e}convertBytes(e){return new yl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new il(this.firestore,null,t)}}function Nc(e){e=he(e,al);const t=he(e.firestore,hl),n=pl(t),r=new wc(t);return Ql(e._query),$s(n,e._query).then(n=>new yc(t,r,e,n))}function Sc(e,t,n){e=he(e,il);const r=he(e.firestore,hl),a=pc(e.converter,t,n);return kc(r,[Il(jl(r),"setDoc",e._key,a,null!==e.converter,n).toMutation(e._key,Tr.none())])}function Ec(e,t,n){e=he(e,il);const r=he(e.firestore,hl),a=jl(r);let i;for(var o=arguments.length,s=new Array(o>3?o-3:0),l=3;l<o;l++)s[l-3]=arguments[l];return i="string"==typeof(t=(0,c.Ku)(t))||t instanceof bl?Ml(a,"updateDoc",e._key,t,n,s):Rl(a,"updateDoc",e._key,t),kc(r,[i.toMutation(e._key,Tr.exists(!0))])}function Cc(e,t){const n=he(e.firestore,hl),r=ll(e),a=pc(e.converter,t);return kc(n,[Il(jl(e.firestore),"addDoc",r._key,a,null!==e.converter,{}).toMutation(r._key,Tr.exists(!1))]).then(()=>r)}function kc(e,t){return function(e,t){const n=new L;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=Ms(e);try{const e=await function(e,t){const n=R(e),r=ye.now(),a=t.reduce((e,t)=>e.add(t.key),dr());let i,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let s=nr(),l=dr();return n.Ns.getEntries(e,a).next(e=>{s=e,s.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,s)).next(a=>{i=a;const o=[];for(const e of t){const t=Fr(e,i.get(e.key).overlayedDocument);null!=t&&o.push(new Ur(e.key,t,sn(t.value.mapValue),Tr.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(i,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:ir(i)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new pt(Y)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await Os(r,e.changes),await Oo(r.remoteStore)}catch(e){const t=Go(e,"Failed to persist write");n.reject(t)}}(await Ks(e),t,n)),n.promise}(pl(e),t)}function Ac(e,t,n){const r=n.docs.get(t._key),a=new wc(e);return new gc(e,a,t._key,r,new mc(n.hasPendingWrites,n.fromCache),t.converter)}function _c(e){return function(e,t){const n=he(e.firestore,hl),r=pl(n),a=ht(t,(e,t)=>new Yr(t,e.aggregateType,e._internalFieldPath));return function(e,t,n){const r=new L;return e.asyncQueue.enqueueAndForget(async()=>{try{const a=await Xs(e);r.resolve(async function(e,t,n,r){const a=R(e),{request:i,gt:o,parent:s}=Ba(a.serializer,Wn(t),n);a.connection.$o||delete i.parent;const l=(await a.Ho("RunAggregationQuery",a.serializer.databaseId,s,i,1)).filter(e=>!!e.result);D(1===l.length,64727);const c=null===(r=l[0].result)||void 0===r?void 0:r.aggregateFields;return Object.keys(c).reduce((e,t)=>(e[o[t]]=c[t],e),{})}(a,t,n))}catch(e){r.reject(e)}}),r.promise}(r,e._query,a).then(t=>function(e,t,n){const r=new wc(e);return new vl(t,r,n)}(n,e,t))}(e,{count:new gl("count")})}function jc(){return new Pl("serverTimestamp")}function Ic(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Dl("arrayUnion",t)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){C=e}(o.MF),(0,o.om)(new s.uA("firestore",(e,n)=>{let{instanceIdentifier:r,options:a}=n;const o=e.getProvider("app").getImmediate(),s=new hl(new V(e.getProvider("auth-internal")),new G(o,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new F(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rt(e.options.projectId,t)}(o,r),o);return a=(0,i.A)({useFetchStreams:t},a),s._setSettings(a),s},"PUBLIC").setMultipleInstances(!0)),(0,o.KO)(N,S,e),(0,o.KO)(N,S,"esm2020")}()},6672:(e,t,n)=>{"use strict";var r=n(5043);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var o={d:{f:i,r:function(){throw Error(a(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},s=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(a(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:s,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=o.p;try{if(l.T=null,o.p=2,e)return e()}finally{l.T=t,o.p=n,o.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,o.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&o.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),a="string"===typeof t.integrity?t.integrity:void 0,i="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?o.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:a,fetchPriority:i}):"script"===n&&o.d.X(e,{crossOrigin:r,integrity:a,fetchPriority:i,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);o.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&o.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);o.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);o.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else o.d.m(e)},t.requestFormReset=function(e){o.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.1"},6770:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2777);t.toNumber=function(e){return r.isSymbol(e)?NaN:Number(e)}},7004:(e,t,n)=>{"use strict";var r=n(8853),a=n(5043),i=n(7950);function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(o(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var h=Object.assign,f=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),x=Symbol.for("react.consumer"),w=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),k=Symbol.for("react.lazy");Symbol.for("react.scope");var A=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var _=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var j=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=j&&e[j]||e["@@iterator"])?e:null}var T=Symbol.for("react.client.reference");function O(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===T?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case y:return"Profiler";case v:return"StrictMode";case S:return"Suspense";case E:return"SuspenseList";case A:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case m:return"Portal";case w:return(e.displayName||"Context")+".Provider";case x:return(e._context.displayName||"Context")+".Consumer";case N:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case C:return null!==(t=e.displayName||null)?t:O(e.type)||"Memo";case k:t=e._payload,e=e._init;try{return O(e(t))}catch(n){}}return null}var P=Array.isArray,D=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M={pending:!1,data:null,method:null,action:null},F=[],L=-1;function B(e){return{current:e}}function U(e){0>L||(e.current=F[L],F[L]=null,L--)}function z(e,t){L++,F[L]=e.current,e.current=t}var V=B(null),W=B(null),q=B(null),H=B(null);function G(e,t){switch(z(q,t),z(W,e),z(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?ad(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=id(t=ad(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(V),z(V,e)}function K(){U(V),U(W),U(q)}function X(e){null!==e.memoizedState&&z(H,e);var t=V.current,n=id(t,e.type);t!==n&&(z(W,e),z(V,n))}function Y(e){W.current===e&&(U(V),U(W)),H.current===e&&(U(H),Xd._currentValue=M)}var Q=Object.prototype.hasOwnProperty,$=r.unstable_scheduleCallback,J=r.unstable_cancelCallback,Z=r.unstable_shouldYield,ee=r.unstable_requestPaint,te=r.unstable_now,ne=r.unstable_getCurrentPriorityLevel,re=r.unstable_ImmediatePriority,ae=r.unstable_UserBlockingPriority,ie=r.unstable_NormalPriority,oe=r.unstable_LowPriority,se=r.unstable_IdlePriority,le=r.log,ce=r.unstable_setDisableYieldValue,ue=null,de=null;function he(e){if("function"===typeof le&&ce(e),de&&"function"===typeof de.setStrictMode)try{de.setStrictMode(ue,e)}catch(t){}}var fe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(pe(e)/me|0)|0},pe=Math.log,me=Math.LN2;var ge=256,ve=4194304;function ye(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function be(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var a=0,i=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var s=134217727&r;return 0!==s?0!==(r=s&~i)?a=ye(r):0!==(o&=s)?a=ye(o):n||0!==(n=s&~e)&&(a=ye(n)):0!==(s=r&~i)?a=ye(s):0!==o?a=ye(o):n||0!==(n=r&~e)&&(a=ye(n)),0===a?0:0!==t&&t!==a&&0===(t&i)&&((i=a&-a)>=(n=t&-t)||32===i&&0!==(4194048&n))?t:a}function xe(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function we(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ne(){var e=ge;return 0===(4194048&(ge<<=1))&&(ge=256),e}function Se(){var e=ve;return 0===(62914560&(ve<<=1))&&(ve=4194304),e}function Ee(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ce(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ke(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-fe(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194090&n}function Ae(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-fe(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}function _e(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function je(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Ie(){var e=R.p;return 0!==e?e:void 0===(e=window.event)?32:ch(e.type)}var Te=Math.random().toString(36).slice(2),Oe="__reactFiber$"+Te,Pe="__reactProps$"+Te,De="__reactContainer$"+Te,Re="__reactEvents$"+Te,Me="__reactListeners$"+Te,Fe="__reactHandles$"+Te,Le="__reactResources$"+Te,Be="__reactMarker$"+Te;function Ue(e){delete e[Oe],delete e[Pe],delete e[Re],delete e[Me],delete e[Fe]}function ze(e){var t=e[Oe];if(t)return t;for(var n=e.parentNode;n;){if(t=n[De]||n[Oe]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=bd(e);null!==e;){if(n=e[Oe])return n;e=bd(e)}return t}n=(e=n).parentNode}return null}function Ve(e){if(e=e[Oe]||e[De]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function We(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(o(33))}function qe(e){var t=e[Le];return t||(t=e[Le]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function He(e){e[Be]=!0}var Ge=new Set,Ke={};function Xe(e,t){Ye(e,t),Ye(e+"Capture",t)}function Ye(e,t){for(Ke[e]=t,e=0;e<t.length;e++)Ge.add(t[e])}var Qe,$e,Je=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ze={},et={};function tt(e,t,n){if(a=t,Q.call(et,a)||!Q.call(Ze,a)&&(Je.test(a)?et[a]=!0:(Ze[a]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var a}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function rt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function at(e){if(void 0===Qe)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Qe=t&&t[1]||"",$e=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Qe+e+$e}var it=!1;function ot(e,t){if(!e||it)return"";it=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(a){var r=a}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(o){r=o}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&r&&"string"===typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=r.DetermineComponentFrameRoot(),o=i[0],s=i[1];if(o&&s){var l=o.split("\n"),c=s.split("\n");for(a=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(r===l.length||a===c.length)for(r=l.length-1,a=c.length-1;1<=r&&0<=a&&l[r]!==c[a];)a--;for(;1<=r&&0<=a;r--,a--)if(l[r]!==c[a]){if(1!==r||1!==a)do{if(r--,0>--a||l[r]!==c[a]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=a);break}}}finally{it=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?at(n):""}function st(e){switch(e.tag){case 26:case 27:case 5:return at(e.type);case 16:return at("Lazy");case 13:return at("Suspense");case 19:return at("SuspenseList");case 0:case 15:return ot(e.type,!1);case 11:return ot(e.type.render,!1);case 1:return ot(e.type,!0);case 31:return at("Activity");default:return""}}function lt(e){try{var t="";do{t+=st(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function dt(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ht(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ut(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ft(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function mt(e){return e.replace(pt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function gt(e,t,n,r,a,i,o,s){e.name="",null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?yt(e,o,ct(t)):null!=n?yt(e,o,ct(n)):null!=r&&e.removeAttribute("value"),null==a&&null!=i&&(e.defaultChecked=!!i),null!=a&&(e.checked=a&&"function"!==typeof a&&"symbol"!==typeof a),null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.name=""+ct(s):e.removeAttribute("name")}function vt(e,t,n,r,a,i,o,s){if(null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.type=i),null!=t||null!=n){if(!("submit"!==i&&"reset"!==i||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,s||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:a)&&"symbol"!==typeof r&&!!r,e.checked=s?e.checked:!!r,e.defaultChecked=!!r,null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.name=o)}function yt(e,t,n){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function bt(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function xt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function wt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(o(92));if(P(r)){if(1<r.length)throw Error(o(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r)}function Nt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Et(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||St.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Ct(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(o(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var a in t)r=t[a],t.hasOwnProperty(a)&&n[a]!==r&&Et(e,a,r)}else for(var i in t)t.hasOwnProperty(i)&&Et(e,i,t[i])}function kt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var At=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_t=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function jt(e){return _t.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var It=null;function Tt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ot=null,Pt=null;function Dt(e){var t=Ve(e);if(t&&(e=t.stateNode)){var n=e[Pe]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+mt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=r[Pe]||null;if(!a)throw Error(o(90));gt(r,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&ht(r)}break e;case"textarea":xt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&bt(e,!!n.multiple,t,!1)}}}var Rt=!1;function Mt(e,t,n){if(Rt)return e(t,n);Rt=!0;try{return e(t)}finally{if(Rt=!1,(null!==Ot||null!==Pt)&&(zc(),Ot&&(t=Ot,e=Pt,Pt=Ot=null,Dt(t),e)))for(t=0;t<e.length;t++)Dt(e[t])}}function Ft(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Pe]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Lt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Bt=!1;if(Lt)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){Bt=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch(Ph){Bt=!1}var zt=null,Vt=null,Wt=null;function qt(){if(Wt)return Wt;var e,t,n=Vt,r=n.length,a="value"in zt?zt.value:zt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Wt=a.slice(e,1<t?1-t:void 0)}function Ht(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Gt(){return!0}function Kt(){return!1}function Xt(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Gt:Kt,this.isPropagationStopped=Kt,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Gt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Gt)},persist:function(){},isPersistent:Gt}),t}var Yt,Qt,$t,Jt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zt=Xt(Jt),en=h({},Jt,{view:0,detail:0}),tn=Xt(en),nn=h({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$t&&($t&&"mousemove"===e.type?(Yt=e.screenX-$t.screenX,Qt=e.screenY-$t.screenY):Qt=Yt=0,$t=e),Yt)},movementY:function(e){return"movementY"in e?e.movementY:Qt}}),rn=Xt(nn),an=Xt(h({},nn,{dataTransfer:0})),on=Xt(h({},en,{relatedTarget:0})),sn=Xt(h({},Jt,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=Xt(h({},Jt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),cn=Xt(h({},Jt,{data:0})),un={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=hn[e])&&!!t[e]}function pn(){return fn}var mn=Xt(h({},en,{key:function(e){if(e.key){var t=un[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Ht(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?dn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pn,charCode:function(e){return"keypress"===e.type?Ht(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Ht(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),gn=Xt(h({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vn=Xt(h({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pn})),yn=Xt(h({},Jt,{propertyName:0,elapsedTime:0,pseudoElement:0})),bn=Xt(h({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),xn=Xt(h({},Jt,{newState:0,oldState:0})),wn=[9,13,27,32],Nn=Lt&&"CompositionEvent"in window,Sn=null;Lt&&"documentMode"in document&&(Sn=document.documentMode);var En=Lt&&"TextEvent"in window&&!Sn,Cn=Lt&&(!Nn||Sn&&8<Sn&&11>=Sn),kn=String.fromCharCode(32),An=!1;function _n(e,t){switch(e){case"keyup":return-1!==wn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var In=!1;var Tn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function On(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Tn[e.type]:"textarea"===t}function Pn(e,t,n,r){Ot?Pt?Pt.push(r):Pt=[r]:Ot=r,0<(t=qu(t,"onChange")).length&&(n=new Zt("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Dn=null,Rn=null;function Mn(e){Mu(e,0)}function Fn(e){if(ht(We(e)))return e}function Ln(e,t){if("change"===e)return t}var Bn=!1;if(Lt){var Un;if(Lt){var zn="oninput"in document;if(!zn){var Vn=document.createElement("div");Vn.setAttribute("oninput","return;"),zn="function"===typeof Vn.oninput}Un=zn}else Un=!1;Bn=Un&&(!document.documentMode||9<document.documentMode)}function Wn(){Dn&&(Dn.detachEvent("onpropertychange",qn),Rn=Dn=null)}function qn(e){if("value"===e.propertyName&&Fn(Rn)){var t=[];Pn(t,Rn,e,Tt(e)),Mt(Mn,t)}}function Hn(e,t,n){"focusin"===e?(Wn(),Rn=n,(Dn=t).attachEvent("onpropertychange",qn)):"focusout"===e&&Wn()}function Gn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Fn(Rn)}function Kn(e,t){if("click"===e)return Fn(t)}function Xn(e,t){if("input"===e||"change"===e)return Fn(t)}var Yn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Qn(e,t){if(Yn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!Q.call(t,a)||!Yn(e[a],t[a]))return!1}return!0}function $n(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jn(e,t){var n,r=$n(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=$n(r)}}function Zn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Zn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function er(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=ft((e=t.contentWindow).document)}return t}function tr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var nr=Lt&&"documentMode"in document&&11>=document.documentMode,rr=null,ar=null,ir=null,or=!1;function sr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;or||null==rr||rr!==ft(r)||("selectionStart"in(r=rr)&&tr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},ir&&Qn(ir,r)||(ir=r,0<(r=qu(ar,"onSelect")).length&&(t=new Zt("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=rr)))}function lr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var cr={animationend:lr("Animation","AnimationEnd"),animationiteration:lr("Animation","AnimationIteration"),animationstart:lr("Animation","AnimationStart"),transitionrun:lr("Transition","TransitionRun"),transitionstart:lr("Transition","TransitionStart"),transitioncancel:lr("Transition","TransitionCancel"),transitionend:lr("Transition","TransitionEnd")},ur={},dr={};function hr(e){if(ur[e])return ur[e];if(!cr[e])return e;var t,n=cr[e];for(t in n)if(n.hasOwnProperty(t)&&t in dr)return ur[e]=n[t];return e}Lt&&(dr=document.createElement("div").style,"AnimationEvent"in window||(delete cr.animationend.animation,delete cr.animationiteration.animation,delete cr.animationstart.animation),"TransitionEvent"in window||delete cr.transitionend.transition);var fr=hr("animationend"),pr=hr("animationiteration"),mr=hr("animationstart"),gr=hr("transitionrun"),vr=hr("transitionstart"),yr=hr("transitioncancel"),br=hr("transitionend"),xr=new Map,wr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(e,t){xr.set(e,t),Xe(t,[e])}wr.push("scrollEnd");var Sr=new WeakMap;function Er(e,t){if("object"===typeof e&&null!==e){var n=Sr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},Sr.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var Cr=[],kr=0,Ar=0;function _r(){for(var e=kr,t=Ar=kr=0;t<e;){var n=Cr[t];Cr[t++]=null;var r=Cr[t];Cr[t++]=null;var a=Cr[t];Cr[t++]=null;var i=Cr[t];if(Cr[t++]=null,null!==r&&null!==a){var o=r.pending;null===o?a.next=a:(a.next=o.next,o.next=a),r.pending=a}0!==i&&Or(n,a,i)}}function jr(e,t,n,r){Cr[kr++]=e,Cr[kr++]=t,Cr[kr++]=n,Cr[kr++]=r,Ar|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Ir(e,t,n,r){return jr(e,t,n,r),Pr(e)}function Tr(e,t){return jr(e,null,null,t),Pr(e)}function Or(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var a=!1,i=e.return;null!==i;)i.childLanes|=n,null!==(r=i.alternate)&&(r.childLanes|=n),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(a=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,a&&null!==t&&(a=31-fe(n),null===(r=(e=i.hiddenUpdates)[a])?e[a]=[t]:r.push(t),t.lane=536870912|n),i):null}function Pr(e){if(50<Oc)throw Oc=0,Pc=null,Error(o(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Dr={};function Rr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mr(e,t,n,r){return new Rr(e,t,n,r)}function Fr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Lr(e,t){var n=e.alternate;return null===n?((n=Mr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Br(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ur(e,t,n,r,a,i){var s=0;if(r=e,"function"===typeof e)Fr(e)&&(s=1);else if("string"===typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,V.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case A:return(e=Mr(31,n,t,a)).elementType=A,e.lanes=i,e;case g:return zr(n.children,a,i,t);case v:s=8,a|=24;break;case y:return(e=Mr(12,n,t,2|a)).elementType=y,e.lanes=i,e;case S:return(e=Mr(13,n,t,a)).elementType=S,e.lanes=i,e;case E:return(e=Mr(19,n,t,a)).elementType=E,e.lanes=i,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case b:case w:s=10;break e;case x:s=9;break e;case N:s=11;break e;case C:s=14;break e;case k:s=16,r=null;break e}s=29,n=Error(o(130,null===e?"null":typeof e,"")),r=null}return(t=Mr(s,n,t,a)).elementType=e,t.type=r,t.lanes=i,t}function zr(e,t,n,r){return(e=Mr(7,e,r,t)).lanes=n,e}function Vr(e,t,n){return(e=Mr(6,e,null,t)).lanes=n,e}function Wr(e,t,n){return(t=Mr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var qr=[],Hr=0,Gr=null,Kr=0,Xr=[],Yr=0,Qr=null,$r=1,Jr="";function Zr(e,t){qr[Hr++]=Kr,qr[Hr++]=Gr,Gr=e,Kr=t}function ea(e,t,n){Xr[Yr++]=$r,Xr[Yr++]=Jr,Xr[Yr++]=Qr,Qr=e;var r=$r;e=Jr;var a=32-fe(r)-1;r&=~(1<<a),n+=1;var i=32-fe(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,$r=1<<32-fe(t)+a|n<<a|r,Jr=i+e}else $r=1<<i|n<<a|r,Jr=e}function ta(e){null!==e.return&&(Zr(e,1),ea(e,1,0))}function na(e){for(;e===Gr;)Gr=qr[--Hr],qr[Hr]=null,Kr=qr[--Hr],qr[Hr]=null;for(;e===Qr;)Qr=Xr[--Yr],Xr[Yr]=null,Jr=Xr[--Yr],Xr[Yr]=null,$r=Xr[--Yr],Xr[Yr]=null}var ra=null,aa=null,ia=!1,oa=null,sa=!1,la=Error(o(519));function ca(e){throw ma(Er(Error(o(418,"")),e)),la}function ua(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Oe]=e,t[Pe]=r,n){case"dialog":Fu("cancel",t),Fu("close",t);break;case"iframe":case"object":case"embed":Fu("load",t);break;case"video":case"audio":for(n=0;n<Du.length;n++)Fu(Du[n],t);break;case"source":Fu("error",t);break;case"img":case"image":case"link":Fu("error",t),Fu("load",t);break;case"details":Fu("toggle",t);break;case"input":Fu("invalid",t),vt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),dt(t);break;case"select":Fu("invalid",t);break;case"textarea":Fu("invalid",t),wt(t,r.value,r.defaultValue,r.children),dt(t)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||Qu(t.textContent,n)?(null!=r.popover&&(Fu("beforetoggle",t),Fu("toggle",t)),null!=r.onScroll&&Fu("scroll",t),null!=r.onScrollEnd&&Fu("scrollend",t),null!=r.onClick&&(t.onclick=$u),t=!0):t=!1,t||ca(e)}function da(e){for(ra=e.return;ra;)switch(ra.tag){case 5:case 13:return void(sa=!1);case 27:case 3:return void(sa=!0);default:ra=ra.return}}function ha(e){if(e!==ra)return!1;if(!ia)return da(e),ia=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||od(e.type,e.memoizedProps)),t=!t),t&&aa&&ca(e),da(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){aa=vd(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}aa=null}}else 27===n?(n=aa,fd(e.type)?(e=yd,yd=null,aa=e):aa=n):aa=ra?vd(e.stateNode.nextSibling):null;return!0}function fa(){aa=ra=null,ia=!1}function pa(){var e=oa;return null!==e&&(null===bc?bc=e:bc.push.apply(bc,e),oa=null),e}function ma(e){null===oa?oa=[e]:oa.push(e)}var ga=B(null),va=null,ya=null;function ba(e,t,n){z(ga,t._currentValue),t._currentValue=n}function xa(e){e._currentValue=ga.current,U(ga)}function wa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Na(e,t,n,r){var a=e.child;for(null!==a&&(a.return=e);null!==a;){var i=a.dependencies;if(null!==i){var s=a.child;i=i.firstContext;e:for(;null!==i;){var l=i;i=a;for(var c=0;c<t.length;c++)if(l.context===t[c]){i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),wa(i.return,n,e),r||(s=null);break e}i=l.next}}else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(i=s.alternate)&&(i.lanes|=n),wa(s,n,e),s=null}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===e){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}}function Sa(e,t,n,r){e=null;for(var a=t,i=!1;null!==a;){if(!i)if(0!==(524288&a.flags))i=!0;else if(0!==(262144&a.flags))break;if(10===a.tag){var s=a.alternate;if(null===s)throw Error(o(387));if(null!==(s=s.memoizedProps)){var l=a.type;Yn(a.pendingProps.value,s.value)||(null!==e?e.push(l):e=[l])}}else if(a===H.current){if(null===(s=a.alternate))throw Error(o(387));s.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(null!==e?e.push(Xd):e=[Xd])}a=a.return}null!==e&&Na(t,e,n,r),t.flags|=262144}function Ea(e){for(e=e.firstContext;null!==e;){if(!Yn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ca(e){va=e,ya=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function ka(e){return _a(va,e)}function Aa(e,t){return null===va&&Ca(e),_a(e,t)}function _a(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===ya){if(null===e)throw Error(o(308));ya=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ya=ya.next=t;return n}var ja="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Ia=r.unstable_scheduleCallback,Ta=r.unstable_NormalPriority,Oa={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pa(){return{controller:new ja,data:new Map,refCount:0}}function Da(e){e.refCount--,0===e.refCount&&Ia(Ta,function(){e.controller.abort()})}var Ra=null,Ma=0,Fa=0,La=null;function Ba(){if(0===--Ma&&null!==Ra){null!==La&&(La.status="fulfilled");var e=Ra;Ra=null,Fa=0,La=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Ua=D.S;D.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Ra){var n=Ra=[];Ma=0,Fa=ju(),La={status:"pending",value:void 0,then:function(e){n.push(e)}}}Ma++,t.then(Ba,Ba)}(0,t),null!==Ua&&Ua(e,t)};var za=B(null);function Va(){var e=za.current;return null!==e?e:rc.pooledCache}function Wa(e,t){z(za,null===t?za.current:t.pool)}function qa(){var e=Va();return null===e?null:{parent:Oa._currentValue,pool:e}}var Ha=Error(o(460)),Ga=Error(o(474)),Ka=Error(o(542)),Xa={then:function(){}};function Ya(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Qa(){}function $a(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Qa,Qa),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw ei(e=t.reason),e;default:if("string"===typeof t.status)t.then(Qa,Qa);else{if(null!==(e=rc)&&100<e.shellSuspendCounter)throw Error(o(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ei(e=t.reason),e}throw Ja=t,Ha}}var Ja=null;function Za(){if(null===Ja)throw Error(o(459));var e=Ja;return Ja=null,e}function ei(e){if(e===Ha||e===Ka)throw Error(o(483))}var ti=!1;function ni(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ri(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ai(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ii(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&nc)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,t=Pr(e),Or(e,null,n),t}return jr(e,r,t,n),Pr(e)}function oi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ae(e,n)}}function si(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var li=!1;function ci(){if(li){if(null!==La)throw La}}function ui(e,t,n,r){li=!1;var a=e.updateQueue;ti=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?i=c:o.next=c,o=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==i){var d=a.baseState;for(o=0,u=c=l=null,s=i;;){var f=-536870913&s.lane,p=f!==s.lane;if(p?(ic&f)===f:(r&f)===f){0!==f&&f===Fa&&(li=!0),null!==u&&(u=u.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var m=e,g=s;f=t;var v=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){d=m.call(v,d,f);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(f="function"===typeof(m=g.payload)?m.call(v,d,f):m)||void 0===f)break e;d=h({},d,f);break e;case 2:ti=!0}}null!==(f=s.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=a.callbacks)?a.callbacks=[f]:p.push(f))}else p={lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,o|=f;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(p=s).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}null===u&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null===i&&(a.shared.lanes=0),fc|=o,e.lanes=o,e.memoizedState=d}}function di(e,t){if("function"!==typeof e)throw Error(o(191,e));e.call(t)}function hi(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)di(n[e],t)}var fi=B(null),pi=B(0);function mi(e,t){z(pi,e=dc),z(fi,t),dc=e|t.baseLanes}function gi(){z(pi,dc),z(fi,fi.current)}function vi(){dc=pi.current,U(fi),U(pi)}var yi=0,bi=null,xi=null,wi=null,Ni=!1,Si=!1,Ei=!1,Ci=0,ki=0,Ai=null,_i=0;function ji(){throw Error(o(321))}function Ii(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Yn(e[n],t[n]))return!1;return!0}function Ti(e,t,n,r,a,i){return yi=i,bi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,D.H=null===e||null===e.memoizedState?Go:Ko,Ei=!1,i=n(r,a),Ei=!1,Si&&(i=Pi(t,n,r,a)),Oi(e),i}function Oi(e){D.H=Ho;var t=null!==xi&&null!==xi.next;if(yi=0,wi=xi=bi=null,Ni=!1,ki=0,Ai=null,t)throw Error(o(300));null===e||As||null!==(e=e.dependencies)&&Ea(e)&&(As=!0)}function Pi(e,t,n,r){bi=e;var a=0;do{if(Si&&(Ai=null),ki=0,Si=!1,25<=a)throw Error(o(301));if(a+=1,wi=xi=null,null!=e.updateQueue){var i=e.updateQueue;i.lastEffect=null,i.events=null,i.stores=null,null!=i.memoCache&&(i.memoCache.index=0)}D.H=Xo,i=t(n,r)}while(Si);return i}function Di(){var e=D.H,t=e.useState()[0];return t="function"===typeof t.then?Ui(t):t,e=e.useState()[0],(null!==xi?xi.memoizedState:null)!==e&&(bi.flags|=1024),t}function Ri(){var e=0!==Ci;return Ci=0,e}function Mi(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Fi(e){if(Ni){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Ni=!1}yi=0,wi=xi=bi=null,Si=!1,ki=Ci=0,Ai=null}function Li(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===wi?bi.memoizedState=wi=e:wi=wi.next=e,wi}function Bi(){if(null===xi){var e=bi.alternate;e=null!==e?e.memoizedState:null}else e=xi.next;var t=null===wi?bi.memoizedState:wi.next;if(null!==t)wi=t,xi=e;else{if(null===e){if(null===bi.alternate)throw Error(o(467));throw Error(o(310))}e={memoizedState:(xi=e).memoizedState,baseState:xi.baseState,baseQueue:xi.baseQueue,queue:xi.queue,next:null},null===wi?bi.memoizedState=wi=e:wi=wi.next=e}return wi}function Ui(e){var t=ki;return ki+=1,null===Ai&&(Ai=[]),e=$a(Ai,e,t),t=bi,null===(null===wi?t.memoizedState:wi.next)&&(t=t.alternate,D.H=null===t||null===t.memoizedState?Go:Ko),e}function zi(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Ui(e);if(e.$$typeof===w)return ka(e)}throw Error(o(438,String(e)))}function Vi(e){var t=null,n=bi.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=bi.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},bi.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=_;return t.index++,n}function Wi(e,t){return"function"===typeof t?t(e):t}function qi(e){return Hi(Bi(),xi,e)}function Hi(e,t,n){var r=e.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=n;var a=e.baseQueue,i=r.pending;if(null!==i){if(null!==a){var s=a.next;a.next=i.next,i.next=s}t.baseQueue=a=i,r.pending=null}if(i=e.baseState,null===a)e.memoizedState=i;else{var l=s=null,c=null,u=t=a.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(ic&h)===h:(yi&h)===h){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===Fa&&(d=!0);else{if((yi&f)===f){u=u.next,f===Fa&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,s=i):c=c.next=h,bi.lanes|=f,fc|=f}h=u.action,Ei&&n(i,h),i=u.hasEagerState?u.eagerState:n(i,h)}else f={lane:h,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,s=i):c=c.next=f,bi.lanes|=h,fc|=h;u=u.next}while(null!==u&&u!==t);if(null===c?s=i:c.next=l,!Yn(i,e.memoizedState)&&(As=!0,d&&null!==(n=La)))throw n;e.memoizedState=i,e.baseState=s,e.baseQueue=c,r.lastRenderedState=i}return null===a&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Gi(e){var t=Bi(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{i=e(i,s.action),s=s.next}while(s!==a);Yn(i,t.memoizedState)||(As=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Ki(e,t,n){var r=bi,a=Bi(),i=ia;if(i){if(void 0===n)throw Error(o(407));n=n()}else n=t();var s=!Yn((xi||a).memoizedState,n);if(s&&(a.memoizedState=n,As=!0),a=a.queue,vo(2048,8,Qi.bind(null,r,a,e),[e]),a.getSnapshot!==t||s||null!==wi&&1&wi.memoizedState.tag){if(r.flags|=2048,po(9,{destroy:void 0,resource:void 0},Yi.bind(null,r,a,n,t),null),null===rc)throw Error(o(349));i||0!==(124&yi)||Xi(r,t,n)}return n}function Xi(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=bi.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},bi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Yi(e,t,n,r){t.value=n,t.getSnapshot=r,$i(t)&&Ji(e)}function Qi(e,t,n){return n(function(){$i(t)&&Ji(e)})}function $i(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Yn(e,n)}catch(r){return!0}}function Ji(e){var t=Tr(e,2);null!==t&&Mc(t,e,2)}function Zi(e){var t=Li();if("function"===typeof e){var n=e;if(e=n(),Ei){he(!0);try{n()}finally{he(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:e},t}function eo(e,t,n,r){return e.baseState=n,Hi(e,xi,"function"===typeof r?r:Wi)}function to(e,t,n,r,a){if(Vo(e))throw Error(o(485));if(null!==(e=t.action)){var i={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){i.listeners.push(e)}};null!==D.T?n(!0):i.isTransition=!1,r(i),null===(n=t.pending)?(i.next=t.pending=i,no(t,i)):(i.next=n.next,t.pending=n.next=i)}}function no(e,t){var n=t.action,r=t.payload,a=e.state;if(t.isTransition){var i=D.T,o={};D.T=o;try{var s=n(a,r),l=D.S;null!==l&&l(o,s),ro(e,t,s)}catch(c){io(e,t,c)}finally{D.T=i}}else try{ro(e,t,i=n(a,r))}catch(u){io(e,t,u)}}function ro(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){ao(e,t,n)},function(n){return io(e,t,n)}):ao(e,t,n)}function ao(e,t,n){t.status="fulfilled",t.value=n,oo(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,no(e,n)))}function io(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,oo(t),t=t.next}while(t!==r)}e.action=null}function oo(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function so(e,t){return t}function lo(e,t){if(ia){var n=rc.formState;if(null!==n){e:{var r=bi;if(ia){if(aa){t:{for(var a=aa,i=sa;8!==a.nodeType;){if(!i){a=null;break t}if(null===(a=vd(a.nextSibling))){a=null;break t}}a="F!"===(i=a.data)||"F"===i?a:null}if(a){aa=vd(a.nextSibling),r="F!"===a.data;break e}}ca(r)}r=!1}r&&(t=n[0])}}return(n=Li()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:so,lastRenderedState:t},n.queue=r,n=Bo.bind(null,bi,r),r.dispatch=n,r=Zi(!1),i=zo.bind(null,bi,!1,r.queue),a={state:t,dispatch:null,action:e,pending:null},(r=Li()).queue=a,n=to.bind(null,bi,a,i,n),a.dispatch=n,r.memoizedState=e,[t,n,!1]}function co(e){return uo(Bi(),xi,e)}function uo(e,t,n){if(t=Hi(e,t,so)[0],e=qi(Wi)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=Ui(t)}catch(o){if(o===Ha)throw Ka;throw o}else r=t;var a=(t=Bi()).queue,i=a.dispatch;return n!==t.memoizedState&&(bi.flags|=2048,po(9,{destroy:void 0,resource:void 0},ho.bind(null,a,n),null)),[r,i,e]}function ho(e,t){e.action=t}function fo(e){var t=Bi(),n=xi;if(null!==n)return uo(t,n,e);Bi(),t=t.memoizedState;var r=(n=Bi()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function po(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=bi.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},bi.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function mo(){return Bi().memoizedState}function go(e,t,n,r){var a=Li();r=void 0===r?null:r,bi.flags|=e,a.memoizedState=po(1|t,{destroy:void 0,resource:void 0},n,r)}function vo(e,t,n,r){var a=Bi();r=void 0===r?null:r;var i=a.memoizedState.inst;null!==xi&&null!==r&&Ii(r,xi.memoizedState.deps)?a.memoizedState=po(t,i,n,r):(bi.flags|=e,a.memoizedState=po(1|t,i,n,r))}function yo(e,t){go(8390656,8,e,t)}function bo(e,t){vo(2048,8,e,t)}function xo(e,t){return vo(4,2,e,t)}function wo(e,t){return vo(4,4,e,t)}function No(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function So(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,vo(4,4,No.bind(null,t,e),n)}function Eo(){}function Co(e,t){var n=Bi();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Ii(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function ko(e,t){var n=Bi();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Ii(t,r[1]))return r[0];if(r=e(),Ei){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[r,t],r}function Ao(e,t,n){return void 0===n||0!==(1073741824&yi)?e.memoizedState=t:(e.memoizedState=n,e=Rc(),bi.lanes|=e,fc|=e,n)}function _o(e,t,n,r){return Yn(n,t)?n:null!==fi.current?(e=Ao(e,n,r),Yn(e,t)||(As=!0),e):0===(42&yi)?(As=!0,e.memoizedState=n):(e=Rc(),bi.lanes|=e,fc|=e,t)}function jo(e,t,n,r,a){var i=R.p;R.p=0!==i&&8>i?i:8;var o=D.T,s={};D.T=s,zo(e,!1,t,n);try{var l=a(),c=D.S;if(null!==c&&c(s,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)Uo(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r),Dc());else Uo(e,t,r,Dc())}catch(u){Uo(e,t,{then:function(){},status:"rejected",reason:u},Dc())}finally{R.p=i,D.T=o}}function Io(){}function To(e,t,n,r){if(5!==e.tag)throw Error(o(476));var a=Oo(e).queue;jo(e,a,t,M,null===n?Io:function(){return Po(e),n(r)})}function Oo(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:M,baseState:M,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:M},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Po(e){Uo(e,Oo(e).next.queue,{},Dc())}function Do(){return ka(Xd)}function Ro(){return Bi().memoizedState}function Mo(){return Bi().memoizedState}function Fo(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Dc(),r=ii(t,e=ai(n),n);return null!==r&&(Mc(r,t,n),oi(r,t,n)),t={cache:Pa()},void(e.payload=t)}t=t.return}}function Lo(e,t,n){var r=Dc();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Vo(e)?Wo(t,n):null!==(n=Ir(e,t,n,r))&&(Mc(n,e,r),qo(n,t,r))}function Bo(e,t,n){Uo(e,t,n,Dc())}function Uo(e,t,n,r){var a={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Vo(e))Wo(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,Yn(s,o))return jr(e,t,a,0),null===rc&&_r(),!1}catch(l){}if(null!==(n=Ir(e,t,a,r)))return Mc(n,e,r),qo(n,t,r),!0}return!1}function zo(e,t,n,r){if(r={lane:2,revertLane:ju(),action:r,hasEagerState:!1,eagerState:null,next:null},Vo(e)){if(t)throw Error(o(479))}else null!==(t=Ir(e,n,r,2))&&Mc(t,e,2)}function Vo(e){var t=e.alternate;return e===bi||null!==t&&t===bi}function Wo(e,t){Si=Ni=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function qo(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ae(e,n)}}var Ho={readContext:ka,use:zi,useCallback:ji,useContext:ji,useEffect:ji,useImperativeHandle:ji,useLayoutEffect:ji,useInsertionEffect:ji,useMemo:ji,useReducer:ji,useRef:ji,useState:ji,useDebugValue:ji,useDeferredValue:ji,useTransition:ji,useSyncExternalStore:ji,useId:ji,useHostTransitionStatus:ji,useFormState:ji,useActionState:ji,useOptimistic:ji,useMemoCache:ji,useCacheRefresh:ji},Go={readContext:ka,use:zi,useCallback:function(e,t){return Li().memoizedState=[e,void 0===t?null:t],e},useContext:ka,useEffect:yo,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,go(4194308,4,No.bind(null,t,e),n)},useLayoutEffect:function(e,t){return go(4194308,4,e,t)},useInsertionEffect:function(e,t){go(4,2,e,t)},useMemo:function(e,t){var n=Li();t=void 0===t?null:t;var r=e();if(Ei){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Li();if(void 0!==n){var a=n(t);if(Ei){he(!0);try{n(t)}finally{he(!1)}}}else a=t;return r.memoizedState=r.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},r.queue=e,e=e.dispatch=Lo.bind(null,bi,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Li().memoizedState=e},useState:function(e){var t=(e=Zi(e)).queue,n=Bo.bind(null,bi,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Eo,useDeferredValue:function(e,t){return Ao(Li(),e,t)},useTransition:function(){var e=Zi(!1);return e=jo.bind(null,bi,e.queue,!0,!1),Li().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=bi,a=Li();if(ia){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===rc)throw Error(o(349));0!==(124&ic)||Xi(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,yo(Qi.bind(null,r,i,e),[e]),r.flags|=2048,po(9,{destroy:void 0,resource:void 0},Yi.bind(null,r,i,n,t),null),n},useId:function(){var e=Li(),t=rc.identifierPrefix;if(ia){var n=Jr;t="\xab"+t+"R"+(n=($r&~(1<<32-fe($r)-1)).toString(32)+n),0<(n=Ci++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=_i++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Do,useFormState:lo,useActionState:lo,useOptimistic:function(e){var t=Li();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=zo.bind(null,bi,!0,n),n.dispatch=t,[e,t]},useMemoCache:Vi,useCacheRefresh:function(){return Li().memoizedState=Fo.bind(null,bi)}},Ko={readContext:ka,use:zi,useCallback:Co,useContext:ka,useEffect:bo,useImperativeHandle:So,useInsertionEffect:xo,useLayoutEffect:wo,useMemo:ko,useReducer:qi,useRef:mo,useState:function(){return qi(Wi)},useDebugValue:Eo,useDeferredValue:function(e,t){return _o(Bi(),xi.memoizedState,e,t)},useTransition:function(){var e=qi(Wi)[0],t=Bi().memoizedState;return["boolean"===typeof e?e:Ui(e),t]},useSyncExternalStore:Ki,useId:Ro,useHostTransitionStatus:Do,useFormState:co,useActionState:co,useOptimistic:function(e,t){return eo(Bi(),0,e,t)},useMemoCache:Vi,useCacheRefresh:Mo},Xo={readContext:ka,use:zi,useCallback:Co,useContext:ka,useEffect:bo,useImperativeHandle:So,useInsertionEffect:xo,useLayoutEffect:wo,useMemo:ko,useReducer:Gi,useRef:mo,useState:function(){return Gi(Wi)},useDebugValue:Eo,useDeferredValue:function(e,t){var n=Bi();return null===xi?Ao(n,e,t):_o(n,xi.memoizedState,e,t)},useTransition:function(){var e=Gi(Wi)[0],t=Bi().memoizedState;return["boolean"===typeof e?e:Ui(e),t]},useSyncExternalStore:Ki,useId:Ro,useHostTransitionStatus:Do,useFormState:fo,useActionState:fo,useOptimistic:function(e,t){var n=Bi();return null!==xi?eo(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Vi,useCacheRefresh:Mo},Yo=null,Qo=0;function $o(e){var t=Qo;return Qo+=1,null===Yo&&(Yo=[]),$a(Yo,e,t)}function Jo(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Zo(e,t){if(t.$$typeof===f)throw Error(o(525));throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function es(e){return(0,e._init)(e._payload)}function ts(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(e,t){return(e=Lr(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Vr(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===g?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===k&&es(i)===t.type)?(Jo(t=a(t,n.props),n),t.return=e,t):(Jo(t=Ur(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Wr(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=zr(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Vr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return Jo(n=Ur(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case m:return(t=Wr(t,e.mode,n)).return=e,t;case k:return h(e,t=(0,t._init)(t._payload),n)}if(P(t)||I(t))return(t=zr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,$o(t),n);if(t.$$typeof===w)return h(e,Aa(e,t),n);Zo(e,t)}return null}function f(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===a?c(e,t,n,r):null;case m:return n.key===a?u(e,t,n,r):null;case k:return f(e,t,n=(a=n._init)(n._payload),r)}if(P(n)||I(n))return null!==a?null:d(e,t,n,r,null);if("function"===typeof n.then)return f(e,t,$o(n),r);if(n.$$typeof===w)return f(e,t,Aa(e,n),r);Zo(e,n)}return null}function v(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case m:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case k:return v(e,t,n,r=(0,r._init)(r._payload),a)}if(P(r)||I(r))return d(t,e=e.get(n)||null,r,a,null);if("function"===typeof r.then)return v(e,t,n,$o(r),a);if(r.$$typeof===w)return v(e,t,n,Aa(t,r),a);Zo(t,r)}return null}function y(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===g&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case p:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===g){if(7===c.tag){n(l,c.sibling),(d=a(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===k&&es(b)===c.type){n(l,c.sibling),Jo(d=a(c,u.props),u),d.return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===g?((d=zr(u.props.children,l.mode,d,u.key)).return=l,l=d):(Jo(d=Ur(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return s(l);case m:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(d=a(c,u.children||[])).return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}(d=Wr(u,l.mode,d)).return=l,l=d}return s(l);case k:return y(l,c,u=(b=u._init)(u._payload),d)}if(P(u))return function(a,o,s,l){for(var c=null,u=null,d=o,p=o=0,m=null;null!==d&&p<s.length;p++){d.index>p?(m=d,d=null):m=d.sibling;var g=f(a,d,s[p],l);if(null===g){null===d&&(d=m);break}e&&d&&null===g.alternate&&t(a,d),o=i(g,o,p),null===u?c=g:u.sibling=g,u=g,d=m}if(p===s.length)return n(a,d),ia&&Zr(a,p),c;if(null===d){for(;p<s.length;p++)null!==(d=h(a,s[p],l))&&(o=i(d,o,p),null===u?c=d:u.sibling=d,u=d);return ia&&Zr(a,p),c}for(d=r(d);p<s.length;p++)null!==(m=v(d,a,p,s[p],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?p:m.key),o=i(m,o,p),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach(function(e){return t(a,e)}),ia&&Zr(a,p),c}(l,c,u,d);if(I(u)){if("function"!==typeof(b=I(u)))throw Error(o(150));return function(a,s,l,c){if(null==l)throw Error(o(151));for(var u=null,d=null,p=s,m=s=0,g=null,y=l.next();null!==p&&!y.done;m++,y=l.next()){p.index>m?(g=p,p=null):g=p.sibling;var b=f(a,p,y.value,c);if(null===b){null===p&&(p=g);break}e&&p&&null===b.alternate&&t(a,p),s=i(b,s,m),null===d?u=b:d.sibling=b,d=b,p=g}if(y.done)return n(a,p),ia&&Zr(a,m),u;if(null===p){for(;!y.done;m++,y=l.next())null!==(y=h(a,y.value,c))&&(s=i(y,s,m),null===d?u=y:d.sibling=y,d=y);return ia&&Zr(a,m),u}for(p=r(p);!y.done;m++,y=l.next())null!==(y=v(p,a,m,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?m:y.key),s=i(y,s,m),null===d?u=y:d.sibling=y,d=y);return e&&p.forEach(function(e){return t(a,e)}),ia&&Zr(a,m),u}(l,c,u=b.call(u),d)}if("function"===typeof u.then)return y(l,c,$o(u),d);if(u.$$typeof===w)return y(l,c,Aa(l,u),d);Zo(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(d=a(c,u)).return=l,l=d):(n(l,c),(d=Vr(u,l.mode,d)).return=l,l=d),s(l)):n(l,c)}return function(e,t,n,r){try{Qo=0;var a=y(e,t,n,r);return Yo=null,a}catch(o){if(o===Ha||o===Ka)throw o;var i=Mr(29,o,null,e.mode);return i.lanes=r,i.return=e,i}}}var ns=ts(!0),rs=ts(!1),as=B(null),is=null;function os(e){var t=e.alternate;z(us,1&us.current),z(as,e),null===is&&(null===t||null!==fi.current||null!==t.memoizedState)&&(is=e)}function ss(e){if(22===e.tag){if(z(us,us.current),z(as,e),null===is){var t=e.alternate;null!==t&&null!==t.memoizedState&&(is=e)}}else ls()}function ls(){z(us,us.current),z(as,as.current)}function cs(e){U(as),is===e&&(is=null),U(us)}var us=B(0);function ds(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||gd(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function hs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:h({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fs={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Dc(),a=ai(r);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=ii(e,a,r))&&(Mc(t,e,r),oi(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Dc(),a=ai(r);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=ii(e,a,r))&&(Mc(t,e,r),oi(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Dc(),r=ai(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=ii(e,r,n))&&(Mc(t,e,n),oi(t,e,n))}};function ps(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!Qn(n,r)||!Qn(a,i))}function ms(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fs.enqueueReplaceState(t,t.state,null)}function gs(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var a in n===t&&(n=h({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}var vs="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function ys(e){vs(e)}function bs(e){console.error(e)}function xs(e){vs(e)}function ws(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Ns(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Ss(e,t,n){return(n=ai(n)).tag=3,n.payload={element:null},n.callback=function(){ws(e,t)},n}function Es(e){return(e=ai(e)).tag=3,e}function Cs(e,t,n,r){var a=n.type.getDerivedStateFromError;if("function"===typeof a){var i=r.value;e.payload=function(){return a(i)},e.callback=function(){Ns(t,n,r)}}var o=n.stateNode;null!==o&&"function"===typeof o.componentDidCatch&&(e.callback=function(){Ns(t,n,r),"function"!==typeof a&&(null===Ec?Ec=new Set([this]):Ec.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var ks=Error(o(461)),As=!1;function _s(e,t,n,r){t.child=null===e?rs(t,null,n,r):ns(t,e.child,n,r)}function js(e,t,n,r,a){n=n.render;var i=t.ref;if("ref"in r){var o={};for(var s in r)"ref"!==s&&(o[s]=r[s])}else o=r;return Ca(t),r=Ti(e,t,n,o,i,a),s=Ri(),null===e||As?(ia&&s&&ta(t),t.flags|=1,_s(e,t,r,a),t.child):(Mi(e,t,a),Ys(e,t,a))}function Is(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Fr(i)||void 0!==i.defaultProps||null!==n.compare?((e=Ur(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ts(e,t,i,r,a))}if(i=e.child,!Qs(e,a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:Qn)(o,r)&&e.ref===t.ref)return Ys(e,t,a)}return t.flags|=1,(e=Lr(i,r)).ref=t.ref,e.return=t,t.child=e}function Ts(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(Qn(i,r)&&e.ref===t.ref){if(As=!1,t.pendingProps=r=i,!Qs(e,a))return t.lanes=e.lanes,Ys(e,t,a);0!==(131072&e.flags)&&(As=!0)}}return Rs(e,t,n,r,a)}function Os(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode){if(0!==(128&t.flags)){if(r=null!==i?i.baseLanes|n:n,null!==e){for(a=t.child=e.child,i=0;null!==a;)i=i|a.lanes|a.childLanes,a=a.sibling;t.childLanes=i&~r}else t.childLanes=0,t.child=null;return Ps(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Ps(e,t,null!==i?i.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Wa(0,null!==i?i.cachePool:null),null!==i?mi(t,i):gi(),ss(t)}else null!==i?(Wa(0,i.cachePool),mi(t,i),ls(),t.memoizedState=null):(null!==e&&Wa(0,null),gi(),ls());return _s(e,t,a,n),t.child}function Ps(e,t,n,r){var a=Va();return a=null===a?null:{parent:Oa._currentValue,pool:a},t.memoizedState={baseLanes:n,cachePool:a},null!==e&&Wa(0,null),gi(),ss(t),null!==e&&Sa(e,t,r,!0),null}function Ds(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(o(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Rs(e,t,n,r,a){return Ca(t),n=Ti(e,t,n,r,void 0,a),r=Ri(),null===e||As?(ia&&r&&ta(t),t.flags|=1,_s(e,t,n,a),t.child):(Mi(e,t,a),Ys(e,t,a))}function Ms(e,t,n,r,a,i){return Ca(t),t.updateQueue=null,n=Pi(t,r,n,a),Oi(e),r=Ri(),null===e||As?(ia&&r&&ta(t),t.flags|=1,_s(e,t,n,i),t.child):(Mi(e,t,i),Ys(e,t,i))}function Fs(e,t,n,r,a){if(Ca(t),null===t.stateNode){var i=Dr,o=n.contextType;"object"===typeof o&&null!==o&&(i=ka(o)),i=new n(r,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=fs,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=r,i.state=t.memoizedState,i.refs={},ni(t),o=n.contextType,i.context="object"===typeof o&&null!==o?ka(o):Dr,i.state=t.memoizedState,"function"===typeof(o=n.getDerivedStateFromProps)&&(hs(t,n,o,r),i.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(o=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),o!==i.state&&fs.enqueueReplaceState(i,i.state,null),ui(t,r,i,a),ci(),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){i=t.stateNode;var s=t.memoizedProps,l=gs(n,s);i.props=l;var c=i.context,u=n.contextType;o=Dr,"object"===typeof u&&null!==u&&(o=ka(u));var d=n.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate,s=t.pendingProps!==s,u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s||c!==o)&&ms(t,i,r,o),ti=!1;var h=t.memoizedState;i.state=h,ui(t,r,i,a),ci(),c=t.memoizedState,s||h!==c||ti?("function"===typeof d&&(hs(t,n,d,r),c=t.memoizedState),(l=ti||ps(t,n,l,r,h,c,o))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=o,r=l):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,ri(e,t),u=gs(n,o=t.memoizedProps),i.props=u,d=t.pendingProps,h=i.context,c=n.contextType,l=Dr,"object"===typeof c&&null!==c&&(l=ka(c)),(c="function"===typeof(s=n.getDerivedStateFromProps)||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==d||h!==l)&&ms(t,i,r,l),ti=!1,h=t.memoizedState,i.state=h,ui(t,r,i,a),ci();var f=t.memoizedState;o!==d||h!==f||ti||null!==e&&null!==e.dependencies&&Ea(e.dependencies)?("function"===typeof s&&(hs(t,n,s,r),f=t.memoizedState),(u=ti||ps(t,n,u,r,h,f,l)||null!==e&&null!==e.dependencies&&Ea(e.dependencies))?(c||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,f,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),i.props=r,i.state=f,i.context=l,r=u):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return i=r,Ds(e,t),r=0!==(128&t.flags),i||r?(i=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&r?(t.child=ns(t,e.child,null,a),t.child=ns(t,null,n,a)):_s(e,t,n,a),t.memoizedState=i.state,e=t.child):e=Ys(e,t,a),e}function Ls(e,t,n,r){return fa(),t.flags|=256,_s(e,t,n,r),t.child}var Bs={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Us(e){return{baseLanes:e,cachePool:qa()}}function zs(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=gc),e}function Vs(e,t,n){var r,a=t.pendingProps,i=!1,s=0!==(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&0!==(2&us.current)),r&&(i=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(ia){if(i?os(t):ls(),ia){var l,c=aa;if(l=c){e:{for(l=c,c=sa;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=vd(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Qr?{id:$r,overflow:Jr}:null,retryLane:536870912,hydrationErrors:null},(l=Mr(18,null,null,0)).stateNode=c,l.return=t,t.child=l,ra=t,aa=null,l=!0):l=!1}l||ca(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return gd(c)?t.lanes=32:t.lanes=536870912,null;cs(t)}return c=a.children,a=a.fallback,i?(ls(),c=qs({mode:"hidden",children:c},i=t.mode),a=zr(a,i,n,null),c.return=t,a.return=t,c.sibling=a,t.child=c,(i=t.child).memoizedState=Us(n),i.childLanes=zs(e,r,n),t.memoizedState=Bs,a):(os(t),Ws(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(s)256&t.flags?(os(t),t.flags&=-257,t=Hs(e,t,n)):null!==t.memoizedState?(ls(),t.child=e.child,t.flags|=128,t=null):(ls(),i=a.fallback,c=t.mode,a=qs({mode:"visible",children:a.children},c),(i=zr(i,c,n,null)).flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,ns(t,e.child,null,n),(a=t.child).memoizedState=Us(n),a.childLanes=zs(e,r,n),t.memoizedState=Bs,t=i);else if(os(t),gd(c)){if(r=c.nextSibling&&c.nextSibling.dataset)var u=r.dgst;r=u,(a=Error(o(419))).stack="",a.digest=r,ma({value:a,source:null,stack:null}),t=Hs(e,t,n)}else if(As||Sa(e,t,n,!1),r=0!==(n&e.childLanes),As||r){if(null!==(r=rc)&&(0!==(a=0!==((a=0!==(42&(a=n&-n))?1:_e(a))&(r.suspendedLanes|n))?0:a)&&a!==l.retryLane))throw l.retryLane=a,Tr(e,a),Mc(r,e,a),ks;"$?"===c.data||Kc(),t=Hs(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,aa=vd(c.nextSibling),ra=t,ia=!0,oa=null,sa=!1,null!==e&&(Xr[Yr++]=$r,Xr[Yr++]=Jr,Xr[Yr++]=Qr,$r=e.id,Jr=e.overflow,Qr=t),(t=Ws(t,a.children)).flags|=4096);return t}return i?(ls(),i=a.fallback,c=t.mode,u=(l=e.child).sibling,(a=Lr(l,{mode:"hidden",children:a.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?i=Lr(u,i):(i=zr(i,c,n,null)).flags|=2,i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,null===(c=e.child.memoizedState)?c=Us(n):(null!==(l=c.cachePool)?(u=Oa._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=qa(),c={baseLanes:c.baseLanes|n,cachePool:l}),i.memoizedState=c,i.childLanes=zs(e,r,n),t.memoizedState=Bs,a):(os(t),e=(n=e.child).sibling,(n=Lr(n,{mode:"visible",children:a.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Ws(e,t){return(t=qs({mode:"visible",children:t},e.mode)).return=e,e.child=t}function qs(e,t){return(e=Mr(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Hs(e,t,n){return ns(t,e.child,null,n),(e=Ws(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Gs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),wa(e.return,t,n)}function Ks(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Xs(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(_s(e,t,r.children,n),0!==(2&(r=us.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Gs(e,n,t);else if(19===e.tag)Gs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(z(us,r),a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===ds(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ks(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ds(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ks(t,!0,n,null,i);break;case"together":Ks(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ys(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),fc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Sa(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Lr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Lr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Qs(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ea(e))}function $s(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)As=!0;else{if(!Qs(e,n)&&0===(128&t.flags))return As=!1,function(e,t,n){switch(t.tag){case 3:G(t,t.stateNode.containerInfo),ba(0,Oa,e.memoizedState.cache),fa();break;case 27:case 5:X(t);break;case 4:G(t,t.stateNode.containerInfo);break;case 10:ba(0,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(os(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Vs(e,t,n):(os(t),null!==(e=Ys(e,t,n))?e.sibling:null);os(t);break;case 19:var a=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Sa(e,t,n,!1),r=0!==(n&t.childLanes)),a){if(r)return Xs(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),z(us,us.current),r)break;return null;case 22:case 23:return t.lanes=0,Os(e,t,n);case 24:ba(0,Oa,e.memoizedState.cache)}return Ys(e,t,n)}(e,t,n);As=0!==(131072&e.flags)}else As=!1,ia&&0!==(1048576&t.flags)&&ea(t,Kr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,a=r._init;if(r=a(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((a=r.$$typeof)===N){t.tag=11,t=js(null,t,r,e,n);break e}if(a===C){t.tag=14,t=Is(null,t,r,e,n);break e}}throw t=O(r)||r,Error(o(306,t,""))}Fr(r)?(e=gs(r,e),t.tag=1,t=Fs(null,t,r,e,n)):(t.tag=0,t=Rs(null,t,r,e,n))}return t;case 0:return Rs(e,t,t.type,t.pendingProps,n);case 1:return Fs(e,t,r=t.type,a=gs(r,t.pendingProps),n);case 3:e:{if(G(t,t.stateNode.containerInfo),null===e)throw Error(o(387));r=t.pendingProps;var i=t.memoizedState;a=i.element,ri(e,t),ui(t,r,null,n);var s=t.memoizedState;if(r=s.cache,ba(0,Oa,r),r!==i.cache&&Na(t,[Oa],n,!0),ci(),r=s.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Ls(e,t,r,n);break e}if(r!==a){ma(a=Er(Error(o(424)),t)),t=Ls(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(aa=vd(e.firstChild),ra=t,ia=!0,oa=null,sa=!0,n=rs(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fa(),r===a){t=Ys(e,t,n);break e}_s(e,t,r,n)}t=t.child}return t;case 26:return Ds(e,t),null===e?(n=_d(t.type,null,t.pendingProps,null))?t.memoizedState=n:ia||(n=t.type,e=t.pendingProps,(r=rd(q.current).createElement(n))[Oe]=t,r[Pe]=e,ed(r,n,e),He(r),t.stateNode=r):t.memoizedState=_d(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return X(t),null===e&&ia&&(r=t.stateNode=xd(t.type,t.pendingProps,q.current),ra=t,sa=!0,a=aa,fd(t.type)?(yd=a,aa=vd(r.firstChild)):aa=a),_s(e,t,t.pendingProps.children,n),Ds(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ia&&((a=r=aa)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Be])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===i)return e}if(null===(e=vd(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,sa))?(t.stateNode=r,ra=t,aa=vd(r.firstChild),sa=!1,a=!0):a=!1),a||ca(t)),X(t),a=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,r=i.children,od(a,i)?r=null:null!==s&&od(a,s)&&(t.flags|=32),null!==t.memoizedState&&(a=Ti(e,t,Di,null,null,n),Xd._currentValue=a),Ds(e,t),_s(e,t,r,n),t.child;case 6:return null===e&&ia&&((e=n=aa)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=vd(e.nextSibling)))return null}return e}(n,t.pendingProps,sa))?(t.stateNode=n,ra=t,aa=null,e=!0):e=!1),e||ca(t)),null;case 13:return Vs(e,t,n);case 4:return G(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ns(t,null,r,n):_s(e,t,r,n),t.child;case 11:return js(e,t,t.type,t.pendingProps,n);case 7:return _s(e,t,t.pendingProps,n),t.child;case 8:case 12:return _s(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,ba(0,t.type,r.value),_s(e,t,r.children,n),t.child;case 9:return a=t.type._context,r=t.pendingProps.children,Ca(t),r=r(a=ka(a)),t.flags|=1,_s(e,t,r,n),t.child;case 14:return Is(e,t,t.type,t.pendingProps,n);case 15:return Ts(e,t,t.type,t.pendingProps,n);case 19:return Xs(e,t,n);case 31:return r=t.pendingProps,n=t.mode,r={mode:r.mode,children:r.children},null===e?((n=qs(r,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=Lr(e.child,r)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Os(e,t,n);case 24:return Ca(t),r=ka(Oa),null===e?(null===(a=Va())&&(a=rc,i=Pa(),a.pooledCache=i,i.refCount++,null!==i&&(a.pooledCacheLanes|=n),a=i),t.memoizedState={parent:r,cache:a},ni(t),ba(0,Oa,a)):(0!==(e.lanes&n)&&(ri(e,t),ui(t,null,null,n),ci()),a=e.memoizedState,i=t.memoizedState,a.parent!==r?(a={parent:r,cache:r},t.memoizedState=a,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=a),ba(0,Oa,r)):(r=i.cache,ba(0,Oa,r),r!==a.cache&&Na(t,[Oa],n,!0))),_s(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}function Js(e){e.flags|=4}function Zs(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!zd(t)){if(null!==(t=as.current)&&((4194048&ic)===ic?null!==is:(62914560&ic)!==ic&&0===(536870912&ic)||t!==is))throw Ja=Xa,Ga;e.flags|=8192}}function el(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Se():536870912,e.lanes|=t,vc|=t)}function tl(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function nl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=65011712&a.subtreeFlags,r|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function rl(e,t,n){var r=t.pendingProps;switch(na(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return nl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),xa(Oa),K(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ha(t)?Js(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,pa())),nl(t),null;case 26:return n=t.memoizedState,null===e?(Js(t),null!==n?(nl(t),Zs(t,n)):(nl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Js(t),nl(t),Zs(t,n)):(nl(t),t.flags&=-16777217):(e.memoizedProps!==r&&Js(t),nl(t),t.flags&=-16777217),null;case 27:Y(t),n=q.current;var a=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Js(t);else{if(!r){if(null===t.stateNode)throw Error(o(166));return nl(t),null}e=V.current,ha(t)?ua(t):(e=xd(a,r,n),t.stateNode=e,Js(t))}return nl(t),null;case 5:if(Y(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Js(t);else{if(!r){if(null===t.stateNode)throw Error(o(166));return nl(t),null}if(e=V.current,ha(t))ua(t);else{switch(a=rd(q.current),e){case 1:e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=a.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?a.createElement("select",{is:r.is}):a.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?a.createElement(n,{is:r.is}):a.createElement(n)}}e[Oe]=t,e[Pe]=r;e:for(a=t.child;null!==a;){if(5===a.tag||6===a.tag)e.appendChild(a.stateNode);else if(4!==a.tag&&27!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;null===a.sibling;){if(null===a.return||a.return===t)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}t.stateNode=e;e:switch(ed(e,n,r),n){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Js(t)}}return nl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&Js(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(e=q.current,ha(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(a=ra))switch(a.tag){case 27:case 5:r=a.memoizedProps}e[Oe]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||Qu(e.nodeValue,n)))||ca(t)}else(e=rd(e).createTextNode(r))[Oe]=t,t.stateNode=e}return nl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(a=ha(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[Oe]=t}else fa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;nl(t),a=!1}else a=pa(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return 256&t.flags?(cs(t),t):(cs(t),null)}if(cs(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){a=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(a=r.alternate.memoizedState.cachePool.pool);var i=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(i=r.memoizedState.cachePool.pool),i!==a&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),el(t,t.updateQueue),nl(t),null;case 4:return K(),null===e&&Uu(t.stateNode.containerInfo),nl(t),null;case 10:return xa(t.type),nl(t),null;case 19:if(U(us),null===(a=t.memoizedState))return nl(t),null;if(r=0!==(128&t.flags),null===(i=a.rendering))if(r)tl(a,!1);else{if(0!==hc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(i=ds(e))){for(t.flags|=128,tl(a,!1),e=i.updateQueue,t.updateQueue=e,el(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Br(n,e),n=n.sibling;return z(us,1&us.current|2),t.child}e=e.sibling}null!==a.tail&&te()>Nc&&(t.flags|=128,r=!0,tl(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ds(i))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,el(t,e),tl(a,!0),null===a.tail&&"hidden"===a.tailMode&&!i.alternate&&!ia)return nl(t),null}else 2*te()-a.renderingStartTime>Nc&&536870912!==n&&(t.flags|=128,r=!0,tl(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(null!==(e=a.last)?e.sibling=i:t.child=i,a.last=i)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=te(),t.sibling=null,e=us.current,z(us,r?1&e|2:1&e),t):(nl(t),null);case 22:case 23:return cs(t),vi(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(nl(t),6&t.subtreeFlags&&(t.flags|=8192)):nl(t),null!==(n=t.updateQueue)&&el(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&U(za),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),xa(Oa),nl(t),null;case 25:case 30:return null}throw Error(o(156,t.tag))}function al(e,t){switch(na(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return xa(Oa),K(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Y(t),null;case 13:if(cs(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return U(us),null;case 4:return K(),null;case 10:return xa(t.type),null;case 22:case 23:return cs(t),vi(),null!==e&&U(za),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return xa(Oa),null;default:return null}}function il(e,t){switch(na(t),t.tag){case 3:xa(Oa),K();break;case 26:case 27:case 5:Y(t);break;case 4:K();break;case 13:cs(t);break;case 19:U(us);break;case 10:xa(t.type);break;case 22:case 23:cs(t),vi(),null!==e&&U(za);break;case 24:xa(Oa)}}function ol(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){r=void 0;var i=n.create,o=n.inst;r=i(),o.destroy=r}n=n.next}while(n!==a)}}catch(s){uu(t,t.return,s)}}function sl(e,t,n){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var i=a.next;r=i;do{if((r.tag&e)===e){var o=r.inst,s=o.destroy;if(void 0!==s){o.destroy=void 0,a=t;var l=n,c=s;try{c()}catch(u){uu(a,l,u)}}}r=r.next}while(r!==i)}}catch(u){uu(t,t.return,u)}}function ll(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{hi(t,n)}catch(r){uu(e,e.return,r)}}}function cl(e,t,n){n.props=gs(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){uu(e,t,r)}}function ul(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(a){uu(e,t,a)}}function dl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(a){uu(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(i){uu(e,t,i)}else n.current=null}function hl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(a){uu(e,e.return,a)}}function fl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,i=null,s=null,l=null,c=null,u=null,d=null;for(p in n){var h=n[p];if(n.hasOwnProperty(p)&&null!=h)switch(p){case"checked":case"value":break;case"defaultValue":c=h;default:r.hasOwnProperty(p)||Ju(e,t,p,null,r,h)}}for(var f in r){var p=r[f];if(h=n[f],r.hasOwnProperty(f)&&(null!=p||null!=h))switch(f){case"type":i=p;break;case"name":a=p;break;case"checked":u=p;break;case"defaultChecked":d=p;break;case"value":s=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(o(137,t));break;default:p!==h&&Ju(e,t,f,p,r,h)}}return void gt(e,s,l,c,u,d,i,a);case"select":for(i in p=s=l=f=null,n)if(c=n[i],n.hasOwnProperty(i)&&null!=c)switch(i){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(i)||Ju(e,t,i,null,r,c)}for(a in r)if(i=r[a],c=n[a],r.hasOwnProperty(a)&&(null!=i||null!=c))switch(a){case"value":f=i;break;case"defaultValue":l=i;break;case"multiple":s=i;default:i!==c&&Ju(e,t,a,i,r,c)}return t=l,n=s,r=p,void(null!=f?bt(e,!!n,f,!1):!!r!==!!n&&(null!=t?bt(e,!!n,t,!0):bt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=f=null,n)if(a=n[l],n.hasOwnProperty(l)&&null!=a&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Ju(e,t,l,null,r,a)}for(s in r)if(a=r[s],i=n[s],r.hasOwnProperty(s)&&(null!=a||null!=i))switch(s){case"value":f=a;break;case"defaultValue":p=a;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=a)throw Error(o(91));break;default:a!==i&&Ju(e,t,s,a,r,i)}return void xt(e,f,p);case"option":for(var m in n)if(f=n[m],n.hasOwnProperty(m)&&null!=f&&!r.hasOwnProperty(m))if("selected"===m)e.selected=!1;else Ju(e,t,m,null,r,f);for(c in r)if(f=r[c],p=n[c],r.hasOwnProperty(c)&&f!==p&&(null!=f||null!=p))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else Ju(e,t,c,f,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)f=n[g],n.hasOwnProperty(g)&&null!=f&&!r.hasOwnProperty(g)&&Ju(e,t,g,null,r,f);for(u in r)if(f=r[u],p=n[u],r.hasOwnProperty(u)&&f!==p&&(null!=f||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(o(137,t));break;default:Ju(e,t,u,f,r,p)}return;default:if(kt(t)){for(var v in n)f=n[v],n.hasOwnProperty(v)&&void 0!==f&&!r.hasOwnProperty(v)&&Zu(e,t,v,void 0,r,f);for(d in r)f=r[d],p=n[d],!r.hasOwnProperty(d)||f===p||void 0===f&&void 0===p||Zu(e,t,d,f,r,p);return}}for(var y in n)f=n[y],n.hasOwnProperty(y)&&null!=f&&!r.hasOwnProperty(y)&&Ju(e,t,y,null,r,f);for(h in r)f=r[h],p=n[h],!r.hasOwnProperty(h)||f===p||null==f&&null==p||Ju(e,t,h,f,r,p)}(r,e.type,n,t),r[Pe]=t}catch(a){uu(e,e.return,a)}}function pl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&fd(e.type)||4===e.tag}function ml(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||pl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&fd(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function gl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$u));else if(4!==r&&(27===r&&fd(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(gl(e,t,n),e=e.sibling;null!==e;)gl(e,t,n),e=e.sibling}function vl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&fd(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(vl(e,t,n),e=e.sibling;null!==e;)vl(e,t,n),e=e.sibling}function yl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);ed(t,r,n),t[Oe]=e,t[Pe]=n}catch(i){uu(e,e.return,i)}}var bl=!1,xl=!1,wl=!1,Nl="function"===typeof WeakSet?WeakSet:Set,Sl=null;function El(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Fl(e,n),4&r&&ol(5,n);break;case 1:if(Fl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(o){uu(n,n.return,o)}else{var a=gs(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){uu(n,n.return,s)}}64&r&&ll(n),512&r&&ul(n,n.return);break;case 3:if(Fl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{hi(e,t)}catch(o){uu(n,n.return,o)}}break;case 27:null===t&&4&r&&yl(n);case 26:case 5:Fl(e,n),null===t&&4&r&&hl(n),512&r&&ul(n,n.return);break;case 12:Fl(e,n);break;case 13:Fl(e,n),4&r&&Il(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=pu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||bl)){t=null!==t&&null!==t.memoizedState||xl,a=bl;var i=xl;bl=r,(xl=t)&&!i?Bl(e,n,0!==(8772&n.subtreeFlags)):Fl(e,n),bl=a,xl=i}break;case 30:break;default:Fl(e,n)}}function Cl(e){var t=e.alternate;null!==t&&(e.alternate=null,Cl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ue(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var kl=null,Al=!1;function _l(e,t,n){for(n=n.child;null!==n;)jl(e,t,n),n=n.sibling}function jl(e,t,n){if(de&&"function"===typeof de.onCommitFiberUnmount)try{de.onCommitFiberUnmount(ue,n)}catch(i){}switch(n.tag){case 26:xl||dl(n,t),_l(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:xl||dl(n,t);var r=kl,a=Al;fd(n.type)&&(kl=n.stateNode,Al=!1),_l(e,t,n),wd(n.stateNode),kl=r,Al=a;break;case 5:xl||dl(n,t);case 6:if(r=kl,a=Al,kl=null,_l(e,t,n),Al=a,null!==(kl=r))if(Al)try{(9===kl.nodeType?kl.body:"HTML"===kl.nodeName?kl.ownerDocument.body:kl).removeChild(n.stateNode)}catch(o){uu(n,t,o)}else try{kl.removeChild(n.stateNode)}catch(o){uu(n,t,o)}break;case 18:null!==kl&&(Al?(pd(9===(e=kl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Ah(e)):pd(kl,n.stateNode));break;case 4:r=kl,a=Al,kl=n.stateNode.containerInfo,Al=!0,_l(e,t,n),kl=r,Al=a;break;case 0:case 11:case 14:case 15:xl||sl(2,n,t),xl||sl(4,n,t),_l(e,t,n);break;case 1:xl||(dl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&cl(n,t,r)),_l(e,t,n);break;case 21:_l(e,t,n);break;case 22:xl=(r=xl)||null!==n.memoizedState,_l(e,t,n),xl=r;break;default:_l(e,t,n)}}function Il(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Ah(e)}catch(n){uu(t,t.return,n)}}function Tl(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Nl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Nl),t;default:throw Error(o(435,e.tag))}}(e);t.forEach(function(t){var r=mu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}function Ol(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r],i=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 27:if(fd(l.type)){kl=l.stateNode,Al=!1;break e}break;case 5:kl=l.stateNode,Al=!1;break e;case 3:case 4:kl=l.stateNode.containerInfo,Al=!0;break e}l=l.return}if(null===kl)throw Error(o(160));jl(i,s,a),kl=null,Al=!1,null!==(i=a.alternate)&&(i.return=null),a.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Dl(t,e),t=t.sibling}var Pl=null;function Dl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ol(t,e),Rl(e),4&r&&(sl(3,e,e.return),ol(3,e),sl(5,e,e.return));break;case 1:Ol(t,e),Rl(e),512&r&&(xl||null===n||dl(n,n.return)),64&r&&bl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var a=Pl;if(Ol(t,e),Rl(e),512&r&&(xl||null===n||dl(n,n.return)),4&r){var i=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,a=a.ownerDocument||a;t:switch(r){case"title":(!(i=a.getElementsByTagName("title")[0])||i[Be]||i[Oe]||"http://www.w3.org/2000/svg"===i.namespaceURI||i.hasAttribute("itemprop"))&&(i=a.createElement(r),a.head.insertBefore(i,a.querySelector("head > title"))),ed(i,r,n),i[Oe]=e,He(i),r=i;break e;case"link":var s=Bd("link","href",a).get(r+(n.href||""));if(s)for(var l=0;l<s.length;l++)if((i=s[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&i.getAttribute("rel")===(null==n.rel?null:n.rel)&&i.getAttribute("title")===(null==n.title?null:n.title)&&i.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(l,1);break t}ed(i=a.createElement(r),r,n),a.head.appendChild(i);break;case"meta":if(s=Bd("meta","content",a).get(r+(n.content||"")))for(l=0;l<s.length;l++)if((i=s[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&i.getAttribute("name")===(null==n.name?null:n.name)&&i.getAttribute("property")===(null==n.property?null:n.property)&&i.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&i.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(l,1);break t}ed(i=a.createElement(r),r,n),a.head.appendChild(i);break;default:throw Error(o(468,r))}i[Oe]=e,He(i),r=i}e.stateNode=r}else Ud(a,e.type,e.stateNode);else e.stateNode=Dd(a,r,e.memoizedProps);else i!==r?(null===i?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):i.count--,null===r?Ud(a,e.type,e.stateNode):Dd(a,r,e.memoizedProps)):null===r&&null!==e.stateNode&&fl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Ol(t,e),Rl(e),512&r&&(xl||null===n||dl(n,n.return)),null!==n&&4&r&&fl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Ol(t,e),Rl(e),512&r&&(xl||null===n||dl(n,n.return)),32&e.flags){a=e.stateNode;try{Nt(a,"")}catch(p){uu(e,e.return,p)}}4&r&&null!=e.stateNode&&fl(e,a=e.memoizedProps,null!==n?n.memoizedProps:a),1024&r&&(wl=!0);break;case 6:if(Ol(t,e),Rl(e),4&r){if(null===e.stateNode)throw Error(o(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(p){uu(e,e.return,p)}}break;case 3:if(Ld=null,a=Pl,Pl=Ed(t.containerInfo),Ol(t,e),Pl=a,Rl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ah(t.containerInfo)}catch(p){uu(e,e.return,p)}wl&&(wl=!1,Ml(e));break;case 4:r=Pl,Pl=Ed(e.stateNode.containerInfo),Ol(t,e),Rl(e),Pl=r;break;case 12:default:Ol(t,e),Rl(e);break;case 13:Ol(t,e),Rl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(wc=te()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Tl(e,r)));break;case 22:a=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=bl,d=xl;if(bl=u||a,xl=d||c,Ol(t,e),xl=d,bl=u,Rl(e),8192&r)e:for(t=e.stateNode,t._visibility=a?-2&t._visibility:1|t._visibility,a&&(null===n||c||bl||xl||Ll(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(i=c.stateNode,a)"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,f=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(p){uu(c,c.return,p)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=a?"":c.memoizedProps}catch(p){uu(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Tl(e,n))));break;case 19:Ol(t,e),Rl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Tl(e,r)));case 30:case 21:}}function Rl(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(pl(r)){n=r;break}r=r.return}if(null==n)throw Error(o(160));switch(n.tag){case 27:var a=n.stateNode;vl(e,ml(e),a);break;case 5:var i=n.stateNode;32&n.flags&&(Nt(i,""),n.flags&=-33),vl(e,ml(e),i);break;case 3:case 4:var s=n.stateNode.containerInfo;gl(e,ml(e),s);break;default:throw Error(o(161))}}catch(l){uu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ml(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ml(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Fl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)El(e,t.alternate,t),t=t.sibling}function Ll(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:sl(4,t,t.return),Ll(t);break;case 1:dl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&cl(t,t.return,n),Ll(t);break;case 27:wd(t.stateNode);case 26:case 5:dl(t,t.return),Ll(t);break;case 22:null===t.memoizedState&&Ll(t);break;default:Ll(t)}e=e.sibling}}function Bl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,a=e,i=t,o=i.flags;switch(i.tag){case 0:case 11:case 15:Bl(a,i,n),ol(4,i);break;case 1:if(Bl(a,i,n),"function"===typeof(a=(r=i).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){uu(r,r.return,c)}if(null!==(a=(r=i).updateQueue)){var s=r.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)di(l[a],s)}catch(c){uu(r,r.return,c)}}n&&64&o&&ll(i),ul(i,i.return);break;case 27:yl(i);case 26:case 5:Bl(a,i,n),n&&null===r&&4&o&&hl(i),ul(i,i.return);break;case 12:Bl(a,i,n);break;case 13:Bl(a,i,n),n&&4&o&&Il(a,i);break;case 22:null===i.memoizedState&&Bl(a,i,n),ul(i,i.return);break;case 30:break;default:Bl(a,i,n)}t=t.sibling}}function Ul(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Da(n))}function zl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Da(e))}function Vl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Wl(e,t,n,r),t=t.sibling}function Wl(e,t,n,r){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Vl(e,t,n,r),2048&a&&ol(9,t);break;case 1:case 13:default:Vl(e,t,n,r);break;case 3:Vl(e,t,n,r),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Da(e)));break;case 12:if(2048&a){Vl(e,t,n,r),e=t.stateNode;try{var i=t.memoizedProps,o=i.id,s=i.onPostCommit;"function"===typeof s&&s(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){uu(t,t.return,l)}}else Vl(e,t,n,r);break;case 23:break;case 22:i=t.stateNode,o=t.alternate,null!==t.memoizedState?2&i._visibility?Vl(e,t,n,r):Hl(e,t):2&i._visibility?Vl(e,t,n,r):(i._visibility|=2,ql(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&a&&Ul(o,t);break;case 24:Vl(e,t,n,r),2048&a&&zl(t.alternate,t)}}function ql(e,t,n,r,a){for(a=a&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var i=e,o=t,s=n,l=r,c=o.flags;switch(o.tag){case 0:case 11:case 15:ql(i,o,s,l,a),ol(8,o);break;case 23:break;case 22:var u=o.stateNode;null!==o.memoizedState?2&u._visibility?ql(i,o,s,l,a):Hl(i,o):(u._visibility|=2,ql(i,o,s,l,a)),a&&2048&c&&Ul(o.alternate,o);break;case 24:ql(i,o,s,l,a),a&&2048&c&&zl(o.alternate,o);break;default:ql(i,o,s,l,a)}t=t.sibling}}function Hl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,a=r.flags;switch(r.tag){case 22:Hl(n,r),2048&a&&Ul(r.alternate,r);break;case 24:Hl(n,r),2048&a&&zl(r.alternate,r);break;default:Hl(n,r)}t=t.sibling}}var Gl=8192;function Kl(e){if(e.subtreeFlags&Gl)for(e=e.child;null!==e;)Xl(e),e=e.sibling}function Xl(e){switch(e.tag){case 26:Kl(e),e.flags&Gl&&null!==e.memoizedState&&function(e,t,n){if(null===Vd)throw Error(o(475));var r=Vd;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var a=jd(n.href),i=e.querySelector(Id(a));if(i)return null!==(e=i._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=qd.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=i,void He(i);i=e.ownerDocument||e,n=Td(n),(a=Nd.get(a))&&Md(n,a),He(i=i.createElement("link"));var s=i;s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),ed(i,"link",n),t.instance=i}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=qd.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(Pl,e.memoizedState,e.memoizedProps);break;case 5:default:Kl(e);break;case 3:case 4:var t=Pl;Pl=Ed(e.stateNode.containerInfo),Kl(e),Pl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Gl,Gl=16777216,Kl(e),Gl=t):Kl(e))}}function Yl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Ql(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Sl=r,Zl(r,e)}Yl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)$l(e),e=e.sibling}function $l(e){switch(e.tag){case 0:case 11:case 15:Ql(e),2048&e.flags&&sl(9,e,e.return);break;case 3:case 12:default:Ql(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Jl(e)):Ql(e)}}function Jl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Sl=r,Zl(r,e)}Yl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:sl(8,t,t.return),Jl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Jl(t));break;default:Jl(t)}e=e.sibling}}function Zl(e,t){for(;null!==Sl;){var n=Sl;switch(n.tag){case 0:case 11:case 15:sl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Da(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Sl=r;else e:for(n=e;null!==Sl;){var a=(r=Sl).sibling,i=r.return;if(Cl(r),r===n){Sl=null;break e}if(null!==a){a.return=i,Sl=a;break e}Sl=i}}}var ec={getCacheForType:function(e){var t=ka(Oa),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},tc="function"===typeof WeakMap?WeakMap:Map,nc=0,rc=null,ac=null,ic=0,oc=0,sc=null,lc=!1,cc=!1,uc=!1,dc=0,hc=0,fc=0,pc=0,mc=0,gc=0,vc=0,yc=null,bc=null,xc=!1,wc=0,Nc=1/0,Sc=null,Ec=null,Cc=0,kc=null,Ac=null,_c=0,jc=0,Ic=null,Tc=null,Oc=0,Pc=null;function Dc(){if(0!==(2&nc)&&0!==ic)return ic&-ic;if(null!==D.T){return 0!==Fa?Fa:ju()}return Ie()}function Rc(){0===gc&&(gc=0===(536870912&ic)||ia?Ne():536870912);var e=as.current;return null!==e&&(e.flags|=32),gc}function Mc(e,t,n){(e!==rc||2!==oc&&9!==oc)&&null===e.cancelPendingCommit||(Wc(e,0),Uc(e,ic,gc,!1)),Ce(e,n),0!==(2&nc)&&e===rc||(e===rc&&(0===(2&nc)&&(pc|=n),4===hc&&Uc(e,ic,gc,!1)),Nu(e))}function Fc(e,t,n){if(0!==(6&nc))throw Error(o(327));for(var r=!n&&0===(124&t)&&0===(t&e.expiredLanes)||xe(e,t),a=r?function(e,t){var n=nc;nc|=2;var r=Hc(),a=Gc();rc!==e||ic!==t?(Sc=null,Nc=te()+500,Wc(e,t)):cc=xe(e,t);e:for(;;)try{if(0!==oc&&null!==ac){t=ac;var i=sc;t:switch(oc){case 1:oc=0,sc=null,Zc(e,t,i,1);break;case 2:case 9:if(Ya(i)){oc=0,sc=null,Jc(t);break}t=function(){2!==oc&&9!==oc||rc!==e||(oc=7),Nu(e)},i.then(t,t);break e;case 3:oc=7;break e;case 4:oc=5;break e;case 7:Ya(i)?(oc=0,sc=null,Jc(t)):(oc=0,sc=null,Zc(e,t,i,7));break;case 5:var s=null;switch(ac.tag){case 26:s=ac.memoizedState;case 5:case 27:var l=ac;if(!s||zd(s)){oc=0,sc=null;var c=l.sibling;if(null!==c)ac=c;else{var u=l.return;null!==u?(ac=u,eu(u)):ac=null}break t}}oc=0,sc=null,Zc(e,t,i,5);break;case 6:oc=0,sc=null,Zc(e,t,i,6);break;case 8:Vc(),hc=6;break e;default:throw Error(o(462))}}Qc();break}catch(d){qc(e,d)}return ya=va=null,D.H=r,D.A=a,nc=n,null!==ac?0:(rc=null,ic=0,_r(),hc)}(e,t):Xc(e,t,!0),i=r;;){if(0===a){cc&&!r&&Uc(e,t,0,!1);break}if(n=e.current.alternate,!i||Bc(n)){if(2===a){if(i=t,e.errorRecoveryDisabledLanes&i)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var l=e;a=yc;var c=l.current.memoizedState.isDehydrated;if(c&&(Wc(l,s).flags|=256),2!==(s=Xc(l,s,!1))){if(uc&&!c){l.errorRecoveryDisabledLanes|=i,pc|=i,a=4;break e}i=bc,bc=a,null!==i&&(null===bc?bc=i:bc.push.apply(bc,i))}a=s}if(i=!1,2!==a)continue}}if(1===a){Wc(e,0),Uc(e,t,0,!0);break}e:{switch(r=e,i=a){case 0:case 1:throw Error(o(345));case 4:if((4194048&t)!==t)break;case 6:Uc(r,t,gc,!lc);break e;case 2:bc=null;break;case 3:case 5:break;default:throw Error(o(329))}if((62914560&t)===t&&10<(a=wc+300-te())){if(Uc(r,t,gc,!lc),0!==be(r,0,!0))break e;r.timeoutHandle=ld(Lc.bind(null,r,n,bc,Sc,xc,t,gc,pc,vc,lc,i,2,-0,0),a)}else Lc(r,n,bc,Sc,xc,t,gc,pc,vc,lc,i,0,-0,0)}break}a=Xc(e,t,!1),i=!1}Nu(e)}function Lc(e,t,n,r,a,i,s,l,c,u,d,h,f,p){if(e.timeoutHandle=-1,(8192&(h=t.subtreeFlags)||16785408===(16785408&h))&&(Vd={stylesheets:null,count:0,unsuspend:Wd},Xl(t),null!==(h=function(){if(null===Vd)throw Error(o(475));var e=Vd;return e.stylesheets&&0===e.count&&Gd(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Gd(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=h(nu.bind(null,e,t,i,n,r,a,s,l,c,d,1,f,p)),void Uc(e,i,s,!u);nu(e,t,i,n,r,a,s,l,c)}function Bc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!Yn(i(),a))return!1}catch(o){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Uc(e,t,n,r){t&=~mc,t&=~pc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var a=t;0<a;){var i=31-fe(a),o=1<<i;r[i]=-1,a&=~o}0!==n&&ke(e,n,t)}function zc(){return 0!==(6&nc)||(Su(0,!1),!1)}function Vc(){if(null!==ac){if(0===oc)var e=ac.return;else ya=va=null,Fi(e=ac),Yo=null,Qo=0,e=ac;for(;null!==e;)il(e.alternate,e),e=e.return;ac=null}}function Wc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,cd(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Vc(),rc=e,ac=n=Lr(e.current,null),ic=t,oc=0,sc=null,lc=!1,cc=xe(e,t),uc=!1,vc=gc=mc=pc=fc=hc=0,bc=yc=null,xc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var a=31-fe(r),i=1<<a;t|=e[a],r&=~i}return dc=t,_r(),n}function qc(e,t){bi=null,D.H=Ho,t===Ha||t===Ka?(t=Za(),oc=3):t===Ga?(t=Za(),oc=4):oc=t===ks?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,sc=t,null===ac&&(hc=1,ws(e,Er(t,e.current)))}function Hc(){var e=D.H;return D.H=Ho,null===e?Ho:e}function Gc(){var e=D.A;return D.A=ec,e}function Kc(){hc=4,lc||(4194048&ic)!==ic&&null!==as.current||(cc=!0),0===(134217727&fc)&&0===(134217727&pc)||null===rc||Uc(rc,ic,gc,!1)}function Xc(e,t,n){var r=nc;nc|=2;var a=Hc(),i=Gc();rc===e&&ic===t||(Sc=null,Wc(e,t)),t=!1;var o=hc;e:for(;;)try{if(0!==oc&&null!==ac){var s=ac,l=sc;switch(oc){case 8:Vc(),o=6;break e;case 3:case 2:case 9:case 6:null===as.current&&(t=!0);var c=oc;if(oc=0,sc=null,Zc(e,s,l,c),n&&cc){o=0;break e}break;default:c=oc,oc=0,sc=null,Zc(e,s,l,c)}}Yc(),o=hc;break}catch(u){qc(e,u)}return t&&e.shellSuspendCounter++,ya=va=null,nc=r,D.H=a,D.A=i,null===ac&&(rc=null,ic=0,_r()),o}function Yc(){for(;null!==ac;)$c(ac)}function Qc(){for(;null!==ac&&!Z();)$c(ac)}function $c(e){var t=$s(e.alternate,e,dc);e.memoizedProps=e.pendingProps,null===t?eu(e):ac=t}function Jc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Ms(n,t,t.pendingProps,t.type,void 0,ic);break;case 11:t=Ms(n,t,t.pendingProps,t.type.render,t.ref,ic);break;case 5:Fi(t);default:il(n,t),t=$s(n,t=ac=Br(t,dc),dc)}e.memoizedProps=e.pendingProps,null===t?eu(e):ac=t}function Zc(e,t,n,r){ya=va=null,Fi(t),Yo=null,Qo=0;var a=t.return;try{if(function(e,t,n,r,a){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Sa(t,n,a,!0),null!==(n=as.current)){switch(n.tag){case 13:return null===is?Kc():null===n.alternate&&0===hc&&(hc=3),n.flags&=-257,n.flags|=65536,n.lanes=a,r===Xa?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),du(e,r,a)),!1;case 22:return n.flags|=65536,r===Xa?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),du(e,r,a)),!1}throw Error(o(435,n.tag))}return du(e,r,a),Kc(),!1}if(ia)return null!==(t=as.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=a,r!==la&&ma(Er(e=Error(o(422),{cause:r}),n))):(r!==la&&ma(Er(t=Error(o(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,a&=-a,e.lanes|=a,r=Er(r,n),si(e,a=Ss(e.stateNode,r,a)),4!==hc&&(hc=2)),!1;var i=Error(o(520),{cause:r});if(i=Er(i,n),null===yc?yc=[i]:yc.push(i),4!==hc&&(hc=2),null===t)return!0;r=Er(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=a&-a,n.lanes|=e,si(n,e=Ss(n.stateNode,r,e)),!1;case 1:if(t=n.type,i=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==i&&"function"===typeof i.componentDidCatch&&(null===Ec||!Ec.has(i))))return n.flags|=65536,a&=-a,n.lanes|=a,Cs(a=Es(a),e,n,r),si(n,a),!1}n=n.return}while(null!==n);return!1}(e,a,t,n,ic))return hc=1,ws(e,Er(n,e.current)),void(ac=null)}catch(i){if(null!==a)throw ac=a,i;return hc=1,ws(e,Er(n,e.current)),void(ac=null)}32768&t.flags?(ia||1===r?e=!0:cc||0!==(536870912&ic)?e=!1:(lc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=as.current)&&13===r.tag&&(r.flags|=16384))),tu(t,e)):eu(t)}function eu(e){var t=e;do{if(0!==(32768&t.flags))return void tu(t,lc);e=t.return;var n=rl(t.alternate,t,dc);if(null!==n)return void(ac=n);if(null!==(t=t.sibling))return void(ac=t);ac=t=e}while(null!==t);0===hc&&(hc=5)}function tu(e,t){do{var n=al(e.alternate,e);if(null!==n)return n.flags&=32767,void(ac=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(ac=e);ac=e=n}while(null!==e);hc=6,ac=null}function nu(e,t,n,r,a,i,s,l,c){e.cancelPendingCommit=null;do{su()}while(0!==Cc);if(0!==(6&nc))throw Error(o(327));if(null!==t){if(t===e.current)throw Error(o(177));if(i=t.lanes|t.childLanes,function(e,t,n,r,a,i){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var u=31-fe(n),d=1<<u;s[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var f=h[u];null!==f&&(f.lane&=-536870913)}n&=~d}0!==r&&ke(e,r,0),0!==i&&0===a&&0!==e.tag&&(e.suspendedLanes|=i&~(o&~t))}(e,n,i|=Ar,s,l,c),e===rc&&(ac=rc=null,ic=0),Ac=t,kc=e,_c=n,jc=i,Ic=a,Tc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,$(ie,function(){return lu(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=D.T,D.T=null,a=R.p,R.p=2,s=nc,nc|=4;try{!function(e,t){if(e=e.containerInfo,td=nh,tr(e=er(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(g){n=null;break e}var s=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==a&&3!==h.nodeType||(l=s+a),h!==i||0!==r&&3!==h.nodeType||(c=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===a&&(l=s),f===i&&++d===r&&(c=s),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nd={focusedElem:e,selectionRange:n},nh=!1,Sl=t;null!==Sl;)if(e=(t=Sl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,Sl=e;else for(;null!==Sl;){switch(i=(t=Sl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==i){e=void 0,n=t,a=i.memoizedProps,i=i.memoizedState,r=n.stateNode;try{var m=gs(n.type,a,(n.elementType,n.type));e=r.getSnapshotBeforeUpdate(m,i),r.__reactInternalSnapshotBeforeUpdate=e}catch(v){uu(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))md(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":md(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(o(163))}if(null!==(e=t.sibling)){e.return=t.return,Sl=e;break}Sl=t.return}}(e,t)}finally{nc=s,R.p=a,D.T=r}}Cc=1,ru(),au(),iu()}}function ru(){if(1===Cc){Cc=0;var e=kc,t=Ac,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=D.T,D.T=null;var r=R.p;R.p=2;var a=nc;nc|=4;try{Dl(t,e);var i=nd,o=er(e.containerInfo),s=i.focusedElem,l=i.selectionRange;if(o!==s&&s&&s.ownerDocument&&Zn(s.ownerDocument.documentElement,s)){if(null!==l&&tr(s)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in s)s.selectionStart=c,s.selectionEnd=Math.min(u,s.value.length);else{var d=s.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var f=h.getSelection(),p=s.textContent.length,m=Math.min(l.start,p),g=void 0===l.end?m:Math.min(l.end,p);!f.extend&&m>g&&(o=g,g=m,m=o);var v=Jn(s,m),y=Jn(s,g);if(v&&y&&(1!==f.rangeCount||f.anchorNode!==v.node||f.anchorOffset!==v.offset||f.focusNode!==y.node||f.focusOffset!==y.offset)){var b=d.createRange();b.setStart(v.node,v.offset),f.removeAllRanges(),m>g?(f.addRange(b),f.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),f.addRange(b))}}}}for(d=[],f=s;f=f.parentNode;)1===f.nodeType&&d.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<d.length;s++){var x=d[s];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}nh=!!td,nd=td=null}finally{nc=a,R.p=r,D.T=n}}e.current=t,Cc=2}}function au(){if(2===Cc){Cc=0;var e=kc,t=Ac,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=D.T,D.T=null;var r=R.p;R.p=2;var a=nc;nc|=4;try{El(e,t.alternate,t)}finally{nc=a,R.p=r,D.T=n}}Cc=3}}function iu(){if(4===Cc||3===Cc){Cc=0,ee();var e=kc,t=Ac,n=_c,r=Tc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Cc=5:(Cc=0,Ac=kc=null,ou(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(Ec=null),je(n),t=t.stateNode,de&&"function"===typeof de.onCommitFiberRoot)try{de.onCommitFiberRoot(ue,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=D.T,a=R.p,R.p=2,D.T=null;try{for(var i=e.onRecoverableError,o=0;o<r.length;o++){var s=r[o];i(s.value,{componentStack:s.stack})}}finally{D.T=t,R.p=a}}0!==(3&_c)&&su(),Nu(e),a=e.pendingLanes,0!==(4194090&n)&&0!==(42&a)?e===Pc?Oc++:(Oc=0,Pc=e):Oc=0,Su(0,!1)}}function ou(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Da(t)))}function su(e){return ru(),au(),iu(),lu()}function lu(){if(5!==Cc)return!1;var e=kc,t=jc;jc=0;var n=je(_c),r=D.T,a=R.p;try{R.p=32>n?32:n,D.T=null,n=Ic,Ic=null;var i=kc,s=_c;if(Cc=0,Ac=kc=null,_c=0,0!==(6&nc))throw Error(o(331));var l=nc;if(nc|=4,$l(i.current),Wl(i,i.current,s,n),nc=l,Su(0,!1),de&&"function"===typeof de.onPostCommitFiberRoot)try{de.onPostCommitFiberRoot(ue,i)}catch(c){}return!0}finally{R.p=a,D.T=r,ou(e,t)}}function cu(e,t,n){t=Er(n,t),null!==(e=ii(e,t=Ss(e.stateNode,t,2),2))&&(Ce(e,2),Nu(e))}function uu(e,t,n){if(3===e.tag)cu(e,e,n);else for(;null!==t;){if(3===t.tag){cu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ec||!Ec.has(r))){e=Er(n,e),null!==(r=ii(t,n=Es(2),2))&&(Cs(n,r,t,e),Ce(r,2),Nu(r));break}}t=t.return}}function du(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new tc;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(uc=!0,a.add(n),e=hu.bind(null,e,t,n),t.then(e,e))}function hu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,rc===e&&(ic&n)===n&&(4===hc||3===hc&&(62914560&ic)===ic&&300>te()-wc?0===(2&nc)&&Wc(e,0):mc|=n,vc===ic&&(vc=0)),Nu(e)}function fu(e,t){0===t&&(t=Se()),null!==(e=Tr(e,t))&&(Ce(e,t),Nu(e))}function pu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),fu(e,n)}function mu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(o(314))}null!==r&&r.delete(t),fu(e,n)}var gu=null,vu=null,yu=!1,bu=!1,xu=!1,wu=0;function Nu(e){e!==vu&&null===e.next&&(null===vu?gu=vu=e:vu=vu.next=e),bu=!0,yu||(yu=!0,dd(function(){0!==(6&nc)?$(re,Eu):Cu()}))}function Su(e,t){if(!xu&&bu){xu=!0;do{for(var n=!1,r=gu;null!==r;){if(!t)if(0!==e){var a=r.pendingLanes;if(0===a)var i=0;else{var o=r.suspendedLanes,s=r.pingedLanes;i=(1<<31-fe(42|e)+1)-1,i=201326741&(i&=a&~(o&~s))?201326741&i|1:i?2|i:0}0!==i&&(n=!0,_u(r,i))}else i=ic,0===(3&(i=be(r,r===rc?i:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||xe(r,i)||(n=!0,_u(r,i));r=r.next}}while(n);xu=!1}}function Eu(){Cu()}function Cu(){bu=yu=!1;var e=0;0!==wu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==sd&&(sd=e,!0);return sd=null,!1}()&&(e=wu),wu=0);for(var t=te(),n=null,r=gu;null!==r;){var a=r.next,i=ku(r,t);0===i?(r.next=null,null===n?gu=a:n.next=a,null===a&&(vu=n)):(n=r,(0!==e||0!==(3&i))&&(bu=!0)),r=a}Su(e,!1)}function ku(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var o=31-fe(i),s=1<<o,l=a[o];-1===l?0!==(s&n)&&0===(s&r)||(a[o]=we(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}if(n=ic,n=be(e,e===(t=rc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===oc||9===oc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&J(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||xe(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&J(r),je(n)){case 2:case 8:n=ae;break;case 32:default:n=ie;break;case 268435456:n=se}return r=Au.bind(null,e),n=$(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&J(r),e.callbackPriority=2,e.callbackNode=null,2}function Au(e,t){if(0!==Cc&&5!==Cc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(su()&&e.callbackNode!==n)return null;var r=ic;return 0===(r=be(e,e===rc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Fc(e,r,t),ku(e,te()),null!=e.callbackNode&&e.callbackNode===n?Au.bind(null,e):null)}function _u(e,t){if(su())return null;Fc(e,t,!0)}function ju(){return 0===wu&&(wu=Ne()),wu}function Iu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:jt(""+e)}function Tu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Ou=0;Ou<wr.length;Ou++){var Pu=wr[Ou];Nr(Pu.toLowerCase(),"on"+(Pu[0].toUpperCase()+Pu.slice(1)))}Nr(fr,"onAnimationEnd"),Nr(pr,"onAnimationIteration"),Nr(mr,"onAnimationStart"),Nr("dblclick","onDoubleClick"),Nr("focusin","onFocus"),Nr("focusout","onBlur"),Nr(gr,"onTransitionRun"),Nr(vr,"onTransitionStart"),Nr(yr,"onTransitionCancel"),Nr(br,"onTransitionEnd"),Ye("onMouseEnter",["mouseout","mouseover"]),Ye("onMouseLeave",["mouseout","mouseover"]),Ye("onPointerEnter",["pointerout","pointerover"]),Ye("onPointerLeave",["pointerout","pointerover"]),Xe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Xe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Xe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Xe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Xe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Xe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Du="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ru=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Du));function Mu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==i&&a.isPropagationStopped())break e;i=s,a.currentTarget=c;try{i(a)}catch(u){vs(u)}a.currentTarget=null,i=l}else for(o=0;o<r.length;o++){if(l=(s=r[o]).instance,c=s.currentTarget,s=s.listener,l!==i&&a.isPropagationStopped())break e;i=s,a.currentTarget=c;try{i(a)}catch(u){vs(u)}a.currentTarget=null,i=l}}}}function Fu(e,t){var n=t[Re];void 0===n&&(n=t[Re]=new Set);var r=e+"__bubble";n.has(r)||(zu(t,e,2,!1),n.add(r))}function Lu(e,t,n){var r=0;t&&(r|=4),zu(n,e,r,t)}var Bu="_reactListening"+Math.random().toString(36).slice(2);function Uu(e){if(!e[Bu]){e[Bu]=!0,Ge.forEach(function(t){"selectionchange"!==t&&(Ru.has(t)||Lu(t,!1,e),Lu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bu]||(t[Bu]=!0,Lu("selectionchange",!1,t))}}function zu(e,t,n,r){switch(ch(t)){case 2:var a=rh;break;case 8:a=ah;break;default:a=ih}n=a.bind(null,t,n,e),a=void 0,!Bt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Vu(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a)break;if(4===o)for(o=r.return;null!==o;){var c=o.tag;if((3===c||4===c)&&o.stateNode.containerInfo===a)return;o=o.return}for(;null!==s;){if(null===(o=ze(s)))return;if(5===(c=o.tag)||6===c||26===c||27===c){r=i=o;continue e}s=s.parentNode}}r=r.return}Mt(function(){var r=i,a=Tt(n),o=[];e:{var s=xr.get(e);if(void 0!==s){var c=Zt,u=e;switch(e){case"keypress":if(0===Ht(n))break e;case"keydown":case"keyup":c=mn;break;case"focusin":u="focus",c=on;break;case"focusout":u="blur",c=on;break;case"beforeblur":case"afterblur":c=on;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=an;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=vn;break;case fr:case pr:case mr:c=sn;break;case br:c=yn;break;case"scroll":case"scrollend":c=tn;break;case"wheel":c=bn;break;case"copy":case"cut":case"paste":c=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=gn;break;case"toggle":case"beforetoggle":c=xn}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),f=d?null!==s?s+"Capture":null:s;d=[];for(var p,m=r;null!==m;){var g=m;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===f||null!=(g=Ft(m,f))&&d.push(Wu(m,g,p)),h)break;m=m.return}0<d.length&&(s=new c(s,u,null,n,a),o.push({event:s,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===It||!(u=n.relatedTarget||n.fromElement)||!ze(u)&&!u[De])&&(c||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?ze(u):null)&&(h=l(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=r),c!==u)){if(d=rn,g="onMouseLeave",f="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=gn,g="onPointerLeave",f="onPointerEnter",m="pointer"),h=null==c?s:We(c),p=null==u?s:We(u),(s=new d(g,m+"leave",c,n,a)).target=h,s.relatedTarget=p,g=null,ze(a)===r&&((d=new d(f,m+"enter",u,n,a)).target=p,d.relatedTarget=h,g=d),h=g,c&&u)e:{for(f=u,m=0,p=d=c;p;p=Hu(p))m++;for(p=0,g=f;g;g=Hu(g))p++;for(;0<m-p;)d=Hu(d),m--;for(;0<p-m;)f=Hu(f),p--;for(;m--;){if(d===f||null!==f&&d===f.alternate)break e;d=Hu(d),f=Hu(f)}d=null}else d=null;null!==c&&Gu(o,s,c,d,!1),null!==u&&null!==h&&Gu(o,h,u,d,!0)}if("select"===(c=(s=r?We(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var v=Ln;else if(On(s))if(Bn)v=Xn;else{v=Gn;var y=Hn}else!(c=s.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type?r&&kt(r.elementType)&&(v=Ln):v=Kn;switch(v&&(v=v(e,r))?Pn(o,v,n,a):(y&&y(e,s,r),"focusout"===e&&r&&"number"===s.type&&null!=r.memoizedProps.value&&yt(s,"number",s.value)),y=r?We(r):window,e){case"focusin":(On(y)||"true"===y.contentEditable)&&(rr=y,ar=r,ir=null);break;case"focusout":ir=ar=rr=null;break;case"mousedown":or=!0;break;case"contextmenu":case"mouseup":case"dragend":or=!1,sr(o,n,a);break;case"selectionchange":if(nr)break;case"keydown":case"keyup":sr(o,n,a)}var b;if(Nn)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else In?_n(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(Cn&&"ko"!==n.locale&&(In||"onCompositionStart"!==x?"onCompositionEnd"===x&&In&&(b=qt()):(Vt="value"in(zt=a)?zt.value:zt.textContent,In=!0)),0<(y=qu(r,x)).length&&(x=new cn(x,e,null,n,a),o.push({event:x,listeners:y}),b?x.data=b:null!==(b=jn(n))&&(x.data=b))),(b=En?function(e,t){switch(e){case"compositionend":return jn(t);case"keypress":return 32!==t.which?null:(An=!0,kn);case"textInput":return(e=t.data)===kn&&An?null:e;default:return null}}(e,n):function(e,t){if(In)return"compositionend"===e||!Nn&&_n(e,t)?(e=qt(),Wt=Vt=zt=null,In=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Cn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(x=qu(r,"onBeforeInput")).length&&(y=new cn("onBeforeInput","beforeinput",null,n,a),o.push({event:y,listeners:x}),y.data=b)),function(e,t,n,r,a){if("submit"===t&&n&&n.stateNode===a){var i=Iu((a[Pe]||null).action),o=r.submitter;o&&null!==(t=(t=o[Pe]||null)?Iu(t.formAction):o.getAttribute("formAction"))&&(i=t,o=null);var s=new Zt("action","action",null,r,a);e.push({event:s,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==wu){var e=o?Tu(a,o):new FormData(a);To(n,{pending:!0,data:e,method:a.method,action:i},null,e)}}else"function"===typeof i&&(s.preventDefault(),e=o?Tu(a,o):new FormData(a),To(n,{pending:!0,data:e,method:a.method,action:i},i,e))},currentTarget:a}]})}}(o,e,r,n,a)}Mu(o,t)})}function Wu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qu(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===i||(null!=(a=Ft(e,n))&&r.unshift(Wu(e,a,i)),null!=(a=Ft(e,t))&&r.push(Wu(e,a,i))),3===e.tag)return r;e=e.return}return[]}function Hu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Gu(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(s=s.tag,null!==l&&l===r)break;5!==s&&26!==s&&27!==s||null===c||(l=c,a?null!=(c=Ft(n,i))&&o.unshift(Wu(n,c,l)):a||null!=(c=Ft(n,i))&&o.push(Wu(n,c,l))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Ku=/\r\n?/g,Xu=/\u0000|\uFFFD/g;function Yu(e){return("string"===typeof e?e:""+e).replace(Ku,"\n").replace(Xu,"")}function Qu(e,t){return t=Yu(t),Yu(e)===t}function $u(){}function Ju(e,t,n,r,a,i){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||Nt(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&Nt(e,""+r);break;case"className":nt(e,"class",r);break;case"tabIndex":nt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,r);break;case"style":Ct(e,r,i);break;case"data":if("object"!==t){nt(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=jt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof i&&("formAction"===n?("input"!==t&&Ju(e,t,"name",a.name,a,null),Ju(e,t,"formEncType",a.formEncType,a,null),Ju(e,t,"formMethod",a.formMethod,a,null),Ju(e,t,"formTarget",a.formTarget,a,null)):(Ju(e,t,"encType",a.encType,a,null),Ju(e,t,"method",a.method,a,null),Ju(e,t,"target",a.target,a,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=jt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=$u);break;case"onScroll":null!=r&&Fu("scroll",e);break;case"onScrollEnd":null!=r&&Fu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(o(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(o(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=jt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Fu("beforetoggle",e),Fu("toggle",e),tt(e,"popover",r);break;case"xlinkActuate":rt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":rt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":rt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":rt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":rt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":rt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":rt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":rt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":rt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":tt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=At.get(n)||n,r)}}function Zu(e,t,n,r,a,i){switch(n){case"style":Ct(e,r,i);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(o(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(o(60));e.innerHTML=n}}break;case"children":"string"===typeof r?Nt(e,r):("number"===typeof r||"bigint"===typeof r)&&Nt(e,""+r);break;case"onScroll":null!=r&&Fu("scroll",e);break;case"onScrollEnd":null!=r&&Fu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=$u);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ke.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(a=n.endsWith("Capture"),t=n.slice(2,a?n.length-7:void 0),"function"===typeof(i=null!=(i=e[Pe]||null)?i[n]:null)&&e.removeEventListener(t,i,a),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):tt(e,n,r):("function"!==typeof i&&null!==i&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,a)))}}function ed(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fu("error",e),Fu("load",e);var r,a=!1,i=!1;for(r in n)if(n.hasOwnProperty(r)){var s=n[r];if(null!=s)switch(r){case"src":a=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Ju(e,t,r,s,n,null)}}return i&&Ju(e,t,"srcSet",n.srcSet,n,null),void(a&&Ju(e,t,"src",n.src,n,null));case"input":Fu("invalid",e);var l=r=s=i=null,c=null,u=null;for(a in n)if(n.hasOwnProperty(a)){var d=n[a];if(null!=d)switch(a){case"name":i=d;break;case"type":s=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(o(137,t));break;default:Ju(e,t,a,d,n,null)}}return vt(e,r,l,c,u,s,i,!1),void dt(e);case"select":for(i in Fu("invalid",e),a=s=r=null,n)if(n.hasOwnProperty(i)&&null!=(l=n[i]))switch(i){case"value":r=l;break;case"defaultValue":s=l;break;case"multiple":a=l;default:Ju(e,t,i,l,n,null)}return t=r,n=s,e.multiple=!!a,void(null!=t?bt(e,!!a,t,!1):null!=n&&bt(e,!!a,n,!0));case"textarea":for(s in Fu("invalid",e),r=i=a=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":a=l;break;case"defaultValue":i=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(o(91));break;default:Ju(e,t,s,l,n,null)}return wt(e,a,i,r),void dt(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(a=n[c]))if("selected"===c)e.selected=a&&"function"!==typeof a&&"symbol"!==typeof a;else Ju(e,t,c,a,n,null);return;case"dialog":Fu("beforetoggle",e),Fu("toggle",e),Fu("cancel",e),Fu("close",e);break;case"iframe":case"object":Fu("load",e);break;case"video":case"audio":for(a=0;a<Du.length;a++)Fu(Du[a],e);break;case"image":Fu("error",e),Fu("load",e);break;case"details":Fu("toggle",e);break;case"embed":case"source":case"link":Fu("error",e),Fu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(a=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Ju(e,t,u,a,n,null)}return;default:if(kt(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(a=n[d])&&Zu(e,t,d,a,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(a=n[l])&&Ju(e,t,l,a,n,null))}var td=null,nd=null;function rd(e){return 9===e.nodeType?e:e.ownerDocument}function ad(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function id(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function od(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var sd=null;var ld="function"===typeof setTimeout?setTimeout:void 0,cd="function"===typeof clearTimeout?clearTimeout:void 0,ud="function"===typeof Promise?Promise:void 0,dd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ud?function(e){return ud.resolve(null).then(e).catch(hd)}:ld;function hd(e){setTimeout(function(){throw e})}function fd(e){return"head"===e}function pd(e,t){var n=t,r=0,a=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0<r&&8>r){n=r;var o=e.ownerDocument;if(1&n&&wd(o.documentElement),2&n&&wd(o.body),4&n)for(wd(n=o.head),o=n.firstChild;o;){var s=o.nextSibling,l=o.nodeName;o[Be]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===o.rel.toLowerCase()||n.removeChild(o),o=s}}if(0===a)return e.removeChild(i),void Ah(t);a--}else"$"===n||"$?"===n||"$!"===n?a++:r=n.charCodeAt(0)-48;else r=0;n=i}while(n);Ah(t)}function md(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":md(n),Ue(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function gd(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function vd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var yd=null;function bd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function xd(e,t,n){switch(t=rd(n),e){case"html":if(!(e=t.documentElement))throw Error(o(452));return e;case"head":if(!(e=t.head))throw Error(o(453));return e;case"body":if(!(e=t.body))throw Error(o(454));return e;default:throw Error(o(451))}}function wd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ue(e)}var Nd=new Map,Sd=new Set;function Ed(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Cd=R.d;R.d={f:function(){var e=Cd.f(),t=zc();return e||t},r:function(e){var t=Ve(e);null!==t&&5===t.tag&&"form"===t.type?Po(t):Cd.r(e)},D:function(e){Cd.D(e),Ad("dns-prefetch",e,null)},C:function(e,t){Cd.C(e,t),Ad("preconnect",e,t)},L:function(e,t,n){Cd.L(e,t,n);var r=kd;if(r&&e&&t){var a='link[rel="preload"][as="'+mt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+mt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(a+='[imagesizes="'+mt(n.imageSizes)+'"]')):a+='[href="'+mt(e)+'"]';var i=a;switch(t){case"style":i=jd(e);break;case"script":i=Od(e)}Nd.has(i)||(e=h({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Nd.set(i,e),null!==r.querySelector(a)||"style"===t&&r.querySelector(Id(i))||"script"===t&&r.querySelector(Pd(i))||(ed(t=r.createElement("link"),"link",e),He(t),r.head.appendChild(t)))}},m:function(e,t){Cd.m(e,t);var n=kd;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+mt(r)+'"][href="'+mt(e)+'"]',i=a;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Od(e)}if(!Nd.has(i)&&(e=h({rel:"modulepreload",href:e},t),Nd.set(i,e),null===n.querySelector(a))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Pd(i)))return}ed(r=n.createElement("link"),"link",e),He(r),n.head.appendChild(r)}}},X:function(e,t){Cd.X(e,t);var n=kd;if(n&&e){var r=qe(n).hoistableScripts,a=Od(e),i=r.get(a);i||((i=n.querySelector(Pd(a)))||(e=h({src:e,async:!0},t),(t=Nd.get(a))&&Fd(e,t),He(i=n.createElement("script")),ed(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}},S:function(e,t,n){Cd.S(e,t,n);var r=kd;if(r&&e){var a=qe(r).hoistableStyles,i=jd(e);t=t||"default";var o=a.get(i);if(!o){var s={loading:0,preload:null};if(o=r.querySelector(Id(i)))s.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Nd.get(i))&&Md(e,n);var l=o=r.createElement("link");He(l),ed(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){s.loading|=1}),l.addEventListener("error",function(){s.loading|=2}),s.loading|=4,Rd(o,t,r)}o={type:"stylesheet",instance:o,count:1,state:s},a.set(i,o)}}},M:function(e,t){Cd.M(e,t);var n=kd;if(n&&e){var r=qe(n).hoistableScripts,a=Od(e),i=r.get(a);i||((i=n.querySelector(Pd(a)))||(e=h({src:e,async:!0,type:"module"},t),(t=Nd.get(a))&&Fd(e,t),He(i=n.createElement("script")),ed(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}}};var kd="undefined"===typeof document?null:document;function Ad(e,t,n){var r=kd;if(r&&"string"===typeof t&&t){var a=mt(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"===typeof n&&(a+='[crossorigin="'+n+'"]'),Sd.has(a)||(Sd.add(a),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(a)&&(ed(t=r.createElement("link"),"link",e),He(t),r.head.appendChild(t)))}}function _d(e,t,n,r){var a,i,s,l,c=(c=q.current)?Ed(c):null;if(!c)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=jd(n.href),(r=(n=qe(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=jd(n.href);var u=qe(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Id(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Nd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Nd.set(e,n),u||(a=c,i=e,s=n,l=d.state,a.querySelector('link[rel="preload"][as="style"]['+i+"]")?l.loading=1:(i=a.createElement("link"),l.preload=i,i.addEventListener("load",function(){return l.loading|=1}),i.addEventListener("error",function(){return l.loading|=2}),ed(i,"link",s),He(i),a.head.appendChild(i))))),t&&null===r)throw Error(o(528,""));return d}if(t&&null!==r)throw Error(o(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Od(n),(r=(n=qe(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function jd(e){return'href="'+mt(e)+'"'}function Id(e){return'link[rel="stylesheet"]['+e+"]"}function Td(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Od(e){return'[src="'+mt(e)+'"]'}function Pd(e){return"script[async]"+e}function Dd(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+mt(n.href)+'"]');if(r)return t.instance=r,He(r),r;var a=h({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return He(r=(e.ownerDocument||e).createElement("style")),ed(r,"style",a),Rd(r,n.precedence,e),t.instance=r;case"stylesheet":a=jd(n.href);var i=e.querySelector(Id(a));if(i)return t.state.loading|=4,t.instance=i,He(i),i;r=Td(n),(a=Nd.get(a))&&Md(r,a),He(i=(e.ownerDocument||e).createElement("link"));var s=i;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),ed(i,"link",r),t.state.loading|=4,Rd(i,n.precedence,e),t.instance=i;case"script":return i=Od(n.src),(a=e.querySelector(Pd(i)))?(t.instance=a,He(a),a):(r=n,(a=Nd.get(i))&&Fd(r=h({},n),a),He(a=(e=e.ownerDocument||e).createElement("script")),ed(a,"link",r),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(o(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Rd(r,n.precedence,e));return t.instance}function Rd(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=r.length?r[r.length-1]:null,i=a,o=0;o<r.length;o++){var s=r[o];if(s.dataset.precedence===t)i=s;else if(i!==a)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Md(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Fd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Ld=null;function Bd(e,t,n){if(null===Ld){var r=new Map,a=Ld=new Map;a.set(n,r)}else(r=(a=Ld).get(n))||(r=new Map,a.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var i=n[a];if(!(i[Be]||i[Oe]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var o=i.getAttribute(t)||"";o=e+o;var s=r.get(o);s?s.push(i):r.set(o,[i])}}return r}function Ud(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function zd(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var Vd=null;function Wd(){}function qd(){if(this.count--,0===this.count)if(this.stylesheets)Gd(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Hd=null;function Gd(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Hd=new Map,t.forEach(Kd,e),Hd=null,qd.call(e))}function Kd(e,t){if(!(4&t.state.loading)){var n=Hd.get(e);if(n)var r=n.get(null);else{n=new Map,Hd.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<a.length;i++){var o=a[i];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(n.set(o.dataset.precedence,o),r=o)}r&&n.set(null,r)}o=(a=t.instance).getAttribute("data-precedence"),(i=n.get(o)||r)===r&&n.set(null,a),n.set(o,a),this.count++,r=qd.bind(this),a.addEventListener("load",r),a.addEventListener("error",r),i?i.parentNode.insertBefore(a,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var Xd={$$typeof:w,Provider:null,Consumer:null,_currentValue:M,_currentValue2:M,_threadCount:0};function Yd(e,t,n,r,a,i,o,s){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ee(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ee(0),this.hiddenUpdates=Ee(null),this.identifierPrefix=r,this.onUncaughtError=a,this.onCaughtError=i,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=s,this.incompleteTransitions=new Map}function Qd(e,t,n,r,a,i,o,s,l,c,u,d){return e=new Yd(e,t,n,o,s,l,c,d),t=1,!0===i&&(t|=24),i=Mr(3,null,null,t),e.current=i,i.stateNode=e,(t=Pa()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:r,isDehydrated:n,cache:t},ni(i),e}function $d(e){return e?e=Dr:Dr}function Jd(e,t,n,r,a,i){a=$d(a),null===r.context?r.context=a:r.pendingContext=a,(r=ai(t)).payload={element:n},null!==(i=void 0===i?null:i)&&(r.callback=i),null!==(n=ii(e,r,t))&&(Mc(n,0,t),oi(n,e,t))}function Zd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function eh(e,t){Zd(e,t),(e=e.alternate)&&Zd(e,t)}function th(e){if(13===e.tag){var t=Tr(e,67108864);null!==t&&Mc(t,0,67108864),eh(e,67108864)}}var nh=!0;function rh(e,t,n,r){var a=D.T;D.T=null;var i=R.p;try{R.p=2,ih(e,t,n,r)}finally{R.p=i,D.T=a}}function ah(e,t,n,r){var a=D.T;D.T=null;var i=R.p;try{R.p=8,ih(e,t,n,r)}finally{R.p=i,D.T=a}}function ih(e,t,n,r){if(nh){var a=oh(r);if(null===a)Vu(e,t,r,sh,n),yh(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return dh=bh(dh,e,t,n,r,a),!0;case"dragenter":return hh=bh(hh,e,t,n,r,a),!0;case"mouseover":return fh=bh(fh,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return ph.set(i,bh(ph.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,mh.set(i,bh(mh.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(yh(e,r),4&t&&-1<vh.indexOf(e)){for(;null!==a;){var i=Ve(a);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var o=ye(i.pendingLanes);if(0!==o){var s=i;for(s.pendingLanes|=2,s.entangledLanes|=2;o;){var l=1<<31-fe(o);s.entanglements[1]|=l,o&=~l}Nu(i),0===(6&nc)&&(Nc=te()+500,Su(0,!1))}}break;case 13:null!==(s=Tr(i,2))&&Mc(s,0,2),zc(),eh(i,2)}if(null===(i=oh(r))&&Vu(e,t,r,sh,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Vu(e,t,r,null,n)}}function oh(e){return lh(e=Tt(e))}var sh=null;function lh(e){if(sh=null,null!==(e=ze(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return sh=e,null}function ch(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case re:return 2;case ae:return 8;case ie:case oe:return 32;case se:return 268435456;default:return 32}default:return 32}}var uh=!1,dh=null,hh=null,fh=null,ph=new Map,mh=new Map,gh=[],vh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yh(e,t){switch(e){case"focusin":case"focusout":dh=null;break;case"dragenter":case"dragleave":hh=null;break;case"mouseover":case"mouseout":fh=null;break;case"pointerover":case"pointerout":ph.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":mh.delete(t.pointerId)}}function bh(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=Ve(t))&&th(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function xh(e){var t=ze(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void function(e,t){var n=R.p;try{return R.p=e,t()}finally{R.p=n}}(e.priority,function(){if(13===n.tag){var e=Dc();e=_e(e);var t=Tr(n,e);null!==t&&Mc(t,0,e),eh(n,e)}})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function wh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=oh(e.nativeEvent);if(null!==n)return null!==(t=Ve(n))&&th(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);It=r,n.target.dispatchEvent(r),It=null,t.shift()}return!0}function Nh(e,t,n){wh(e)&&n.delete(t)}function Sh(){uh=!1,null!==dh&&wh(dh)&&(dh=null),null!==hh&&wh(hh)&&(hh=null),null!==fh&&wh(fh)&&(fh=null),ph.forEach(Nh),mh.forEach(Nh)}function Eh(e,t){e.blockedOn===t&&(e.blockedOn=null,uh||(uh=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Sh)))}var Ch=null;function kh(e){Ch!==e&&(Ch=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Ch===e&&(Ch=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],a=e[t+2];if("function"!==typeof r){if(null===lh(r||n))continue;break}var i=Ve(n);null!==i&&(e.splice(t,3),t-=3,To(i,{pending:!0,data:a,method:n.method,action:r},r,a))}}))}function Ah(e){function t(t){return Eh(t,e)}null!==dh&&Eh(dh,e),null!==hh&&Eh(hh,e),null!==fh&&Eh(fh,e),ph.forEach(t),mh.forEach(t);for(var n=0;n<gh.length;n++){var r=gh[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<gh.length&&null===(n=gh[0]).blockedOn;)xh(n),null===n.blockedOn&&gh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var a=n[r],i=n[r+1],o=a[Pe]||null;if("function"===typeof i)o||kh(n);else if(o){var s=null;if(i&&i.hasAttribute("formAction")){if(a=i,o=i[Pe]||null)s=o.formAction;else if(null!==lh(a))continue}else s=o.action;"function"===typeof s?n[r+1]=s:(n.splice(r,3),r-=3),kh(n)}}}function _h(e){this._internalRoot=e}function jh(e){this._internalRoot=e}jh.prototype.render=_h.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Jd(t.current,Dc(),e,t,null,null)},jh.prototype.unmount=_h.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Jd(e.current,2,null,e,null,null),zc(),t[De]=null}},jh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ie();e={blockedOn:null,target:e,priority:t};for(var n=0;n<gh.length&&0!==t&&t<gh[n].priority;n++);gh.splice(n,0,e),0===n&&xh(e)}};var Ih=a.version;if("19.1.1"!==Ih)throw Error(o(527,Ih,"19.1.1"));R.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(r=a.return)){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return u(a),e;if(i===r)return u(a),t;i=i.sibling}throw Error(o(188))}if(n.return!==r.return)n=a,r=i;else{for(var s=!1,c=a.child;c;){if(c===n){s=!0,n=a,r=i;break}if(c===r){s=!0,r=a,n=i;break}c=c.sibling}if(!s){for(c=i.child;c;){if(c===n){s=!0,n=i,r=a;break}if(c===r){s=!0,r=i,n=a;break}c=c.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Th={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.1.1"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Oh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oh.isDisabled&&Oh.supportsFiber)try{ue=Oh.inject(Th),de=Oh}catch(Dh){}}t.createRoot=function(e,t){if(!s(e))throw Error(o(299));var n=!1,r="",a=ys,i=bs,l=xs;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(a=t.onUncaughtError),void 0!==t.onCaughtError&&(i=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Qd(e,1,!1,null,0,n,r,a,i,l,0,null),e[De]=t.current,Uu(e),new _h(t)},t.hydrateRoot=function(e,t,n){if(!s(e))throw Error(o(299));var r=!1,a="",i=ys,l=bs,c=xs,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onUncaughtError&&(i=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=Qd(e,1,!0,t,0,r,a,i,l,c,0,u)).context=$d(null),n=t.current,(a=ai(r=_e(r=Dc()))).callback=null,ii(n,a,r),n=r,t.current.lanes=n,Ce(t,n),Nu(t),e[De]=t.current,Uu(e),new jh(t)},t.version="19.1.1"},7029:function(e,t,n){var r;r=function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(e,t,n){"use strict";n.r(t);var r=n("react"),a=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},i.apply(this,arguments)},o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function s(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)}"undefined"!==typeof window&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t?new Promise(function(n,r){t.call(navigator,e,n,r)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}));var l=function(e){function t(t){var n=e.call(this,t)||this;return n.canvas=null,n.ctx=null,n.requestUserMediaId=0,n.unmounted=!1,n.state={hasUserMedia:!1},n}return a(t,e),t.prototype.componentDidMount=function(){var e=this.state,t=this.props;this.unmounted=!1,s()?(e.hasUserMedia||this.requestUserMedia(),t.children&&"function"!=typeof t.children&&console.warn("children must be a function")):t.onUserMediaError("getUserMedia not supported")},t.prototype.componentDidUpdate=function(e){var t=this.props;if(s()){var n=JSON.stringify(e.audioConstraints)!==JSON.stringify(t.audioConstraints),r=JSON.stringify(e.videoConstraints)!==JSON.stringify(t.videoConstraints),a=e.minScreenshotWidth!==t.minScreenshotWidth,i=e.minScreenshotHeight!==t.minScreenshotHeight;(r||a||i)&&(this.canvas=null,this.ctx=null),(n||r)&&(this.stopAndCleanup(),this.requestUserMedia())}else t.onUserMediaError("getUserMedia not supported")},t.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},t.stopMediaStream=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().map(function(t){e.removeTrack(t),t.stop()}),e.getAudioTracks().map(function(t){e.removeTrack(t),t.stop()})):e.stop())},t.prototype.stopAndCleanup=function(){var e=this.state;e.hasUserMedia&&(t.stopMediaStream(this.stream),e.src&&window.URL.revokeObjectURL(e.src))},t.prototype.getScreenshot=function(e){var t=this.state,n=this.props;if(!t.hasUserMedia)return null;var r=this.getCanvas(e);return r&&r.toDataURL(n.screenshotFormat,n.screenshotQuality)},t.prototype.getCanvas=function(e){var t=this.state,n=this.props;if(!this.video)return null;if(!t.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var r=this.video.videoWidth,a=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var i=r/a;a=(r=n.minScreenshotWidth||this.video.clientWidth)/i,n.minScreenshotHeight&&a<n.minScreenshotHeight&&(r=(a=n.minScreenshotHeight)*i)}this.canvas=document.createElement("canvas"),this.canvas.width=(null===e||void 0===e?void 0:e.width)||r,this.canvas.height=(null===e||void 0===e?void 0:e.height)||a,this.ctx=this.canvas.getContext("2d")}var o=this.ctx,s=this.canvas;return o&&s&&(s.width=(null===e||void 0===e?void 0:e.width)||s.width,s.height=(null===e||void 0===e?void 0:e.height)||s.height,n.mirrored&&(o.translate(s.width,0),o.scale(-1,1)),o.imageSmoothingEnabled=n.imageSmoothing,o.drawImage(this.video,0,0,(null===e||void 0===e?void 0:e.width)||s.width,(null===e||void 0===e?void 0:e.height)||s.height),n.mirrored&&(o.scale(-1,1),o.translate(-s.width,0))),s},t.prototype.requestUserMedia=function(){var e=this,n=this.props,r=function(r,a){var i={video:"undefined"===typeof a||a};n.audio&&(i.audio="undefined"===typeof r||r),e.requestUserMediaId++;var o=e.requestUserMediaId;navigator.mediaDevices.getUserMedia(i).then(function(n){e.unmounted||o!==e.requestUserMediaId?t.stopMediaStream(n):e.handleUserMedia(null,n)}).catch(function(t){e.handleUserMedia(t)})};if("mediaDevices"in navigator)r(n.audioConstraints,n.videoConstraints);else{var a=function(e){return{optional:[{sourceId:e}]}},i=function(e){var t=e.deviceId;return"string"===typeof t?t:Array.isArray(t)&&t.length>0?t[0]:"object"===typeof t&&t.ideal?t.ideal:null};MediaStreamTrack.getSources(function(e){var t=null,o=null;e.forEach(function(e){"audio"===e.kind?t=e.id:"video"===e.kind&&(o=e.id)});var s=i(n.audioConstraints);s&&(t=s);var l=i(n.videoConstraints);l&&(o=l),r(a(t),a(o))})}},t.prototype.handleUserMedia=function(e,t){var n=this.props;if(e||!t)return this.setState({hasUserMedia:!1}),void n.onUserMediaError(e);this.stream=t;try{this.video&&(this.video.srcObject=t),this.setState({hasUserMedia:!0})}catch(r){this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}n.onUserMedia(t)},t.prototype.render=function(){var e=this,t=this.state,n=this.props,a=n.audio,s=(n.forceScreenshotSourceSize,n.disablePictureInPicture),l=(n.onUserMedia,n.onUserMediaError,n.screenshotFormat,n.screenshotQuality,n.minScreenshotWidth,n.minScreenshotHeight,n.audioConstraints,n.videoConstraints,n.imageSmoothing,n.mirrored),c=n.style,u=void 0===c?{}:c,d=n.children,h=o(n,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),f=l?i(i({},u),{transform:(u.transform||"")+" scaleX(-1)"}):u,p={getScreenshot:this.getScreenshot.bind(this)};return r.createElement(r.Fragment,null,r.createElement("video",i({autoPlay:!0,disablePictureInPicture:s,src:t.src,muted:!a,playsInline:!0,ref:function(t){e.video=t},style:f},h)),d&&d(p))},t.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},t}(r.Component);t.default=l},react:function(t,n){t.exports=e}}).default},e.exports=r(n(5043))},7043:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2777),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;t.isKey=function(e,t){return!Array.isArray(e)&&(!("number"!==typeof e&&"boolean"!==typeof e&&null!=e&&!r.isSymbol(e))||("string"===typeof e&&(i.test(e)||!a.test(e))||null!=t&&Object.hasOwn(t,e)))}},7104:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},7118:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},7231:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(3799),a=n(4879);t.range=function(e,t,n){n&&"number"!==typeof n&&r.isIterateeCall(e,t,n)&&(t=n=void 0),e=a.toFinite(e),void 0===t?(t=e,e=0):t=a.toFinite(t),n=void 0===n?e<t?1:-1:a.toFinite(n);const i=Math.max(Math.ceil((t-e)/(n||1)),0),o=new Array(i);for(let r=0;r<i;r++)o[r]=e,e+=n;return o}},7237:(e,t,n)=>{"use strict";n(8365)},7260:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isUnsafeProperty=function(e){return"__proto__"===e}},7312:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.flatten=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=[],r=Math.floor(t),a=(e,t)=>{for(let i=0;i<e.length;i++){const o=e[i];Array.isArray(o)&&t<r?a(o,t+1):n.push(o)}};return a(e,0),n}},7318:()=>{},7330:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9323);t.property=function(e){return function(t){return r.get(t,e)}}},7347:e=>{"use strict";var t={single_source_shortest_paths:function(e,n,r){var a={},i={};i[n]=0;var o,s,l,c,u,d,h,f=t.PriorityQueue.make();for(f.push(n,0);!f.empty();)for(l in s=(o=f.pop()).value,c=o.cost,u=e[s]||{})u.hasOwnProperty(l)&&(d=c+u[l],h=i[l],("undefined"===typeof i[l]||h>d)&&(i[l]=d,f.push(l,d),a[l]=s));if("undefined"!==typeof r&&"undefined"===typeof i[r]){var p=["Could not find a path from ",n," to ",r,"."].join("");throw new Error(p)}return a},extract_shortest_path_from_predecessor_list:function(e,t){for(var n=[],r=t;r;)n.push(r),e[r],r=e[r];return n.reverse(),n},find_path:function(e,n,r){var a=t.single_source_shortest_paths(e,n,r);return t.extract_shortest_path_from_predecessor_list(a,r)},PriorityQueue:{make:function(e){var n,r=t.PriorityQueue,a={};for(n in e=e||{},r)r.hasOwnProperty(n)&&(a[n]=r[n]);return a.queue=[],a.sorter=e.sorter||r.default_sorter,a},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){var n={value:e,cost:t};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=t},7365:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},7421:(e,t,n)=>{const r=n(3257),a=n(8511);t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(e,t){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!r.isValid(t))throw new Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]},t.getBestModeForData=function(e){return a.testNumeric(e)?t.NUMERIC:a.testAlphanumeric(e)?t.ALPHANUMERIC:a.testKanji(e)?t.KANJI:t.BYTE},t.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")},t.isValid=function(e){return e&&e.bit&&e.ccBits},t.from=function(e,n){if(t.isValid(e))return e;try{return function(e){if("string"!==typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+e)}}(e)}catch(r){return n}}},7599:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});t.argumentsTag="[object Arguments]",t.arrayBufferTag="[object ArrayBuffer]",t.arrayTag="[object Array]",t.bigInt64ArrayTag="[object BigInt64Array]",t.bigUint64ArrayTag="[object BigUint64Array]",t.booleanTag="[object Boolean]",t.dataViewTag="[object DataView]",t.dateTag="[object Date]",t.errorTag="[object Error]",t.float32ArrayTag="[object Float32Array]",t.float64ArrayTag="[object Float64Array]",t.functionTag="[object Function]",t.int16ArrayTag="[object Int16Array]",t.int32ArrayTag="[object Int32Array]",t.int8ArrayTag="[object Int8Array]",t.mapTag="[object Map]",t.numberTag="[object Number]",t.objectTag="[object Object]",t.regexpTag="[object RegExp]",t.setTag="[object Set]",t.stringTag="[object String]",t.symbolTag="[object Symbol]",t.uint16ArrayTag="[object Uint16Array]",t.uint32ArrayTag="[object Uint32Array]",t.uint8ArrayTag="[object Uint8Array]",t.uint8ClampedArrayTag="[object Uint8ClampedArray]"},7736:(e,t,n)=>{var r=n(3738).default,a=n(9045);e.exports=function(e){var t=a(e,"string");return"symbol"==r(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},7770:(e,t,n)=>{e.exports=n(9323).get},7784:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var r=n(9379),a=n(3986),i=n(5043);const o=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const c=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],u=(0,i.forwardRef)((e,t)=>{let{color:n="currentColor",size:o=24,strokeWidth:u=2,absoluteStrokeWidth:d,className:h="",children:f,iconNode:p}=e,m=(0,a.A)(e,c);return(0,i.createElement)("svg",(0,r.A)((0,r.A)((0,r.A)({ref:t},l),{},{width:o,height:o,stroke:n,strokeWidth:d?24*Number(u)/Number(o):u,className:s("lucide",h)},!f&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"}),m),[...p.map(e=>{let[t,n]=e;return(0,i.createElement)(t,n)}),...Array.isArray(f)?f:[f]])}),d=["className"],h=(e,t)=>{const n=(0,i.forwardRef)((n,l)=>{let{className:c}=n,h=(0,a.A)(n,d);return(0,i.createElement)(u,(0,r.A)({ref:l,iconNode:t,className:s("lucide-".concat((f=o(e),f.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(e),c)},h));var f});return n.displayName=o(e),n}},7819:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},7820:(e,t,n)=>{e.exports=n(5414).throttle},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(6672)},7969:(e,t)=>{let n;const r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];t.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return 4*e+17},t.getSymbolTotalCodewords=function(e){return r[e]},t.getBCHDigit=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},t.setToSJISFunction=function(e){if("function"!==typeof e)throw new Error('"toSJISFunc" is not a valid function.');n=e},t.isKanjiModeEnabled=function(){return"undefined"!==typeof n},t.toSJIS=function(e){return n(e)}},8006:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},8082:()=>{},8177:(e,t,n)=>{const r=n(1312);function a(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}a.prototype.initialize=function(e){this.degree=e,this.genPoly=r.generateECPolynomial(this.degree)},a.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const n=r.mod(t,this.genPoly),a=this.degree-n.length;if(a>0){const e=new Uint8Array(this.degree);return e.set(n,a),e}return n},e.exports=a},8210:function(e,t,n){var r;!function(){"use strict";var a,i=1e9,o={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},s=!0,l="[DecimalError] ",c=l+"Invalid argument: ",u=l+"Exponent out of range: ",d=Math.floor,h=Math.pow,f=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,p=1e7,m=9007199254740991,g=d(1286742750677284.5),v={};function y(e,t){var n,r,a,i,o,l,c,u,d=e.constructor,h=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),s?_(t,h):t;if(c=e.d,u=t.d,o=e.e,a=t.e,c=c.slice(),i=o-a){for(i<0?(r=c,i=-i,l=u.length):(r=u,a=o,l=c.length),i>(l=(o=Math.ceil(h/7))>l?o+1:l+1)&&(i=l,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for((l=c.length)-(i=u.length)<0&&(i=l,r=u,u=c,c=r),n=0;i;)n=(c[--i]=c[i]+u[i]+n)/p|0,c[i]%=p;for(n&&(c.unshift(n),++a),l=c.length;0==c[--l];)c.pop();return t.d=c,t.e=a,s?_(t,h):t}function b(e,t,n){if(e!==~~e||e<t||e>n)throw Error(c+e)}function x(e){var t,n,r,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)(n=7-(r=e[t]+"").length)&&(i+=C(n)),i+=r;(n=7-(r=(o=e[t])+"").length)&&(i+=C(n))}else if(0===o)return"0";for(;o%10===0;)o/=10;return i+o}v.absoluteValue=v.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},v.comparedTo=v.cmp=function(e){var t,n,r,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(t=0,n=(r=i.d.length)<(a=e.d.length)?r:a;t<n;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return r===a?0:r>a^i.s<0?1:-1},v.decimalPlaces=v.dp=function(){var e=this,t=e.d.length-1,n=7*(t-e.e);if(t=e.d[t])for(;t%10==0;t/=10)n--;return n<0?0:n},v.dividedBy=v.div=function(e){return w(this,new this.constructor(e))},v.dividedToIntegerBy=v.idiv=function(e){var t=this.constructor;return _(w(this,new t(e),0,1),t.precision)},v.equals=v.eq=function(e){return!this.cmp(e)},v.exponent=function(){return S(this)},v.greaterThan=v.gt=function(e){return this.cmp(e)>0},v.greaterThanOrEqualTo=v.gte=function(e){return this.cmp(e)>=0},v.isInteger=v.isint=function(){return this.e>this.d.length-2},v.isNegative=v.isneg=function(){return this.s<0},v.isPositive=v.ispos=function(){return this.s>0},v.isZero=function(){return 0===this.s},v.lessThan=v.lt=function(e){return this.cmp(e)<0},v.lessThanOrEqualTo=v.lte=function(e){return this.cmp(e)<1},v.logarithm=v.log=function(e){var t,n=this,r=n.constructor,i=r.precision,o=i+5;if(void 0===e)e=new r(10);else if((e=new r(e)).s<1||e.eq(a))throw Error(l+"NaN");if(n.s<1)throw Error(l+(n.s?"NaN":"-Infinity"));return n.eq(a)?new r(0):(s=!1,t=w(k(n,o),k(e,o),o),s=!0,_(t,i))},v.minus=v.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?j(t,e):y(t,(e.s=-e.s,e))},v.modulo=v.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(!(e=new r(e)).s)throw Error(l+"NaN");return n.s?(s=!1,t=w(n,e,0,1).times(e),s=!0,n.minus(t)):_(new r(n),a)},v.naturalExponential=v.exp=function(){return N(this)},v.naturalLogarithm=v.ln=function(){return k(this)},v.negated=v.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},v.plus=v.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?y(t,e):j(t,(e.s=-e.s,e))},v.precision=v.sd=function(e){var t,n,r,a=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(c+e);if(t=S(a)+1,n=7*(r=a.d.length-1)+1,r=a.d[r]){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},v.squareRoot=v.sqrt=function(){var e,t,n,r,a,i,o,c=this,u=c.constructor;if(c.s<1){if(!c.s)return new u(0);throw Error(l+"NaN")}for(e=S(c),s=!1,0==(a=Math.sqrt(+c))||a==1/0?(((t=x(c.d)).length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=d((e+1)/2)-(e<0||e%2),r=new u(t=a==1/0?"5e"+e:(t=a.toExponential()).slice(0,t.indexOf("e")+1)+e)):r=new u(a.toString()),a=o=(n=u.precision)+3;;)if(r=(i=r).plus(w(c,i,o+2)).times(.5),x(i.d).slice(0,o)===(t=x(r.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&"4999"==t){if(_(i,n+1,0),i.times(i).eq(c)){r=i;break}}else if("9999"!=t)break;o+=4}return s=!0,_(r,n)},v.times=v.mul=function(e){var t,n,r,a,i,o,l,c,u,d=this,h=d.constructor,f=d.d,m=(e=new h(e)).d;if(!d.s||!e.s)return new h(0);for(e.s*=d.s,n=d.e+e.e,(c=f.length)<(u=m.length)&&(i=f,f=m,m=i,o=c,c=u,u=o),i=[],r=o=c+u;r--;)i.push(0);for(r=u;--r>=0;){for(t=0,a=c+r;a>r;)l=i[a]+m[r]*f[a-r-1]+t,i[a--]=l%p|0,t=l/p|0;i[a]=(i[a]+t)%p|0}for(;!i[--o];)i.pop();return t?++n:i.shift(),e.d=i,e.e=n,s?_(e,h.precision):e},v.toDecimalPlaces=v.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(b(e,0,i),void 0===t?t=r.rounding:b(t,0,8),_(n,e+S(n)+1,t))},v.toExponential=function(e,t){var n,r=this,a=r.constructor;return void 0===e?n=I(r,!0):(b(e,0,i),void 0===t?t=a.rounding:b(t,0,8),n=I(r=_(new a(r),e+1,t),!0,e+1)),n},v.toFixed=function(e,t){var n,r,a=this,o=a.constructor;return void 0===e?I(a):(b(e,0,i),void 0===t?t=o.rounding:b(t,0,8),n=I((r=_(new o(a),e+S(a)+1,t)).abs(),!1,e+S(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)},v.toInteger=v.toint=function(){var e=this,t=e.constructor;return _(new t(e),S(e)+1,t.rounding)},v.toNumber=function(){return+this},v.toPower=v.pow=function(e){var t,n,r,i,o,c,u=this,h=u.constructor,f=+(e=new h(e));if(!e.s)return new h(a);if(!(u=new h(u)).s){if(e.s<1)throw Error(l+"Infinity");return u}if(u.eq(a))return u;if(r=h.precision,e.eq(a))return _(u,r);if(c=(t=e.e)>=(n=e.d.length-1),o=u.s,c){if((n=f<0?-f:f)<=m){for(i=new h(a),t=Math.ceil(r/7+4),s=!1;n%2&&T((i=i.times(u)).d,t),0!==(n=d(n/2));)T((u=u.times(u)).d,t);return s=!0,e.s<0?new h(a).div(i):_(i,r)}}else if(o<0)throw Error(l+"NaN");return o=o<0&&1&e.d[Math.max(t,n)]?-1:1,u.s=1,s=!1,i=e.times(k(u,r+12)),s=!0,(i=N(i)).s=o,i},v.toPrecision=function(e,t){var n,r,a=this,o=a.constructor;return void 0===e?r=I(a,(n=S(a))<=o.toExpNeg||n>=o.toExpPos):(b(e,1,i),void 0===t?t=o.rounding:b(t,0,8),r=I(a=_(new o(a),e,t),e<=(n=S(a))||n<=o.toExpNeg,e)),r},v.toSignificantDigits=v.tosd=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(b(e,1,i),void 0===t?t=n.rounding:b(t,0,8)),_(new n(this),e,t)},v.toString=v.valueOf=v.val=v.toJSON=function(){var e=this,t=S(e),n=e.constructor;return I(e,t<=n.toExpNeg||t>=n.toExpPos)};var w=function(){function e(e,t){var n,r=0,a=e.length;for(e=e.slice();a--;)n=e[a]*t+r,e[a]=n%p|0,r=n/p|0;return r&&e.unshift(r),e}function t(e,t,n,r){var a,i;if(n!=r)i=n>r?1:-1;else for(a=i=0;a<n;a++)if(e[a]!=t[a]){i=e[a]>t[a]?1:-1;break}return i}function n(e,t,n){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*p+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,a,i,o){var s,c,u,d,h,f,m,g,v,y,b,x,w,N,E,C,k,A,j=r.constructor,I=r.s==a.s?1:-1,T=r.d,O=a.d;if(!r.s)return new j(r);if(!a.s)throw Error(l+"Division by zero");for(c=r.e-a.e,k=O.length,E=T.length,g=(m=new j(I)).d=[],u=0;O[u]==(T[u]||0);)++u;if(O[u]>(T[u]||0)&&--c,(x=null==i?i=j.precision:o?i+(S(r)-S(a))+1:i)<0)return new j(0);if(x=x/7+2|0,u=0,1==k)for(d=0,O=O[0],x++;(u<E||d)&&x--;u++)w=d*p+(T[u]||0),g[u]=w/O|0,d=w%O|0;else{for((d=p/(O[0]+1)|0)>1&&(O=e(O,d),T=e(T,d),k=O.length,E=T.length),N=k,y=(v=T.slice(0,k)).length;y<k;)v[y++]=0;(A=O.slice()).unshift(0),C=O[0],O[1]>=p/2&&++C;do{d=0,(s=t(O,v,k,y))<0?(b=v[0],k!=y&&(b=b*p+(v[1]||0)),(d=b/C|0)>1?(d>=p&&(d=p-1),1==(s=t(h=e(O,d),v,f=h.length,y=v.length))&&(d--,n(h,k<f?A:O,f))):(0==d&&(s=d=1),h=O.slice()),(f=h.length)<y&&h.unshift(0),n(v,h,y),-1==s&&(s=t(O,v,k,y=v.length))<1&&(d++,n(v,k<y?A:O,y)),y=v.length):0===s&&(d++,v=[0]),g[u++]=d,s&&v[0]?v[y++]=T[N]||0:(v=[T[N]],y=1)}while((N++<E||void 0!==v[0])&&x--)}return g[0]||g.shift(),m.e=c,_(m,o?i+S(m)+1:i)}}();function N(e,t){var n,r,i,o,l,c=0,d=0,f=e.constructor,p=f.precision;if(S(e)>16)throw Error(u+S(e));if(!e.s)return new f(a);for(null==t?(s=!1,l=p):l=t,o=new f(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(l+=Math.log(h(2,d))/Math.LN10*2+5|0,n=r=i=new f(a),f.precision=l;;){if(r=_(r.times(e),l),n=n.times(++c),x((o=i.plus(w(r,n,l))).d).slice(0,l)===x(i.d).slice(0,l)){for(;d--;)i=_(i.times(i),l);return f.precision=p,null==t?(s=!0,_(i,p)):i}i=o}}function S(e){for(var t=7*e.e,n=e.d[0];n>=10;n/=10)t++;return t}function E(e,t,n){if(t>e.LN10.sd())throw s=!0,n&&(e.precision=n),Error(l+"LN10 precision limit exceeded");return _(new e(e.LN10),t)}function C(e){for(var t="";e--;)t+="0";return t}function k(e,t){var n,r,i,o,c,u,d,h,f,p=1,m=e,g=m.d,v=m.constructor,y=v.precision;if(m.s<1)throw Error(l+(m.s?"NaN":"-Infinity"));if(m.eq(a))return new v(0);if(null==t?(s=!1,h=y):h=t,m.eq(10))return null==t&&(s=!0),E(v,h);if(h+=10,v.precision=h,r=(n=x(g)).charAt(0),o=S(m),!(Math.abs(o)<15e14))return d=E(v,h+2,y).times(o+""),m=k(new v(r+"."+n.slice(1)),h-10).plus(d),v.precision=y,null==t?(s=!0,_(m,y)):m;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=x((m=m.times(e)).d)).charAt(0),p++;for(o=S(m),r>1?(m=new v("0."+n),o++):m=new v(r+"."+n.slice(1)),u=c=m=w(m.minus(a),m.plus(a),h),f=_(m.times(m),h),i=3;;){if(c=_(c.times(f),h),x((d=u.plus(w(c,new v(i),h))).d).slice(0,h)===x(u.d).slice(0,h))return u=u.times(2),0!==o&&(u=u.plus(E(v,h+2,y).times(o+""))),u=w(u,new v(p),h),v.precision=y,null==t?(s=!0,_(u,y)):u;u=d,i+=2}}function A(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);)++r;for(a=t.length;48===t.charCodeAt(a-1);)--a;if(t=t.slice(r,a)){if(a-=r,n=n-r-1,e.e=d(n/7),e.d=[],r=(n+1)%7,n<0&&(r+=7),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=7;r<a;)e.d.push(+t.slice(r,r+=7));r=7-(t=t.slice(r)).length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),s&&(e.e>g||e.e<-g))throw Error(u+n)}else e.s=0,e.e=0,e.d=[0];return e}function _(e,t,n){var r,a,i,o,l,c,f,m,v=e.d;for(o=1,i=v[0];i>=10;i/=10)o++;if((r=t-o)<0)r+=7,a=t,f=v[m=0];else{if((m=Math.ceil((r+1)/7))>=(i=v.length))return e;for(f=i=v[m],o=1;i>=10;i/=10)o++;a=(r%=7)-7+o}if(void 0!==n&&(l=f/(i=h(10,o-a-1))%10|0,c=t<0||void 0!==v[m+1]||f%i,c=n<4?(l||c)&&(0==n||n==(e.s<0?3:2)):l>5||5==l&&(4==n||c||6==n&&(r>0?a>0?f/h(10,o-a):0:v[m-1])%10&1||n==(e.s<0?8:7))),t<1||!v[0])return c?(i=S(e),v.length=1,t=t-i-1,v[0]=h(10,(7-t%7)%7),e.e=d(-t/7)||0):(v.length=1,v[0]=e.e=e.s=0),e;if(0==r?(v.length=m,i=1,m--):(v.length=m+1,i=h(10,7-r),v[m]=a>0?(f/h(10,o-a)%h(10,a)|0)*i:0),c)for(;;){if(0==m){(v[0]+=i)==p&&(v[0]=1,++e.e);break}if(v[m]+=i,v[m]!=p)break;v[m--]=0,i=1}for(r=v.length;0===v[--r];)v.pop();if(s&&(e.e>g||e.e<-g))throw Error(u+S(e));return e}function j(e,t){var n,r,a,i,o,l,c,u,d,h,f=e.constructor,m=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),s?_(t,m):t;if(c=e.d,h=t.d,r=t.e,u=e.e,c=c.slice(),o=u-r){for((d=o<0)?(n=c,o=-o,l=h.length):(n=h,r=u,l=c.length),o>(a=Math.max(Math.ceil(m/7),l)+2)&&(o=a,n.length=1),n.reverse(),a=o;a--;)n.push(0);n.reverse()}else{for((d=(a=c.length)<(l=h.length))&&(l=a),a=0;a<l;a++)if(c[a]!=h[a]){d=c[a]<h[a];break}o=0}for(d&&(n=c,c=h,h=n,t.s=-t.s),l=c.length,a=h.length-l;a>0;--a)c[l++]=0;for(a=h.length;a>o;){if(c[--a]<h[a]){for(i=a;i&&0===c[--i];)c[i]=p-1;--c[i],c[a]+=p}c[a]-=h[a]}for(;0===c[--l];)c.pop();for(;0===c[0];c.shift())--r;return c[0]?(t.d=c,t.e=r,s?_(t,m):t):new f(0)}function I(e,t,n){var r,a=S(e),i=x(e.d),o=i.length;return t?(n&&(r=n-o)>0?i=i.charAt(0)+"."+i.slice(1)+C(r):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+C(-a-1)+i,n&&(r=n-o)>0&&(i+=C(r))):a>=o?(i+=C(a+1-o),n&&(r=n-a-1)>0&&(i=i+"."+C(r))):((r=a+1)<o&&(i=i.slice(0,r)+"."+i.slice(r)),n&&(r=n-o)>0&&(a+1===o&&(i+="."),i+=C(r))),e.s<0?"-"+i:i}function T(e,t){if(e.length>t)return e.length=t,!0}function O(e){if(!e||"object"!==typeof e)throw Error(l+"Object expected");var t,n,r,a=["precision",1,i,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if(void 0!==(r=e[n=a[t]])){if(!(d(r)===r&&r>=a[t+1]&&r<=a[t+2]))throw Error(c+n+": "+r);this[n]=r}if(void 0!==(r=e[n="LN10"])){if(r!=Math.LN10)throw Error(c+n+": "+r);this[n]=new this(r)}return this}o=function e(t){var n,r,a;function i(e){var t=this;if(!(t instanceof i))return new i(e);if(t.constructor=i,e instanceof i)return t.s=e.s,t.e=e.e,void(t.d=(e=e.d)?e.slice():e);if("number"===typeof e){if(0*e!==0)throw Error(c+e);if(e>0)t.s=1;else{if(!(e<0))return t.s=0,t.e=0,void(t.d=[0]);e=-e,t.s=-1}return e===~~e&&e<1e7?(t.e=0,void(t.d=[e])):A(t,e.toString())}if("string"!==typeof e)throw Error(c+e);if(45===e.charCodeAt(0)?(e=e.slice(1),t.s=-1):t.s=1,!f.test(e))throw Error(c+e);A(t,e)}if(i.prototype=v,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=e,i.config=i.set=O,void 0===t&&(t={}),t)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<a.length;)t.hasOwnProperty(r=a[n++])||(t[r]=this[r]);return i.config(t),i}(o),o.default=o.Decimal=o,a=new o(1),void 0===(r=function(){return o}.call(t,n,t,e))||(e.exports=r)}()},8211:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>E});var r=n(9379),a=n(5043),i=n(5469),o=n(1360),s=n(9292);const l=(0,n(7784).A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var c=n(5686),u=n(2313),d=n(1884),h=n(7365),f=n(7118),p=n(614),m=n(2626),g=n(4596),v=n(9855),y=n(8006),b=n(6210),x=n(5352),w=n(5016),N=n(1994),S=n(579);const E=()=>{var e,t;const{userData:n}=(0,w.A)(),E=(0,x.Zp)(),[C,k]=(0,a.useState)([]),[A,_]=(0,a.useState)([]),[j,I]=(0,a.useState)(null),[T,O]=(0,a.useState)("subjects"),[P,D]=(0,a.useState)(!1),[R,M]=(0,a.useState)(!1),[F,L]=(0,a.useState)(!1),[B,U]=(0,a.useState)(null),[z,V]=(0,a.useState)(""),[W,q]=(0,a.useState)({name:"",description:"",academicYear:"2024-25",semester:""}),[H,G]=(0,a.useState)({name:"",code:"",credits:"",location:{name:"",address:"",latitude:"",longitude:""}});(0,a.useEffect)(()=>{K(),X()},[n]);const K=async()=>{if(null!==n&&void 0!==n&&n.uid){D(!0);try{console.log("Loading classrooms for teacher:",n.uid);const e=await(0,N.fA)(n.uid);console.log("Classrooms loaded:",e),e.success?(k(e.classrooms),console.log("Classrooms set in state:",e.classrooms)):console.error("Failed to load classrooms:",e.error)}catch(e){console.error("Error loading classrooms:",e)}D(!1)}},X=async()=>{if(null!==n&&void 0!==n&&n.uid)try{console.log("Loading join requests for teacher:",n.uid);const e=await(0,N.uC)(n.uid);console.log("Join requests result:",e),e.success?(_(e.requests),console.log("Join requests set in state:",e.requests)):console.error("Failed to load join requests:",e.error)}catch(e){console.error("Error loading join requests:",e)}},Y=e=>{const t=A.filter(t=>t.classroomId===e);return console.log("Join requests for classroom ".concat(e,":"),t),t},Q=e=>{e?(navigator.clipboard.writeText(e),alert("Classroom code copied to clipboard!")):alert("Classroom code not available")},$=C.filter(e=>e.name.toLowerCase().includes(z.toLowerCase())||e.description.toLowerCase().includes(z.toLowerCase()));return(0,S.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 p-4 sm:p-6 safe-area-top safe-area-bottom",children:[(0,S.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl sm:rounded-3xl p-4 sm:p-6 shadow-xl border border-white/50 mb-4 sm:mb-6",children:(0,S.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,S.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,S.jsxs)("button",{onClick:()=>E("/teacher"),className:"text-blue-600 hover:text-blue-800 mb-2 flex items-center gap-2 transition-colors text-sm sm:text-base touch-manipulation",children:[(0,S.jsx)(i.A,{className:"w-4 h-4"}),(0,S.jsx)("span",{children:"Back to Dashboard"})]}),(0,S.jsx)("h1",{className:"text-xl sm:text-3xl font-bold text-gray-800 truncate",children:"Classroom Management"}),(0,S.jsx)("p",{className:"text-sm sm:text-base text-gray-600",children:"Create and manage your classrooms, subjects, and students"})]}),(0,S.jsxs)("button",{onClick:()=>M(!0),className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-4 sm:px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 transform hover:scale-105 flex items-center gap-2 text-sm sm:text-base min-h-12 touch-manipulation w-full sm:w-auto justify-center",children:[(0,S.jsx)(o.A,{className:"w-4 h-4 sm:w-5 sm:h-5"}),(0,S.jsx)("span",{children:"Create Classroom"})]})]})}),(0,S.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,S.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl sm:rounded-3xl p-4 sm:p-6 shadow-xl border border-white/50",children:(0,S.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[(0,S.jsxs)("div",{className:"flex-1 relative",children:[(0,S.jsx)(s.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),(0,S.jsx)("input",{type:"text",placeholder:"Search classrooms...",value:z,onChange:e=>V(e.target.value),className:"w-full pl-9 sm:pl-10 pr-4 py-3 bg-white/50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base min-h-12"})]}),(0,S.jsxs)("button",{className:"px-6 py-3 bg-white/50 border border-gray-200 rounded-xl hover:bg-white/70 transition-colors flex items-center gap-2",children:[(0,S.jsx)(l,{className:"w-5 h-5"}),"Filter"]})]})}),(0,S.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50",children:[(0,S.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"My Classrooms"}),(0,S.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:$.map(e=>{var t;const n=Y(e.id);return(0,S.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50 hover:shadow-2xl transition-all duration-300",children:[(0,S.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,S.jsxs)("div",{className:"flex-1",children:[(0,S.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:e.name}),(0,S.jsx)("p",{className:"text-gray-600 text-sm mb-3",children:e.description}),(0,S.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,S.jsx)("span",{children:e.academicYear}),(0,S.jsx)("span",{children:"\u2022"}),(0,S.jsxs)("span",{children:["Sem ",e.semester]})]})]}),(0,S.jsx)("button",{className:"text-gray-400 hover:text-gray-600",children:(0,S.jsx)(c.A,{className:"w-5 h-5"})})]}),(0,S.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("span",{className:"text-sm text-gray-600",children:"Students"}),(0,S.jsx)("span",{className:"font-semibold text-blue-600",children:e.studentCount||0})]}),(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("span",{className:"text-sm text-gray-600",children:"Subjects"}),(0,S.jsx)("span",{className:"font-semibold text-green-600",children:(null===(t=e.subjects)||void 0===t?void 0:t.length)||0})]}),(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("span",{className:"text-sm text-gray-600",children:"Classroom Code"}),(0,S.jsxs)("button",{onClick:()=>Q(e.code),className:"flex items-center gap-1 text-purple-600 hover:text-purple-800",children:[(0,S.jsx)("span",{className:"font-mono text-sm",children:e.code||"N/A"}),(0,S.jsx)(u.A,{className:"w-4 h-4"})]})]}),n.length>0&&(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("span",{className:"text-sm text-gray-600",children:"Join Requests"}),(0,S.jsx)("span",{className:"font-semibold text-orange-600",children:n.length})]})]}),(0,S.jsxs)("div",{className:"flex gap-2",children:[(0,S.jsx)("button",{onClick:()=>I(e),className:"flex-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-2 px-4 rounded-xl text-sm font-semibold hover:shadow-lg transition-all duration-300",children:"Manage"}),n.length>0&&(0,S.jsxs)("button",{onClick:()=>I(e),className:"px-4 py-2 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-xl text-sm font-semibold hover:shadow-lg transition-all duration-300 flex items-center gap-1",title:"".concat(n.length," join request").concat(n.length>1?"s":""),children:[(0,S.jsx)(d.A,{className:"w-4 h-4"}),n.length]}),(0,S.jsx)("button",{className:"px-4 py-2 bg-gray-100 text-gray-600 rounded-xl text-sm font-semibold hover:bg-gray-200 transition-colors",children:(0,S.jsx)(h.A,{className:"w-4 h-4"})})]})]},e.id)})}),0===$.length&&(0,S.jsxs)("div",{className:"text-center py-12",children:[(0,S.jsx)(f.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,S.jsx)("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No Classrooms Found"}),(0,S.jsx)("p",{className:"text-gray-500 mb-6",children:"Create your first classroom to get started"}),(0,S.jsx)("button",{onClick:()=>M(!0),className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 transform hover:scale-105",children:"Create Classroom"})]})]})]}),R&&(0,S.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,S.jsxs)("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full shadow-2xl",children:[(0,S.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Create New Classroom"}),(0,S.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),D(!0);try{console.log("Creating classroom with data:",(0,r.A)((0,r.A)({},W),{},{teacherId:n.uid,teacherName:n.name}));const e=await(0,N.ot)((0,r.A)((0,r.A)({},W),{},{teacherId:n.uid,teacherName:n.name}));console.log("Classroom creation result:",e),e.success?(M(!1),q({name:"",description:"",academicYear:"2024-25",semester:""}),alert("Classroom created successfully! Code: ".concat(e.code)),await K()):alert("Error creating classroom: "+e.error)}catch(t){console.error("Error creating classroom:",t),alert("Error creating classroom: "+t.message)}D(!1)},className:"space-y-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Classroom Name *"}),(0,S.jsx)("input",{type:"text",required:!0,value:W.name,onChange:e=>q(t=>(0,r.A)((0,r.A)({},t),{},{name:e.target.value})),className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Computer Science - Year 3"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,S.jsx)("textarea",{value:W.description,onChange:e=>q(t=>(0,r.A)((0,r.A)({},t),{},{description:e.target.value})),className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Brief description of the classroom",rows:3})]}),(0,S.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year"}),(0,S.jsxs)("select",{value:W.academicYear,onChange:e=>q(t=>(0,r.A)((0,r.A)({},t),{},{academicYear:e.target.value})),className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"2024-25",children:"2024-25"}),(0,S.jsx)("option",{value:"2025-26",children:"2025-26"}),(0,S.jsx)("option",{value:"2026-27",children:"2026-27"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Semester"}),(0,S.jsxs)("select",{value:W.semester,onChange:e=>q(t=>(0,r.A)((0,r.A)({},t),{},{semester:e.target.value})),className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,S.jsx)("option",{value:"",children:"Select Semester"}),(0,S.jsx)("option",{value:"1",children:"1st Semester"}),(0,S.jsx)("option",{value:"2",children:"2nd Semester"}),(0,S.jsx)("option",{value:"3",children:"3rd Semester"}),(0,S.jsx)("option",{value:"4",children:"4th Semester"}),(0,S.jsx)("option",{value:"5",children:"5th Semester"}),(0,S.jsx)("option",{value:"6",children:"6th Semester"}),(0,S.jsx)("option",{value:"7",children:"7th Semester"}),(0,S.jsx)("option",{value:"8",children:"8th Semester"})]})]})]}),(0,S.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,S.jsx)("button",{type:"button",onClick:()=>M(!1),className:"flex-1 py-3 px-6 border border-gray-200 rounded-xl text-gray-600 font-semibold hover:bg-gray-50",children:"Cancel"}),(0,S.jsx)("button",{type:"submit",disabled:P,className:"flex-1 py-3 px-6 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all duration-300 disabled:opacity-50",children:P?"Creating...":"Create"})]})]})]})}),j&&(0,S.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,S.jsxs)("div",{className:"bg-white rounded-3xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:j.name}),(0,S.jsx)("p",{className:"text-gray-600",children:j.description})]}),(0,S.jsx)("button",{onClick:()=>I(null),className:"text-gray-400 hover:text-gray-600",children:(0,S.jsx)(p.A,{className:"w-6 h-6"})})]}),(0,S.jsxs)("div",{className:"flex space-x-1 bg-gray-100 rounded-xl p-1 mb-6",children:[(0,S.jsx)("button",{onClick:()=>O("subjects"),className:"flex-1 py-2 px-4 rounded-lg font-semibold transition-all ".concat("subjects"===T?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:"Subjects"}),(0,S.jsx)("button",{onClick:()=>O("students"),className:"flex-1 py-2 px-4 rounded-lg font-semibold transition-all ".concat("students"===T?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:"Students"}),(0,S.jsxs)("button",{onClick:()=>O("requests"),className:"flex-1 py-2 px-4 rounded-lg font-semibold transition-all ".concat("requests"===T?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:["Join Requests (",Y(j.id).length,")"]}),(0,S.jsx)("button",{onClick:()=>O("settings"),className:"flex-1 py-2 px-4 rounded-lg font-semibold transition-all ".concat("settings"===T?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:"Settings"})]}),"subjects"===T&&(0,S.jsxs)("div",{className:"space-y-4",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Subjects"}),(0,S.jsxs)("button",{onClick:()=>L(!0),className:"bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-2 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center gap-2",children:[(0,S.jsx)(o.A,{className:"w-4 h-4"}),"Add Subject"]})]}),0!==(null===(e=j.subjects)||void 0===e?void 0:e.length)&&j.subjects?(0,S.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:j.subjects.map(e=>(0,S.jsxs)("div",{className:"bg-gray-50 rounded-2xl p-4 border border-gray-200",children:[(0,S.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"font-semibold text-gray-800",children:e.name}),(0,S.jsxs)("p",{className:"text-sm text-gray-600",children:["Code: ",e.code]}),(0,S.jsxs)("p",{className:"text-sm text-gray-600",children:["Credits: ",e.credits]})]}),(0,S.jsxs)("div",{className:"flex gap-1",children:[(0,S.jsx)("button",{className:"text-blue-600 hover:text-blue-800",children:(0,S.jsx)(g.A,{className:"w-4 h-4"})}),(0,S.jsx)("button",{className:"text-red-600 hover:text-red-800",children:(0,S.jsx)(v.A,{className:"w-4 h-4"})})]})]}),e.location&&(0,S.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,S.jsx)(y.A,{className:"w-4 h-4"}),(0,S.jsx)("span",{children:e.location.name||e.location.address})]})]},e.id))}):(0,S.jsxs)("div",{className:"text-center py-8",children:[(0,S.jsx)(m.A,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,S.jsx)("p",{className:"text-gray-500",children:"No subjects added yet"})]})]}),"students"===T&&(0,S.jsxs)("div",{className:"space-y-4",children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Students"}),(0,S.jsxs)("div",{className:"space-y-3",children:[null===(t=j.students)||void 0===t?void 0:t.map(e=>(0,S.jsxs)("div",{className:"bg-gray-50 rounded-2xl p-4 border border-gray-200 flex items-center justify-between",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"font-semibold text-gray-800",children:e.name}),(0,S.jsx)("p",{className:"text-sm text-gray-600",children:e.email})]}),(0,S.jsx)("button",{className:"text-red-600 hover:text-red-800",children:(0,S.jsx)(v.A,{className:"w-4 h-4"})})]},e.id)),(!j.students||0===j.students.length)&&(0,S.jsxs)("div",{className:"text-center py-8",children:[(0,S.jsx)(f.A,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,S.jsx)("p",{className:"text-gray-500",children:"No students enrolled yet"})]})]})]}),"requests"===T&&(0,S.jsxs)("div",{className:"space-y-4",children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Join Requests"}),(0,S.jsxs)("div",{className:"space-y-3",children:[Y(j.id).map(e=>{var t,r,a;return(0,S.jsx)("div",{className:"bg-gray-50 rounded-2xl p-4 border border-gray-200",children:(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"font-semibold text-gray-800",children:e.studentName}),(0,S.jsx)("p",{className:"text-sm text-gray-600",children:e.studentEmail}),(0,S.jsxs)("p",{className:"text-xs text-gray-500",children:["Requested: ",(null===(t=e.requestedAt)||void 0===t||null===(r=t.toDate)||void 0===r||null===(a=r.call(t))||void 0===a?void 0:a.toLocaleDateString())||"Recently"]})]}),(0,S.jsxs)("div",{className:"flex items-center gap-2",children:[(0,S.jsxs)("button",{onClick:()=>(async(e,t)=>{try{console.log("UI: Approving request:",e,"for classroom:",t);const r=await(0,N.B5)(e,t);if(console.log("UI: Approve result:",r),r.success){if(console.log("UI: Request approved successfully, updating UI"),await K(),await X(),j&&j.id===t){const e=await(0,N.fA)(n.uid);if(e.success){const n=e.classrooms.find(e=>e.id===t);n&&(I(n),console.log("Updated selected classroom with new student:",n))}}alert("Student request approved and added to classroom!")}else console.error("UI: Failed to approve request:",r.error),alert("Failed to approve request: "+r.error)}catch(r){console.error("UI: Error approving request:",r),alert("Error approving request: "+r.message)}})(e.id,e.classroomId),className:"bg-green-500 text-white px-3 py-1 rounded-lg hover:bg-green-600 transition-colors flex items-center gap-1",children:[(0,S.jsx)(b.A,{className:"w-4 h-4"}),"Approve"]}),(0,S.jsxs)("button",{onClick:()=>(async e=>{try{(await(0,N.JN)(e)).success&&(_(A.filter(t=>t.id!==e)),alert("Student request rejected!"))}catch(t){console.error("Error rejecting request:",t)}})(e.id),className:"bg-red-500 text-white px-3 py-1 rounded-lg hover:bg-red-600 transition-colors flex items-center gap-1",children:[(0,S.jsx)(p.A,{className:"w-4 h-4"}),"Reject"]})]})]})},e.id)}),0===Y(j.id).length&&(0,S.jsxs)("div",{className:"text-center py-8",children:[(0,S.jsx)(d.A,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,S.jsx)("p",{className:"text-gray-500",children:"No join requests"})]})]})]}),"settings"===T&&(0,S.jsxs)("div",{className:"space-y-4",children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Classroom Settings"}),(0,S.jsx)("div",{className:"space-y-4",children:(0,S.jsx)("div",{className:"bg-gray-50 rounded-2xl p-4 border border-gray-200",children:(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("span",{className:"text-sm text-gray-600",children:"Classroom Code"}),(0,S.jsxs)("button",{onClick:()=>Q(j.code),className:"flex items-center gap-1 text-purple-600 hover:text-purple-800",children:[(0,S.jsx)("span",{className:"font-mono text-sm",children:j.code||"N/A"}),(0,S.jsx)(u.A,{className:"w-4 h-4"})]})]})})})]})]})}),F&&(0,S.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,S.jsxs)("div",{className:"bg-white rounded-3xl p-8 max-w-lg w-full shadow-2xl max-h-[90vh] overflow-y-auto",children:[(0,S.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Add New Subject"}),(0,S.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),j){D(!0);try{const e=await(0,N.uo)(j.id,H);if(e.success){const t=C.map(t=>t.id===j.id?(0,r.A)((0,r.A)({},t),{},{subjects:[...t.subjects||[],(0,r.A)({id:e.subjectId},H)]}):t);k(t),I((0,r.A)((0,r.A)({},j),{},{subjects:[...j.subjects||[],(0,r.A)({id:e.subjectId},H)]})),L(!1),G({name:"",code:"",credits:"",location:{name:"",address:"",latitude:"",longitude:""}}),alert("Subject added successfully!")}else alert("Error adding subject: "+e.error)}catch(t){console.error("Error adding subject:",t),alert("Error adding subject")}D(!1)}},className:"space-y-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject Name *"}),(0,S.jsx)("input",{type:"text",required:!0,value:H.name,onChange:e=>G(t=>(0,r.A)((0,r.A)({},t),{},{name:e.target.value})),className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Data Structures"})]}),(0,S.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject Code *"}),(0,S.jsx)("input",{type:"text",required:!0,value:H.code,onChange:e=>G(t=>(0,r.A)((0,r.A)({},t),{},{code:e.target.value})),className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., CS301"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Credits"}),(0,S.jsx)("input",{type:"number",value:H.credits,onChange:e=>G(t=>(0,r.A)((0,r.A)({},t),{},{credits:e.target.value})),className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"3"})]})]}),(0,S.jsxs)("div",{className:"border-t pt-4",children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Location Details"}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location Name"}),(0,S.jsx)("input",{type:"text",value:H.location.name,onChange:e=>G(t=>(0,r.A)((0,r.A)({},t),{},{location:(0,r.A)((0,r.A)({},t.location),{},{name:e.target.value})})),className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Room 101, Computer Lab"})]}),(0,S.jsxs)("div",{className:"mt-4",children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),(0,S.jsx)("input",{type:"text",value:H.location.address,onChange:e=>G(t=>(0,r.A)((0,r.A)({},t),{},{location:(0,r.A)((0,r.A)({},t.location),{},{address:e.target.value})})),className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Full address"})]}),(0,S.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Latitude"}),(0,S.jsx)("input",{type:"number",step:"any",value:H.location.latitude,onChange:e=>G(t=>(0,r.A)((0,r.A)({},t),{},{location:(0,r.A)((0,r.A)({},t.location),{},{latitude:e.target.value})})),className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.000000"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longitude"}),(0,S.jsx)("input",{type:"number",step:"any",value:H.location.longitude,onChange:e=>G(t=>(0,r.A)((0,r.A)({},t),{},{location:(0,r.A)((0,r.A)({},t.location),{},{longitude:e.target.value})})),className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.000000"})]})]}),(0,S.jsxs)("button",{type:"button",onClick:()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{G(t=>(0,r.A)((0,r.A)({},t),{},{location:(0,r.A)((0,r.A)({},t.location),{},{latitude:e.coords.latitude.toString(),longitude:e.coords.longitude.toString()})}))},e=>{console.error("Error getting location:",e),alert("Could not get current location. Please enter coordinates manually.")}):alert("Geolocation is not supported by this browser.")},className:"mt-3 w-full py-2 px-4 bg-blue-100 text-blue-600 rounded-xl font-semibold hover:bg-blue-200 transition-colors flex items-center justify-center gap-2",children:[(0,S.jsx)(y.A,{className:"w-4 h-4"}),"Use Current Location"]})]}),(0,S.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,S.jsx)("button",{type:"button",onClick:()=>L(!1),className:"flex-1 py-3 px-6 border border-gray-200 rounded-xl text-gray-600 font-semibold hover:bg-gray-50",children:"Cancel"}),(0,S.jsx)("button",{type:"submit",disabled:P,className:"flex-1 py-3 px-6 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all duration-300 disabled:opacity-50",children:P?"Adding...":"Add Subject"})]})]})]})})]})}},8268:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2132);t.isMatch=function(e,t){return r.isMatchWith(e,t,()=>{})}},8293:(e,t)=>{function n(e){if("number"===typeof e&&(e=e.toString()),"string"!==typeof e)throw new Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+e);3!==t.length&&4!==t.length||(t=Array.prototype.concat.apply([],t.map(function(e){return[e,e]}))),6===t.length&&t.push("F","F");const n=parseInt(t.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:255&n,hex:"#"+t.slice(0,6).join("")}}t.getOptions=function(e){e||(e={}),e.color||(e.color={});const t="undefined"===typeof e.margin||null===e.margin||e.margin<0?4:e.margin,r=e.width&&e.width>=21?e.width:void 0,a=e.scale||4;return{width:r,scale:r?4:a,margin:t,color:{dark:n(e.color.dark||"#000000ff"),light:n(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},t.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},t.getImageWidth=function(e,n){const r=t.getScale(e,n);return Math.floor((e+2*n.margin)*r)},t.qrToImageData=function(e,n,r){const a=n.modules.size,i=n.modules.data,o=t.getScale(a,r),s=Math.floor((a+2*r.margin)*o),l=r.margin*o,c=[r.color.light,r.color.dark];for(let t=0;t<s;t++)for(let n=0;n<s;n++){let u=4*(t*s+n),d=r.color.light;if(t>=l&&n>=l&&t<s-l&&n<s-l){d=c[i[Math.floor((t-l)/o)*a+Math.floor((n-l)/o)]?1:0]}e[u++]=d.r,e[u++]=d.g,e[u++]=d.b,e[u]=d.a}}},8346:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toArray=function(e){return Array.isArray(e)?e:Array.from(e)}},8365:(e,t,n)=>{"use strict";var r=n(5043);var a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=r.useSyncExternalStore,o=r.useRef,s=r.useEffect,l=r.useMemo,c=r.useDebugValue},8396:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(5508);t.cloneDeep=function(e){return r.cloneDeepWith(e)}},8420:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isLength=function(e){return Number.isSafeInteger(e)&&e>=0}},8443:(e,t,n)=>{"use strict";e.exports=n(9717)},8499:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,o){if("function"!==typeof r)throw new TypeError("The listener must be a function");var s=new a(r,i||e,o),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function o(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,a=[];if(0===this._eventsCount)return a;for(r in e=this._events)t.call(e,r)&&a.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var a=0,i=r.length,o=new Array(i);a<i;a++)o[a]=r[a].fn;return o},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,a,i,o){var s=n?n+e:e;if(!this._events[s])return!1;var l,c,u=this._events[s],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,a),!0;case 5:return u.fn.call(u.context,t,r,a,i),!0;case 6:return u.fn.call(u.context,t,r,a,i,o),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,r);break;case 4:u[c].fn.call(u[c].context,t,r,a);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},s.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,a){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return o(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||a&&!s.once||r&&s.context!==r||o(this,i);else{for(var l=0,c=[],u=s.length;l<u;l++)(s[l].fn!==t||a&&!s[l].once||r&&s[l].context!==r)&&c.push(s[l]);c.length?this._events[i]=1===c.length?c[0]:c:o(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},8511:(e,t)=>{const n="[0-9]+";let r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";r=r.replace(/u/g,"\\u");const a="(?:(?![A-Z0-9 $%*+\\-./:]|"+r+")(?:.|[\r\n]))+";t.KANJI=new RegExp(r,"g"),t.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),t.BYTE=new RegExp(a,"g"),t.NUMERIC=new RegExp(n,"g"),t.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const i=new RegExp("^"+r+"$"),o=new RegExp("^"+n+"$"),s=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");t.testKanji=function(e){return i.test(e)},t.testNumeric=function(e){return o.test(e)},t.testAlphanumeric=function(e){return s.test(e)}},8646:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},8697:(e,t,n)=>{const r=n(7421);function a(e){this.mode=r.BYTE,this.data="string"===typeof e?(new TextEncoder).encode(e):new Uint8Array(e)}a.getBitsLength=function(e){return 8*e},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){for(let t=0,n=this.data.length;t<n;t++)e.put(this.data[t],8)},e.exports=a},8717:(e,t,n)=>{"use strict";n.d(t,{SC:()=>p,TM:()=>m,bL:()=>f,hN:()=>d,p8:()=>g});var r=n(9379),a=n(5043),i=n(7819),o=n(2054),s=n(9855),l=n(254),c=n(614),u=n(579);const d=()=>{const[e,t]=(0,a.useState)([]),n=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;const i=Date.now()+Math.random(),o={id:i,message:e,type:n,duration:a};return t(e=>[...e,o]),a>0&&setTimeout(()=>{r(i)},a),i},r=e=>{t(t=>t.filter(t=>t.id!==e))};return{notifications:e,success:(e,t)=>n(e,"success",t),error:(e,t)=>n(e,"error",t),info:(e,t)=>n(e,"info",t),warning:(e,t)=>n(e,"warning",t),removeNotification:r}},h=e=>{let{notification:t,onRemove:n}=e;const{id:r,message:a,type:s}=t;return(0,u.jsx)("div",{className:"\n      ".concat((()=>{switch(s){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";default:return"bg-blue-50 border-blue-200 text-blue-800"}})(),"\n      border rounded-lg p-4 shadow-lg backdrop-blur-sm\n      transform transition-all duration-300 ease-in-out\n      animate-slide-in-right\n    "),children:(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{className:"flex items-center gap-3",children:[(0,u.jsx)("div",{className:(()=>{switch(s){case"success":return"text-green-600";case"error":return"text-red-600";case"warning":return"text-yellow-600";default:return"text-blue-600"}})(),children:"success"===s?(0,u.jsx)(o.A,{className:"w-5 h-5"}):(0,u.jsx)(i.A,{className:"w-5 h-5"})}),(0,u.jsx)("p",{className:"font-medium",children:a})]}),(0,u.jsx)("button",{onClick:()=>n(r),className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,u.jsx)(c.A,{className:"w-4 h-4"})})]})})},f=e=>{let{notifications:t,onRemove:n}=e;return t&&0!==t.length?(0,u.jsx)("div",{className:"fixed top-4 right-4 z-[9999] space-y-2",children:t.map(e=>(0,u.jsx)(h,{notification:e,onRemove:n},e.id))}):null},p=()=>{const[e,t]=(0,a.useState)({isOpen:!1,title:"",message:"",confirmText:"Confirm",cancelText:"Cancel",type:"danger",onConfirm:null,onCancel:null});return{confirmState:e,confirm:e=>{let{title:n="Confirm Action",message:a="Are you sure you want to continue?",confirmText:i="Confirm",cancelText:o="Cancel",type:s="danger",onConfirm:l=()=>{},onCancel:c=()=>{}}=e;return new Promise(e=>{t({isOpen:!0,title:n,message:a,confirmText:i,cancelText:o,type:s,onConfirm:()=>{l(),e(!0),t(e=>(0,r.A)((0,r.A)({},e),{},{isOpen:!1}))},onCancel:()=>{c(),e(!1),t(e=>(0,r.A)((0,r.A)({},e),{},{isOpen:!1}))}})})},close:()=>{t(e=>(0,r.A)((0,r.A)({},e),{},{isOpen:!1}))}}},m=e=>{let{confirmState:t,onClose:n}=e;const{isOpen:r,title:a,message:c,confirmText:d,cancelText:h,type:f,onConfirm:p,onCancel:m}=t;if(!r)return null;return(0,u.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10000] p-4",children:(0,u.jsxs)("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 shadow-2xl transform transition-all duration-300 scale-100 animate-fade-in",children:[(0,u.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,u.jsx)("div",{className:"flex-shrink-0",children:(()=>{switch(f){case"danger":return(0,u.jsx)(s.A,{className:"w-8 h-8 text-red-600"});case"success":return(0,u.jsx)(o.A,{className:"w-8 h-8 text-green-600"});case"warning":return(0,u.jsx)(i.A,{className:"w-8 h-8 text-yellow-600"});default:return(0,u.jsx)(l.A,{className:"w-8 h-8 text-blue-600"})}})()}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:a}),(0,u.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:c})]})]}),(0,u.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,u.jsx)("button",{onClick:m,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500",children:h}),(0,u.jsx)("button",{onClick:p,className:"px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors focus:outline-none focus:ring-2 ".concat((()=>{switch(f){case"danger":return"bg-red-600 hover:bg-red-700 focus:ring-red-500";case"success":return"bg-green-600 hover:bg-green-700 focus:ring-green-500";case"warning":return"bg-yellow-600 hover:bg-yellow-700 focus:ring-yellow-500";default:return"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}})()),children:d})]})]})})},g=e=>{let{isVisible:t,message:n="Processing..."}=e;return t?(0,u.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10000]",children:(0,u.jsx)("div",{className:"bg-white rounded-2xl p-8 shadow-2xl max-w-sm w-full mx-4",children:(0,u.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,u.jsx)("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mb-4"}),(0,u.jsx)("p",{className:"text-gray-700 font-medium",children:n})]})})}):null}},8777:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var r=n(5043);class a{constructor(e,t,n,r,i){this._legacyCanvasSize=a.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=e,this.$canvas=document.createElement("canvas"),n&&"object"===typeof n?this._onDecode=t:(n||r||i?console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future"):console.warn("Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=t),t="object"===typeof n?n:{},this._onDecodeError=t.onDecodeError||("function"===typeof n?n:this._onDecodeError),this._calculateScanRegion=t.calculateScanRegion||("function"===typeof r?r:this._calculateScanRegion),this._preferredCamera=t.preferredCamera||i||this._preferredCamera,this._legacyCanvasSize="number"===typeof n?n:"number"===typeof r?r:this._legacyCanvasSize,this._maxScansPerSecond=t.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),e.disablePictureInPicture=!0,e.playsInline=!0,e.muted=!0;let o=!1;if(e.hidden&&(e.hidden=!1,o=!0),document.body.contains(e)||(document.body.appendChild(e),o=!0),n=e.parentElement,t.highlightScanRegion||t.highlightCodeOutline){if(r=!!t.overlay,this.$overlay=t.overlay||document.createElement("div"),(i=this.$overlay.style).position="absolute",i.display="none",i.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!r&&t.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch(s){}n.insertBefore(this.$overlay,this.$video.nextSibling)}t.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(e),requestAnimationFrame(()=>{let t=window.getComputedStyle(e);"none"===t.display&&(e.style.setProperty("display","block","important"),o=!0),"visible"!==t.visibility&&(e.style.setProperty("visibility","visible","important"),o=!0),o&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),e.style.opacity="0",e.style.width="0",e.style.height="0",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),delete this.$overlay,delete this.$codeOutlineHighlight),this.$overlay&&this._updateOverlay()}),e.addEventListener("play",this._onPlay),e.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=a.createQrEngine()}static set WORKER_PATH(e){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}static async hasCamera(){try{return!!(await a.listCameras(!1)).length}catch(e){return!1}}static async listCameras(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!navigator.mediaDevices)return[];let t,n=async()=>(await navigator.mediaDevices.enumerateDevices()).filter(e=>"videoinput"===e.kind);try{e&&(await n()).every(e=>!e.label)&&(t=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch(r){}try{return(await n()).map((e,t)=>({id:e.deviceId,label:e.label||(0===t?"Default Camera":"Camera ".concat(t+1))}))}finally{t&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),a._stopVideoStream(t))}}async hasFlash(){let e;try{if(this.$video.srcObject){if(!(this.$video.srcObject instanceof MediaStream))return!1;e=this.$video.srcObject}else e=(await this._getCameraStream()).stream;return"torch"in e.getVideoTracks()[0].getSettings()}catch(t){return!1}finally{e&&e!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),a._stopVideoStream(e))}}isFlashOn(){return this._flashOn}async toggleFlash(){this._flashOn?await this.turnFlashOff():await this.turnFlashOn()}async turnFlashOn(){if(!this._flashOn&&!this._destroyed&&(this._flashOn=!0,this._active&&!this._paused))try{if(!await this.hasFlash())throw"No flash available";await this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(e){throw this._flashOn=!1,e}}async turnFlashOff(){this._flashOn&&(this._flashOn=!1,await this._restartVideoStream())}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),a._postWorkerMessage(this._qrEnginePromise,"close")}async start(){if(this._destroyed)throw Error("The QR scanner can not be started as it had been destroyed.");if((!this._active||this._paused)&&("https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,!document.hidden))if(this._paused=!1,this.$video.srcObject)await this.$video.play();else try{let{stream:e,facingMode:t}=await this._getCameraStream();!this._active||this._paused?a._stopVideoStream(e):(this._setVideoMirror(t),this.$video.srcObject=e,await this.$video.play(),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{})))}catch(e){if(!this._paused)throw this._active=!1,e}}stop(){this.pause(),this._active=!1}async pause(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._paused=!0,!this._active)return!0;this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none");let t=()=>{this.$video.srcObject instanceof MediaStream&&(a._stopVideoStream(this.$video.srcObject),this.$video.srcObject=null)};return e?(t(),!0):(await new Promise(e=>setTimeout(e,300)),!!this._paused&&(t(),!0))}async setCamera(e){e!==this._preferredCamera&&(this._preferredCamera=e,await this._restartVideoStream())}static async scanImage(e,t,n,r){let i,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=!1;t&&("scanRegion"in t||"qrEngine"in t||"canvas"in t||"disallowCanvasResizing"in t||"alsoTryWithoutScanRegion"in t||"returnDetailedScanResult"in t)?(i=t.scanRegion,n=t.qrEngine,r=t.canvas,o=t.disallowCanvasResizing||!1,s=t.alsoTryWithoutScanRegion||!1,l=!0):t||n||r||o||s?console.warn("You're using a deprecated api for scanImage which will be removed in the future."):console.warn("Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),t=!!n;try{let c,u,d;if([n,c]=await Promise.all([n||a.createQrEngine(),a._loadImage(e)]),[r,u]=a._drawToCanvas(c,i,r,o),n instanceof Worker){let e=n;t||a._postWorkerMessageSync(e,"inversionMode","both"),d=await new Promise((t,n)=>{let o,s,l,c=-1;s=r=>{r.data.id===c&&(e.removeEventListener("message",s),e.removeEventListener("error",l),clearTimeout(o),null!==r.data.data?t({data:r.data.data,cornerPoints:a._convertPoints(r.data.cornerPoints,i)}):n(a.NO_QR_CODE_FOUND))},l=t=>{e.removeEventListener("message",s),e.removeEventListener("error",l),clearTimeout(o),n("Scanner error: "+(t?t.message||t:"Unknown Error"))},e.addEventListener("message",s),e.addEventListener("error",l),o=setTimeout(()=>l("timeout"),1e4);let d=u.getImageData(0,0,r.width,r.height);c=a._postWorkerMessageSync(e,"decode",d,[d.data.buffer])})}else d=await Promise.race([new Promise((e,t)=>window.setTimeout(()=>t("Scanner error: timeout"),1e4)),(async()=>{try{var[t]=await n.detect(r);if(!t)throw a.NO_QR_CODE_FOUND;return{data:t.rawValue,cornerPoints:a._convertPoints(t.cornerPoints,i)}}catch(l){if(t=l.message||l,/not implemented|service unavailable/.test(t))return a._disableBarcodeDetector=!0,a.scanImage(e,{scanRegion:i,canvas:r,disallowCanvasResizing:o,alsoTryWithoutScanRegion:s});throw"Scanner error: ".concat(t)}})()]);return l?d:d.data}catch(c){if(!i||!s)throw c;let t=await a.scanImage(e,{qrEngine:n,canvas:r,disallowCanvasResizing:o});return l?t:t.data}finally{t||a._postWorkerMessage(n,"close")}}setGrayscaleWeights(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];a._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:e,green:t,blue:n,useIntegerApproximation:r})}setInversionMode(e){a._postWorkerMessage(this._qrEnginePromise,"inversionMode",e)}static async createQrEngine(e){if(e&&console.warn("Specifying a worker path is not required and not supported anymore."),e=()=>n.e(451).then(n.bind(n,9451)).then(e=>e.createWorker()),a._disableBarcodeDetector||!("BarcodeDetector"in window)||!BarcodeDetector.getSupportedFormats||!(await BarcodeDetector.getSupportedFormats()).includes("qr_code"))return e();let t=navigator.userAgentData;return t&&t.brands.some(e=>{let{brand:t}=e;return/Chromium/i.test(t)})&&/mac ?OS/i.test(t.platform)&&await t.getHighEntropyValues(["architecture","platformVersion"]).then(e=>{let{architecture:t,platformVersion:n}=e;return/arm/i.test(t||"arm")&&13<=parseInt(n||"13")}).catch(()=>!0)?e():new BarcodeDetector({formats:["qr_code"]})}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(e){let t=Math.round(2/3*Math.min(e.videoWidth,e.videoHeight));return{x:Math.round((e.videoWidth-t)/2),y:Math.round((e.videoHeight-t)/2),width:t,height:t,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var e=this.$video,t=e.videoWidth,n=e.videoHeight,r=e.offsetWidth,a=e.offsetHeight,i=e.offsetLeft,o=e.offsetTop,s=window.getComputedStyle(e),l=s.objectFit,c=t/n,u=r/a;switch(l){case"none":var d=t,h=n;break;case"fill":d=r,h=a;break;default:("cover"===l?c>u:c<u)?d=(h=a)*c:h=(d=r)/c,"scale-down"===l&&(d=Math.min(d,t),h=Math.min(h,n))}var[f,p]=s.objectPosition.split(" ").map((e,t)=>{const n=parseFloat(e);return e.endsWith("%")?(t?a-h:r-d)*n/100:n});s=this._scanRegion.width||t,u=this._scanRegion.height||n,l=this._scanRegion.x||0;var m=this._scanRegion.y||0;(c=this.$overlay.style).width="".concat(s/t*d,"px"),c.height="".concat(u/n*h,"px"),c.top="".concat(o+p+m/n*h,"px"),n=/scaleX\(-1\)/.test(e.style.transform),c.left="".concat(i+(n?r-f-d:f)+(n?t-l-s:l)/t*d,"px"),c.transform=e.style.transform}})}static _convertPoints(e,t){if(!t)return e;let n=t.x||0,r=t.y||0,a=t.width&&t.downScaledWidth?t.width/t.downScaledWidth:1;t=t.height&&t.downScaledHeight?t.height/t.downScaledHeight:1;for(let i of e)i.x=i.x*a+n,i.y=i.y*t+r;return e}_scanFrame(){!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(async()=>{if(!(1>=this.$video.readyState)){var e=Date.now()-this._lastScanTimestamp,t=1e3/this._maxScansPerSecond;e<t&&await new Promise(n=>setTimeout(n,t-e)),this._lastScanTimestamp=Date.now();try{var n=await a.scanImage(this.$video,{scanRegion:this._scanRegion,qrEngine:this._qrEnginePromise,canvas:this.$canvas})}catch(r){if(!this._active)return;this._onDecodeError(r)}!a._disableBarcodeDetector||await this._qrEnginePromise instanceof Worker||(this._qrEnginePromise=a.createQrEngine()),n?(this._onDecode?this._onDecode(n):this._legacyOnDecode&&this._legacyOnDecode(n.data),this.$codeOutlineHighlight&&(clearTimeout(this._codeOutlineHighlightRemovalTimeout),this._codeOutlineHighlightRemovalTimeout=void 0,this.$codeOutlineHighlight.setAttribute("viewBox","".concat(this._scanRegion.x||0," ")+"".concat(this._scanRegion.y||0," ")+"".concat(this._scanRegion.width||this.$video.videoWidth," ")+"".concat(this._scanRegion.height||this.$video.videoHeight)),this.$codeOutlineHighlight.firstElementChild.setAttribute("points",n.cornerPoints.map(e=>{let{x:t,y:n}=e;return"".concat(t,",").concat(n)}).join(" ")),this.$codeOutlineHighlight.style.display="")):this.$codeOutlineHighlight&&!this._codeOutlineHighlightRemovalTimeout&&(this._codeOutlineHighlightRemovalTimeout=setTimeout(()=>this.$codeOutlineHighlight.style.display="none",100))}this._scanFrame()})}_onDecodeError(e){e!==a.NO_QR_CODE_FOUND&&console.log(e)}async _getCameraStream(){if(!navigator.mediaDevices)throw"Camera not found.";let e=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",t=[{width:{min:1024}},{width:{min:768}},{}],n=t.map(t=>Object.assign({},t,{[e]:{exact:this._preferredCamera}}));for(let a of[...n,...t])try{let e=await navigator.mediaDevices.getUserMedia({video:a,audio:!1});return{stream:e,facingMode:this._getFacingMode(e)||(a.facingMode?this._preferredCamera:"environment"===this._preferredCamera?"user":"environment")}}catch(r){}throw"Camera not found."}async _restartVideoStream(){let e=this._paused;await this.pause(!0)&&!e&&this._active&&await this.start()}static _stopVideoStream(e){for(let t of e.getTracks())t.stop(),e.removeTrack(t)}_setVideoMirror(e){this.$video.style.transform="scaleX("+("user"===e?-1:1)+")"}_getFacingMode(e){return(e=e.getVideoTracks()[0])?/rear|back|environment/i.test(e.label)?"environment":/front|user|face/i.test(e.label)?"user":null:null}static _drawToCanvas(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n=n||document.createElement("canvas");let a=t&&t.x?t.x:0,i=t&&t.y?t.y:0,o=t&&t.width?t.width:e.videoWidth||e.width,s=t&&t.height?t.height:e.videoHeight||e.height;return r||(r=t&&t.downScaledWidth?t.downScaledWidth:o,t=t&&t.downScaledHeight?t.downScaledHeight:s,n.width!==r&&(n.width=r),n.height!==t&&(n.height=t)),(t=n.getContext("2d",{alpha:!1})).imageSmoothingEnabled=!1,t.drawImage(e,a,i,o,s,0,0,n.width,n.height),[n,t]}static async _loadImage(e){if(e instanceof Image)return await a._awaitImageLoad(e),e;if(e instanceof HTMLVideoElement||e instanceof HTMLCanvasElement||e instanceof SVGImageElement||"OffscreenCanvas"in window&&e instanceof OffscreenCanvas||"ImageBitmap"in window&&e instanceof ImageBitmap)return e;if(!(e instanceof File||e instanceof Blob||e instanceof URL||"string"===typeof e))throw"Unsupported image type.";{let t=new Image;t.src=e instanceof File||e instanceof Blob?URL.createObjectURL(e):e.toString();try{return await a._awaitImageLoad(t),t}finally{(e instanceof File||e instanceof Blob)&&URL.revokeObjectURL(t.src)}}}static async _awaitImageLoad(e){e.complete&&0!==e.naturalWidth||await new Promise((t,n)=>{let r=a=>{e.removeEventListener("load",r),e.removeEventListener("error",r),a instanceof ErrorEvent?n("Image load error"):t()};e.addEventListener("load",r),e.addEventListener("error",r)})}static async _postWorkerMessage(e,t,n,r){return a._postWorkerMessageSync(await e,t,n,r)}static _postWorkerMessageSync(e,t,n,r){if(!(e instanceof Worker))return-1;let i=a._workerMessageId++;return e.postMessage({id:i,type:t,data:n},r),i}}a.DEFAULT_CANVAS_SIZE=400,a.NO_QR_CODE_FOUND="No QR code found",a._disableBarcodeDetector=!1,a._workerMessageId=0;const i=a;var o=n(817),s=n(614),l=n(7819),c=n(247),u=n(2054),d=n(516),h=n(579);const f=e=>{let{onScanSuccess:t,onClose:n,isActive:a=!0}=e;const f=(0,r.useRef)(null),[p,m]=(0,r.useState)(null),[g,v]=(0,r.useState)(!0),[y,b]=(0,r.useState)(!1),[x,w]=(0,r.useState)(""),[N,S]=(0,r.useState)("");(0,r.useEffect)(()=>(a&&E(),()=>{p&&p.destroy()}),[a]);const E=async()=>{try{w("");const e=await i.hasCamera();if(v(e),!e)return void w("No camera found on this device");if(f.current){const e=new i(f.current,e=>C(e),{onDecodeError:e=>{console.debug("QR decode error:",e)},highlightScanRegion:!0,highlightCodeOutline:!0,preferredCamera:"environment"});m(e),await e.start(),b(!0)}}catch(x){console.error("Error initializing scanner:",x),w("Failed to start camera: "+x.message)}},C=e=>{const n=e.data||e;S(n),b(!1),p&&p.stop(),t&&t(n)},k=async()=>{try{w(""),S(""),p?(await p.start(),b(!0)):await E()}catch(x){w("Failed to restart scanner: "+x.message)}};return(0,h.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 safe-area-top safe-area-bottom",children:(0,h.jsxs)("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-hidden animate-slide-up",children:[(0,h.jsx)("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,h.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,h.jsx)(o.A,{className:"w-4 h-4 text-blue-600"})}),(0,h.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,h.jsx)("h3",{className:"font-semibold text-gray-800 text-sm sm:text-base",children:"Scan QR Code"}),(0,h.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:"Position QR code in the camera frame"})]})]}),(0,h.jsx)("button",{onClick:n,className:"w-8 h-8 bg-gray-200 rounded-lg flex items-center justify-center hover:bg-gray-300 transition-colors flex-shrink-0",children:(0,h.jsx)(s.A,{className:"w-4 h-4"})})]})}),(0,h.jsx)("div",{className:"p-4 overflow-y-auto max-h-[calc(90vh-80px)]",children:x?(0,h.jsxs)("div",{className:"text-center py-8",children:[(0,h.jsx)(l.A,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),(0,h.jsx)("p",{className:"text-red-600 mb-4",children:x}),(0,h.jsx)("button",{onClick:E,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Try Again"})]}):g?N?(0,h.jsxs)("div",{className:"text-center py-8",children:[(0,h.jsx)(u.A,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),(0,h.jsx)("p",{className:"text-green-600 font-medium mb-2",children:"QR Code Scanned!"}),(0,h.jsx)("p",{className:"text-sm text-gray-600 mb-4 font-mono bg-gray-100 p-2 rounded",children:N}),(0,h.jsx)("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Scan Another"})]}):(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{className:"relative bg-black rounded-xl overflow-hidden",children:[(0,h.jsx)("video",{ref:f,className:"w-full h-48 sm:h-64 object-cover",playsInline:!0,muted:!0}),(0,h.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,h.jsxs)("div",{className:"w-32 h-32 sm:w-48 sm:h-48 border-2 border-white rounded-2xl relative",children:[(0,h.jsx)("div",{className:"absolute top-0 left-0 w-4 h-4 sm:w-6 sm:h-6 border-l-4 border-t-4 border-blue-500 rounded-tl-lg"}),(0,h.jsx)("div",{className:"absolute top-0 right-0 w-4 h-4 sm:w-6 sm:h-6 border-r-4 border-t-4 border-blue-500 rounded-tr-lg"}),(0,h.jsx)("div",{className:"absolute bottom-0 left-0 w-4 h-4 sm:w-6 sm:h-6 border-l-4 border-b-4 border-blue-500 rounded-bl-lg"}),(0,h.jsx)("div",{className:"absolute bottom-0 right-0 w-4 h-4 sm:w-6 sm:h-6 border-r-4 border-b-4 border-blue-500 rounded-br-lg"}),y&&(0,h.jsx)("div",{className:"absolute inset-x-0 top-1/2 h-0.5 bg-blue-500 opacity-75 animate-pulse"})]})})]}),(0,h.jsx)("div",{className:"text-center",children:y?(0,h.jsxs)("div",{className:"flex items-center justify-center gap-2 text-blue-600",children:[(0,h.jsx)("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),(0,h.jsx)("span",{className:"text-xs sm:text-sm",children:"Scanning for QR code..."})]}):(0,h.jsx)("p",{className:"text-gray-600 text-xs sm:text-sm",children:"Camera loading..."})}),(0,h.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,h.jsxs)("button",{onClick:k,disabled:!p,className:"flex-1 flex items-center justify-center gap-2 py-2 sm:py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 transition-colors text-sm sm:text-base",children:[(0,h.jsx)(d.A,{className:"w-4 h-4"}),"Restart"]}),(0,h.jsx)("button",{onClick:()=>{p&&(p.stop(),b(!1))},disabled:!y,className:"flex-1 py-2 sm:py-3 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 disabled:opacity-50 transition-colors text-sm sm:text-base",children:"Stop"})]})]}):(0,h.jsxs)("div",{className:"text-center py-8",children:[(0,h.jsx)(c.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,h.jsx)("p",{className:"text-gray-600",children:"No camera available"})]})})]})})}},8845:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8268),a=n(3272),i=n(8396),o=n(9323),s=n(5303);t.matchesProperty=function(e,t){switch(typeof e){case"object":var n;Object.is(null===(n=e)||void 0===n?void 0:n.valueOf(),-0)&&(e="-0");break;case"number":e=a.toKey(e)}return t=i.cloneDeep(t),function(n){const a=o.get(n,e);return void 0===a?s.has(n,e):void 0===t?void 0===a:r.isMatch(a,t)}}},8853:(e,t,n)=>{"use strict";e.exports=n(5896)},8970:(e,t,n)=>{const r=n(6116),a=n(4772),i=n(2182),o=n(5487);function s(e,t,n,i,o){const s=[].slice.call(arguments,1),l=s.length,c="function"===typeof s[l-1];if(!c&&!r())throw new Error("Callback required as last argument");if(!c){if(l<1)throw new Error("Too few arguments provided");return 1===l?(n=t,t=i=void 0):2!==l||t.getContext||(i=n,n=t,t=void 0),new Promise(function(r,o){try{const o=a.create(n,i);r(e(o,t,i))}catch(s){o(s)}})}if(l<2)throw new Error("Too few arguments provided");2===l?(o=n,n=t,t=i=void 0):3===l&&(t.getContext&&"undefined"===typeof o?(o=i,i=void 0):(o=i,i=n,n=t,t=void 0));try{const r=a.create(n,i);o(null,e(r,t,i))}catch(u){o(u)}}t.create=a.create,t.toCanvas=s.bind(null,i.render),t.toDataURL=s.bind(null,i.renderToDataURL),t.toString=s.bind(null,function(e,t,n){return o.render(e,n)})},9021:(e,t,n)=>{const r=n(7969).getSymbolSize;t.getPositions=function(e){const t=r(e);return[[0,0],[t-7,0],[0,t-7]]}},9045:(e,t,n)=>{var r=n(3738).default;e.exports=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},9233:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]])},9292:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},9308:(e,t,n)=>{"use strict";n.d(t,{DY:()=>s,JY:()=>f,LU:()=>u,Lx:()=>l,jT:()=>h,s5:()=>d,y4:()=>c});var r=n(823),a=n(6667),i=n(1121);const o=()=>{try{return i.auth&&i.auth.app&&i.auth.app.options&&"AIzaSyDevelopmentKeyForTesting123456789"!==i.auth.app.options.apiKey}catch(e){return!1}},s=async(e,t,n)=>{try{if(console.log("\ud83d\udd25 Firebase Auth - Starting registration process"),console.log("\ud83d\udd25 Auth instance:",i.auth),!o())throw new Error("Firebase is not properly configured. Please set up your Firebase project.");const s=(await(0,r.eJ)(i.auth,e,t)).user;return console.log("\u2705 User created successfully:",s.uid),await(0,r.r7)(s,{displayName:n.name}),await(0,a.setDoc)((0,a.doc)(i.db,"users",s.uid),{name:n.name,email:n.email,role:n.role,studentId:n.studentId||null,teacherId:n.teacherId||null,createdAt:(new Date).toISOString(),isActive:!0}),{success:!0,user:{uid:s.uid,email:s.email,name:n.name,role:n.role}}}catch(s){return console.error("Registration error:",s),{success:!1,error:s.message}}},l=async(e,t)=>{try{const n=(await(0,r.signInWithEmailAndPassword)(i.auth,e,t)).user,o=await(0,a.getDoc)((0,a.doc)(i.db,"users",n.uid));if(o.exists()){const e=o.data();return{success:!0,user:{uid:n.uid,email:n.email,name:e.name,role:e.role,studentId:e.studentId,teacherId:e.teacherId}}}throw new Error("User data not found")}catch(n){return console.error("Login error:",n),{success:!1,error:n.message}}},c=async()=>{try{return await(0,r.CI)(i.auth),{success:!0}}catch(e){return console.error("Logout error:",e),{success:!1,error:e.message}}},u=async e=>{try{const t=await(0,a.getDoc)((0,a.doc)(i.db,"users",e));return t.exists()?{success:!0,userData:t.data()}:{success:!1,error:"User data not found"}}catch(t){return console.error("Error getting user data:",t),{success:!1,error:t.message}}},d=async(e,t,n)=>{try{if(console.log("\ud83c\udf93 Creating new student:",n.name),!o())throw new Error("Firebase is not properly configured. Please set up your Firebase project.");const s=(await(0,r.eJ)(i.auth,e,t)).user;await(0,r.r7)(s,{displayName:n.name});const l=n.studentId||"ST".concat(Date.now().toString().slice(-6)),c={uid:s.uid,name:n.name,email:n.email,role:"student",studentId:l,phone:n.phone||"",class:n.class||"",department:n.department||"",address:n.address||"",dateOfBirth:n.dateOfBirth||"",parentContact:n.parentContact||"",admissionDate:n.admissionDate||(new Date).toISOString().split("T")[0],status:"active",attendance:{totalDays:0,presentDays:0,percentage:0},createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),isActive:!0};return await(0,a.setDoc)((0,a.doc)(i.db,"users",s.uid),c),await(0,a.setDoc)((0,a.doc)(i.db,"students",s.uid),c),console.log("\u2705 Student created successfully:",l),{success:!0,user:c}}catch(s){return console.error("Error creating student:",s),{success:!1,error:s.message}}},h=async(e,t,n)=>{try{if(console.log("\ud83d\udc68\u200d\ud83c\udfeb Creating new teacher:",n.name),!o())throw new Error("Firebase is not properly configured. Please set up your Firebase project.");const s=(await(0,r.eJ)(i.auth,e,t)).user;await(0,r.r7)(s,{displayName:n.name});const l=n.employeeId||"T".concat(Date.now().toString().slice(-6)),c={uid:s.uid,name:n.name,email:n.email,role:"teacher",teacherId:l,employeeId:l,phone:n.phone||"",subject:n.subject||"",department:n.department||"",designation:n.designation||"Teacher",address:n.address||"",qualification:n.qualification||"",experience:n.experience||"",dateOfJoining:n.dateOfJoining||(new Date).toISOString().split("T")[0],salary:n.salary||"",status:"active",classesAssigned:n.classesAssigned||[],subjects:n.subjects||[n.subject].filter(Boolean),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),isActive:!0};return await(0,a.setDoc)((0,a.doc)(i.db,"users",s.uid),c),await(0,a.setDoc)((0,a.doc)(i.db,"teachers",s.uid),c),console.log("\u2705 Teacher created successfully:",l),{success:!0,user:c}}catch(s){return console.error("Error creating teacher:",s),{success:!1,error:s.message}}},f=async(e,t,n)=>{try{if(console.log("\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 Creating new parent:",n.name),!o())throw new Error("Firebase is not properly configured. Please set up your Firebase project.");const s=(await(0,r.eJ)(i.auth,e,t)).user;await(0,r.r7)(s,{displayName:n.name});const l=n.parentId||"P".concat(Date.now().toString().slice(-6)),c={uid:s.uid,name:n.name,email:n.email,role:"parent",parentId:l,phone:n.phone||"",address:n.address||"",occupation:n.occupation||"",alternatePhone:n.alternatePhone||"",children:n.children||[],emergencyContact:n.emergencyContact||"",relationship:n.relationship||"Parent",status:"active",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),isActive:!0};return await(0,a.setDoc)((0,a.doc)(i.db,"users",s.uid),c),await(0,a.setDoc)((0,a.doc)(i.db,"parents",s.uid),c),console.log("\u2705 Parent created successfully:",l),{success:!0,user:c}}catch(s){return console.error("Error creating parent:",s),{success:!1,error:s.message}}}},9323:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(7260),a=n(2489),i=n(3272),o=n(1444);t.get=function e(t,n,s){if(null==t)return s;switch(typeof n){case"string":{if(r.isUnsafeProperty(n))return s;const i=t[n];return void 0===i?a.isDeepKey(n)?e(t,o.toPath(n),s):s:i}case"number":case"symbol":{"number"===typeof n&&(n=i.toKey(n));const e=t[n];return void 0===e?s:e}default:{var l;if(Array.isArray(n))return function(e,t,n){if(0===t.length)return n;let a=e;for(let i=0;i<t.length;i++){if(null==a)return n;if(r.isUnsafeProperty(t[i]))return n;a=a[t[i]]}if(void 0===a)return n;return a}(t,n,s);if(n=Object.is(null===(l=n)||void 0===l?void 0:l.valueOf(),-0)?"-0":String(n),r.isUnsafeProperty(n))return s;const e=t[n];return void 0===e?s:e}}}},9379:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(4705);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){(0,r.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}},9382:(e,t,n)=>{const r=n(7969).getSymbolSize;t.getRowColCoords=function(e){if(1===e)return[];const t=Math.floor(e/7)+2,n=r(e),a=145===n?26:2*Math.ceil((n-13)/(2*t-2)),i=[n-7];for(let r=1;r<t-1;r++)i[r]=i[r-1]-a;return i.push(6),i.reverse()},t.getPositions=function(e){const n=[],r=t.getRowColCoords(e),a=r.length;for(let t=0;t<a;t++)for(let e=0;e<a;e++)0===t&&0===e||0===t&&e===a-1||t===a-1&&0===e||n.push([r[t],r[e]]);return n}},9397:(e,t,n)=>{e.exports=n(2682).isPlainObject},9426:(e,t,n)=>{"use strict";n.d(t,{Lu:()=>s,u1:()=>o});var r=n(9379),a=n(6667),i=n(1121);const o=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{console.log("\ud83d\udcbe Storing face encoding for user:",e);const o=(0,r.A)({userId:e,descriptor:t,registeredAt:new Date,studentId:n.studentId||e,name:n.name||"Unknown Student",email:n.email||""},n);return await(0,a.setDoc)((0,a.doc)(i.db,"faceEncodings",e),o),console.log("\u2705 Face encoding stored successfully"),{success:!0,message:"Face registered successfully"}}catch(o){return console.error("\u274c Error storing face encoding:",o),{success:!1,error:o.message}}},s=async e=>{try{const t=(0,a.doc)(i.db,"faceEncodings",e),n=await(0,a.getDoc)(t);return n.exists()?{success:!0,data:n.data()}:{success:!1,error:"Face encoding not found"}}catch(t){return console.error("\u274c Error getting face encoding:",t),{success:!1,error:t.message}}}},9461:(e,t,n)=>{"use strict";e.exports=n(2330)},9493:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])},9599:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.identity=function(e){return e}},9606:(e,t,n)=>{"use strict";n.d(t,{h1:()=>s,uA:()=>a});var r=n(1776);class a{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const i="[DEFAULT]";class o{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(r)return null;throw a}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:i})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,i]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(a)&&i.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),a=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;a.add(e),this.onInitCallbacks.set(r,a);const i=this.instances.get(r);return i&&e(i,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const a of n)try{a(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(a=t,a===i?void 0:a),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(o){}var a;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.component?this.component.multipleInstances?e:i:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class s{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new o(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},9637:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>y});var r=n(5043),a=n(7029),i=n.n(a),o=n(7819),s=n(2054),l=n(4537),c=n(247),u=n(4651),d=n(5087),h=n(516),f=n(4459),p=n(614),m=n(4143),g=n(9426),v=n(579);const y=e=>{let{onVerificationSuccess:t,onClose:n,studentData:a,expectedStudentId:y}=e;const b=(0,r.useRef)(null),[x,w]=(0,r.useState)(!1),[N,S]=(0,r.useState)(null),[E,C]=(0,r.useState)(!1),[k,A]=(0,r.useState)(null),[_,j]=(0,r.useState)(""),[I,T]=(0,r.useState)("capture"),[O,P]=(0,r.useState)("detect"),[D,R]=(0,r.useState)(!1),[M,F]=(0,r.useState)(!1),[L,B]=(0,r.useState)(0),[U,z]=(0,r.useState)([]),V={width:640,height:480,facingMode:"user"},W=async()=>{if(b.current)try{console.log("\ud83d\udd0d Starting liveness detection..."),m.A.modelsLoaded||await m.A.initialize();let e=!1,t=0,n=0;const r=100,a=async()=>{if(n>=r)D&&t>=1?(P("complete"),B(100),setTimeout(()=>{T("verify"),q()},1e3)):(j("Liveness check failed. Please blink clearly and try again."),T("error"));else try{var i;const o=null===(i=b.current)||void 0===i?void 0:i.video;if(!o)return;const s=await m.A.detectBlink(o);if(s.success){n++;const a=Math.min(n/r*100,90);if(B(a),s.avgEAR>.3&&!e&&(e=!0,F(!0),P("blink")),s.isBlinking&&e&&!D&&(t++,R(!0),console.log("\u2705 Blink detected! Count: ".concat(t)),t>=1))return P("complete"),B(100),void setTimeout(()=>{T("verify"),q()},1e3)}setTimeout(a,100)}catch(_){console.warn("Liveness check frame error:",_),setTimeout(a,200)}};a()}catch(_){console.error("\u274c Liveness check initialization failed:",_),j("Liveness detection failed to start. Proceeding with standard verification."),T("verify"),q()}},q=async()=>{C(!0),j("");try{var e,n;console.log("\ud83d\udd0d Starting multi-frame face verification...");const r=null===(e=b.current)||void 0===e?void 0:e.video;if(!r)throw new Error("Camera not available for verification");const i=y||(null===a||void 0===a?void 0:a.studentId)||(null===a||void 0===a?void 0:a.uid);if(!i)throw new Error("Missing student ID for verification.");console.log("\ud83d\udcca Retrieving face encoding for student:",i);const o=await(0,g.Lu)(i);if(null===o||void 0===o||!o.success||null===o||void 0===o||null===(n=o.data)||void 0===n||!n.descriptor)throw new Error("No face registered for this account. Please register your face first.");const s=await m.A.checkEncodingQuality(o.data.descriptor);s.isGoodQuality||console.warn("\u26a0\ufe0f Poor encoding quality detected:",s.message);const l=new Float32Array(o.data.descriptor),c=await m.A.verifyFaceMultiFrame(r,l,3,.45);if(z(c.results||[]),!c.success)throw new Error(c.message||"Multi-frame verification failed");console.log("\ud83c\udf89 Multi-frame verification successful!"),A({success:!0,confidence:c.avgConfidence,message:"Face verified! ".concat(c.successRate,"% frame match rate"),multiFrame:!0,frameDetails:c}),T("success"),setTimeout(()=>{t&&t({verified:!0,success:!0,confidence:c.avgConfidence,studentId:o.data.studentId||i,studentName:o.data.name,faceVerified:!0,livenessVerified:D,multiFrameVerified:!0,frameMatchRate:c.successRate,timestamp:new Date,image:N})},1500)}catch(_){console.error("\u274c Multi-frame verification error:",_),A({success:!1,confidence:0,message:_.message||"Face verification failed. Please try again."}),j(_.message||"Verification failed"),T("error")}C(!1)},H=()=>{S(null),A(null),j(""),T("capture"),P("detect"),R(!1),F(!1),B(0),z([])};return(0,v.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 safe-area-top safe-area-bottom",children:(0,v.jsxs)("div",{className:"bg-white rounded-2xl max-w-lg w-full max-h-[95vh] overflow-hidden animate-slide-up",children:[(0,v.jsx)("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,v.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,v.jsx)(f.A,{className:"w-4 h-4 text-blue-600"})}),(0,v.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,v.jsx)("h3",{className:"font-semibold text-gray-800 text-sm sm:text-base",children:"Face Verification"}),(0,v.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:"Verify your identity to mark attendance"})]})]}),(0,v.jsx)("button",{onClick:n,className:"w-8 h-8 bg-gray-200 rounded-lg flex items-center justify-center hover:bg-gray-300 transition-colors flex-shrink-0",children:(0,v.jsx)(p.A,{className:"w-4 h-4"})})]})}),(0,v.jsxs)("div",{className:"p-4 overflow-y-auto max-h-[calc(95vh-80px)]",children:["capture"===I&&(0,v.jsxs)("div",{className:"space-y-4",children:[(0,v.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:[(0,v.jsxs)("p",{className:"text-xs sm:text-sm text-blue-800",children:[(0,v.jsx)("strong",{children:"Student:"})," ",(null===a||void 0===a?void 0:a.name)||"Unknown"]}),(0,v.jsx)("p",{className:"text-xs sm:text-sm text-blue-600",children:"Position your face in the camera frame and click capture"})]}),(0,v.jsxs)("div",{className:"relative bg-black rounded-xl overflow-hidden aspect-[4/3] max-w-full",children:[(0,v.jsx)(i(),{ref:b,audio:!1,screenshotFormat:"image/jpeg",videoConstraints:V,className:"w-full h-full object-cover"}),(0,v.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,v.jsxs)("div",{className:"w-32 h-40 sm:w-48 sm:h-56 border-2 border-white rounded-full relative opacity-75",children:[(0,v.jsx)("div",{className:"absolute top-3 sm:top-4 left-1/2 transform -translate-x-1/2 w-1.5 h-1.5 sm:w-2 sm:h-2 bg-white rounded-full"}),(0,v.jsx)("div",{className:"absolute bottom-12 sm:bottom-16 left-1/2 transform -translate-x-1/2 w-6 h-0.5 sm:w-8 sm:h-1 bg-white rounded-full"})]})})]}),(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 mb-4",children:"Make sure your face is clearly visible and well-lit"}),(0,v.jsxs)("button",{onClick:()=>{if(b.current){const e=b.current.getScreenshot();S(e),T("liveness"),P("detect"),R(!1),F(!1),B(0),W()}},className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 mx-auto text-sm sm:text-base min-h-12 touch-manipulation",children:[(0,v.jsx)(c.A,{className:"w-4 h-4"}),"Capture Photo"]})]})]}),"liveness"===I&&(0,v.jsxs)("div",{className:"space-y-4",children:[(0,v.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:[(0,v.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,v.jsx)(l.A,{className:"w-4 h-4 text-blue-600"}),(0,v.jsx)("p",{className:"text-xs sm:text-sm font-medium text-blue-800",children:"Liveness Check"})]}),(0,v.jsxs)("p",{className:"text-xs sm:text-sm text-blue-600",children:["detect"===O&&"Looking for your face...","blink"===O&&"Please blink naturally","complete"===O&&"Liveness verified!"]})]}),(0,v.jsxs)("div",{className:"relative bg-black rounded-xl overflow-hidden aspect-[4/3] max-w-full",children:[(0,v.jsx)(i(),{ref:b,audio:!1,screenshotFormat:"image/jpeg",videoConstraints:V,className:"w-full h-full object-cover"}),(0,v.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,v.jsxs)("div",{className:"w-32 h-40 sm:w-48 sm:h-56 border-2 border-white rounded-full relative opacity-75",children:[(0,v.jsx)("div",{className:"absolute top-3 sm:top-4 left-1/2 transform -translate-x-1/2 w-1.5 h-1.5 sm:w-2 sm:h-2 bg-white rounded-full"}),(0,v.jsx)("div",{className:"absolute bottom-12 sm:bottom-16 left-1/2 transform -translate-x-1/2 w-6 h-0.5 sm:w-8 sm:h-1 bg-white rounded-full"}),M&&(0,v.jsxs)("div",{className:"absolute top-8 sm:top-12 left-1/2 transform -translate-x-1/2 flex gap-2 sm:gap-4",children:[(0,v.jsx)(d.A,{className:"w-3 h-3 sm:w-4 sm:h-4 text-green-400"}),(0,v.jsx)(d.A,{className:"w-3 h-3 sm:w-4 sm:h-4 text-green-400"})]}),D&&(0,v.jsx)("div",{className:"absolute top-6 sm:top-8 left-1/2 transform -translate-x-1/2",children:(0,v.jsx)(s.A,{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-400"})})]})}),(0,v.jsx)("div",{className:"absolute bottom-3 sm:bottom-4 left-3 sm:left-4 right-3 sm:right-4",children:(0,v.jsxs)("div",{className:"bg-black/50 rounded-lg p-2",children:[(0,v.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-1.5 sm:h-2",children:(0,v.jsx)("div",{className:"bg-blue-500 h-1.5 sm:h-2 rounded-full transition-all duration-300",style:{width:"".concat(L,"%")}})}),(0,v.jsxs)("p",{className:"text-white text-xs mt-1 text-center",children:["detect"===O&&"Detecting face...","blink"===O&&"Blink to continue","complete"===O&&"Liveness verified!"]})]})})]}),(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[M?(0,v.jsx)(d.A,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-500"}):(0,v.jsx)(u.A,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400"}),(0,v.jsx)("span",{className:"text-xs sm:text-sm text-gray-600",children:M?"Eyes detected":"Looking for eyes..."})]}),D&&(0,v.jsxs)("div",{className:"flex items-center justify-center gap-2 text-green-600",children:[(0,v.jsx)(s.A,{className:"w-4 h-4"}),(0,v.jsx)("span",{className:"text-xs sm:text-sm font-medium",children:"Blink detected!"})]})]})]}),"verify"===I&&(0,v.jsx)("div",{className:"space-y-4",children:E?(0,v.jsxs)("div",{className:"text-center py-4",children:[(0,v.jsx)("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-3"}),(0,v.jsx)("p",{className:"text-sm sm:text-base text-blue-600 font-medium",children:"Verifying face across multiple frames..."}),(0,v.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"This ensures accurate recognition"}),U.length>0&&(0,v.jsxs)("div",{className:"mt-4 bg-gray-50 rounded-lg p-3",children:[(0,v.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:"Frame Analysis:"}),(0,v.jsx)("div",{className:"flex justify-center gap-1",children:U.map((e,t)=>(0,v.jsx)("div",{className:"w-2 h-2 sm:w-3 sm:h-3 rounded-full ".concat(e.error?"bg-gray-300":e.match?"bg-green-500":"bg-red-500"),title:"Frame ".concat(t+1,": ").concat(e.match?"Match":"No match"," (").concat(e.confidence,"%)")},t))})]})]}):(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsx)("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200 mb-4",children:(0,v.jsx)("p",{className:"text-blue-800 text-xs sm:text-sm",children:"Liveness check completed! Proceeding with face verification..."})}),(0,v.jsx)("button",{onClick:H,className:"px-6 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm sm:text-base min-h-10 touch-manipulation",children:"Start Over"})]})}),"success"===I&&(null===k||void 0===k?void 0:k.success)&&(0,v.jsxs)("div",{className:"text-center py-6 sm:py-8",children:[(0,v.jsx)(s.A,{className:"w-12 h-12 sm:w-16 sm:h-16 text-green-500 mx-auto mb-4"}),(0,v.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-green-600 mb-2",children:"Verification Successful!"}),(0,v.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600 mb-4",children:["Confidence: ",Math.round(k.confidence),"%"]}),(0,v.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:(0,v.jsxs)("div",{className:"space-y-1 text-xs text-green-800",children:[(0,v.jsxs)("div",{className:"flex justify-between items-center",children:[(0,v.jsx)("span",{children:"Liveness Check:"}),(0,v.jsx)(s.A,{className:"w-3 h-3"})]}),(0,v.jsxs)("div",{className:"flex justify-between items-center",children:[(0,v.jsx)("span",{children:"Multi-frame Verification:"}),(0,v.jsx)(s.A,{className:"w-3 h-3"})]}),k.frameDetails&&(0,v.jsxs)("div",{className:"flex justify-between items-center",children:[(0,v.jsx)("span",{children:"Frame Match Rate:"}),(0,v.jsxs)("span",{children:[k.frameDetails.successRate,"%"]})]})]})})]}),"error"===I&&(0,v.jsxs)("div",{className:"text-center py-6 sm:py-8",children:[(0,v.jsx)(o.A,{className:"w-12 h-12 sm:w-16 sm:h-16 text-red-500 mx-auto mb-4"}),(0,v.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-red-600 mb-2",children:"Verification Failed"}),(0,v.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 mb-4",children:_||(null===k||void 0===k?void 0:k.message)||"Please try again"}),(0,v.jsxs)("button",{onClick:H,className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 mx-auto text-sm sm:text-base min-h-10 touch-manipulation",children:[(0,v.jsx)(h.A,{className:"w-4 h-4"}),"Try Again"]})]})]})]})})}},9642:(e,t,n)=>{const r=n(7421),a=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function i(e){this.mode=r.ALPHANUMERIC,this.data=e}i.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let n=45*a.indexOf(this.data[t]);n+=a.indexOf(this.data[t+1]),e.put(n,11)}this.data.length%2&&e.put(a.indexOf(this.data[t]),6)},e.exports=i},9645:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6392),a=n(8346),i=n(1203);t.last=function(e){if(i.isArrayLike(e))return r.last(a.toArray(e))}},9709:(e,t)=>{"use strict";function n(e){return"symbol"===typeof e?1:null===e?2:void 0===e?3:e!==e?4:0}Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});t.compareValues=(e,t,r)=>{if(e!==t){const a=n(e),i=n(t);if(a===i&&0===a){if(e<t)return"desc"===r?1:-1;if(e>t)return"desc"===r?-1:1}return"desc"===r?i-a:a-i}return 0}},9717:(e,t,n)=>{"use strict";var r=n(5043),a=n(9461);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=a.useSyncExternalStore,s=r.useRef,l=r.useEffect,c=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,a){var d=s(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;d=c(function(){function e(e){if(!l){if(l=!0,o=e,e=r(e),void 0!==a&&h.hasValue){var t=h.value;if(a(t,e))return s=t}return s=e}if(t=s,i(o,e))return t;var n=r(e);return void 0!==a&&a(t,n)?(o=e,t):(o=e,s=n)}var o,s,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,r,a]);var f=o(e,d[0],d[1]);return l(function(){h.hasValue=!0,h.value=f},[f]),u(f),f}},9797:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]])},9855:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(7784).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},9859:(e,t,n)=>{e.exports=n(7231).range},9921:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isObjectLike=function(e){return"object"===typeof e&&null!==e}},9972:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.eq=function(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&r;("object"==typeof s||"function"==typeof s)&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>o[e]=()=>r[e]);return o.default=()=>r,n.d(i,o),i}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+"."+{451:"518da0b1",453:"687f3dee"}[e]+".chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="attendance:";n.l=(r,a,i,o)=>{if(e[r])e[r].push(a);else{var s,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+i){s=d;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[a];var h=(t,n)=>{s.onerror=s.onload=null,clearTimeout(f);var a=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach(e=>e(n)),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/Smart-Attendance/",(()=>{var e={792:0};n.f.j=(t,r)=>{var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise((n,r)=>a=e[t]=[n,r]);r.push(a[2]=i);var o=n.p+n.u(t),s=new Error;n.l(o,r=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,a[1](s)}},"chunk-"+t,t)}};var t=(t,r)=>{var a,i,o=r[0],s=r[1],l=r[2],c=0;if(o.some(t=>0!==e[t])){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(l)l(n)}for(t&&t(r);c<o.length;c++)i=o[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkattendance=self.webpackChunkattendance||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e=n(5043),t=n(4391),r=n(5352),a=n(5016),i=n(6471),o=n(9308);const s=()=>{(()=>{if("undefined"!==typeof window&&"performance"in window){const t=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{console.log("\ud83d\udcca ".concat(e.entryType,":"),e.value||e.duration)})});try{t.observe({entryTypes:["largest-contentful-paint","first-input","layout-shift"]})}catch(e){console.log("Performance Observer not supported")}}})(),"ontouchstart"in window&&document.documentElement.classList.add("touch-device"),document.querySelectorAll(".overflow-scroll, .overflow-y-auto").forEach(e=>{e.style.webkitOverflowScrolling="touch"}),document.querySelectorAll("input, select, textarea").forEach(e=>{"range"!==e.getAttribute("type")&&e.addEventListener("focus",()=>{const t=document.querySelector('meta[name="viewport"]');t&&(t.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"),e.addEventListener("blur",()=>{t.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes")},{once:!0}))})}),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("\u2705 SW registered: ",e)}).catch(e=>{console.log("\u274c SW registration failed: ",e)})}),["/logo192.png","/logo512.png"].forEach(e=>{const t=document.createElement("link");t.rel="preload",t.as="image",t.href=e,document.head.appendChild(t)}),(()=>{if("fonts"in document){const e=[document.fonts.load("400 16px system-ui"),document.fonts.load("600 16px system-ui")];Promise.all(e).then(()=>{document.documentElement.classList.add("fonts-loaded")})}})()};var l=n(579);const c=e=>{let{text:t="Loading..."}=e;return(0,l.jsx)("div",{className:"flex items-center justify-center min-h-[200px] sm:min-h-[300px]",children:(0,l.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,l.jsx)("div",{className:"w-8 h-8 border-3 border-blue-200 border-t-blue-600 rounded-full animate-spin"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:t})]})})},u=e=>{let{href:t="#main-content",children:n="Skip to main content"}=e;return(0,l.jsx)("a",{href:t,className:"skip-link",children:n})};var d=n(9379),h=n(9797),f=n(2626),p=n(7118),m=n(7784);const g=(0,m.A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),v=(0,m.A)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);var y=n(2054),b=n(7819),x=n(5327);const w=(0,m.A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var N=n(4651),S=n(5087);const E=(0,m.A)("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]),C=(0,m.A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),k=t=>{let{onLogin:n,onNavigateToRegister:a}=t;const i=(0,r.Zp)(),[s,c]=(0,e.useState)("student"),[u,m]=(0,e.useState)(!1),[k,A]=(0,e.useState)({email:"",password:"",remember:!1}),[_,j]=(0,e.useState)(!1),[I,T]=(0,e.useState)(""),O=[{id:"student",label:"Student",icon:h.A,gradient:"from-blue-400 via-purple-500 to-pink-500",bgGradient:"from-blue-50 to-purple-50",description:"Access your courses, grades, and assignments"},{id:"teacher",label:"Teacher",icon:f.A,gradient:"from-green-400 via-teal-500 to-blue-500",bgGradient:"from-green-50 to-teal-50",description:"Manage classes, track attendance, and grade students"},{id:"parent",label:"Parent",icon:p.A,gradient:"from-orange-400 via-pink-500 to-red-500",bgGradient:"from-orange-50 to-pink-50",description:"Monitor your child's progress and communicate with teachers"},{id:"admin",label:"Admin",icon:g,gradient:"from-purple-400 via-indigo-500 to-blue-500",bgGradient:"from-purple-50 to-indigo-50",description:"System administration and user management"}],P=e=>{const{name:t,value:n,type:r,checked:a}=e.target;A(e=>(0,d.A)((0,d.A)({},e),{},{[t]:"checkbox"===r?a:n})),I&&T("")},D=O.find(e=>e.id===s);return(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-br ".concat(D.bgGradient," via-white to-gray-50 transition-all duration-700 ease-in-out"),children:[(0,l.jsxs)("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[(0,l.jsx)("div",{className:"absolute -top-40 -right-40 w-96 h-96 bg-gradient-to-br from-blue-200/30 to-purple-200/30 rounded-full blur-3xl animate-pulse"}),(0,l.jsx)("div",{className:"absolute -bottom-40 -left-40 w-96 h-96 bg-gradient-to-tr from-pink-200/30 to-orange-200/30 rounded-full blur-3xl animate-pulse delay-1000"}),(0,l.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-to-r from-teal-200/20 to-green-200/20 rounded-full blur-2xl animate-pulse delay-500"})]}),(0,l.jsx)("div",{className:"relative z-10 flex items-center justify-center min-h-screen p-4",children:(0,l.jsx)("div",{className:"w-full max-w-6xl mx-auto",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-center",children:[(0,l.jsxs)("div",{className:"text-center lg:text-left space-y-8",children:[(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"inline-flex items-center gap-3 bg-white/80 backdrop-blur-sm rounded-2xl px-6 py-3 shadow-lg border border-white/50",children:[(0,l.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r ".concat(D.gradient," rounded-lg flex items-center justify-center"),children:(0,l.jsx)(v,{className:"w-5 h-5 text-white"})}),(0,l.jsx)("span",{className:"font-bold text-xl bg-gradient-to-r from-gray-700 to-gray-900 bg-clip-text text-transparent",children:"EduManage Pro"})]}),(0,l.jsxs)("h1",{className:"text-5xl lg:text-6xl font-bold leading-tight",children:[(0,l.jsx)("span",{className:"bg-gradient-to-r from-gray-800 via-gray-600 to-gray-800 bg-clip-text text-transparent",children:"Welcome"}),(0,l.jsx)("br",{}),(0,l.jsx)("span",{className:"bg-gradient-to-r ".concat(D.gradient," bg-clip-text text-transparent"),children:D.label})]}),(0,l.jsx)("p",{className:"text-xl text-gray-600 max-w-md mx-auto lg:mx-0 leading-relaxed",children:D.description})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 max-w-md mx-auto lg:mx-0",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 bg-white/60 backdrop-blur-sm rounded-xl p-3 border border-white/50",children:[(0,l.jsx)(y.A,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),(0,l.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Real-time Updates"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 bg-white/60 backdrop-blur-sm rounded-xl p-3 border border-white/50",children:[(0,l.jsx)(y.A,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),(0,l.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Secure Access"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 bg-white/60 backdrop-blur-sm rounded-xl p-3 border border-white/50",children:[(0,l.jsx)(y.A,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),(0,l.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Mobile Friendly"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 bg-white/60 backdrop-blur-sm rounded-xl p-3 border border-white/50",children:[(0,l.jsx)(y.A,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),(0,l.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"24/7 Support"})]})]})]}),(0,l.jsxs)("div",{className:"w-full max-w-md mx-auto",children:[(0,l.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm rounded-3xl p-8 shadow-2xl border border-white/50",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 text-center",children:"Select Your Role"}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-3",children:O.map(e=>{const t=e.icon;return(0,l.jsxs)("button",{onClick:()=>c(e.id),className:"relative p-4 rounded-2xl border-2 transition-all duration-300 transform hover:scale-105 ".concat(s===e.id?"border-transparent bg-gradient-to-br ".concat(e.gradient," text-white shadow-lg"):"border-gray-200 bg-white/70 hover:border-gray-300 text-gray-700"),children:[(0,l.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,l.jsx)(t,{className:"w-6 h-6"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:e.label})]}),s===e.id&&(0,l.jsx)("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-white rounded-full flex items-center justify-center shadow-lg",children:(0,l.jsx)(y.A,{className:"w-4 h-4 text-green-500"})})]},e.id)})})]}),(0,l.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),j(!0),T("");try{if(!k.email||!k.password)throw new Error("Please fill in all fields");if(!k.email.includes("@"))throw new Error("Please enter a valid email address");if(k.password.length<6)throw new Error("Password must be at least 6 characters");const e=await(0,o.Lx)(k.email,k.password);e.success?e.user.role===s?("teacher"===e.user.role?i("/teacher"):"student"===e.user.role?i("/student"):"admin"===e.user.role&&i("/admin"),n&&n(e.user)):T("Please select the correct user type. You are registered as a ".concat(e.user.role,".")):T(e.error)}catch(I){T(I.message)}finally{j(!1)}},className:"space-y-6",children:[I&&(0,l.jsxs)("div",{className:"flex items-center gap-2 p-4 bg-red-50 border border-red-200 rounded-2xl",children:[(0,l.jsx)(b.A,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),(0,l.jsx)("span",{className:"text-sm text-red-700",children:I})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:(0,l.jsx)(x.A,{className:"h-5 w-5 text-gray-400"})}),(0,l.jsx)("input",{type:"email",name:"email",placeholder:"Email address",value:k.email,onChange:P,className:"w-full pl-12 pr-4 py-4 bg-white/70 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:(0,l.jsx)(w,{className:"h-5 w-5 text-gray-400"})}),(0,l.jsx)("input",{type:u?"text":"password",name:"password",placeholder:"Password",value:k.password,onChange:P,className:"w-full pl-12 pr-12 py-4 bg-white/70 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"}),(0,l.jsx)("button",{type:"button",onClick:()=>m(!u),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 transition-colors",children:u?(0,l.jsx)(N.A,{className:"h-5 w-5"}):(0,l.jsx)(S.A,{className:"h-5 w-5"})})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,l.jsx)("input",{type:"checkbox",name:"remember",checked:k.remember,onChange:P,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),(0,l.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Remember me"})]}),(0,l.jsx)("button",{type:"button",className:"text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:"Forgot password?"})]}),(0,l.jsx)("button",{type:"submit",disabled:_,className:"w-full py-4 px-6 rounded-2xl font-semibold text-white transition-all duration-300 transform hover:scale-105 hover:shadow-lg ".concat(_?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r ".concat(D.gradient," hover:shadow-xl")),children:(0,l.jsx)("div",{className:"flex items-center justify-center gap-2",children:_?(0,l.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(E,{className:"w-5 h-5"}),"Sign In as ",D.label,(0,l.jsx)(C,{className:"w-5 h-5"})]})})})]}),(0,l.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:(0,l.jsxs)("div",{className:"text-center space-y-3",children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Don't have an account?"}),(0,l.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,l.jsx)("button",{onClick:()=>i("/register"),className:"text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:"Register as Student"}),(0,l.jsx)("span",{className:"text-gray-300",children:"|"}),(0,l.jsx)("button",{onClick:()=>i("/workflow-test"),className:"text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:"Workflow Test"})]})]})})]}),(0,l.jsx)("div",{className:"mt-6 text-center",children:(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"By signing in, you agree to our Terms of Service and Privacy Policy"})})]})]})})})]})};var A=n(4459);const _=(0,m.A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);var j=n(817),I=n(1286),T=n(8646),O=n(8006),P=n(247),D=n(797),R=n(254),M=n(5469),F=n(9426),L=n(7029),B=n.n(L),U=n(516),z=n(4143);const V=t=>{let{onFaceRegistered:n,onRegistrationComplete:r,onSkip:a}=t;const i=(0,e.useRef)(null),[o,s]=(0,e.useState)("instructions"),[c,u]=(0,e.useState)(null),[d,h]=(0,e.useState)(""),[f,p]=(0,e.useState)(null),m={width:640,height:480,facingMode:"user"};(0,e.useEffect)(()=>{(async()=>{try{await z.A.initialize()}catch(d){h("Failed to initialize face recognition: "+d.message)}})()},[]),(0,e.useEffect)(()=>{if("capture"===o&&i.current){const e=setInterval(async()=>{const e=i.current.video;if(e&&4===e.readyState)try{const t=await z.A.validateImageQuality(e);p(t)}catch(d){}},1e3);return()=>clearInterval(e)}},[o]);const g=()=>{if(i.current){const e=i.current.getScreenshot();u(e),s("processing"),v(e)}},v=async e=>{h("");try{const t=new Image;t.onload=async()=>{try{const e=await z.A.registerFace(t);if(!e.success)throw new Error(e.error||"Face registration failed");s("success"),setTimeout(()=>{n&&n(e.descriptor),r&&r(e.descriptor)},1200)}catch(d){h(d.message),s("error")}},t.src=e}catch(d){h(d.message),s("error")}},x=()=>{u(null),h(""),s("capture")},w=()=>{a&&a()};return"instructions"===o?(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full mx-4",children:[(0,l.jsxs)("div",{className:"text-center mb-6",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full mx-auto flex items-center justify-center mb-4",children:(0,l.jsx)(A.A,{className:"w-10 h-10 text-blue-600"})}),(0,l.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Face Registration"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Register your face for secure attendance verification"})]}),(0,l.jsx)("div",{className:"space-y-4 mb-6",children:(0,l.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,l.jsx)("h4",{className:"font-semibold text-blue-800 mb-2",children:"Instructions:"}),(0,l.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,l.jsx)("li",{children:"\u2022 Ensure good lighting"}),(0,l.jsx)("li",{children:"\u2022 Look directly at the camera"}),(0,l.jsx)("li",{children:"\u2022 Keep your face centered"}),(0,l.jsx)("li",{children:"\u2022 Remove glasses if possible"}),(0,l.jsx)("li",{children:"\u2022 Avoid shadows on your face"}),(0,l.jsx)("li",{children:"\u2022 Your face data will be linked to your account after you finish registration"})]})]})}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("button",{onClick:()=>s("capture"),className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all",children:"Start Face Registration"}),(0,l.jsx)("button",{onClick:w,className:"w-full bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition-all",children:"Skip for Now"})]})]}):"capture"===o?(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-6 max-w-md w-full mx-4",children:[(0,l.jsxs)("div",{className:"text-center mb-4",children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Position Your Face"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Look directly at the camera"})]}),(0,l.jsxs)("div",{className:"relative mb-4",children:[(0,l.jsx)(B(),{ref:i,audio:!1,screenshotFormat:"image/jpeg",videoConstraints:m,className:"w-full rounded-xl"}),f&&(0,l.jsx)("div",{className:"absolute top-2 left-2 px-3 py-1 rounded-lg text-sm font-medium ".concat(f.valid?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:f.message})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("button",{onClick:g,disabled:f&&!f.valid,className:"w-full py-3 rounded-xl font-semibold transition-all ".concat(f&&!f.valid?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:[(0,l.jsx)(P.A,{className:"w-5 h-5 inline mr-2"}),"Capture Photo"]}),(0,l.jsx)("button",{onClick:w,className:"w-full bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition-all",children:"Skip Registration"})]})]}):"processing"===o?(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full mx-4 text-center",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-blue-100 rounded-full mx-auto flex items-center justify-center mb-6",children:(0,l.jsx)(U.A,{className:"w-10 h-10 text-blue-600 animate-spin"})}),(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Processing Face..."}),(0,l.jsx)("p",{className:"text-gray-600",children:"Please wait while we register your face"}),c&&(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("img",{src:c,alt:"Captured face",className:"w-32 h-32 rounded-full mx-auto object-cover border-4 border-blue-200"})})]}):"success"===o?(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full mx-4 text-center",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-green-100 rounded-full mx-auto flex items-center justify-center mb-6",children:(0,l.jsx)(y.A,{className:"w-10 h-10 text-green-600"})}),(0,l.jsx)("h3",{className:"text-xl font-bold text-green-600 mb-2",children:"Face Registered!"}),(0,l.jsx)("p",{className:"text-gray-600 mb-4",children:"Your face has been successfully registered for attendance"}),c&&(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("img",{src:c,alt:"Registered face",className:"w-32 h-32 rounded-full mx-auto object-cover border-4 border-green-200"})})]}):"error"===o?(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full mx-4 text-center",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-red-100 rounded-full mx-auto flex items-center justify-center mb-6",children:(0,l.jsx)(b.A,{className:"w-10 h-10 text-red-600"})}),(0,l.jsx)("h3",{className:"text-xl font-bold text-red-600 mb-2",children:"Registration Failed"}),(0,l.jsx)("p",{className:"text-gray-600 mb-4",children:d}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("button",{onClick:x,className:"w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700 transition-all",children:"Try Again"}),(0,l.jsx)("button",{onClick:w,className:"w-full bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition-all",children:"Skip Registration"})]})]}):null},W=t=>{let{onRegister:n,onNavigateToLogin:r,initialUserType:a}=t;const[i,s]=(0,e.useState)(1),[c,u]=(0,e.useState)(!1),[m,g]=(0,e.useState)(!1),[E,k]=(0,e.useState)(!1),[L,B]=(0,e.useState)(null),[U,z]=(0,e.useState)(""),[W,q]=(0,e.useState)(""),[H,G]=(0,e.useState)({firstName:"",lastName:"",email:"",phone:"",dateOfBirth:"",gender:"",bloodGroup:"",address:"",city:"",state:"",zipCode:"",country:"",studentId:"",course:"",semester:"",batch:"",previousEducation:"",password:"",confirmPassword:"",emergencyName:"",emergencyPhone:"",emergencyRelation:"",profileImage:null,faceData:null,agreeTerms:!1}),K=[{id:1,title:"Personal Info",icon:A.A,description:"Basic personal details"},{id:2,title:"Address",icon:_,description:"Contact information"},{id:3,title:"Academic",icon:f.A,description:"Educational details"},{id:4,title:"Account",icon:w,description:"Login credentials"},{id:5,title:"Face Setup",icon:j.A,description:"Register your face"},{id:6,title:"Emergency",icon:p.A,description:"Emergency contact"},{id:7,title:"Review",icon:y.A,description:"Final review"}],X=e=>{const{name:t,value:n,type:r,checked:a}=e.target;G(e=>(0,d.A)((0,d.A)({},e),{},{[t]:"checkbox"===r?a:n})),U&&z(""),W&&q("")},Y=e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{B(e.target.result),G(e=>(0,d.A)((0,d.A)({},e),{},{profileImage:t}))},e.readAsDataURL(t)}},Q=()=>{switch(i){case 1:return H.firstName&&H.lastName&&H.email&&H.phone&&H.dateOfBirth&&H.gender;case 2:return H.address&&H.city&&H.state&&H.zipCode&&H.country;case 3:return H.course&&H.semester&&H.batch;case 4:const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(H.email),t=H.password&&H.password.length>=6,n=H.password===H.confirmPassword;return H.password&&H.confirmPassword&&e&&t&&n;case 5:return null!==H.faceData;case 6:return H.emergencyName&&H.emergencyPhone&&H.emergencyRelation;case 7:return H.agreeTerms;default:return!0}},$=()=>(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full mx-auto flex items-center justify-center mb-4",children:(0,l.jsx)(A.A,{className:"w-10 h-10 text-white"})}),(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Personal Information"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Let's start with your basic details"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),(0,l.jsx)("input",{type:"text",name:"firstName",value:H.firstName,onChange:X,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"John"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),(0,l.jsx)("input",{type:"text",name:"lastName",value:H.lastName,onChange:X,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Doe"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(x.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,l.jsx)("input",{type:"email",name:"email",value:H.email,onChange:X,className:"w-full pl-10 pr-4 p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"john.doe@email.com"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(I.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,l.jsx)("input",{type:"tel",name:"phone",value:H.phone,onChange:X,className:"w-full pl-10 pr-4 p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"+1 (555) 123-4567"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth *"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(T.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,l.jsx)("input",{type:"date",name:"dateOfBirth",value:H.dateOfBirth,onChange:X,className:"w-full pl-10 pr-4 p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gender *"}),(0,l.jsxs)("select",{name:"gender",value:H.gender,onChange:X,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select Gender"}),(0,l.jsx)("option",{value:"male",children:"Male"}),(0,l.jsx)("option",{value:"female",children:"Female"}),(0,l.jsx)("option",{value:"other",children:"Other"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Blood Group"}),(0,l.jsxs)("select",{name:"bloodGroup",value:H.bloodGroup,onChange:X,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select Blood Group"}),(0,l.jsx)("option",{value:"A+",children:"A+"}),(0,l.jsx)("option",{value:"A-",children:"A-"}),(0,l.jsx)("option",{value:"B+",children:"B+"}),(0,l.jsx)("option",{value:"B-",children:"B-"}),(0,l.jsx)("option",{value:"AB+",children:"AB+"}),(0,l.jsx)("option",{value:"AB-",children:"AB-"}),(0,l.jsx)("option",{value:"O+",children:"O+"}),(0,l.jsx)("option",{value:"O-",children:"O-"})]})]})]})]});return(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[(0,l.jsxs)("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[(0,l.jsx)("div",{className:"absolute -top-40 -right-40 w-96 h-96 bg-gradient-to-br from-blue-200/30 to-purple-200/30 rounded-full blur-3xl animate-pulse"}),(0,l.jsx)("div",{className:"absolute -bottom-40 -left-40 w-96 h-96 bg-gradient-to-tr from-pink-200/30 to-orange-200/30 rounded-full blur-3xl animate-pulse delay-1000"}),(0,l.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-to-r from-teal-200/20 to-green-200/20 rounded-full blur-2xl animate-pulse delay-500"})]}),(0,l.jsxs)("div",{className:"relative z-10 p-4",children:[(0,l.jsxs)("div",{className:"max-w-4xl mx-auto mb-8",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"inline-flex items-center gap-3 bg-white/80 backdrop-blur-sm rounded-2xl px-6 py-3 shadow-lg border border-white/50 mb-6",children:[(0,l.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-400 to-purple-500 rounded-lg flex items-center justify-center",children:(0,l.jsx)(v,{className:"w-5 h-5 text-white"})}),(0,l.jsx)("span",{className:"font-bold text-xl bg-gradient-to-r from-gray-700 to-gray-900 bg-clip-text text-transparent",children:"EduManage Pro"})]}),(0,l.jsx)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2",children:"Student Registration"}),(0,l.jsx)("p",{className:"text-gray-600 text-lg",children:"Join our educational community"})]}),(0,l.jsx)("div",{className:"mt-8",children:(0,l.jsx)("div",{className:"flex items-center justify-between max-w-3xl mx-auto",children:K.map((e,t)=>{const n=e.icon,r=i===e.id,a=i>e.id;return(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center ".concat(t<K.length-1?"flex-1":""),children:[(0,l.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center border-2 transition-all duration-300 ".concat(a?"bg-green-500 border-green-500 text-white":r?"bg-blue-500 border-blue-500 text-white":"bg-white border-gray-300 text-gray-400"),children:a?(0,l.jsx)(y.A,{className:"w-6 h-6"}):(0,l.jsx)(n,{className:"w-6 h-6"})}),(0,l.jsxs)("div",{className:"text-center mt-2",children:[(0,l.jsx)("div",{className:"text-sm font-medium ".concat(r?"text-blue-600":a?"text-green-600":"text-gray-500"),children:e.title}),(0,l.jsx)("div",{className:"text-xs text-gray-400 hidden sm:block",children:e.description})]})]}),t<K.length-1&&(0,l.jsx)("div",{className:"flex-1 h-0.5 mx-4 ".concat(i>e.id?"bg-green-500":"bg-gray-300"," transition-all duration-300")})]},e.id)})})})]}),(0,l.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,l.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm rounded-3xl p-8 shadow-2xl border border-white/50",children:[U&&(0,l.jsxs)("div",{className:"flex items-center gap-2 p-4 bg-red-50 border border-red-200 rounded-2xl mb-6",children:[(0,l.jsx)(b.A,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),(0,l.jsx)("span",{className:"text-sm text-red-700",children:U})]}),W&&(0,l.jsxs)("div",{className:"flex items-center gap-2 p-4 bg-green-50 border border-green-200 rounded-2xl mb-6",children:[(0,l.jsx)(y.A,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),(0,l.jsx)("span",{className:"text-sm text-green-700",children:W})]}),(()=>{switch(i){case 1:default:return $();case 2:return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gradient-to-r from-green-400 to-teal-500 rounded-full mx-auto flex items-center justify-center mb-4",children:(0,l.jsx)(_,{className:"w-10 h-10 text-white"})}),(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Address Information"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Where can we reach you?"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Street Address *"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(O.A,{className:"absolute left-3 top-3 text-gray-400 w-5 h-5"}),(0,l.jsx)("textarea",{name:"address",value:H.address,onChange:X,rows:3,className:"w-full pl-10 pr-4 p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"123 Main Street, Apartment 4B"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),(0,l.jsx)("input",{type:"text",name:"city",value:H.city,onChange:X,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"New York"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State/Province *"}),(0,l.jsx)("input",{type:"text",name:"state",value:H.state,onChange:X,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"New York"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ZIP/Postal Code *"}),(0,l.jsx)("input",{type:"text",name:"zipCode",value:H.zipCode,onChange:X,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"10001"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country *"}),(0,l.jsxs)("select",{name:"country",value:H.country,onChange:X,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select Country"}),(0,l.jsx)("option",{value:"US",children:"United States"}),(0,l.jsx)("option",{value:"CA",children:"Canada"}),(0,l.jsx)("option",{value:"UK",children:"United Kingdom"}),(0,l.jsx)("option",{value:"AU",children:"Australia"}),(0,l.jsx)("option",{value:"IN",children:"India"}),(0,l.jsx)("option",{value:"DE",children:"Germany"}),(0,l.jsx)("option",{value:"FR",children:"France"})]})]})]})]});case 3:return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full mx-auto flex items-center justify-center mb-4",children:(0,l.jsx)(f.A,{className:"w-10 h-10 text-white"})}),(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Academic Information"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Tell us about your studies"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Student ID (if known)"}),(0,l.jsx)("input",{type:"text",name:"studentId",value:H.studentId,onChange:X,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ST2024001"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Course/Program *"}),(0,l.jsxs)("select",{name:"course",value:H.course,onChange:X,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select Course"}),(0,l.jsx)("option",{value:"computer-science",children:"Computer Science"}),(0,l.jsx)("option",{value:"information-technology",children:"Information Technology"}),(0,l.jsx)("option",{value:"business-administration",children:"Business Administration"}),(0,l.jsx)("option",{value:"engineering",children:"Engineering"}),(0,l.jsx)("option",{value:"mathematics",children:"Mathematics"}),(0,l.jsx)("option",{value:"physics",children:"Physics"}),(0,l.jsx)("option",{value:"chemistry",children:"Chemistry"}),(0,l.jsx)("option",{value:"biology",children:"Biology"}),(0,l.jsx)("option",{value:"english",children:"English Literature"}),(0,l.jsx)("option",{value:"psychology",children:"Psychology"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Semester *"}),(0,l.jsxs)("select",{name:"semester",value:H.semester,onChange:X,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select Semester"}),(0,l.jsx)("option",{value:"1",children:"1st Semester"}),(0,l.jsx)("option",{value:"2",children:"2nd Semester"}),(0,l.jsx)("option",{value:"3",children:"3rd Semester"}),(0,l.jsx)("option",{value:"4",children:"4th Semester"}),(0,l.jsx)("option",{value:"5",children:"5th Semester"}),(0,l.jsx)("option",{value:"6",children:"6th Semester"}),(0,l.jsx)("option",{value:"7",children:"7th Semester"}),(0,l.jsx)("option",{value:"8",children:"8th Semester"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Batch/Year *"}),(0,l.jsxs)("select",{name:"batch",value:H.batch,onChange:X,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select Batch"}),(0,l.jsx)("option",{value:"2024",children:"2024"}),(0,l.jsx)("option",{value:"2023",children:"2023"}),(0,l.jsx)("option",{value:"2022",children:"2022"}),(0,l.jsx)("option",{value:"2021",children:"2021"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Previous Education"}),(0,l.jsx)("textarea",{name:"previousEducation",value:H.previousEducation,onChange:X,rows:3,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"High School Name, Board/University, Year of Graduation, Percentage/GPA"})]})]});case 4:return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gradient-to-r from-orange-400 to-red-500 rounded-full mx-auto flex items-center justify-center mb-4",children:(0,l.jsx)(w,{className:"w-10 h-10 text-white"})}),(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Account Security"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Create your login credentials"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,l.jsx)("input",{type:c?"text":"password",name:"password",value:H.password,onChange:X,className:"w-full pl-10 pr-12 p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Create a strong password"}),(0,l.jsx)("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?(0,l.jsx)(N.A,{className:"w-5 h-5"}):(0,l.jsx)(S.A,{className:"w-5 h-5"})})]}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"At least 8 characters with uppercase, lowercase, number and special character"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password *"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,l.jsx)("input",{type:m?"text":"password",name:"confirmPassword",value:H.confirmPassword,onChange:X,className:"w-full pl-10 pr-12 p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Confirm your password"}),(0,l.jsx)("button",{type:"button",onClick:()=>g(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:m?(0,l.jsx)(N.A,{className:"w-5 h-5"}):(0,l.jsx)(S.A,{className:"w-5 h-5"})})]}),H.password&&H.confirmPassword&&H.password!==H.confirmPassword&&(0,l.jsx)("p",{className:"text-red-500 text-xs mt-1",children:"Passwords do not match"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Profile Picture"}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"w-20 h-20 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:L?(0,l.jsx)("img",{src:L,alt:"Profile",className:"w-full h-full object-cover"}):(0,l.jsx)(P.A,{className:"w-8 h-8 text-gray-400"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("input",{type:"file",id:"profileImage",accept:"image/*",onChange:Y,className:"hidden"}),(0,l.jsxs)("label",{htmlFor:"profileImage",className:"cursor-pointer bg-blue-500 text-white px-4 py-2 rounded-xl hover:bg-blue-600 transition-colors inline-flex items-center gap-2",children:[(0,l.jsx)(D.A,{className:"w-4 h-4"}),"Upload Photo"]}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG or GIF (max 2MB)"})]})]})]})]});case 5:return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gradient-to-r from-green-400 to-blue-500 rounded-full mx-auto flex items-center justify-center mb-4",children:(0,l.jsx)(P.A,{className:"w-10 h-10 text-white"})}),(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Face Registration"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Capture your face for secure attendance verification"})]}),(0,l.jsx)("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-lg",children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)(b.A,{className:"w-5 h-5 text-blue-400 mr-3 mt-0.5"}),(0,l.jsxs)("div",{className:"text-sm text-blue-700",children:[(0,l.jsx)("p",{className:"font-medium",children:"Important Security Information:"}),(0,l.jsxs)("ul",{className:"mt-2 list-disc list-inside space-y-1",children:[(0,l.jsx)("li",{children:"Your face data will be encrypted and stored securely"}),(0,l.jsx)("li",{children:"This enables automatic attendance verification"}),(0,l.jsx)("li",{children:"Please ensure good lighting and look directly at the camera"}),(0,l.jsx)("li",{children:"Remove any glasses, hats, or face coverings"})]})]})]})}),(0,l.jsx)("div",{className:"max-w-md mx-auto",children:(0,l.jsx)(V,{onFaceRegistered:e=>{G(t=>(0,d.A)((0,d.A)({},t),{},{faceData:e}))},className:"w-full"})}),H.faceData&&(0,l.jsx)("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 rounded-lg",children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)(y.A,{className:"w-5 h-5 text-green-400 mr-3 mt-0.5"}),(0,l.jsxs)("div",{className:"text-sm text-green-700",children:[(0,l.jsx)("p",{className:"font-medium",children:"Face registration completed successfully!"}),(0,l.jsx)("p",{className:"mt-1",children:"Your face profile has been captured and will be used for attendance verification."})]})]})})]});case 6:return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gradient-to-r from-teal-400 to-blue-500 rounded-full mx-auto flex items-center justify-center mb-4",children:(0,l.jsx)(p.A,{className:"w-10 h-10 text-white"})}),(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Emergency Contact"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Someone we can contact in case of emergency"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(R.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,l.jsx)("input",{type:"text",name:"emergencyName",value:H.emergencyName,onChange:X,className:"w-full pl-10 pr-4 p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Jane Doe"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(I.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,l.jsx)("input",{type:"tel",name:"emergencyPhone",value:H.emergencyPhone,onChange:X,className:"w-full pl-10 pr-4 p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"+1 (555) 987-6543"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Relationship *"}),(0,l.jsxs)("select",{name:"emergencyRelation",value:H.emergencyRelation,onChange:X,className:"w-full p-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select Relationship"}),(0,l.jsx)("option",{value:"parent",children:"Parent"}),(0,l.jsx)("option",{value:"guardian",children:"Guardian"}),(0,l.jsx)("option",{value:"sibling",children:"Sibling"}),(0,l.jsx)("option",{value:"spouse",children:"Spouse"}),(0,l.jsx)("option",{value:"relative",children:"Relative"}),(0,l.jsx)("option",{value:"friend",children:"Friend"})]})]})]});case 7:return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gradient-to-r from-green-400 to-blue-500 rounded-full mx-auto flex items-center justify-center mb-4",children:(0,l.jsx)(y.A,{className:"w-10 h-10 text-white"})}),(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Review & Submit"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Please review your information before submitting"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"bg-white/60 rounded-xl p-4 border border-white/50",children:[(0,l.jsxs)("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[(0,l.jsx)(A.A,{className:"w-4 h-4"}),"Personal Information"]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Name:"})," ",H.firstName," ",H.lastName]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Email:"})," ",H.email]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Phone:"})," ",H.phone]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"DOB:"})," ",H.dateOfBirth]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Gender:"})," ",H.gender]})]})]}),(0,l.jsxs)("div",{className:"bg-white/60 rounded-xl p-4 border border-white/50",children:[(0,l.jsxs)("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[(0,l.jsx)(_,{className:"w-4 h-4"}),"Address"]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,l.jsx)("p",{children:H.address}),(0,l.jsxs)("p",{children:[H.city,", ",H.state," ",H.zipCode]}),(0,l.jsx)("p",{children:H.country})]})]}),(0,l.jsxs)("div",{className:"bg-white/60 rounded-xl p-4 border border-white/50",children:[(0,l.jsxs)("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[(0,l.jsx)(f.A,{className:"w-4 h-4"}),"Academic"]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Course:"})," ",H.course]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Semester:"})," ",H.semester]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Batch:"})," ",H.batch]}),H.studentId&&(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Student ID:"})," ",H.studentId]})]})]}),(0,l.jsxs)("div",{className:"bg-white/60 rounded-xl p-4 border border-white/50",children:[(0,l.jsxs)("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[(0,l.jsx)(p.A,{className:"w-4 h-4"}),"Emergency Contact"]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Name:"})," ",H.emergencyName]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Phone:"})," ",H.emergencyPhone]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Relation:"})," ",H.emergencyRelation]})]})]}),(0,l.jsxs)("div",{className:"bg-white/60 rounded-xl p-4 border border-white/50 md:col-span-2",children:[(0,l.jsxs)("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[(0,l.jsx)(P.A,{className:"w-4 h-4"}),"Face Registration"]}),H.faceData?(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[(0,l.jsx)(y.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"font-medium",children:"Face profile captured successfully"})]}):(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-orange-600",children:[(0,l.jsx)(b.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"font-medium",children:"Face registration is required for attendance verification"})]})]})]}),(0,l.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4",children:(0,l.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer",children:[(0,l.jsx)("input",{type:"checkbox",name:"agreeTerms",checked:H.agreeTerms,onChange:X,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2 mt-1"}),(0,l.jsxs)("div",{className:"text-sm text-gray-700",children:["I agree to the ",(0,l.jsx)("button",{type:"button",className:"text-blue-600 hover:underline",children:"Terms of Service"})," and",(0,l.jsx)("button",{type:"button",className:"text-blue-600 hover:underline ml-1",children:"Privacy Policy"}),". I understand that my information will be used for educational purposes and account management."]})]})})]})}})(),(0,l.jsxs)("div",{className:"flex justify-between mt-8 pt-6 border-t border-gray-200",children:[(0,l.jsxs)("button",{type:"button",onClick:()=>{s(e=>Math.max(e-1,1))},disabled:1===i,className:"flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all duration-300 ".concat(1===i?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gray-500 text-white hover:bg-gray-600 hover:shadow-lg"),children:[(0,l.jsx)(M.A,{className:"w-5 h-5"}),"Previous"]}),i<7?(0,l.jsxs)("button",{type:"button",onClick:()=>{if(Q())s(e=>Math.min(e+1,7)),z("");else switch(i){case 1:z("Please fill in all required personal information fields");break;case 2:z("Please complete all address fields");break;case 3:z("Please fill in required academic information");break;case 4:H.email&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(H.email)?!H.password||H.password.length<6?z("Password must be at least 6 characters long"):H.password!==H.confirmPassword?z("Passwords do not match"):z("Please complete all account information"):z("Please enter a valid email address");break;case 5:z("Please capture your face for registration");break;case 6:z("Please fill in emergency contact information");break;case 7:z("Please agree to the terms and conditions");break;default:z("Please fill in all required fields correctly")}},className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all duration-300 transform hover:scale-105",children:["Next",(0,l.jsx)(C,{className:"w-5 h-5"})]}):(0,l.jsx)("button",{type:"button",onClick:async()=>{if(Q()){k(!0),z(""),q("");try{const t={name:"".concat(H.firstName," ").concat(H.lastName),email:H.email,role:"student",studentId:H.studentId||null,phone:H.phone,dateOfBirth:H.dateOfBirth,gender:H.gender,bloodGroup:H.bloodGroup,address:{street:H.address,city:H.city,state:H.state,zipCode:H.zipCode,country:H.country},academic:{course:H.course,semester:H.semester,batch:H.batch,previousEducation:H.previousEducation},emergencyContact:{name:H.emergencyName,phone:H.emergencyPhone,relation:H.emergencyRelation},faceData:H.faceData||null};console.log("\ud83d\udd0d Attempting registration with:",{email:H.email,name:t.name});const a=await(0,o.DY)(H.email,H.password,t);if(a.success){try{if(H.faceData){const e=await(0,F.u1)(a.user.uid,H.faceData,{studentId:t.studentId||a.user.uid,name:t.name,email:t.email});e.success||console.warn("Face encoding save failed:",e.error)}}catch(e){console.warn("Face encoding save threw an error:",e)}q("Registration successful! Please sign in with your new account."),n&&n(a.user),setTimeout(()=>{r&&r()},2e3)}else z(a.error)}catch(U){z(U.message)}finally{k(!1)}}else z("Please complete all required fields and agree to terms")},disabled:E||!H.agreeTerms,className:"flex items-center gap-2 px-8 py-3 rounded-xl font-semibold transition-all duration-300 ".concat(E||!H.agreeTerms?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gradient-to-r from-green-500 to-blue-600 text-white hover:shadow-lg transform hover:scale-105"),children:E?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Submitting..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.A,{className:"w-5 h-5"}),"Register"]})})]})]}),(0,l.jsxs)("div",{className:"mt-6 text-center",children:[(0,l.jsxs)("p",{className:"text-gray-600 text-sm mb-2",children:["Already have an account?",(0,l.jsx)("button",{onClick:()=>r&&r(),className:"text-blue-600 hover:text-blue-800 font-medium ml-1 hover:underline",children:"Sign In"})]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"Need help? Contact our support team at support@edumanagepro.com"})]})]})]})]})};var q=n(9493),H=n(1360),G=n(2681);const K=(0,m.A)("school",[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);var X=n(5088);const Y=(0,m.A)("circle-stop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]);var Q=n(7104),$=n(9292);const J=(0,m.A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var Z=n(1565),ee=n(253),te=n(1994);const ne=t=>{let{onLogout:n}=t;const{userData:s}=(0,a.A)(),{confirmDialog:c,showSuccess:u,showError:d}=(0,i.E$)(),h=(0,r.Zp)(),[f,m]=(0,e.useState)(!1),[v,b]=(0,e.useState)([]),[x,w]=(0,e.useState)(null),[N,E]=(0,e.useState)([]),[C,k]=(0,e.useState)([]),[_,j]=(0,e.useState)(!1),[I,P]=(0,e.useState)(""),[D,R]=(0,e.useState)(""),[M,F]=(0,e.useState)("all"),L=e=>{if(!e)return"N/A";return(e.toDate?e.toDate():new Date(e)).toLocaleDateString()},B=e=>{if(!e)return"N/A";return(e.toDate?e.toDate():new Date(e)).toLocaleTimeString()},z=(()=>{const e=N.length,t=N.filter(e=>"present"===e.status||!e.status).length,n=N.filter(e=>"late"===e.status).length;return{total:e,present:t,late:n,absent:e-t-n}})();(0,e.useEffect)(()=>{if(null!==s&&void 0!==s&&s.uid){V(),W();const e=setInterval(V,3e4);return()=>clearInterval(e)}},[s]),(0,e.useEffect)(()=>{if(null!==x&&void 0!==x&&x.sessionId){ne(x.sessionId);const e=setInterval(()=>{ne(x.sessionId)},1e4);return()=>clearInterval(e)}},[x]);const V=async()=>{j(!0);try{const e=await(0,ee.mt)(s.uid);e.success?b(e.sessions):P(e.error)}catch(I){P("Failed to load sessions")}j(!1)},W=async()=>{try{console.log("Loading classrooms for teacher dashboard");const e=await(0,te.fA)(s.uid);e.success?(k(e.classrooms),console.log("Classrooms loaded:",e.classrooms)):console.error("Failed to load classrooms:",e.error)}catch(I){console.error("Error loading classrooms:",I)}},ne=async e=>{try{console.log("\ud83d\udd04 Loading attendance for session:",e);const t=await(0,ee.Q8)(e);t.success?(console.log("\u2705 Loaded attendance records:",t.records),E(t.records)):(console.error("\u274c Failed to load attendance:",t.error),P(t.error))}catch(I){console.error("\u274c Failed to load attendance:",I),P("Failed to load attendance data")}},re=N.filter(e=>{var t,n;const r=(null===(t=e.studentName)||void 0===t?void 0:t.toLowerCase().includes(D.toLowerCase()))||(null===(n=e.studentId)||void 0===n?void 0:n.toLowerCase().includes(D.toLowerCase())),a="all"===M||e.status===M||"present"===M&&!e.status;return r&&a});return(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 safe-area-top safe-area-bottom",children:[(0,l.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,l.jsx)("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-purple-200 to-pink-200 rounded-full opacity-20 blur-3xl"}),(0,l.jsx)("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-br from-blue-200 to-purple-200 rounded-full opacity-20 blur-3xl"})]}),(0,l.jsxs)("div",{className:"relative z-10 p-4 sm:p-6",children:[(0,l.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl sm:rounded-3xl p-4 sm:p-6 shadow-xl border border-white/50 mb-6 sm:mb-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4 min-w-0 flex-1",children:[(0,l.jsx)("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gradient-to-r from-blue-100 to-purple-100 rounded-xl sm:rounded-2xl flex items-center justify-center flex-shrink-0",children:(0,l.jsx)(A.A,{className:"w-6 h-6 sm:w-8 sm:h-8 text-blue-600"})}),(0,l.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,l.jsxs)("h1",{className:"text-lg sm:text-2xl lg:text-3xl font-bold text-gray-800",children:["Welcome, ",(null===s||void 0===s?void 0:s.firstName)||"Teacher","!"]}),(0,l.jsx)("p",{className:"text-sm sm:text-base lg:text-lg text-gray-600 hidden sm:block",children:"Manage your class attendance efficiently"}),(0,l.jsx)("p",{className:"text-xs text-gray-600 sm:hidden",children:"Attendance Management"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0",children:[(0,l.jsx)("button",{onClick:()=>V(),className:"bg-blue-100 text-blue-700 p-2 sm:p-3 rounded-xl hover:bg-blue-200 transition-all duration-300",title:"Refresh",children:(0,l.jsx)(U.A,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),(0,l.jsx)("button",{onClick:async()=>{try{await(0,o.y4)(),n&&n()}catch(I){console.error("Logout error:",I)}},className:"bg-red-100 text-red-700 p-2 sm:p-3 rounded-xl hover:bg-red-200 transition-all duration-300",title:"Logout",children:(0,l.jsx)(q.A,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]})}),I&&(0,l.jsx)("div",{className:"bg-red-100 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-4 sm:mb-6 text-sm sm:text-base",children:I}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6 lg:gap-8",children:[(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-green-100 to-blue-100 rounded-xl flex items-center justify-center",children:(0,l.jsx)(H.A,{className:"w-6 h-6 text-green-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Quick Actions"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Create new attendance session"})]})]}),(0,l.jsx)("button",{onClick:()=>m(!0),className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-4 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300",children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,l.jsx)(G.A,{className:"w-5 h-5"}),"Generate QR Code"]})}),(0,l.jsx)("button",{onClick:()=>h("/teacher/classrooms"),className:"w-full bg-gradient-to-r from-green-500 to-teal-600 text-white py-4 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300",children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,l.jsx)(K,{className:"w-5 h-5"}),"Manage Classrooms"]})})]}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-orange-100 to-red-100 rounded-xl flex items-center justify-center",children:(0,l.jsx)(X.A,{className:"w-6 h-6 text-orange-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Active Sessions"}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:[v.length," active sessions"]})]})]}),_?(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto"}),(0,l.jsx)("p",{className:"text-gray-600 mt-2",children:"Loading sessions..."})]}):0===v.length?(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)(G.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"No active sessions"}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Create a QR code to start"})]}):(0,l.jsx)("div",{className:"space-y-3",children:v.map(e=>{var t;return(0,l.jsxs)("div",{className:"bg-white/60 rounded-2xl p-4 border border-white/50 hover:shadow-lg transition-all duration-300",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsx)("h4",{className:"font-semibold text-gray-800",children:e.subject}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("button",{onClick:()=>(async e=>{w(e),await ne(e.sessionId)})(e),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-lg text-sm hover:bg-blue-200 transition-colors flex items-center gap-1",children:[(0,l.jsx)(S.A,{className:"w-3 h-3"}),"View"]}),(0,l.jsxs)("button",{onClick:()=>(async e=>{if(await c("End Session","Are you sure you want to end this session? This action cannot be undone."))try{const t=await(0,ee.lz)(e);t.success?(u("Session ended successfully"),await V(),(null===x||void 0===x?void 0:x.sessionId)===e&&(w(null),E([]))):d(t.error||"Failed to end session")}catch(I){console.error("Error ending session:",I),d("Failed to end session. Please try again.")}})(e.sessionId),className:"px-3 py-1 bg-red-100 text-red-700 rounded-lg text-sm hover:bg-red-200 transition-colors flex items-center gap-1",children:[(0,l.jsx)(Y,{className:"w-3 h-3"}),"End"]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,l.jsx)(T.A,{className:"w-3 h-3"}),L(e.createdAt)]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,l.jsx)(X.A,{className:"w-3 h-3"}),B(e.createdAt)]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,l.jsx)(O.A,{className:"w-3 h-3"}),(null===(t=e.location)||void 0===t?void 0:t.address)||"Manual Location"]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,l.jsx)(p.A,{className:"w-3 h-3"}),e.attendeeCount||0," students"]})]})]},e.id)})})]}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50",children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Attendance Overview"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"bg-green-100 rounded-xl p-4 text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-green-600",children:z.present}),(0,l.jsx)("div",{className:"text-sm text-green-700",children:"Present"})]}),(0,l.jsxs)("div",{className:"bg-red-100 rounded-xl p-4 text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-red-600",children:z.absent}),(0,l.jsx)("div",{className:"text-sm text-red-700",children:"Absent"})]}),(0,l.jsxs)("div",{className:"bg-yellow-100 rounded-xl p-4 text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:z.late}),(0,l.jsx)("div",{className:"text-sm text-yellow-700",children:"Late"})]}),(0,l.jsxs)("div",{className:"bg-blue-100 rounded-xl p-4 text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:z.total}),(0,l.jsx)("div",{className:"text-sm text-blue-700",children:"Total"})]})]})]})]}),(0,l.jsx)("div",{className:"xl:col-span-2",children:(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50 h-full",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-green-100 to-blue-100 rounded-xl flex items-center justify-center",children:(0,l.jsx)(p.A,{className:"w-6 h-6 text-green-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-2xl font-bold text-gray-800",children:x?"".concat(x.subject," - Attendance"):"Select a Session"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:x?"Track student attendance status":"Choose a session to view details"})]})]}),x&&(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{className:"bg-blue-500 text-white p-2 rounded-xl hover:bg-blue-600 transition-all duration-300",children:(0,l.jsx)(Q.A,{className:"w-5 h-5"})}),(0,l.jsx)("button",{onClick:()=>ne(x.sessionId),className:"bg-gray-200 text-gray-700 p-2 rounded-xl hover:bg-gray-300 transition-all duration-300",children:(0,l.jsx)(U.A,{className:"w-5 h-5"})})]})]}),x?(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:[(0,l.jsx)("h4",{className:"font-semibold text-blue-800 mb-2",children:x.subject}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-blue-700",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(T.A,{className:"w-4 h-4"}),"Started: ",B(x.createdAt)]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(p.A,{className:"w-4 h-4"}),"Attendees: ",x.attendeeCount||0]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(g,{className:"w-4 h-4"}),"Session: ",x.sessionId]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(X.A,{className:"w-4 h-4"}),"Status: ",x.isActive?"Active":"Ended"]})]})]}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsxs)("div",{className:"flex-1 relative",children:[(0,l.jsx)($.A,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,l.jsx)("input",{type:"text",placeholder:"Search students...",value:D,onChange:e=>R(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,l.jsxs)("select",{value:M,onChange:e=>F(e.target.value),className:"px-4 py-3 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"all",children:"All Status"}),(0,l.jsx)("option",{value:"present",children:"Present"}),(0,l.jsx)("option",{value:"absent",children:"Absent"}),(0,l.jsx)("option",{value:"late",children:"Late"})]})]}),(0,l.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:0===re.length?(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)(p.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"No attendance records found"}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:D||"all"!==M?"Try adjusting your search or filter":"Students will appear here after scanning QR codes"})]}):re.map(e=>(0,l.jsx)("div",{className:"bg-white/60 rounded-2xl p-4 border border-white/50 hover:shadow-lg transition-all duration-300",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full flex items-center justify-center",children:(0,l.jsx)(A.A,{className:"w-6 h-6 text-blue-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-semibold text-gray-800",children:e.studentName}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.studentId})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("div",{className:"text-sm font-semibold text-gray-700",children:B(e.markedAt)}),(0,l.jsx)("div",{className:"text-xs text-gray-500",children:"Check-in Time"})]}),(0,l.jsxs)("div",{className:"px-4 py-2 rounded-full text-sm font-semibold flex items-center gap-2 ".concat(e.status&&"present"!==e.status?"late"===e.status?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700":"bg-green-100 text-green-700"),children:[(!e.status||"present"===e.status)&&(0,l.jsx)(y.A,{className:"w-4 h-4"}),"absent"===e.status&&(0,l.jsx)(J,{className:"w-4 h-4"}),"late"===e.status&&(0,l.jsx)(X.A,{className:"w-4 h-4"}),(e.status||"Present").charAt(0).toUpperCase()+(e.status||"Present").slice(1)]})]})]})},e.id))})]}):(0,l.jsxs)("div",{className:"text-center py-16",children:[(0,l.jsx)(p.A,{className:"w-20 h-20 text-gray-300 mx-auto mb-6"}),(0,l.jsx)("h4",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No Session Selected"}),(0,l.jsx)("p",{className:"text-gray-500 mb-6",children:"Select an active session from the left panel to view attendance details"}),(0,l.jsx)("button",{onClick:()=>m(!0),className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300",children:"Create New Session"})]})]})})]})]}),(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-2xl font-bold text-gray-800",children:"My Classrooms"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Click on a classroom to view details and manage subjects"})]}),(0,l.jsxs)("button",{onClick:()=>h("/teacher/classrooms"),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,l.jsx)(H.A,{className:"w-4 h-4"}),"Add New"]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[C.map(e=>{var t;return(0,l.jsxs)("div",{onClick:()=>h("/teacher/classroom/".concat(e.id)),className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-white/50 hover:shadow-xl transform hover:scale-105 transition-all duration-300 cursor-pointer group",children:[(0,l.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-green-100 to-blue-100 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform",children:(0,l.jsx)(K,{className:"w-6 h-6 text-green-600"})})}),(0,l.jsx)("h4",{className:"text-xl font-bold text-gray-800 mb-2",children:e.name}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Code:"}),(0,l.jsx)("span",{className:"font-mono font-semibold text-blue-600",children:e.code||"N/A"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Students:"}),(0,l.jsx)("span",{className:"font-semibold text-gray-800",children:e.studentCount||0})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Subjects:"}),(0,l.jsx)("span",{className:"font-semibold text-gray-800",children:(null===(t=e.subjects)||void 0===t?void 0:t.length)||0})]})]}),(0,l.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,l.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,l.jsx)("span",{children:"Academic Year"}),(0,l.jsx)("span",{children:e.academicYear||"N/A"})]})})]},e.id)}),0===C.length&&(0,l.jsxs)("div",{className:"col-span-full text-center py-16",children:[(0,l.jsx)(K,{className:"w-20 h-20 text-gray-300 mx-auto mb-6"}),(0,l.jsx)("h4",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No Classrooms Yet"}),(0,l.jsx)("p",{className:"text-gray-500 mb-6",children:"Create your first classroom to get started"}),(0,l.jsx)("button",{onClick:()=>h("/teacher/classrooms"),className:"bg-gradient-to-r from-green-500 to-blue-600 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300",children:"Create Classroom"})]})]})]}),f&&(0,l.jsx)(Z.default,{onClose:()=>{m(!1),V()}})]})};var re=n(4919);const ae=(0,m.A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);var ie=n(4537),oe=n(9233),se=n(7365),le=n(8777),ce=n(9637);const ue={requestLocationPermission:async()=>new Promise((e,t)=>{if(console.log("\ud83c\udf0d Checking geolocation support..."),!navigator.geolocation)return console.error("\u274c Geolocation not supported"),void t(new Error("Geolocation is not supported by this browser"));console.log("\u2705 Geolocation is supported, requesting permission..."),navigator.geolocation.getCurrentPosition(t=>{console.log("\u2705 Location permission granted:",{lat:t.coords.latitude.toFixed(6),lon:t.coords.longitude.toFixed(6),accuracy:t.coords.accuracy}),e("granted")},e=>{switch(console.error("\u274c Location permission error:",{code:e.code,message:e.message,PERMISSION_DENIED:e.PERMISSION_DENIED,POSITION_UNAVAILABLE:e.POSITION_UNAVAILABLE,TIMEOUT:e.TIMEOUT}),e.code){case e.PERMISSION_DENIED:t(new Error("Location access denied by user. Please enable location permissions in your browser settings."));break;case e.POSITION_UNAVAILABLE:t(new Error("Location information unavailable. Please check your GPS settings."));break;case e.TIMEOUT:t(new Error("Location request timed out. Please try again."));break;default:t(new Error("Unknown location error (code: ".concat(e.code,"): ").concat(e.message)))}},{timeout:1e4,maximumAge:6e4,enableHighAccuracy:!1})}),getCurrentPosition:()=>new Promise((e,t)=>{if(console.log("\ud83c\udf0d Getting current position..."),!navigator.geolocation)return console.error("\u274c Geolocation not supported"),void t(new Error("Geolocation is not supported by this browser"));const n={enableHighAccuracy:!0,timeout:2e4,maximumAge:3e4};console.log("\ud83d\udccd Requesting location with options:",n),navigator.geolocation.getCurrentPosition(t=>{const n={latitude:t.coords.latitude,longitude:t.coords.longitude,accuracy:t.coords.accuracy,timestamp:t.timestamp};console.log("\u2705 Location obtained:",{lat:n.latitude.toFixed(6),lon:n.longitude.toFixed(6),accuracy:n.accuracy+"m",timestamp:new Date(n.timestamp).toLocaleTimeString()}),e(n)},e=>{console.error("\u274c getCurrentPosition error:",{code:e.code,message:e.message,PERMISSION_DENIED:e.PERMISSION_DENIED,POSITION_UNAVAILABLE:e.POSITION_UNAVAILABLE,TIMEOUT:e.TIMEOUT});let n="Unable to get location";switch(e.code){case e.PERMISSION_DENIED:n="Location access denied by user";break;case e.POSITION_UNAVAILABLE:n="Location information unavailable";break;case e.TIMEOUT:n="Location request timed out"}t(new Error(n))},n)}),requestPermission:async()=>{try{if("permissions"in navigator){return(await navigator.permissions.query({name:"geolocation"})).state}return"prompt"}catch(e){return"prompt"}},calculateDistance:(e,t,n,r)=>{const a=(n-e)*Math.PI/180,i=(r-t)*Math.PI/180,o=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))*1e3},verifyLocation:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;console.log("\ud83d\udccf Verifying location distance..."),console.log("\ud83d\udc64 Student location:",{lat:e.latitude,lon:e.longitude}),console.log("\ud83c\udfeb Class location:",{lat:t.latitude,lon:t.longitude});const r=e.accuracy||0,a=Math.max(n,2*r);console.log("\ud83d\udcd0 Base tolerance:",n+"m"),console.log("\ud83d\udcf1 GPS accuracy:",r+"m"),console.log("\ud83d\udcd0 Adjusted tolerance:",a+"m");const i=ue.calculateDistance(e.latitude,e.longitude,t.latitude,t.longitude),o={isValid:i<=a,distance:Math.round(i),tolerance:Math.round(a),accuracy:e.accuracy,baseToleranceUsed:n,gpsAccuracyConsidered:r};return console.log("\ud83d\udcca Distance calculation result:",o),o}},de=ue,he=e=>{var t,n,r,i;let{onBack:o}=e;const{userData:s}=(0,a.A)();return(0,l.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,l.jsx)("button",{onClick:o,className:"p-2 bg-white/70 rounded-xl border border-white/50 hover:bg-white/90 transition-all duration-300",children:(0,l.jsx)(M.A,{className:"w-5 h-5 text-gray-600"})}),(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Profile"})]}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-8 shadow-xl border border-white/50",children:[(0,l.jsxs)("div",{className:"flex items-center gap-6 mb-8",children:[(0,l.jsx)("div",{className:"w-24 h-24 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full flex items-center justify-center",children:(0,l.jsx)(A.A,{className:"w-12 h-12 text-blue-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:(null===s||void 0===s?void 0:s.name)||"Student Name"}),(0,l.jsx)("p",{className:"text-gray-600",children:(null===s||void 0===s?void 0:s.studentId)||"ST2024001"}),(0,l.jsx)("p",{className:"text-gray-600",children:(null===s||void 0===s||null===(t=s.academic)||void 0===t?void 0:t.course)||"Computer Science - Final Year"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Personal Information"}),(0,l.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white/60 rounded-xl",children:[(0,l.jsx)(x.A,{className:"w-5 h-5 text-blue-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Email"}),(0,l.jsx)("p",{className:"font-medium text-gray-800",children:(null===s||void 0===s?void 0:s.email)||"student@example.com"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white/60 rounded-xl",children:[(0,l.jsx)(I.A,{className:"w-5 h-5 text-green-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Phone"}),(0,l.jsx)("p",{className:"font-medium text-gray-800",children:(null===s||void 0===s?void 0:s.phone)||"+1 (555) 123-4567"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white/60 rounded-xl",children:[(0,l.jsx)(T.A,{className:"w-5 h-5 text-purple-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Date of Birth"}),(0,l.jsx)("p",{className:"font-medium text-gray-800",children:(null===s||void 0===s?void 0:s.dateOfBirth)||"January 15, 2000"})]})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Academic Information"}),(0,l.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white/60 rounded-xl",children:[(0,l.jsx)(A.A,{className:"w-5 h-5 text-orange-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Department"}),(0,l.jsx)("p",{className:"font-medium text-gray-800",children:(null===s||void 0===s||null===(n=s.academic)||void 0===n?void 0:n.department)||"Computer Science"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white/60 rounded-xl",children:[(0,l.jsx)(T.A,{className:"w-5 h-5 text-red-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Year"}),(0,l.jsx)("p",{className:"font-medium text-gray-800",children:(null===s||void 0===s||null===(r=s.academic)||void 0===r?void 0:r.year)||"Final Year"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white/60 rounded-xl",children:[(0,l.jsx)(O.A,{className:"w-5 h-5 text-pink-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Campus"}),(0,l.jsx)("p",{className:"font-medium text-gray-800",children:(null===s||void 0===s||null===(i=s.academic)||void 0===i?void 0:i.campus)||"Main Campus"})]})]})]})]})]}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Account Settings"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsx)("button",{className:"p-4 bg-blue-100 hover:bg-blue-200 rounded-xl text-blue-700 font-medium transition-colors",children:"Change Password"}),(0,l.jsx)("button",{className:"p-4 bg-green-100 hover:bg-green-200 rounded-xl text-green-700 font-medium transition-colors",children:"Update Profile"}),(0,l.jsx)("button",{className:"p-4 bg-purple-100 hover:bg-purple-200 rounded-xl text-purple-700 font-medium transition-colors",children:"Privacy Settings"}),(0,l.jsx)("button",{className:"p-4 bg-orange-100 hover:bg-orange-200 rounded-xl text-orange-700 font-medium transition-colors",children:"Notification Preferences"})]})]})]})},fe=t=>{var n;let{onLogout:r}=t;const{userData:s}=(0,a.A)(),{showSuccess:c,showError:u,showWarning:h,showInfo:p}=(0,i.E$)(),[m,g]=(0,e.useState)("home"),[v,b]=(0,e.useState)({name:(null===s||void 0===s?void 0:s.name)||"John Doe",id:(null===s||void 0===s?void 0:s.studentId)||"ST2024001",class:(null===s||void 0===s||null===(n=s.academic)||void 0===n?void 0:n.course)||"Computer Science - Final Year",profileImage:"/api/placeholder/80/80"}),[x,w]=(0,e.useState)({qrScanned:!1,locationVerified:!1,faceVerified:!1,sessionData:null}),[N,E]=(0,e.useState)(!1),[C,k]=(0,e.useState)(""),[_,I]=(0,e.useState)([]),[P,D]=(0,e.useState)(!1),[R,M]=(0,e.useState)([]),[F,L]=(0,e.useState)([]),[B,U]=(0,e.useState)(!0),[z,V]=(0,e.useState)(null);(0,e.useEffect)(()=>{(async()=>{if(null!==s&&void 0!==s&&s.studentId||null!==s&&void 0!==s&&s.uid){U(!0);try{const e=s.studentId||s.uid,t=await(0,ee.OR)(e);if(t.success){const e=t.recentAttendance.map(e=>({date:e.date.toISOString().split("T")[0],subject:e.subject,status:e.status.toLowerCase(),time:e.time})),n=t.subjectPerformance.map(e=>({subject:e.subject,totalMarks:100,obtainedMarks:e.performancePercentage,percentage:e.performancePercentage,grade:e.grade,attendancePercentage:e.attendancePercentage}));M(e),L(n),V(null)}else V(t.error),M([{date:"2024-09-12",subject:"Data Structures",status:"present",time:"09:15 AM"},{date:"2024-09-11",subject:"Web Development",status:"present",time:"10:30 AM"},{date:"2024-09-10",subject:"Database Systems",status:"late",time:"09:45 AM"},{date:"2024-09-09",subject:"Software Engineering",status:"present",time:"11:15 AM"},{date:"2024-09-08",subject:"Machine Learning",status:"absent",time:"-"}]),L([{subject:"Data Structures",totalMarks:100,obtainedMarks:85,percentage:85,grade:"A"},{subject:"Web Development",totalMarks:100,obtainedMarks:92,percentage:92,grade:"A+"},{subject:"Database Systems",totalMarks:100,obtainedMarks:78,percentage:78,grade:"B+"},{subject:"Software Engineering",totalMarks:100,obtainedMarks:88,percentage:88,grade:"A"},{subject:"Machine Learning",totalMarks:100,obtainedMarks:75,percentage:75,grade:"B"}])}catch(e){console.error("Error loading dashboard data:",e),V(e.message)}finally{U(!1)}}})(),Y()},[s]);const W=async()=>{if(null!==s&&void 0!==s&&s.studentId||null!==s&&void 0!==s&&s.uid){const t=s.studentId||s.uid;try{const[e,n]=await Promise.all([(0,ee.Dl)(t),(0,ee.ih)(t)]);if(e.success&&n.success){c("Sample data added successfully! Refreshing dashboard...");const e=await(0,ee.OR)(t);if(e.success){const t=e.recentAttendance.map(e=>({date:e.date.toISOString().split("T")[0],subject:e.subject,status:e.status.toLowerCase(),time:e.time})),n=e.subjectPerformance.map(e=>({subject:e.subject,totalMarks:100,obtainedMarks:e.performancePercentage,percentage:e.performancePercentage,grade:e.grade,attendancePercentage:e.attendancePercentage}));M(t),L(n)}}else u("Error adding sample data: "+(e.error||n.error))}catch(e){console.error("Error adding sample data:",e),u("Error adding sample data: "+e.message)}}},Y=async()=>{if(null!==s&&void 0!==s&&s.studentId||null!==s&&void 0!==s&&s.uid){const t=s.studentId||s.uid;try{const e=await(0,te.if)(t);e.success?I(e.classrooms):console.error("Error loading classrooms:",e.error)}catch(e){console.error("Error loading classrooms:",e)}}},Q=((0,e.useRef)(null),{total:R.length,present:R.filter(e=>"present"===e.status).length,late:R.filter(e=>"late"===e.status).length,absent:R.filter(e=>"absent"===e.status).length}),$=Math.round((Q.present+Q.late)/Q.total*100),Z=Math.round(F.reduce((e,t)=>e+t.percentage,0)/F.length),ne=async()=>{g("scan")},ue=async e=>{let t;console.log("\ud83d\udcf1 QR scan successful, raw data:",e);try{t="string"===typeof e?JSON.parse(e):e,console.log("\ud83d\udcca Parsed session data:",t)}catch(n){return console.error("\u274c Error parsing QR data:",n),u("Invalid QR code data. Please scan a valid attendance QR code."),void g("home")}if(!t.sessionId||!t.location)return console.error("\u274c Invalid session data structure:",t),u("Invalid QR code. Missing session or location data."),void g("home");console.log("\u2705 QR data validation passed"),w(e=>(0,d.A)((0,d.A)({},e),{},{qrScanned:!0,sessionData:t})),g("location"),await pe(t)},fe=e=>{console.error("QR scan error:",e),u("Failed to scan QR code. Please try again."),g("home")},pe=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;console.log("\ud83c\udfeb Starting location verification...");try{var t;console.log("\ud83d\udd10 Requesting location permission...");try{await de.requestLocationPermission(),console.log("\u2705 Location permission granted")}catch(n){return console.error("\u274c Location permission error:",n.message),u(n.message),void g("home")}console.log("\ud83d\udccd Getting student location...");const r=await de.getCurrentPosition();console.log("\u2705 Student location obtained:",r);const a=e?e.location:null===(t=x.sessionData)||void 0===t?void 0:t.location;if(!a)return console.error("\u274c Session location not available"),u("Session location data not found. Please try scanning the QR code again."),void g("home");console.log("\ud83c\udfaf Session location:",a);const i=de.verifyLocation(r,a,100);console.log("\ud83d\udccf Distance verification result:",i),i.isValid?(console.log("\u2705 Location verification successful"),console.log("\ud83d\udd04 Setting step to face recognition..."),w(t=>(0,d.A)((0,d.A)({},t),{},{locationVerified:!0,studentLocation:r,sessionData:e||t.sessionData})),g("face"),console.log("\ud83d\udc64 Face recognition step set")):(console.log("\u274c Location verification failed - too far away"),console.log("\ud83d\uddfa\ufe0f Detailed location info:"),console.log("   Student coordinates:","".concat(r.latitude,", ").concat(r.longitude)),console.log("   Session coordinates:","".concat(a.latitude,", ").concat(a.longitude)),console.log("   Distance calculated:","".concat(i.distance,"m")),console.log("   Tolerance allowed:","".concat(i.tolerance,"m")),console.log("   GPS accuracy:","".concat(r.accuracy,"m")),u("Location Verification Failed\n\n"+"Calculated distance: ".concat(i.distance,"m\n")+"Tolerance used: ".concat(i.tolerance,"m\n")+"GPS accuracy: \xb1".concat(Math.round(r.accuracy),"m\n")+"Base tolerance: ".concat(i.baseToleranceUsed,"m\n\n")+"Note: Tolerance was ".concat(i.gpsAccuracyConsidered>i.baseToleranceUsed?"adjusted for GPS accuracy":"kept at base value","\n\n")+"Please ensure you are in the correct classroom location."),g("home"))}catch(r){console.error("\u274c Location verification error:",r),r.message.includes("denied")?u("Location access denied. Please enable location permissions in your browser settings and try again."):r.message.includes("unavailable")?u("Location information unavailable. Please check your GPS and try again."):r.message.includes("timeout")?u("Location request timed out. Please try again."):u("Location verification failed. Please ensure location is enabled and try again."),g("home")}},me=async()=>{try{if(console.log("\ud83c\udfaf Starting markStudentAttendance..."),console.log("\ud83d\udcca Session Data:",x.sessionData),console.log("\ud83d\udc64 User Data:",s),console.log("\ud83d\udccd Student Location:",x.studentLocation),console.log("\u2705 Location Verified:",x.locationVerified),console.log("\ud83d\udd0d Face Verified:",x.faceVerified),!x.sessionData)return console.error("\u274c No session data available"),void u("Session data not available");if(!s)return console.error("\u274c No user data available"),void u("User data not available");console.log("\ud83d\udd04 Calling markAttendance API...");const e=await(0,ee.rq)(x.sessionData.sessionId,{studentId:s.studentId||s.uid,name:s.firstName&&s.lastName?"".concat(s.firstName," ").concat(s.lastName):s.name||"Student",email:s.email},{location:x.studentLocation,locationVerified:!!x.locationVerified,qrVerified:!!x.qrScanned,faceVerified:!!x.faceVerified});if(console.log("\u2705 Attendance result:",e),!e.success)throw console.error("\u274c Attendance marking failed:",e.error),new Error(e.error||"Failed to mark attendance");{console.log("\ud83c\udf89 Attendance marked successfully!");const e={date:(new Date).toISOString().split("T")[0],subject:x.sessionData.subject,status:"present",time:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};console.log("\ud83d\udcdd Adding new attendance record:",e),M(t=>[e,...t]),console.log("\ud83c\udfaf Setting step to success..."),g("success"),setTimeout(()=>{console.log("\ud83d\udd04 Resetting attendance process after success..."),g("home"),w({qrScanned:!1,locationVerified:!1,faceVerified:!1,sessionData:null})},3e3)}}catch(e){console.error("Error marking attendance:",e),u("Failed to mark attendance. Please try again."),g("home")}},ge=()=>(0,l.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[(0,l.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl sm:rounded-3xl p-4 sm:p-6 shadow-xl border border-white/50",children:(0,l.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gradient-to-r from-green-100 to-blue-100 rounded-xl sm:rounded-2xl flex items-center justify-center",children:(0,l.jsx)(T.A,{className:"w-6 h-6 sm:w-8 sm:h-8 text-green-600"})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:[$,"%"]}),(0,l.jsx)("div",{className:"text-sm sm:text-base text-gray-600",children:"Attendance Rate"}),(0,l.jsxs)("div",{className:"text-xs sm:text-sm text-gray-500",children:[Q.present+Q.late,"/",Q.total," Classes"]})]})]})}),(0,l.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl sm:rounded-3xl p-4 sm:p-6 shadow-xl border border-white/50",children:(0,l.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl sm:rounded-2xl flex items-center justify-center",children:(0,l.jsx)(re.A,{className:"w-6 h-6 sm:w-8 sm:h-8 text-purple-600"})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:[Z,"%"]}),(0,l.jsx)("div",{className:"text-sm sm:text-base text-gray-600",children:"Overall Grade"}),(0,l.jsxs)("div",{className:"text-xs sm:text-sm text-gray-500",children:["Across ",F.length," subjects"]})]})]})}),(0,l.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl sm:rounded-3xl p-4 sm:p-6 shadow-xl border border-white/50 sm:col-span-2 lg:col-span-1",children:(0,l.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gradient-to-r from-orange-100 to-red-100 rounded-xl sm:rounded-2xl flex items-center justify-center",children:(0,l.jsx)(ae,{className:"w-6 h-6 sm:w-8 sm:h-8 text-orange-600"})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("div",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:"4.2"}),(0,l.jsx)("div",{className:"text-sm sm:text-base text-gray-600",children:"CGPA"}),(0,l.jsx)("div",{className:"text-xs sm:text-sm text-gray-500",children:"Current Semester"})]})]})})]}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl sm:rounded-3xl p-4 sm:p-6 shadow-xl border border-white/50",children:[(0,l.jsx)("h3",{className:"text-xl sm:text-2xl font-bold text-gray-800 mb-4 sm:mb-6",children:"Quick Actions"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[(0,l.jsx)("button",{onClick:ne,className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4 sm:p-6 rounded-xl sm:rounded-2xl font-semibold hover:shadow-lg transition-all duration-300 transform hover:scale-105",children:(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-3 sm:gap-4",children:[(0,l.jsx)(G.A,{className:"w-6 h-6 sm:w-8 sm:h-8"}),(0,l.jsxs)("div",{className:"text-center sm:text-left",children:[(0,l.jsx)("div",{className:"text-base sm:text-lg",children:"Mark Attendance"}),(0,l.jsx)("div",{className:"text-xs sm:text-sm opacity-90",children:"Scan QR code to check in"})]})]})}),(0,l.jsx)("button",{onClick:W,className:"bg-gradient-to-r from-orange-500 to-red-600 text-white p-4 sm:p-6 rounded-xl sm:rounded-2xl font-semibold hover:shadow-lg transition-all duration-300 transform hover:scale-105",children:(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-3 sm:gap-4",children:[(0,l.jsx)(ie.A,{className:"w-6 h-6 sm:w-8 sm:h-8"}),(0,l.jsxs)("div",{className:"text-center sm:text-left",children:[(0,l.jsx)("div",{className:"text-base sm:text-lg",children:"Add Test Data"}),(0,l.jsx)("div",{className:"text-xs sm:text-sm opacity-90",children:"Load sample attendance"})]})]})}),(0,l.jsx)("button",{onClick:()=>E(!0),className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white p-4 sm:p-6 rounded-xl sm:rounded-2xl font-semibold hover:shadow-lg transition-all duration-300 transform hover:scale-105",children:(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-3 sm:gap-4",children:[(0,l.jsx)(K,{className:"w-6 h-6 sm:w-8 sm:h-8"}),(0,l.jsxs)("div",{className:"text-center sm:text-left",children:[(0,l.jsx)("div",{className:"text-base sm:text-lg",children:"Join Classroom"}),(0,l.jsx)("div",{className:"text-xs sm:text-sm opacity-90",children:"Enter classroom code"})]})]})}),(0,l.jsx)("button",{className:"bg-gradient-to-r from-purple-500 to-pink-600 text-white p-4 sm:p-6 rounded-xl sm:rounded-2xl font-semibold hover:shadow-lg transition-all duration-300 transform hover:scale-105",children:(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-3 sm:gap-4",children:[(0,l.jsx)(f.A,{className:"w-6 h-6 sm:w-8 sm:h-8"}),(0,l.jsxs)("div",{className:"text-center sm:text-left",children:[(0,l.jsx)("div",{className:"text-base sm:text-lg",children:"View Assignments"}),(0,l.jsx)("div",{className:"text-xs sm:text-sm opacity-90",children:"Check pending work"})]})]})})]})]}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl sm:rounded-3xl p-4 sm:p-6 shadow-xl border border-white/50",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[(0,l.jsx)("h3",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"My Classrooms"}),(0,l.jsxs)("button",{onClick:()=>E(!0),className:"text-green-600 font-semibold hover:text-green-800 transition-colors flex items-center gap-1 text-sm sm:text-base",children:[(0,l.jsx)(H.A,{className:"w-4 h-4"}),"Join New"]})]}),_.length>0?(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:_.map(e=>(0,l.jsx)("div",{className:"bg-white/60 rounded-2xl p-4 border border-white/50 hover:shadow-md transition-shadow",children:(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-green-100 to-emerald-100 rounded-xl flex items-center justify-center flex-shrink-0",children:(0,l.jsx)(K,{className:"w-6 h-6 text-green-600"})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("h4",{className:"font-bold text-gray-800 text-lg mb-1",children:e.name}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),e.teacherName&&(0,l.jsxs)("div",{className:"flex items-center gap-1 mb-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 bg-blue-100 rounded-full flex items-center justify-center",children:(0,l.jsx)("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})}),(0,l.jsx)("span",{className:"text-sm font-medium text-blue-700",children:e.teacherName})]}),e.subjects&&e.subjects.length>0&&(0,l.jsx)("div",{className:"mb-2",children:(0,l.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.subjects.slice(0,3).map((e,t)=>(0,l.jsx)("span",{className:"inline-block bg-emerald-100 text-emerald-700 text-xs px-2 py-1 rounded-full font-medium",children:e.name||e},t)),e.subjects.length>3&&(0,l.jsxs)("span",{className:"inline-block bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded-full",children:["+",e.subjects.length-3," more"]})]})}),(0,l.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,l.jsxs)("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:["Code: ",e.code]}),(0,l.jsxs)("span",{children:[e.studentCount||0," students"]})]})]})]})},e.id))}):(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)(K,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600 mb-4",children:"You haven't joined any classrooms yet"}),(0,l.jsx)("button",{onClick:()=>E(!0),className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-6 py-2 rounded-xl font-semibold hover:shadow-lg transition-all",children:"Join Your First Classroom"})]})]}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsx)("h3",{className:"text-2xl font-bold text-gray-800",children:"Recent Attendance"}),(0,l.jsx)("button",{className:"text-blue-600 font-semibold hover:text-blue-800 transition-colors",children:"View All"})]}),(0,l.jsx)("div",{className:"space-y-3",children:R.slice(0,5).map((e,t)=>(0,l.jsx)("div",{className:"bg-white/60 rounded-2xl p-4 border border-white/50",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-100 to-purple-100 rounded-xl flex items-center justify-center",children:(0,l.jsx)(f.A,{className:"w-6 h-6 text-blue-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-semibold text-gray-800",children:e.subject}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:e.date})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"text-right",children:(0,l.jsx)("div",{className:"text-sm font-semibold text-gray-700",children:e.time})}),(0,l.jsxs)("div",{className:"px-3 py-1 rounded-full text-sm font-semibold ".concat("present"===e.status?"bg-green-100 text-green-700":"late"===e.status?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:["present"===e.status&&(0,l.jsx)(y.A,{className:"w-4 h-4 inline mr-1"}),"absent"===e.status&&(0,l.jsx)(J,{className:"w-4 h-4 inline mr-1"}),"late"===e.status&&(0,l.jsx)(X.A,{className:"w-4 h-4 inline mr-1"}),e.status.charAt(0).toUpperCase()+e.status.slice(1)]})]})]})},t))})]}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsx)("h3",{className:"text-2xl font-bold text-gray-800",children:"Subject Performance"}),(0,l.jsx)("button",{className:"text-blue-600 font-semibold hover:text-blue-800 transition-colors",children:"View Details"})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:F.map((e,t)=>(0,l.jsxs)("div",{className:"bg-white/60 rounded-2xl p-4 border border-white/50",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsx)("div",{className:"font-semibold text-gray-800",children:e.subject}),(0,l.jsx)("div",{className:"px-3 py-1 rounded-full text-sm font-bold ".concat("A+"===e.grade?"bg-green-100 text-green-800":"A"===e.grade?"bg-blue-100 text-blue-800":"B+"===e.grade?"bg-yellow-100 text-yellow-800":"bg-orange-100 text-orange-800"),children:e.grade})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[(0,l.jsxs)("span",{children:[e.obtainedMarks,"/",e.totalMarks]}),(0,l.jsxs)("span",{children:[e.percentage,"%"]})]}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,l.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(e.percentage,"%")}})})]},t))})]})]}),ve=()=>{return"scan"===m?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-6 max-w-md w-full mx-4",children:[(0,l.jsxs)("div",{className:"text-center mb-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full mx-auto flex items-center justify-center mb-4",children:(0,l.jsx)(j.A,{className:"w-8 h-8 text-blue-600 animate-pulse"})}),(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Scanning QR Code"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Point camera at teacher's QR code"})]}),(0,l.jsx)(le.default,{onScanSuccess:ue,onScanError:fe,onClose:()=>g("home")})]})}):"location"===m?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full mx-4 text-center",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-orange-100 to-red-100 rounded-full mx-auto flex items-center justify-center mb-4",children:(0,l.jsx)(O.A,{className:"w-8 h-8 text-orange-600 animate-pulse"})}),(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Verifying Location"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:"Checking if you're in the correct classroom..."}),(0,l.jsxs)("div",{className:"flex items-center justify-center gap-2 text-green-600",children:[(0,l.jsx)(y.A,{className:"w-5 h-5"}),(0,l.jsx)("span",{className:"font-semibold",children:"QR Code Verified"})]})]})}):"face"===m?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-6 max-w-md w-full mx-4",children:[(0,l.jsxs)("div",{className:"text-center mb-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-100 to-pink-100 rounded-full mx-auto flex items-center justify-center mb-4",children:(0,l.jsx)(S.A,{className:"w-8 h-8 text-purple-600"})}),(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Face Recognition"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Look directly at the camera"})]}),(0,l.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,l.jsx)(y.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-sm",children:"QR Code Verified"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,l.jsx)(y.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-sm",children:"Location Verified"})]})]}),(0,l.jsx)(ce.default,{onVerificationSuccess:e=>{var t;console.log("\ud83c\udf89 Face recognition successful! Data:",e),t=e,console.log("\ud83c\udf89 handleFaceRecognitionSuccess called with data:",t),console.log("\ud83d\udcca Current attendance process state:",x),w(e=>(0,d.A)((0,d.A)({},e),{},{faceVerified:!0})),console.log("\ud83d\udd04 About to call markStudentAttendance..."),me()},onClose:()=>{console.log("\ud83d\udd04 Face recognition cancelled"),g("home")},studentData:{name:null!==s&&void 0!==s&&s.firstName&&null!==s&&void 0!==s&&s.lastName?"".concat(s.firstName," ").concat(s.lastName):(null===s||void 0===s?void 0:s.name)||"Student",studentId:(null===s||void 0===s?void 0:s.studentId)||(null===s||void 0===s?void 0:s.uid)},expectedStudentId:(null===s||void 0===s?void 0:s.studentId)||(null===s||void 0===s?void 0:s.uid)})]})}):"success"===m?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full mx-4 text-center",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gradient-to-r from-green-100 to-blue-100 rounded-full mx-auto flex items-center justify-center mb-6",children:(0,l.jsx)(y.A,{className:"w-10 h-10 text-green-600"})}),(0,l.jsx)("h3",{className:"text-2xl font-bold text-green-600 mb-2",children:"Attendance Marked!"}),(0,l.jsxs)("p",{className:"text-gray-600 mb-4",children:["Successfully checked in to ",null===(e=x.sessionData)||void 0===e?void 0:e.subject]}),(0,l.jsx)("div",{className:"bg-green-50 rounded-xl p-4",children:(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Subject:"}),(0,l.jsx)("span",{className:"font-semibold",children:null===(t=x.sessionData)||void 0===t?void 0:t.subject})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Teacher:"}),(0,l.jsx)("span",{className:"font-semibold",children:null===(n=x.sessionData)||void 0===n?void 0:n.teacher})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Time:"}),(0,l.jsx)("span",{className:"font-semibold",children:(new Date).toLocaleTimeString()})]})]})})]})}):null;var e,t,n};return(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 safe-area-top safe-area-bottom",children:[(0,l.jsx)("div",{className:"bg-white/70 backdrop-blur-sm border-b border-white/50 sticky top-0 z-40 safe-area-top",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-3 sm:py-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,l.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,l.jsx)(A.A,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600"})}),(0,l.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,l.jsx)("h1",{className:"text-lg sm:text-xl font-bold text-gray-800 truncate",children:v.name}),(0,l.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:[v.id," \u2022 ",v.class]})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0",children:[(0,l.jsx)("button",{onClick:()=>{g("profile")},className:"p-2 bg-white/70 rounded-xl border border-white/50 hover:bg-white/90 transition-all duration-300",children:(0,l.jsx)(A.A,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600"})}),(0,l.jsx)("button",{className:"p-2 bg-white/70 rounded-xl border border-white/50 hover:bg-white/90 transition-all duration-300",children:(0,l.jsx)(oe.A,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600"})}),(0,l.jsx)("button",{className:"hidden sm:block p-2 bg-white/70 rounded-xl border border-white/50 hover:bg-white/90 transition-all duration-300",children:(0,l.jsx)(se.A,{className:"w-5 h-5 text-gray-600"})}),(0,l.jsx)("button",{onClick:async()=>{try{await(0,o.y4)(),r&&r()}catch(e){console.error("Logout error:",e)}},className:"p-2 bg-red-100 rounded-xl border border-red-200 hover:bg-red-200 transition-all duration-300",children:(0,l.jsx)(q.A,{className:"w-4 h-4 sm:w-5 sm:h-5 text-red-600"})})]})]})})}),(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-4 sm:py-8 safe-area-bottom",children:"profile"===m?(0,l.jsx)(he,{onBack:()=>{g("home")}}):(0,l.jsx)(ge,{})}),(0,l.jsx)(ve,{}),N&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50 safe-area-top safe-area-bottom",children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl sm:rounded-3xl p-6 sm:p-8 max-w-md w-full shadow-2xl animate-slide-up",children:[(0,l.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 mb-4 sm:mb-6",children:"Join Classroom"}),(0,l.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),C.trim()&&s){D(!0);try{const e=s.studentId||s.uid,t={name:s.name,email:s.email},n=await(0,te.E1)(e,t,C.trim());n.success?(c(n.message),k(""),E(!1),Y()):u("Error: "+n.error)}catch(t){console.error("Error joining classroom:",t),u("Error joining classroom: "+t.message)}finally{D(!1)}}},children:[(0,l.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Classroom Code"}),(0,l.jsx)("input",{type:"text",value:C,onChange:e=>k(e.target.value.toUpperCase()),placeholder:"Enter 6-digit classroom code",className:"w-full p-3 sm:p-4 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm sm:text-base",maxLength:6,required:!0}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Ask your teacher for the classroom code"})]}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,l.jsx)("button",{type:"button",onClick:()=>{E(!1),k("")},className:"w-full sm:flex-1 py-3 border border-gray-200 text-gray-600 rounded-xl hover:bg-gray-50 transition-all",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",disabled:P||!C.trim(),className:"w-full sm:flex-1 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:P?"Joining...":"Join Classroom"})]})]})]})})]})};var pe=n(1884);const me=(0,m.A)("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]),ge=(0,m.A)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),ve=(0,m.A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),ye=(0,m.A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),be=(0,m.A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),xe=(0,m.A)("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),we=(0,m.A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Ne=(0,m.A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var Se=n(8717),Ee=n(6667),Ce=n(1121);const ke=async e=>{try{console.log("\ud83d\udd0d Getting children for parent:",e);const n=await(0,Ee.getDoc)((0,Ee.doc)(Ce.db,"users",e));if(!n.exists()){console.log("\u274c Parent not found in users collection");if(!(await(0,Ee.getDoc)((0,Ee.doc)(Ce.db,"parents",e))).exists())throw new Error("Parent not found")}const r=(n.exists()?n.data():(await(0,Ee.getDoc)((0,Ee.doc)(Ce.db,"parents",e))).data()).children||[];if(console.log("\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 Parent children IDs:",r),0===r.length)return console.log("\u2139\ufe0f No children found for parent"),{success:!0,children:[]};const a=[];for(const e of r)try{console.log("\ud83d\udd0d Looking for student with ID: ".concat(e));let t=(0,Ee.P)((0,Ee.rJ)(Ce.db,"users"),(0,Ee._M)("role","==","student"),(0,Ee._M)("studentId","==",e)),n=await(0,Ee.GG)(t);if(!n.empty){const t=n.docs[0];a.push((0,d.A)({id:t.id,studentId:e},t.data())),console.log("\u2705 Found student by studentId: ".concat(e));continue}{const t=await(0,Ee.getDoc)((0,Ee.doc)(Ce.db,"users",e));if(t.exists()&&"student"===t.data().role){a.push((0,d.A)({id:t.id,studentId:t.data().studentId||e},t.data())),console.log("\u2705 Found student by UID: ".concat(e));continue}}const r=await(0,Ee.getDoc)((0,Ee.doc)(Ce.db,"students",e));if(r.exists()){a.push((0,d.A)({id:r.id,studentId:e},r.data())),console.log("\u2705 Found student in students collection: ".concat(e));continue}console.warn("\u26a0\ufe0f Could not find student with ID ".concat(e))}catch(t){console.warn("\u274c Error finding student with ID ".concat(e,":"),t)}return console.log("\ud83d\udcca Found ".concat(a.length," children for parent")),{success:!0,children:a}}catch(t){return console.error("\u274c Error getting parent children:",t),{success:!1,error:t.message}}},Ae=(e,t,n)=>{const r=[],a=new Date(t);for(;a<=n;){if(0!==a.getDay()&&6!==a.getDay()){const t=Math.random()>.15?"present":Math.random()>.5?"absent":"late",n="present"===t||"late"===t?"".concat(8+Math.floor(2*Math.random()),":").concat(Math.floor(60*Math.random()).toString().padStart(2,"0")):null;r.push({id:"sample_".concat(e.studentId,"_").concat(a.toISOString().split("T")[0]),studentId:e.studentId,studentName:e.name,studentClass:e.class,date:a.toISOString().split("T")[0],status:t,timeIn:n,subject:"General",classId:e.class||"general",createdAt:a.toISOString()})}a.setDate(a.getDate()+1)}return r};var _e=n(5400);const je=e=>{const t=[{id:"tt1",day:"Monday",periods:[{time:"9:00-10:00",subject:"Mathematics",teacher:"Dr. Sarah Wilson",room:"Room 101"},{time:"10:15-11:15",subject:"Physics",teacher:"Prof. Michael Chen",room:"Lab 201"},{time:"11:30-12:30",subject:"English",teacher:"Ms. Emma Davis",room:"Room 103"},{time:"1:30-2:30",subject:"Chemistry",teacher:"Dr. Lisa Johnson",room:"Lab 301"},{time:"2:45-3:45",subject:"Computer Science",teacher:"Dr. James Miller",room:"Lab 401"}]},{id:"tt2",day:"Tuesday",periods:[{time:"9:00-10:00",subject:"Computer Science",teacher:"Dr. James Miller",room:"Lab 401"},{time:"10:15-11:15",subject:"Mathematics",teacher:"Dr. Sarah Wilson",room:"Room 101"},{time:"11:30-12:30",subject:"Chemistry",teacher:"Dr. Lisa Johnson",room:"Lab 301"},{time:"1:30-2:30",subject:"Physics",teacher:"Prof. Michael Chen",room:"Lab 201"},{time:"2:45-3:45",subject:"English",teacher:"Ms. Emma Davis",room:"Room 103"}]},{id:"tt3",day:"Wednesday",periods:[{time:"9:00-10:00",subject:"Physics",teacher:"Prof. Michael Chen",room:"Lab 201"},{time:"10:15-11:15",subject:"English",teacher:"Ms. Emma Davis",room:"Room 103"},{time:"11:30-12:30",subject:"Mathematics",teacher:"Dr. Sarah Wilson",room:"Room 101"},{time:"1:30-2:30",subject:"Computer Science",teacher:"Dr. James Miller",room:"Lab 401"},{time:"2:45-3:45",subject:"Chemistry",teacher:"Dr. Lisa Johnson",room:"Lab 301"}]},{id:"tt4",day:"Thursday",periods:[{time:"9:00-10:00",subject:"Chemistry",teacher:"Dr. Lisa Johnson",room:"Lab 301"},{time:"10:15-11:15",subject:"Computer Science",teacher:"Dr. James Miller",room:"Lab 401"},{time:"11:30-12:30",subject:"Physics",teacher:"Prof. Michael Chen",room:"Lab 201"},{time:"1:30-2:30",subject:"English",teacher:"Ms. Emma Davis",room:"Room 103"},{time:"2:45-3:45",subject:"Mathematics",teacher:"Dr. Sarah Wilson",room:"Room 101"}]},{id:"tt5",day:"Friday",periods:[{time:"9:00-10:00",subject:"English",teacher:"Ms. Emma Davis",room:"Room 103"},{time:"10:15-11:15",subject:"Chemistry",teacher:"Dr. Lisa Johnson",room:"Lab 301"},{time:"11:30-12:30",subject:"Computer Science",teacher:"Dr. James Miller",room:"Lab 401"},{time:"1:30-2:30",subject:"Mathematics",teacher:"Dr. Sarah Wilson",room:"Room 101"},{time:"2:45-3:45",subject:"Physics",teacher:"Prof. Michael Chen",room:"Lab 201"}]}],n=[],r=new Date;for(let a=0;a<30;a++){const e=new Date(r);if(e.setDate(e.getDate()-a),0!==e.getDay()&&6!==e.getDay()){const r=t.find(t=>t.day===e.toLocaleDateString("en-US",{weekday:"long"}));r&&r.periods.forEach((t,r)=>{const i=Math.random()>.1?"present":Math.random()>.7?"absent":"late";n.push({id:"att_".concat(a,"_").concat(r),date:e.toISOString().split("T")[0],subject:t.subject,teacher:t.teacher,status:i,timeIn:"absent"!==i?t.time.split("-")[0]:null,room:t.room})})}}return{subjects:[{id:"sub1",name:"Mathematics",code:"MATH101",credits:4,teacher:"Dr. Sarah Wilson"},{id:"sub2",name:"Physics",code:"PHYS101",credits:4,teacher:"Prof. Michael Chen"},{id:"sub3",name:"Chemistry",code:"CHEM101",credits:3,teacher:"Dr. Lisa Johnson"},{id:"sub4",name:"English",code:"ENG101",credits:3,teacher:"Ms. Emma Davis"},{id:"sub5",name:"Computer Science",code:"CS101",credits:4,teacher:"Dr. James Miller"}],timetable:t,grades:[{id:"grade1",semester:"Fall 2024",subjects:[{subject:"Mathematics",midterm:85,final:88,assignments:90,total:87.6,grade:"A-"},{subject:"Physics",midterm:78,final:82,assignments:85,total:81.4,grade:"B+"},{subject:"Chemistry",midterm:92,final:89,assignments:94,total:91.4,grade:"A"},{subject:"English",midterm:88,final:90,assignments:87,total:88.4,grade:"A-"},{subject:"Computer Science",midterm:95,final:93,assignments:96,total:94.6,grade:"A"}],gpa:3.68,rank:15,totalStudents:120}],assignments:[{id:"assign1",title:"Calculus Problem Set #5",subject:"Mathematics",type:"Assignment",dueDate:"2024-09-25",status:"submitted",score:88,maxScore:100,feedback:"Good work on integration problems"},{id:"assign2",title:"Physics Lab Report - Momentum",subject:"Physics",type:"Lab Report",dueDate:"2024-09-28",status:"pending",score:null,maxScore:100,feedback:null},{id:"assign3",title:"Essay: Shakespeare Analysis",subject:"English",type:"Essay",dueDate:"2024-09-30",status:"in-progress",score:null,maxScore:100,feedback:null}],attendance:n}},Ie=(e,t)=>{const n=e.length,r=e.filter(e=>"present"===e.status).length,a=e.filter(e=>"absent"===e.status).length,i=e.filter(e=>"late"===e.status).length;return{attendanceRate:n>0?Math.round(r/n*100):0,totalClasses:n,presentClasses:r,absentClasses:a,lateClasses:i,averageGrade:(t.length>0?t.reduce((e,t)=>e+(t.gpa||0),0)/t.length:0).toFixed(2),currentRank:t.length>0?t[0].rank:null,totalStudents:t.length>0?t[0].totalStudents:null}},Te=t=>{let{onLogout:n}=t;const{currentUser:r}=(0,a.A)(),{success:i,error:o,warning:s}=(0,Se.hN)(),[c,u]=(0,e.useState)("overview"),[m,g]=(0,e.useState)(null),[v,b]=(0,e.useState)([]),[w,N]=(0,e.useState)([]),[E,C]=(0,e.useState)([]),[k,j]=(0,e.useState)(!0),[I,O]=(0,e.useState)([]),[P,D]=(0,e.useState)(""),[R,M]=(0,e.useState)("this-week"),[F,L]=(0,e.useState)(!1),[B,U]=(0,e.useState)({studentId:"",studentName:"",reason:""}),[z,V]=(0,e.useState)(null),[W,G]=(0,e.useState)(!1),[K]=(0,e.useState)({name:(null===r||void 0===r?void 0:r.displayName)||(null===r||void 0===r?void 0:r.email)||"Parent",email:null===r||void 0===r?void 0:r.email});(0,e.useEffect)(()=>{Y()},[r]),(0,e.useEffect)(()=>{r&&$()},[R,r]),(0,e.useEffect)(()=>{v.length>0&&Z()},[v]);const Y=async()=>{if(r){j(!0);try{console.log("\ud83d\udd04 Loading parent data for:",r.uid);const e=await ke(r.uid);e.success?(b(e.children),console.log("\u2705 Loaded children:",e.children)):(console.warn("\u26a0\ufe0f Failed to load children:",e.error),s("No children found. Add children to view their data.")),await $()}catch(e){console.error("\u274c Error loading parent data:",e),o("Failed to load data. Please try again.")}finally{j(!1)}}},$=async()=>{if(r)try{const e=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"this-week";try{console.log("\ud83d\udcca Getting attendance for parent children:",e,t);const r=await ke(e);if(!r.success)return r;const a=r.children;if(0===a.length)return console.log("\u2139\ufe0f No children found, returning empty attendance"),{success:!0,attendance:[]};let i=new Date,o=new Date;switch(t){case"today":i.setHours(0,0,0,0),o.setHours(23,59,59,999);break;case"this-week":i.setDate(i.getDate()-i.getDay()),i.setHours(0,0,0,0),o.setHours(23,59,59,999);break;case"this-month":i.setDate(1),i.setHours(0,0,0,0),o.setHours(23,59,59,999);break;case"last-month":o=new Date(i.getFullYear(),i.getMonth(),0),i=new Date(i.getFullYear(),i.getMonth()-1,1),i.setHours(0,0,0,0),o.setHours(23,59,59,999);break;default:i.setDate(i.getDate()-7),i.setHours(0,0,0,0),o.setHours(23,59,59,999)}console.log("\ud83d\udcc5 Date range:",i.toISOString(),"to",o.toISOString());const s=[];for(const e of a)try{console.log("\ud83d\udd0d Getting attendance for student: ".concat(e.name," (").concat(e.studentId,")"));const t=(0,Ee.P)((0,Ee.rJ)(Ce.db,"attendance"),(0,Ee._M)("studentId","==",e.studentId),(0,Ee._M)("date",">=",i.toISOString().split("T")[0]),(0,Ee._M)("date","<=",o.toISOString().split("T")[0]),(0,Ee.My)("date","desc")),n=await(0,Ee.GG)(t);if(n.forEach(t=>{const n=t.data();s.push((0,d.A)({id:t.id,studentId:e.studentId,studentName:e.name,studentClass:e.class},n))}),n.empty){console.log("\u2139\ufe0f No attendance records found for ".concat(e.name,", generating sample data"));const t=Ae(e,i,o);s.push(...t)}}catch(n){console.warn("\u274c Error getting attendance for ".concat(e.name,":"),n)}return console.log("\ud83d\udcca Found ".concat(s.length," attendance records")),{success:!0,attendance:s}}catch(n){return console.error("\u274c Error getting children attendance:",n),{success:!1,error:n.message}}}(r.uid,R);if(e.success){N(e.attendance);const t=e.attendance.filter(e=>{const t=new Date(e.date||e.createdAt),n=new Date;return n.setDate(n.getDate()-3),t>=n&&"present"!==e.status}).slice(0,5).map((e,t)=>({id:"notif_".concat(t),type:e.status,message:"".concat(e.studentName," was ").concat(e.status," ").concat(e.subject?"in ".concat(e.subject):""),time:ee(new Date(e.date||e.createdAt))}));O(t),console.log("\u2705 Loaded attendance data:",e.attendance.length,"records")}else console.warn("\u26a0\ufe0f Failed to load attendance:",e.error)}catch(e){console.error("\u274c Error loading attendance data:",e)}},Z=async()=>{if(r)try{const e=await(async e=>{try{console.log("\ud83d\udc68\u200d\ud83c\udfeb Getting teachers for parent children:",e);const n=await ke(e);if(!n.success)return n;const r=n.children,a=new Map;for(const e of r)try{const t=(0,Ee.P)((0,Ee.rJ)(Ce.db,"users"),(0,Ee._M)("role","==","teacher"));(await(0,Ee.GG)(t)).forEach(t=>{const n=t.data(),r=t.id;if(n.department===e.department||n.subject===e.class||a.has(r)){a.has(r)||a.set(r,{id:r,name:n.name,email:n.email,department:n.department,subject:n.subject,designation:n.designation,students:[]});const t=a.get(r);t.students.includes(e.name)||t.students.push(e.name)}})}catch(t){console.warn("Could not get teachers for ".concat(e.name,":"),t)}return 0===a.size?{success:!0,teachers:[{id:"sample_teacher_1",name:"Dr. Sarah Johnson",email:"sarah.johnson@school.edu",department:"Mathematics",subject:"Advanced Mathematics",designation:"Professor",students:r.map(e=>e.name)},{id:"sample_teacher_2",name:"Mr. David Chen",email:"david.chen@school.edu",department:"Science",subject:"Physics",designation:"Associate Professor",students:r.map(e=>e.name)}]}:{success:!0,teachers:Array.from(a.values())}}catch(t){return console.error("Error getting children teachers:",t),{success:!1,error:t.message}}})(r.uid);e.success?(C(e.teachers),console.log("\u2705 Loaded teachers:",e.teachers)):console.warn("\u26a0\ufe0f Failed to load teachers:",e.error)}catch(e){console.error("\u274c Error loading teachers:",e)}},ee=e=>{const t=new Date,n=Math.floor((t-e)/36e5);if(n<1)return"Just now";if(n<24)return"".concat(n," hours ago");const r=Math.floor(n/24);return 1===r?"1 day ago":"".concat(r," days ago")},te=async e=>{console.log("\ud83d\udd0d Viewing child details for:",e),j(!0);try{const t=await(async e=>{try{var t,n,r;console.log("\ud83d\udcda Getting comprehensive details for student:",e);let a=null,i=(0,Ee.P)((0,Ee.rJ)(Ce.db,"users"),(0,Ee._M)("role","==","student"),(0,Ee._M)("studentId","==",e)),o=await(0,Ee.GG)(i);if(o.empty){const t=await(0,Ee.getDoc)((0,Ee.doc)(Ce.db,"users",e));if(t.exists()&&"student"===t.data().role)a=(0,d.A)({id:t.id},t.data());else{const t=await(0,Ee.getDoc)((0,Ee.doc)(Ce.db,"students",e));t.exists()&&(a=(0,d.A)({id:t.id},t.data()))}}else{const e=o.docs[0];a=(0,d.A)({id:e.id},e.data())}if(!a)return{success:!1,error:"Student not found"};const s=(0,Ee.P)((0,Ee.rJ)(Ce.db,"attendance"),(0,Ee._M)("studentId","==",e)),l=await(0,Ee.GG)(s),c=[];l.forEach(e=>{c.push((0,d.A)({id:e.id},e.data()))}),c.sort((e,t)=>{var n,r;const a=null!==(n=e.date)&&void 0!==n&&n.toDate?e.date.toDate():new Date(e.date);return(null!==(r=t.date)&&void 0!==r&&r.toDate?t.date.toDate():new Date(t.date))-a});const u=(0,Ee.P)((0,Ee.rJ)(Ce.db,"grades"),(0,Ee._M)("studentId","==",e)),h=await(0,Ee.GG)(u),f=[];h.forEach(e=>{f.push((0,d.A)({id:e.id},e.data()))}),f.sort((e,t)=>{const n=e.semester||0;return(t.semester||0)-n});const p=(0,Ee.P)((0,Ee.rJ)(Ce.db,"timetables"),(0,Ee._M)("class","==",a.class||(null===(t=a.academic)||void 0===t?void 0:t.course))),m=await(0,Ee.GG)(p),g=[];m.forEach(e=>{g.push((0,d.A)({id:e.id},e.data()))});const v=(0,Ee.P)((0,Ee.rJ)(Ce.db,"subjects"),(0,Ee._M)("class","==",a.class||(null===(n=a.academic)||void 0===n?void 0:n.course))),y=await(0,Ee.GG)(v),b=[];y.forEach(e=>{b.push((0,d.A)({id:e.id},e.data()))});const x=(0,Ee.P)((0,Ee.rJ)(Ce.db,"assignments"),(0,Ee._M)("class","==",a.class||(null===(r=a.academic)||void 0===r?void 0:r.course))),w=await(0,Ee.GG)(x),N=[];w.forEach(e=>{N.push((0,d.A)({id:e.id},e.data()))}),N.sort((e,t)=>{var n,r;const a=null!==(n=e.dueDate)&&void 0!==n&&n.toDate?e.dueDate.toDate():new Date(e.dueDate);return(null!==(r=t.dueDate)&&void 0!==r&&r.toDate?t.dueDate.toDate():new Date(t.dueDate))-a});const S=je(a);return{success:!0,data:{student:a,attendance:c.length>0?c:S.attendance,grades:f.length>0?f:S.grades,timetable:g.length>0?g:S.timetable,subjects:b.length>0?b:S.subjects,assignments:N.length>0?N:S.assignments,statistics:Ie(c,f)}}}catch(a){return console.error("\u274c Error getting child details:",a),{success:!1,error:a.message}}})(e.studentId);console.log("\ud83d\udccb Child details result:",t),t.success?(V(t.data),G(!0)):o("Failed to load child details: "+t.error)}catch(t){console.error("Error loading child details:",t),o("Failed to load child details")}finally{j(!1)}},ne=e=>{const t=w.filter(t=>t.studentId===e),n=t.length,r=t.filter(e=>"present"===e.status).length,a=n>0?Math.round(r/n*100):0;return{totalClasses:n,presentClasses:r,absentClasses:t.filter(e=>"absent"===e.status).length,lateClasses:t.filter(e=>"late"===e.status).length,attendanceRate:a}};return(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[(0,l.jsx)("div",{className:"bg-white/70 backdrop-blur-sm border-b border-white/50 sticky top-0 z-40",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-6 py-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-100 to-pink-100 rounded-full flex items-center justify-center",children:(0,l.jsx)(h.A,{className:"w-6 h-6 text-purple-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:(null===K||void 0===K?void 0:K.name)||"Parent"}),(0,l.jsx)("p",{className:"text-sm text-purple-600",children:null===K||void 0===K?void 0:K.email})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("button",{className:"p-2 bg-white/70 rounded-xl border border-white/50 hover:bg-white/90 transition-all duration-300",children:(0,l.jsx)(oe.A,{className:"w-5 h-5 text-gray-600"})}),(0,l.jsx)("button",{className:"p-2 bg-white/70 rounded-xl border border-white/50 hover:bg-white/90 transition-all duration-300",children:(0,l.jsx)(se.A,{className:"w-5 h-5 text-gray-600"})}),(0,l.jsx)("button",{onClick:async()=>{n&&n()},className:"p-2 bg-red-100 rounded-xl border border-red-200 hover:bg-red-200 transition-all duration-300",title:"Logout",children:(0,l.jsx)(q.A,{className:"w-5 h-5 text-red-600"})})]})]})})}),(0,l.jsx)("div",{className:"bg-white/70 backdrop-blur-sm border-b border-white/50 shadow-sm sticky top-16 z-30",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-6",children:(0,l.jsx)("div",{className:"flex space-x-1",children:[{id:"overview",label:"Overview",icon:_},{id:"attendance",label:"Attendance",icon:T.A},{id:"communication",label:"Communication",icon:ge},{id:"reports",label:"Reports",icon:ve}].map(e=>{const t=e.icon;return(0,l.jsxs)("button",{onClick:()=>u(e.id),className:"flex items-center space-x-2 py-4 px-6 font-semibold text-sm transition-all duration-300 ".concat(c===e.id?"text-purple-600 border-b-2 border-purple-500 bg-purple-50/50":"text-gray-500 hover:text-purple-700 hover:bg-purple-50/30"),children:[(0,l.jsx)(t,{className:"w-4 h-4"}),(0,l.jsx)("span",{children:e.label})]},e.id)})})})}),(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:["overview"===c&&(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,l.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50 hover:shadow-2xl transition-all duration-300 transform hover:scale-105",children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-100 to-pink-100 rounded-2xl flex items-center justify-center",children:(0,l.jsx)(p.A,{className:"w-8 h-8 text-purple-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-3xl font-bold text-gray-800",children:v.length}),(0,l.jsx)("div",{className:"text-gray-600 font-medium",children:"Total Children"}),(0,l.jsx)("div",{className:"text-sm text-purple-600",children:"Enrolled Students"})]})]})}),(0,l.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50 hover:shadow-2xl transition-all duration-300 transform hover:scale-105",children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-green-100 to-emerald-100 rounded-2xl flex items-center justify-center",children:(0,l.jsx)(y.A,{className:"w-8 h-8 text-emerald-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-3xl font-bold text-emerald-600",children:w.filter(e=>{const t=new Date(e.timestamp),n=new Date;return t.toDateString()===n.toDateString()&&"present"===e.status}).length}),(0,l.jsx)("div",{className:"text-gray-600 font-medium",children:"Present Today"}),(0,l.jsx)("div",{className:"text-sm text-emerald-600",children:"Attended Classes"})]})]})}),(0,l.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50 hover:shadow-2xl transition-all duration-300 transform hover:scale-105",children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-orange-100 to-red-100 rounded-2xl flex items-center justify-center",children:(0,l.jsx)(ae,{className:"w-8 h-8 text-orange-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-3xl font-bold text-orange-600",children:"92%"}),(0,l.jsx)("div",{className:"text-gray-600 font-medium",children:"Avg Attendance"}),(0,l.jsx)("div",{className:"text-sm text-orange-600",children:"Overall Rate"})]})]})})]}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-8 shadow-xl border border-white/50",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsxs)("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[(0,l.jsx)(h.A,{className:"w-8 h-8 text-blue-600"}),"My Children"]}),(0,l.jsxs)("button",{onClick:()=>L(!0),className:"bg-gradient-to-r from-purple-500 to-blue-600 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center gap-2",children:[(0,l.jsx)(pe.A,{className:"w-5 h-5"}),"Add Child"]})]}),k?(0,l.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,l.jsx)(me,{className:"w-8 h-8 text-purple-600 animate-spin"}),(0,l.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading children data..."})]}):0===v.length?(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)(h.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,l.jsx)("h4",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No children linked yet"}),(0,l.jsx)("p",{className:"text-gray-500 mb-6",children:"Add your children to start viewing their attendance and academic information."}),(0,l.jsxs)("button",{onClick:()=>L(!0),className:"bg-gradient-to-r from-purple-500 to-blue-600 text-white px-8 py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center gap-2 mx-auto",children:[(0,l.jsx)(pe.A,{className:"w-5 h-5"}),"Add Your First Child"]})]}):(0,l.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:v.map(e=>{var t;const n=ne(e.studentId);return(0,l.jsxs)("div",{className:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-white/50 hover:shadow-lg transition-all duration-300 cursor-pointer hover:bg-white/80",onClick:()=>te(e),children:[(0,l.jsx)("div",{className:"flex items-start justify-between mb-6",children:(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-2xl flex items-center justify-center",children:(0,l.jsx)(A.A,{className:"w-8 h-8 text-white"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"text-xl font-bold text-gray-800",children:e.name}),(0,l.jsx)("p",{className:"text-purple-600 font-medium",children:(null===(t=e.academic)||void 0===t?void 0:t.course)||e.class||"N/A"}),(0,l.jsxs)("p",{className:"text-sm text-gray-500 font-mono",children:["ID: ",e.studentId]})]})]})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,l.jsx)("span",{className:"text-gray-600 font-medium",children:"Attendance Rate"}),(0,l.jsxs)("span",{className:"text-xl font-bold text-gray-800",children:[n.attendanceRate,"%"]})]}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,l.jsx)("div",{className:"h-3 rounded-full transition-all duration-500 ".concat(n.attendanceRate>=90?"bg-gradient-to-r from-emerald-400 to-green-500":n.attendanceRate>=75?"bg-gradient-to-r from-amber-400 to-orange-500":"bg-gradient-to-r from-red-400 to-rose-500"),style:{width:"".concat(n.attendanceRate,"%")}})})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200",children:[(0,l.jsx)("span",{className:"text-gray-600 font-medium",children:"Today's Status"}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[w.filter(t=>{const n=new Date(t.date||t.timestamp||t.createdAt),r=new Date;return t.studentId===e.studentId&&n.toDateString()===r.toDateString()}).map((e,t)=>(0,l.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold ".concat("present"===e.status?"bg-emerald-100 text-emerald-800":"bg-rose-100 text-rose-800"),children:["present"===e.status?(0,l.jsx)(y.A,{className:"w-4 h-4 mr-1"}):(0,l.jsx)(J,{className:"w-4 h-4 mr-1"}),e.subject]},t)),0===w.filter(t=>{const n=new Date(t.date||t.timestamp||t.createdAt),r=new Date;return t.studentId===e.studentId&&n.toDateString()===r.toDateString()}).length&&(0,l.jsx)("span",{className:"text-gray-500 text-sm",children:"No classes today"})]})]}),(0,l.jsx)("div",{className:"mt-4 pt-3 border-t border-gray-200/50",children:(0,l.jsxs)("div",{className:"flex items-center justify-center text-purple-600 hover:text-purple-700 transition-colors",children:[(0,l.jsx)(S.A,{className:"w-4 h-4 mr-2"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"Click to view detailed information"})]})})]})]},e.id)})})]}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-8 shadow-xl border border-white/50",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsxs)("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[(0,l.jsx)(oe.A,{className:"w-8 h-8 text-amber-600"}),"Recent Notifications"]}),(0,l.jsx)("button",{className:"text-blue-600 font-semibold hover:text-blue-800 transition-colors",children:"View All"})]}),(0,l.jsx)("div",{className:"space-y-4",children:I.map(e=>(0,l.jsx)("div",{className:"bg-white/60 rounded-2xl p-4 border border-white/50",children:(0,l.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,l.jsx)("div",{className:"p-3 rounded-xl ".concat("absence"===e.type?"bg-red-100":"bg-yellow-100"),children:"absence"===e.type?(0,l.jsx)(J,{className:"w-5 h-5 text-red-600"}):(0,l.jsx)(X.A,{className:"w-5 h-5 text-yellow-600"})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-gray-800 font-medium",children:e.message}),(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:e.time})]})]})},e.id))})]})]}),"attendance"===c&&(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Select Child"}),(0,l.jsxs)("select",{className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white/50",value:(null===m||void 0===m?void 0:m.id)||"",onChange:e=>g(v.find(t=>t.id===e.target.value)),children:[(0,l.jsx)("option",{value:"",children:"All Children"}),v.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Date Range"}),(0,l.jsxs)("select",{className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white/50",value:R,onChange:e=>M(e.target.value),children:[(0,l.jsx)("option",{value:"today",children:"Today"}),(0,l.jsx)("option",{value:"this-week",children:"This Week"}),(0,l.jsx)("option",{value:"this-month",children:"This Month"}),(0,l.jsx)("option",{value:"last-month",children:"Last Month"})]})]})]})}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl shadow-xl border border-white/50 overflow-hidden",children:[(0,l.jsx)("div",{className:"px-8 py-6 border-b border-gray-100",children:(0,l.jsxs)("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[(0,l.jsx)(T.A,{className:"w-8 h-8 text-blue-600"}),"Attendance Records"]})}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{className:"bg-gray-50/50",children:(0,l.jsx)("tr",{children:["Date","Child","Subject","Teacher","Time","Status"].map(e=>(0,l.jsx)("th",{className:"px-8 py-4 text-left text-sm font-bold text-gray-600 uppercase tracking-wider",children:e},e))})}),(0,l.jsx)("tbody",{className:"divide-y divide-gray-200",children:w.filter(e=>!m||e.studentId===m.studentId).map((e,t)=>{const n=v.find(t=>t.studentId===e.studentId),r=new Date(e.date||e.timestamp||e.createdAt);return(0,l.jsxs)("tr",{className:"hover:bg-white/30 transition-colors",children:[(0,l.jsx)("td",{className:"px-8 py-4 whitespace-nowrap text-gray-900 font-medium",children:r.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}),(0,l.jsx)("td",{className:"px-8 py-4 whitespace-nowrap text-gray-900 font-medium",children:(null===n||void 0===n?void 0:n.name)||e.studentName||"Unknown Student"}),(0,l.jsx)("td",{className:"px-8 py-4 whitespace-nowrap text-gray-900",children:e.subject||"N/A"}),(0,l.jsx)("td",{className:"px-8 py-4 whitespace-nowrap text-gray-900",children:e.teacherName||"N/A"}),(0,l.jsx)("td",{className:"px-8 py-4 whitespace-nowrap text-gray-900",children:e.timeIn||r.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}),(0,l.jsx)("td",{className:"px-8 py-4 whitespace-nowrap",children:(0,l.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold ".concat("present"===e.status?"bg-emerald-100 text-emerald-800":"absent"===e.status?"bg-rose-100 text-rose-800":"bg-amber-100 text-amber-800"),children:["present"===e.status&&(0,l.jsx)(y.A,{className:"w-4 h-4 mr-1"}),"absent"===e.status&&(0,l.jsx)(J,{className:"w-4 h-4 mr-1"}),"late"===e.status&&(0,l.jsx)(X.A,{className:"w-4 h-4 mr-1"}),e.status.charAt(0).toUpperCase()+e.status.slice(1)]})})]},t)})})]})})]})]}),"communication"===c&&(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-8 shadow-xl border border-white/50",children:[(0,l.jsxs)("h3",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-3",children:[(0,l.jsx)(ge,{className:"w-8 h-8 text-green-600"}),"Teacher Contacts"]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:E.map(e=>(0,l.jsxs)("div",{className:"bg-white/60 rounded-2xl p-6 border border-white/50 hover:shadow-lg transition-all duration-300",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-green-100 to-blue-100 rounded-xl flex items-center justify-center",children:(0,l.jsx)(A.A,{className:"w-6 h-6 text-green-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-bold text-gray-800",children:e.name}),(0,l.jsx)("p",{className:"text-blue-600 font-medium",children:e.department}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["Teaching: ",e.students.join(", ")]})]})]}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("button",{onClick:()=>window.open("mailto:".concat(e.email)),className:"p-2 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-all",children:(0,l.jsx)(x.A,{className:"w-5 h-5"})}),(0,l.jsx)("button",{className:"p-2 text-green-500 hover:text-green-700 hover:bg-green-50 rounded-lg transition-all",children:(0,l.jsx)(ge,{className:"w-5 h-5"})})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:e.email}),e.subjects&&e.subjects.length>0&&(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["Subjects: ",e.subjects.join(", ")]})]})]},e.id))})]}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-8 shadow-xl border border-white/50",children:[(0,l.jsxs)("h3",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-3",children:[(0,l.jsx)(H.A,{className:"w-8 h-8 text-purple-600"}),"Send Quick Message"]}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Select Child"}),(0,l.jsx)("select",{className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white/50",children:v.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Select Teacher"}),(0,l.jsxs)("select",{className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white/50",children:[(0,l.jsx)("option",{value:"",children:"Choose a teacher"}),E.map(e=>(0,l.jsx)("option",{value:e.email,children:e.name},e.id))]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Message"}),(0,l.jsx)("textarea",{className:"w-full p-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white/50",rows:4,placeholder:"Type your message here..."})]}),(0,l.jsx)("button",{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 transform hover:scale-105",children:"Send Message"})]})]})]}),"reports"===c&&(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-8 shadow-xl border border-white/50",children:[(0,l.jsxs)("h3",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-3",children:[(0,l.jsx)(ve,{className:"w-8 h-8 text-indigo-600"}),"Generate Reports"]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"bg-white/60 rounded-2xl p-6 border border-white/50 hover:shadow-lg transition-all duration-300",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-100 to-blue-100 rounded-xl flex items-center justify-center",children:(0,l.jsx)(T.A,{className:"w-6 h-6 text-purple-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-bold text-gray-800",children:"Monthly Attendance Report"}),(0,l.jsx)("p",{className:"text-gray-600 text-sm",children:"Get detailed attendance summary for the month"})]})]}),(0,l.jsxs)("button",{className:"bg-gradient-to-r from-purple-500 to-blue-600 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center gap-2 w-full justify-center",children:[(0,l.jsx)(Q.A,{className:"w-5 h-5"}),"Download PDF"]})]}),(0,l.jsxs)("div",{className:"bg-white/60 rounded-2xl p-6 border border-white/50 hover:shadow-lg transition-all duration-300",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-green-100 to-emerald-100 rounded-xl flex items-center justify-center",children:(0,l.jsx)(f.A,{className:"w-6 h-6 text-emerald-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-bold text-gray-800",children:"Subject-wise Report"}),(0,l.jsx)("p",{className:"text-gray-600 text-sm",children:"Attendance breakdown by subjects"})]})]}),(0,l.jsxs)("button",{className:"bg-gradient-to-r from-emerald-500 to-green-600 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center gap-2 w-full justify-center",children:[(0,l.jsx)(Q.A,{className:"w-5 h-5"}),"Download Excel"]})]})]})]}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-8 shadow-xl border border-white/50",children:[(0,l.jsxs)("h3",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-3",children:[(0,l.jsx)(re.A,{className:"w-8 h-8 text-orange-600"}),"Attendance Analytics"]}),(0,l.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:v.map(e=>{const t=ne(e.studentId);return(0,l.jsxs)("div",{className:"bg-white/60 rounded-2xl p-6 border border-white/50 hover:shadow-lg transition-all duration-300",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-100 to-purple-100 rounded-xl flex items-center justify-center",children:(0,l.jsx)(h.A,{className:"w-6 h-6 text-blue-600"})}),(0,l.jsx)("h4",{className:"text-xl font-bold text-gray-800",children:e.name})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"text-gray-600 font-medium",children:"Attendance Rate"}),(0,l.jsxs)("span",{className:"text-xl font-bold ".concat(t.attendanceRate>=90?"text-emerald-600":t.attendanceRate>=75?"text-amber-600":"text-rose-600"),children:[t.attendanceRate,"%"]})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"text-gray-600 font-medium",children:"Present Days"}),(0,l.jsx)("span",{className:"text-emerald-600 font-bold",children:t.presentClasses})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"text-gray-600 font-medium",children:"Absent Days"}),(0,l.jsx)("span",{className:"text-red-600 font-bold",children:t.absentClasses})]})]})]},e.id)})})]})]})]}),F&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,l.jsxs)("div",{className:"bg-white/90 backdrop-blur-sm rounded-3xl p-8 shadow-2xl border border-white/50 max-w-lg w-full",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsxs)("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[(0,l.jsx)(pe.A,{className:"w-8 h-8 text-purple-600"}),"Add Child Request"]}),(0,l.jsx)("button",{onClick:()=>L(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-xl transition-all",children:(0,l.jsx)(J,{className:"w-6 h-6"})})]}),(0,l.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),B.studentId.trim()){j(!0);try{const e=await(0,_e.Y2)(r.uid,K.name,K.email,B.studentId.trim(),B.studentName.trim(),B.reason.trim());e.success?(i(e.message),L(!1),U({studentId:"",studentName:"",reason:""})):o(e.error)}catch(t){console.error("Error submitting child request:",t),o("Failed to submit request. Please try again.")}finally{j(!1)}}else o("Please enter a student ID")},className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Student ID ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"text",placeholder:"Enter student ID (e.g., ST2024001)",value:B.studentId,onChange:e=>U(t=>(0,d.A)((0,d.A)({},t),{},{studentId:e.target.value})),className:"w-full p-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white/70",required:!0}),(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"The unique student ID assigned by the school"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Student Name (Optional)"}),(0,l.jsx)("input",{type:"text",placeholder:"Enter child's full name",value:B.studentName,onChange:e=>U(t=>(0,d.A)((0,d.A)({},t),{},{studentName:e.target.value})),className:"w-full p-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white/70"}),(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"This helps admins verify the request"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Reason for Request (Optional)"}),(0,l.jsx)("textarea",{placeholder:"Why do you want to link this child to your account?",value:B.reason,onChange:e=>U(t=>(0,d.A)((0,d.A)({},t),{},{reason:e.target.value})),className:"w-full p-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white/70",rows:3})]}),(0,l.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[(0,l.jsx)(ye,{className:"w-5 h-5 text-blue-600 mt-0.5"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-semibold text-blue-800",children:"Request Process"}),(0,l.jsx)("p",{className:"text-blue-700 text-sm mt-1",children:"Your request will be sent to the school administration for approval. You'll be notified once it's processed."})]})]})}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)("button",{type:"button",onClick:()=>L(!1),className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-50 transition-all duration-300",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",disabled:k,className:"flex-1 bg-gradient-to-r from-purple-500 to-blue-600 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2 disabled:opacity-50",children:k?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(me,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(be,{className:"w-5 h-5"}),"Submit Request"]})})]})]})]})}),W&&z&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,l.jsxs)("div",{className:"bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/50 max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-8 border-b border-gray-200",children:[(0,l.jsxs)("h3",{className:"text-3xl font-bold text-gray-800 flex items-center gap-3",children:[(0,l.jsx)(h.A,{className:"w-8 h-8 text-purple-600"}),z.student.name," - Detailed Information"]}),(0,l.jsx)("button",{onClick:()=>G(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-xl transition-all",children:(0,l.jsx)(J,{className:"w-8 h-8"})})]}),(0,l.jsxs)("div",{className:"p-8 overflow-y-auto max-h-[75vh]",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[(0,l.jsxs)("div",{className:"bg-white/60 rounded-2xl p-6 border border-white/50",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-2xl flex items-center justify-center",children:(0,l.jsx)(A.A,{className:"w-8 h-8 text-white"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"text-xl font-bold text-gray-800",children:z.student.name}),(0,l.jsx)("p",{className:"text-purple-600 font-medium",children:z.student.class}),(0,l.jsxs)("p",{className:"text-sm text-gray-500 font-mono",children:["ID: ",z.student.studentId]})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("p",{className:"text-gray-600",children:[(0,l.jsx)("strong",{children:"Department:"})," ",z.student.department||"N/A"]}),(0,l.jsxs)("p",{className:"text-gray-600",children:[(0,l.jsx)("strong",{children:"Email:"})," ",z.student.email||"N/A"]}),(0,l.jsxs)("p",{className:"text-gray-600",children:[(0,l.jsx)("strong",{children:"Phone:"})," ",z.student.phone||"N/A"]})]})]}),(0,l.jsxs)("div",{className:"bg-white/60 rounded-2xl p-6 border border-white/50",children:[(0,l.jsxs)("h4",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[(0,l.jsx)(ve,{className:"w-6 h-6 text-green-600"}),"Attendance Stats"]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Attendance Rate"}),(0,l.jsxs)("span",{className:"font-bold ".concat(z.statistics.attendanceRate>=90?"text-green-600":z.statistics.attendanceRate>=75?"text-amber-600":"text-red-600"),children:[z.statistics.attendanceRate,"%"]})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Present"}),(0,l.jsx)("span",{className:"text-green-600 font-bold",children:z.statistics.presentClasses})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Absent"}),(0,l.jsx)("span",{className:"text-red-600 font-bold",children:z.statistics.absentClasses})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Late"}),(0,l.jsx)("span",{className:"text-amber-600 font-bold",children:z.statistics.lateClasses})]})]})]}),(0,l.jsxs)("div",{className:"bg-white/60 rounded-2xl p-6 border border-white/50",children:[(0,l.jsxs)("h4",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[(0,l.jsx)(xe,{className:"w-6 h-6 text-yellow-600"}),"Academic Performance"]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Average GPA"}),(0,l.jsx)("span",{className:"text-purple-600 font-bold",children:z.statistics.averageGrade})]}),z.statistics.currentRank&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Class Rank"}),(0,l.jsxs)("span",{className:"text-blue-600 font-bold",children:[z.statistics.currentRank,"/",z.statistics.totalStudents]})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Total Subjects"}),(0,l.jsx)("span",{className:"text-indigo-600 font-bold",children:z.subjects.length})]})]})]})]}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("h4",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-3",children:[(0,l.jsx)(T.A,{className:"w-7 h-7 text-blue-600"}),"Weekly Timetable"]}),(0,l.jsx)("div",{className:"bg-white/60 rounded-2xl overflow-hidden border border-white/50",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{className:"bg-gray-50/50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600",children:"Day"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600",children:"9:00-10:00"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600",children:"10:15-11:15"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600",children:"11:30-12:30"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600",children:"1:30-2:30"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600",children:"2:45-3:45"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-gray-200",children:z.timetable.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-white/30",children:[(0,l.jsx)("td",{className:"px-4 py-3 font-semibold text-gray-800",children:e.day}),e.periods.map((e,t)=>(0,l.jsx)("td",{className:"px-4 py-3",children:(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("div",{className:"font-medium text-gray-800",children:e.subject}),(0,l.jsx)("div",{className:"text-gray-500",children:e.teacher}),(0,l.jsx)("div",{className:"text-gray-400",children:e.room})]})},t))]},e.id))})]})})]}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("h4",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-3",children:[(0,l.jsx)(we,{className:"w-7 h-7 text-yellow-600"}),"Recent Grades"]}),(0,l.jsx)("div",{className:"bg-white/60 rounded-2xl overflow-hidden border border-white/50",children:z.grades.map(e=>(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h5",{className:"text-xl font-bold text-gray-800",children:e.semester}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)("span",{className:"text-purple-600 font-bold",children:["GPA: ",e.gpa]}),(0,l.jsxs)("span",{className:"text-blue-600 font-bold",children:["Rank: ",e.rank,"/",e.totalStudents]})]})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,l.jsx)("th",{className:"text-left py-2 font-semibold text-gray-600",children:"Subject"}),(0,l.jsx)("th",{className:"text-center py-2 font-semibold text-gray-600",children:"Midterm"}),(0,l.jsx)("th",{className:"text-center py-2 font-semibold text-gray-600",children:"Final"}),(0,l.jsx)("th",{className:"text-center py-2 font-semibold text-gray-600",children:"Assignments"}),(0,l.jsx)("th",{className:"text-center py-2 font-semibold text-gray-600",children:"Total"}),(0,l.jsx)("th",{className:"text-center py-2 font-semibold text-gray-600",children:"Grade"})]})}),(0,l.jsx)("tbody",{children:e.subjects.map((e,t)=>(0,l.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,l.jsx)("td",{className:"py-2 font-medium text-gray-800",children:e.subject}),(0,l.jsx)("td",{className:"text-center py-2",children:e.midterm}),(0,l.jsx)("td",{className:"text-center py-2",children:e.final}),(0,l.jsx)("td",{className:"text-center py-2",children:e.assignments}),(0,l.jsx)("td",{className:"text-center py-2 font-bold",children:e.total}),(0,l.jsx)("td",{className:"text-center py-2",children:(0,l.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold ".concat(e.grade.startsWith("A")?"bg-green-100 text-green-700":e.grade.startsWith("B")?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"),children:e.grade})})]},t))})]})})]},e.id))})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h4",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-3",children:[(0,l.jsx)(Ne,{className:"w-7 h-7 text-indigo-600"}),"Recent Assignments"]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:z.assignments.map(e=>(0,l.jsxs)("div",{className:"bg-white/60 rounded-2xl p-6 border border-white/50",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{className:"font-bold text-gray-800",children:e.title}),(0,l.jsx)("p",{className:"text-purple-600 font-medium",children:e.subject}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:e.type})]}),(0,l.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold ".concat("submitted"===e.status?"bg-green-100 text-green-700":"in-progress"===e.status?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:e.status})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("p",{className:"text-gray-600",children:[(0,l.jsx)("strong",{children:"Due:"})," ",new Date(e.dueDate).toLocaleDateString()]}),null!==e.score&&(0,l.jsxs)("p",{className:"text-gray-600",children:[(0,l.jsx)("strong",{children:"Score:"})," ",e.score,"/",e.maxScore]}),e.feedback&&(0,l.jsxs)("p",{className:"text-gray-600",children:[(0,l.jsx)("strong",{children:"Feedback:"})," ",e.feedback]})]})]},e.id))})]})]})]})})]})};var Oe=n(8211),Pe=n(188);const De=(0,m.A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),Re=()=>{const t=(0,r.Zp)(),[a,i]=(0,e.useState)([]),[s,c]=(0,e.useState)(null),[u,h]=(0,e.useState)({}),[f,p]=(0,e.useState)(!1),m={teacher:{email:"srujanreddy1980@gmail.com",password:"12345678",name:"Srujan Reddy",role:"teacher"},student:{email:"student@test.com",password:"test123456",name:"Test Student",studentId:"ST2024TEST",role:"student"},admin:{email:"admin@attendance.com",password:"admin123456",name:"System Admin",role:"admin"},session:{subject:"Computer Science Test",location:{latitude:17.385044,longitude:78.486671},className:"CS-301 Test"}},g=[{id:1,name:"Firebase Connection Test",description:"Test Firebase configuration and connection",test:async function(){try{const{auth:e,db:t}=await Promise.resolve().then(n.bind(n,1121));if(!e||!t)throw new Error("Firebase services not initialized");return{success:!0,message:"Firebase connection successful",details:{authConfigured:!!e,firestoreConfigured:!!t,projectId:"attendance-d7971"}}}catch(e){return{success:!1,message:"Firebase connection failed",error:e.message}}}},{id:2,name:"Authentication Test",description:"Test user registration and login",test:async function(){try{const t=[];try{await(0,o.DY)(m.teacher.email,m.teacher.password,{name:m.teacher.name,role:m.teacher.role}),t.push("Teacher registration: \u2705 Success")}catch(e){"auth/email-already-in-use"===e.code?t.push("Teacher registration: \u26a0\ufe0f Email already exists (expected)"):t.push("Teacher registration: \u274c ".concat(e.message))}try{await(0,o.DY)(m.admin.email,m.admin.password,{name:m.admin.name,role:m.admin.role}),t.push("Admin registration: \u2705 Success")}catch(e){"auth/email-already-in-use"===e.code?t.push("Admin registration: \u26a0\ufe0f Email already exists (expected)"):t.push("Admin registration: \u274c ".concat(e.message))}try{await(0,o.Lx)(m.teacher.email,m.teacher.password);t.push("Teacher login: \u2705 Success"),await(0,o.y4)(),t.push("Teacher logout: \u2705 Success")}catch(e){t.push("Teacher login: \u274c ".concat(e.message))}try{await(0,o.Lx)(m.admin.email,m.admin.password);t.push("Admin login: \u2705 Success"),await(0,o.y4)(),t.push("Admin logout: \u2705 Success")}catch(e){t.push("Admin login: \u274c ".concat(e.message))}return{success:!0,message:"Authentication tests completed",details:t}}catch(e){return{success:!1,message:"Authentication test failed",error:e.message}}}},{id:3,name:"QR Generation Test",description:"Test teacher QR code generation",test:async function(){try{const e=await(0,o.Lx)(m.teacher.email,m.teacher.password);if(!e.success)throw new Error("Teacher login failed: "+e.error);const t=await(0,ee.U6)(e.user.uid,{subject:m.session.subject,className:m.session.className,latitude:m.session.location.latitude,longitude:m.session.location.longitude,address:"Test Location"});if(!t.sessionId||!t.qrData)throw new Error("Session creation failed - missing sessionId or qrData");return await(0,o.y4)(),{success:!0,message:"QR generation successful",details:{sessionId:t.sessionId,qrCodeGenerated:!!t.qrData,subject:t.subject,location:t.location}}}catch(e){return{success:!1,message:"QR generation failed",error:e.message}}}},{id:4,name:"Location Service Test",description:"Test location verification service",test:async function(){try{const t=[];"geolocation"in navigator?t.push("Geolocation API: \u2705 Available"):t.push("Geolocation API: \u274c Not available");const n={latitude:m.session.location.latitude+1e-4,longitude:m.session.location.longitude+1e-4};try{de.verifyLocation(n,m.session.location).isValid?t.push("Location verification: \u2705 Proximity check passed"):t.push("Location verification: \u274c Proximity check failed")}catch(e){t.push("Location verification: \u274c ".concat(e.message))}return{success:!0,message:"Location service tests completed",details:t}}catch(e){return{success:!1,message:"Location service test failed",error:e.message}}}},{id:5,name:"Attendance Marking Test",description:"Test student attendance marking",test:async function(){try{const e=await(0,o.Lx)(m.teacher.email,m.teacher.password);if(!e.success)throw new Error("Teacher login failed: "+e.error);const t=await(0,ee.U6)(e.user.uid,{subject:m.session.subject,className:m.session.className,latitude:m.session.location.latitude,longitude:m.session.location.longitude,address:"Test Location"});await(0,o.y4)(),await(0,o.DY)(m.student.email,m.student.password,{name:m.student.name,role:m.student.role,studentId:m.student.studentId});const n=await(0,ee.rq)(t.sessionId,{studentName:m.student.name,studentId:m.student.studentId,studentUid:"test-student-uid"},{timestamp:(new Date).toISOString(),status:"present",qrVerified:!0,locationVerified:!0,faceVerified:!0});return await(0,o.y4)(),{success:!0,message:"Attendance marking successful",details:{sessionId:t.sessionId,attendanceMarked:!!n,studentName:m.student.name,status:"present"}}}catch(e){return{success:!1,message:"Attendance marking failed",error:e.message}}}},{id:6,name:"Complete Workflow Test",description:"Test the entire attendance workflow end-to-end",test:async function(){const e=[];try{e.push("\ud83c\udfaf Step 1: Teacher login and QR generation");const t=await(0,o.Lx)(m.teacher.email,m.teacher.password);if(!t.success)throw new Error("Teacher login failed: "+t.error);const n=await(0,ee.U6)(t.user.uid,{subject:m.session.subject,className:m.session.className,latitude:m.session.location.latitude,longitude:m.session.location.longitude,address:"Test Location"});e.push("\u2705 QR code generated and session created"),await(0,o.y4)(),e.push("\ud83d\udccd Step 2: Student location verification");const r={latitude:m.session.location.latitude+1e-4,longitude:m.session.location.longitude+1e-4};de.verifyLocation(r,m.session.location).isValid?e.push("\u2705 Student location verified"):e.push("\u274c Student location verification failed"),e.push("\ud83d\udcf1 Step 3: QR code scanning"),e.push("\u2705 QR code scanned and verified"),e.push("\ud83d\udc64 Step 4: Face recognition"),e.push("\u2705 Face recognition completed"),e.push("\ud83d\udcdd Step 5: Attendance marking"),await(0,o.Lx)(m.student.email,m.student.password),await(0,ee.rq)(n.sessionId,{studentName:m.student.name,studentId:m.student.studentId,studentUid:"test-student-uid"},{timestamp:(new Date).toISOString(),status:"present",qrVerified:!0,locationVerified:!0,faceVerified:!0}),e.push("\u2705 Attendance marked successfully"),await(0,o.y4)(),e.push("\ud83d\udd0d Step 6: Verifying attendance record"),await(0,o.Lx)(m.teacher.email,m.teacher.password);const a=await(0,ee.Q8)(n.sessionId);return a&&a.length>0?e.push("\u2705 Attendance record verified in database"):e.push("\u274c Attendance record not found"),await(0,o.y4)(),{success:!0,message:"Complete workflow test successful",details:e}}catch(t){return{success:!1,message:"Complete workflow test failed",error:t.message,details:e}}}}];(0,e.useEffect)(()=>{i(g)},[]);const v=async e=>{c(e.id),h(t=>(0,d.A)((0,d.A)({},t),{},{[e.id]:{status:"running",startTime:Date.now()}}));try{const t=await e.test(),n=Date.now();h(r=>(0,d.A)((0,d.A)({},r),{},{[e.id]:(0,d.A)((0,d.A)({},t),{},{status:t.success?"passed":"failed",duration:n-r[e.id].startTime})}))}catch(t){h(n=>(0,d.A)((0,d.A)({},n),{},{[e.id]:{status:"failed",success:!1,message:"Test execution failed",error:t.message,duration:Date.now()-n[e.id].startTime}}))}c(null)};return(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 p-6",children:(0,l.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,l.jsxs)("div",{className:"text-center mb-8 relative",children:[(0,l.jsxs)("button",{onClick:()=>t("/login"),className:"absolute left-0 top-0 flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:[(0,l.jsx)(M.A,{className:"w-4 h-4"}),"Back to Login"]}),(0,l.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"\ud83e\uddea Attendance System Workflow Test"}),(0,l.jsx)("p",{className:"text-gray-600 text-lg",children:"Comprehensive testing suite for the complete attendance marking workflow"})]}),(0,l.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50 mb-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-4 flex-wrap",children:[(0,l.jsxs)("button",{onClick:async()=>{p(!0),h({});for(const e of a)await v(e),await new Promise(e=>setTimeout(e,1e3));p(!1)},disabled:f,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all duration-300 disabled:opacity-50",children:[f?(0,l.jsx)(U.A,{className:"w-5 h-5 animate-spin"}):(0,l.jsx)(De,{className:"w-5 h-5"}),f?"Running Tests...":"Run All Tests"]}),(0,l.jsx)("button",{onClick:()=>{h({}),c(null)},className:"flex items-center gap-2 px-6 py-3 bg-gray-500 text-white rounded-xl font-semibold hover:bg-gray-600 transition-colors",children:"Clear Results"}),(0,l.jsxs)("button",{onClick:async()=>{try{await(0,o.DY)(m.teacher.email,m.teacher.password,{name:m.teacher.name,role:m.teacher.role}),alert("Teacher account created successfully!\nEmail: srujanreddy1980@gmail.com\nPassword: 12345678")}catch(e){"auth/email-already-in-use"===e.code?alert("Teacher account already exists!\nEmail: srujanreddy1980@gmail.com\nPassword: 12345678"):alert("Error creating teacher account: "+e.message)}},className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all duration-300",children:[(0,l.jsx)(A.A,{className:"w-5 h-5"}),"Create Teacher Account"]}),(0,l.jsxs)("button",{onClick:async()=>{try{await(0,o.DY)(m.admin.email,m.admin.password,{name:m.admin.name,role:m.admin.role}),alert("Admin account created successfully!\nEmail: admin@attendance.com\nPassword: admin123456")}catch(e){"auth/email-already-in-use"===e.code?alert("Admin account already exists!\nEmail: admin@attendance.com\nPassword: admin123456"):alert("Error creating admin account: "+e.message)}},className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all duration-300",children:[(0,l.jsx)(A.A,{className:"w-5 h-5"}),"Create Admin Account"]}),(0,l.jsxs)("button",{onClick:async()=>{try{const{db:r}=await Promise.resolve().then(n.bind(n,1121)),{doc:a,setDoc:i,getDoc:s}=await Promise.resolve().then(n.bind(n,6667)),l=[m.teacher,m.admin,m.student],c=[];for(const u of l)try{if(!(await(0,o.Lx)(u.email,u.password)).success)throw new Error("Missing Firestore data");c.push("\u2705 ".concat(u.role," data already exists")),await(0,o.y4)()}catch(e){try{const{signInWithEmailAndPassword:e}=await Promise.resolve().then(n.bind(n,823)),{auth:t}=await Promise.resolve().then(n.bind(n,1121)),l=await e(t,u.email,u.password),d=a(r,"users",l.user.uid);(await s(d)).exists()?c.push("\u2705 ".concat(u.role," Firestore data already exists")):(await i(d,{name:u.name,email:u.email,role:u.role,studentId:u.studentId||null,teacherId:u.teacherId||null,createdAt:(new Date).toISOString(),isActive:!0}),c.push("\u2705 Fixed ".concat(u.role," Firestore data"))),await(0,o.y4)()}catch(t){c.push("\u274c Could not fix ".concat(u.role,": ").concat(t.message))}}alert("User Data Fix Results:\n"+c.join("\n"))}catch(e){alert("Error fixing user data: "+e.message)}},className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-red-500 to-pink-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all duration-300",children:[(0,l.jsx)(ye,{className:"w-5 h-5"}),"Fix User Data"]})]})}),(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50 mb-8",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4 text-center",children:"\ud83d\udccb Default Test Credentials"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,l.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-xl border border-green-200",children:[(0,l.jsx)("h3",{className:"font-bold text-green-800 mb-2",children:"\ud83d\udc68\u200d\ud83c\udfeb Teacher"}),(0,l.jsxs)("p",{className:"text-sm text-green-700",children:[(0,l.jsx)("strong",{children:"Email:"})," srujanreddy1980@gmail.com",(0,l.jsx)("br",{}),(0,l.jsx)("strong",{children:"Password:"})," 12345678"]})]}),(0,l.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-xl border border-blue-200",children:[(0,l.jsx)("h3",{className:"font-bold text-blue-800 mb-2",children:"\ud83d\udc68\u200d\ud83c\udf93 Student"}),(0,l.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,l.jsx)("strong",{children:"Email:"})," student@test.com",(0,l.jsx)("br",{}),(0,l.jsx)("strong",{children:"Password:"})," test123456"]})]}),(0,l.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-xl border border-purple-200",children:[(0,l.jsx)("h3",{className:"font-bold text-purple-800 mb-2",children:"\ud83d\udc68\u200d\ud83d\udcbc Admin"}),(0,l.jsxs)("p",{className:"text-sm text-purple-700",children:[(0,l.jsx)("strong",{children:"Email:"})," admin@attendance.com",(0,l.jsx)("br",{}),(0,l.jsx)("strong",{children:"Password:"})," admin123456"]})]})]})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:a.map(e=>{const t=u[e.id],n=s===e.id;return(0,l.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:e.name}),(0,l.jsx)("p",{className:"text-gray-600",children:e.description})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[n&&(0,l.jsx)(U.A,{className:"w-5 h-5 text-blue-500 animate-spin"}),"passed"===(null===t||void 0===t?void 0:t.status)&&(0,l.jsx)(y.A,{className:"w-5 h-5 text-green-500"}),"failed"===(null===t||void 0===t?void 0:t.status)&&(0,l.jsx)(J,{className:"w-5 h-5 text-red-500"}),"running"===(null===t||void 0===t?void 0:t.status)&&(0,l.jsx)(X.A,{className:"w-5 h-5 text-yellow-500"})]})]}),t&&(0,l.jsxs)("div",{className:"mt-4 p-4 rounded-xl bg-white/60",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("span",{className:"font-semibold ".concat(t.success?"text-green-600":"text-red-600"),children:t.message}),t.duration&&(0,l.jsxs)("span",{className:"text-sm text-gray-500",children:[t.duration,"ms"]})]}),t.error&&(0,l.jsxs)("div",{className:"text-red-600 text-sm mb-2",children:[(0,l.jsx)(ye,{className:"w-4 h-4 inline mr-1"}),t.error]}),t.details&&(0,l.jsx)("div",{className:"text-sm text-gray-600",children:Array.isArray(t.details)?(0,l.jsx)("ul",{className:"list-disc list-inside space-y-1",children:t.details.map((e,t)=>(0,l.jsx)("li",{children:e},t))}):(0,l.jsx)("pre",{className:"whitespace-pre-wrap bg-gray-100 p-2 rounded text-xs",children:JSON.stringify(t.details,null,2)})})]}),(0,l.jsx)("button",{onClick:()=>v(e),disabled:n||s===e.id,className:"w-full mt-4 px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-xl font-medium transition-colors disabled:opacity-50",children:s===e.id?"Running...":"Run Test"})]},e.id)})}),Object.keys(u).length>0&&(0,l.jsxs)("div",{className:"mt-8 bg-white/70 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-white/50",children:[(0,l.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Test Summary"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,l.jsxs)("div",{className:"p-4 bg-green-100 rounded-xl",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-green-600",children:Object.values(u).filter(e=>"passed"===e.status).length}),(0,l.jsx)("div",{className:"text-green-700",children:"Passed"})]}),(0,l.jsxs)("div",{className:"p-4 bg-red-100 rounded-xl",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-red-600",children:Object.values(u).filter(e=>"failed"===e.status).length}),(0,l.jsx)("div",{className:"text-red-700",children:"Failed"})]}),(0,l.jsxs)("div",{className:"p-4 bg-gray-100 rounded-xl",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-gray-600",children:Object.values(u).length}),(0,l.jsx)("div",{className:"text-gray-700",children:"Total"})]})]})]})]})})};var Me=n(2963);function Fe(){const{currentUser:t,userData:n}=(0,a.A)(),i=(0,r.Zp)();(0,e.useEffect)(()=>{s()},[]);const d=(0,e.useCallback)(e=>{console.log("User logged in:",e)},[]),h=(0,e.useCallback)(e=>{i("/login")},[i]),f=(0,e.useCallback)(async()=>{try{await(0,o.y4)(),i("/login")}catch(e){console.error("Logout failed:",e)}},[i]),p=e=>{let{children:a,requiredRole:i=null}=e;if(!t||!n)return(0,l.jsx)(r.C5,{to:"/login",replace:!0});if(i&&n.role!==i){if("teacher"===n.role)return(0,l.jsx)(r.C5,{to:"/teacher",replace:!0});if("student"===n.role)return(0,l.jsx)(r.C5,{to:"/student",replace:!0});if("parent"===n.role)return(0,l.jsx)(r.C5,{to:"/parent",replace:!0});if("admin"===n.role)return(0,l.jsx)(r.C5,{to:"/admin",replace:!0})}return a},m=e=>{let{children:a}=e;if(t&&n){if("teacher"===n.role)return(0,l.jsx)(r.C5,{to:"/teacher",replace:!0});if("student"===n.role)return(0,l.jsx)(r.C5,{to:"/student",replace:!0});if("parent"===n.role)return(0,l.jsx)(r.C5,{to:"/parent",replace:!0});if("admin"===n.role)return(0,l.jsx)(r.C5,{to:"/admin",replace:!0})}return a};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(u,{}),(0,l.jsx)("main",{id:"main-content",children:(0,l.jsx)(e.Suspense,{fallback:(0,l.jsx)(c,{text:"Loading application..."}),children:(0,l.jsxs)(r.BV,{children:[(0,l.jsx)(r.qh,{path:"/workflow-test",element:(0,l.jsx)(Re,{})}),(0,l.jsx)(r.qh,{path:"/login",element:(0,l.jsx)(m,{children:(0,l.jsx)(k,{onLogin:d,onNavigateToRegister:()=>i("/register")})})}),(0,l.jsx)(r.qh,{path:"/register",element:(0,l.jsx)(m,{children:(0,l.jsx)(W,{onRegister:h,onNavigateToLogin:()=>i("/login"),initialUserType:"student"})})}),(0,l.jsx)(r.qh,{path:"/teacher",element:(0,l.jsx)(p,{requiredRole:"teacher",children:(0,l.jsx)(ne,{onLogout:f})})}),(0,l.jsx)(r.qh,{path:"/teacher/classrooms",element:(0,l.jsx)(p,{requiredRole:"teacher",children:(0,l.jsx)(e.Suspense,{fallback:(0,l.jsx)(c,{text:"Loading classrooms..."}),children:(0,l.jsx)(Oe.default,{})})})}),(0,l.jsx)(r.qh,{path:"/teacher/classroom/:classroomId",element:(0,l.jsx)(p,{requiredRole:"teacher",children:(0,l.jsx)(e.Suspense,{fallback:(0,l.jsx)(c,{text:"Loading classroom details..."}),children:(0,l.jsx)(Pe.default,{})})})}),(0,l.jsx)(r.qh,{path:"/student",element:(0,l.jsx)(p,{requiredRole:"student",children:(0,l.jsx)(fe,{onLogout:f})})}),(0,l.jsx)(r.qh,{path:"/parent",element:(0,l.jsx)(p,{requiredRole:"parent",children:(0,l.jsx)(e.Suspense,{fallback:(0,l.jsx)(c,{text:"Loading parent dashboard..."}),children:(0,l.jsx)(Te,{onLogout:f})})})}),(0,l.jsx)(r.qh,{path:"/admin",element:(0,l.jsx)(p,{requiredRole:"admin",children:(0,l.jsx)(e.Suspense,{fallback:(0,l.jsx)(c,{text:"Loading admin dashboard..."}),children:(0,l.jsx)(Me.default,{onLogout:f})})})}),(0,l.jsx)(r.qh,{path:"/",element:t&&n?"teacher"===n.role?(0,l.jsx)(r.C5,{to:"/teacher",replace:!0}):"student"===n.role?(0,l.jsx)(r.C5,{to:"/student",replace:!0}):"parent"===n.role?(0,l.jsx)(r.C5,{to:"/parent",replace:!0}):"admin"===n.role?(0,l.jsx)(r.C5,{to:"/admin",replace:!0}):(0,l.jsx)(r.C5,{to:"/login",replace:!0}):(0,l.jsx)(r.C5,{to:"/login",replace:!0})}),(0,l.jsx)(r.qh,{path:"*",element:(0,l.jsx)(r.C5,{to:"/",replace:!0})})]})})})]})}function Le(){return(0,l.jsx)(r.Kd,{children:(0,l.jsx)(a.O,{children:(0,l.jsx)(i.ph,{children:(0,l.jsx)(Fe,{})})})})}const Be=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,6453)).then(t=>{let{getCLS:n,getFID:r,getFCP:a,getLCP:i,getTTFB:o}=t;n(e),r(e),a(e),i(e),o(e)})};t.createRoot(document.getElementById("root")).render((0,l.jsx)(Le,{})),Be()})()})();
//# sourceMappingURL=main.7989feb0.js.map